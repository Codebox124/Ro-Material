var y5=Object.defineProperty;var _5=(e,r,a)=>r in e?y5(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var lg=(e,r,a)=>_5(e,typeof r!="symbol"?r+"":r,a);function x5(e,r){for(var a=0;a<r.length;a++){const u=r[a];if(typeof u!="string"&&!Array.isArray(u)){for(const g in u)if(g!=="default"&&!(g in e)){const _=Object.getOwnPropertyDescriptor(u,g);_&&Object.defineProperty(e,g,_.get?_:{enumerable:!0,get:()=>u[g]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))u(g);new MutationObserver(g=>{for(const _ of g)if(_.type==="childList")for(const M of _.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&u(M)}).observe(document,{childList:!0,subtree:!0});function a(g){const _={};return g.integrity&&(_.integrity=g.integrity),g.referrerPolicy&&(_.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?_.credentials="include":g.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function u(g){if(g.ep)return;g.ep=!0;const _=a(g);fetch(g.href,_)}})();var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fD={exports:{}},xv={},mD={exports:{}},Hn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cy=Symbol.for("react.element"),v5=Symbol.for("react.portal"),b5=Symbol.for("react.fragment"),w5=Symbol.for("react.strict_mode"),S5=Symbol.for("react.profiler"),T5=Symbol.for("react.provider"),C5=Symbol.for("react.context"),M5=Symbol.for("react.forward_ref"),E5=Symbol.for("react.suspense"),I5=Symbol.for("react.memo"),k5=Symbol.for("react.lazy"),Sk=Symbol.iterator;function P5(e){return e===null||typeof e!="object"?null:(e=Sk&&e[Sk]||e["@@iterator"],typeof e=="function"?e:null)}var gD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yD=Object.assign,_D={};function gf(e,r,a){this.props=e,this.context=r,this.refs=_D,this.updater=a||gD}gf.prototype.isReactComponent={};gf.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};gf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function xD(){}xD.prototype=gf.prototype;function vT(e,r,a){this.props=e,this.context=r,this.refs=_D,this.updater=a||gD}var bT=vT.prototype=new xD;bT.constructor=vT;yD(bT,gf.prototype);bT.isPureReactComponent=!0;var Tk=Array.isArray,vD=Object.prototype.hasOwnProperty,wT={current:null},bD={key:!0,ref:!0,__self:!0,__source:!0};function wD(e,r,a){var u,g={},_=null,M=null;if(r!=null)for(u in r.ref!==void 0&&(M=r.ref),r.key!==void 0&&(_=""+r.key),r)vD.call(r,u)&&!bD.hasOwnProperty(u)&&(g[u]=r[u]);var D=arguments.length-2;if(D===1)g.children=a;else if(1<D){for(var i=Array(D),j=0;j<D;j++)i[j]=arguments[j+2];g.children=i}if(e&&e.defaultProps)for(u in D=e.defaultProps,D)g[u]===void 0&&(g[u]=D[u]);return{$$typeof:Cy,type:e,key:_,ref:M,props:g,_owner:wT.current}}function A5(e,r){return{$$typeof:Cy,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function ST(e){return typeof e=="object"&&e!==null&&e.$$typeof===Cy}function D5(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return r[a]})}var Ck=/\/+/g;function vw(e,r){return typeof e=="object"&&e!==null&&e.key!=null?D5(""+e.key):r.toString(36)}function fx(e,r,a,u,g){var _=typeof e;(_==="undefined"||_==="boolean")&&(e=null);var M=!1;if(e===null)M=!0;else switch(_){case"string":case"number":M=!0;break;case"object":switch(e.$$typeof){case Cy:case v5:M=!0}}if(M)return M=e,g=g(M),e=u===""?"."+vw(M,0):u,Tk(g)?(a="",e!=null&&(a=e.replace(Ck,"$&/")+"/"),fx(g,r,a,"",function(j){return j})):g!=null&&(ST(g)&&(g=A5(g,a+(!g.key||M&&M.key===g.key?"":(""+g.key).replace(Ck,"$&/")+"/")+e)),r.push(g)),1;if(M=0,u=u===""?".":u+":",Tk(e))for(var D=0;D<e.length;D++){_=e[D];var i=u+vw(_,D);M+=fx(_,r,a,i,g)}else if(i=P5(e),typeof i=="function")for(e=i.call(e),D=0;!(_=e.next()).done;)_=_.value,i=u+vw(_,D++),M+=fx(_,r,a,i,g);else if(_==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return M}function R0(e,r,a){if(e==null)return e;var u=[],g=0;return fx(e,u,"","",function(_){return r.call(a,_,g++)}),u}function R5(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var hs={current:null},mx={transition:null},L5={ReactCurrentDispatcher:hs,ReactCurrentBatchConfig:mx,ReactCurrentOwner:wT};function SD(){throw Error("act(...) is not supported in production builds of React.")}Hn.Children={map:R0,forEach:function(e,r,a){R0(e,function(){r.apply(this,arguments)},a)},count:function(e){var r=0;return R0(e,function(){r++}),r},toArray:function(e){return R0(e,function(r){return r})||[]},only:function(e){if(!ST(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Hn.Component=gf;Hn.Fragment=b5;Hn.Profiler=S5;Hn.PureComponent=vT;Hn.StrictMode=w5;Hn.Suspense=E5;Hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L5;Hn.act=SD;Hn.cloneElement=function(e,r,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=yD({},e.props),g=e.key,_=e.ref,M=e._owner;if(r!=null){if(r.ref!==void 0&&(_=r.ref,M=wT.current),r.key!==void 0&&(g=""+r.key),e.type&&e.type.defaultProps)var D=e.type.defaultProps;for(i in r)vD.call(r,i)&&!bD.hasOwnProperty(i)&&(u[i]=r[i]===void 0&&D!==void 0?D[i]:r[i])}var i=arguments.length-2;if(i===1)u.children=a;else if(1<i){D=Array(i);for(var j=0;j<i;j++)D[j]=arguments[j+2];u.children=D}return{$$typeof:Cy,type:e.type,key:g,ref:_,props:u,_owner:M}};Hn.createContext=function(e){return e={$$typeof:C5,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:T5,_context:e},e.Consumer=e};Hn.createElement=wD;Hn.createFactory=function(e){var r=wD.bind(null,e);return r.type=e,r};Hn.createRef=function(){return{current:null}};Hn.forwardRef=function(e){return{$$typeof:M5,render:e}};Hn.isValidElement=ST;Hn.lazy=function(e){return{$$typeof:k5,_payload:{_status:-1,_result:e},_init:R5}};Hn.memo=function(e,r){return{$$typeof:I5,type:e,compare:r===void 0?null:r}};Hn.startTransition=function(e){var r=mx.transition;mx.transition={};try{e()}finally{mx.transition=r}};Hn.unstable_act=SD;Hn.useCallback=function(e,r){return hs.current.useCallback(e,r)};Hn.useContext=function(e){return hs.current.useContext(e)};Hn.useDebugValue=function(){};Hn.useDeferredValue=function(e){return hs.current.useDeferredValue(e)};Hn.useEffect=function(e,r){return hs.current.useEffect(e,r)};Hn.useId=function(){return hs.current.useId()};Hn.useImperativeHandle=function(e,r,a){return hs.current.useImperativeHandle(e,r,a)};Hn.useInsertionEffect=function(e,r){return hs.current.useInsertionEffect(e,r)};Hn.useLayoutEffect=function(e,r){return hs.current.useLayoutEffect(e,r)};Hn.useMemo=function(e,r){return hs.current.useMemo(e,r)};Hn.useReducer=function(e,r,a){return hs.current.useReducer(e,r,a)};Hn.useRef=function(e){return hs.current.useRef(e)};Hn.useState=function(e){return hs.current.useState(e)};Hn.useSyncExternalStore=function(e,r,a){return hs.current.useSyncExternalStore(e,r,a)};Hn.useTransition=function(){return hs.current.useTransition()};Hn.version="18.3.1";mD.exports=Hn;var Y=mD.exports;const Fn=Bl(Y),Dx=x5({__proto__:null,default:Fn},[Y]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z5=Y,O5=Symbol.for("react.element"),F5=Symbol.for("react.fragment"),B5=Object.prototype.hasOwnProperty,j5=z5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,N5={key:!0,ref:!0,__self:!0,__source:!0};function TD(e,r,a){var u,g={},_=null,M=null;a!==void 0&&(_=""+a),r.key!==void 0&&(_=""+r.key),r.ref!==void 0&&(M=r.ref);for(u in r)B5.call(r,u)&&!N5.hasOwnProperty(u)&&(g[u]=r[u]);if(e&&e.defaultProps)for(u in r=e.defaultProps,r)g[u]===void 0&&(g[u]=r[u]);return{$$typeof:O5,type:e,key:_,ref:M,props:g,_owner:j5.current}}xv.Fragment=F5;xv.jsx=TD;xv.jsxs=TD;fD.exports=xv;var L=fD.exports,CD={exports:{}},Zs={},MD={exports:{}},ED={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(De,Ke){var Ge=De.length;De.push(Ke);e:for(;0<Ge;){var ft=Ge-1>>>1,Gt=De[ft];if(0<g(Gt,Ke))De[ft]=Ke,De[Ge]=Gt,Ge=ft;else break e}}function a(De){return De.length===0?null:De[0]}function u(De){if(De.length===0)return null;var Ke=De[0],Ge=De.pop();if(Ge!==Ke){De[0]=Ge;e:for(var ft=0,Gt=De.length,Ft=Gt>>>1;ft<Ft;){var wt=2*(ft+1)-1,Rt=De[wt],It=wt+1,zt=De[It];if(0>g(Rt,Ge))It<Gt&&0>g(zt,Rt)?(De[ft]=zt,De[It]=Ge,ft=It):(De[ft]=Rt,De[wt]=Ge,ft=wt);else if(It<Gt&&0>g(zt,Ge))De[ft]=zt,De[It]=Ge,ft=It;else break e}}return Ke}function g(De,Ke){var Ge=De.sortIndex-Ke.sortIndex;return Ge!==0?Ge:De.id-Ke.id}if(typeof performance=="object"&&typeof performance.now=="function"){var _=performance;e.unstable_now=function(){return _.now()}}else{var M=Date,D=M.now();e.unstable_now=function(){return M.now()-D}}var i=[],j=[],H=1,q=null,X=3,se=!1,ne=!1,le=!1,de=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function K(De){for(var Ke=a(j);Ke!==null;){if(Ke.callback===null)u(j);else if(Ke.startTime<=De)u(j),Ke.sortIndex=Ke.expirationTime,r(i,Ke);else break;Ke=a(j)}}function ce(De){if(le=!1,K(De),!ne)if(a(i)!==null)ne=!0,Pe(fe);else{var Ke=a(j);Ke!==null&&tt(ce,Ke.startTime-De)}}function fe(De,Ke){ne=!1,le&&(le=!1,te(we),we=-1),se=!0;var Ge=X;try{for(K(Ke),q=a(i);q!==null&&(!(q.expirationTime>Ke)||De&&!ve());){var ft=q.callback;if(typeof ft=="function"){q.callback=null,X=q.priorityLevel;var Gt=ft(q.expirationTime<=Ke);Ke=e.unstable_now(),typeof Gt=="function"?q.callback=Gt:q===a(i)&&u(i),K(Ke)}else u(i);q=a(i)}if(q!==null)var Ft=!0;else{var wt=a(j);wt!==null&&tt(ce,wt.startTime-Ke),Ft=!1}return Ft}finally{q=null,X=Ge,se=!1}}var Ie=!1,Ce=null,we=-1,ot=5,oe=-1;function ve(){return!(e.unstable_now()-oe<ot)}function je(){if(Ce!==null){var De=e.unstable_now();oe=De;var Ke=!0;try{Ke=Ce(!0,De)}finally{Ke?He():(Ie=!1,Ce=null)}}else Ie=!1}var He;if(typeof Q=="function")He=function(){Q(je)};else if(typeof MessageChannel<"u"){var Le=new MessageChannel,ze=Le.port2;Le.port1.onmessage=je,He=function(){ze.postMessage(null)}}else He=function(){de(je,0)};function Pe(De){Ce=De,Ie||(Ie=!0,He())}function tt(De,Ke){we=de(function(){De(e.unstable_now())},Ke)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(De){De.callback=null},e.unstable_continueExecution=function(){ne||se||(ne=!0,Pe(fe))},e.unstable_forceFrameRate=function(De){0>De||125<De?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ot=0<De?Math.floor(1e3/De):5},e.unstable_getCurrentPriorityLevel=function(){return X},e.unstable_getFirstCallbackNode=function(){return a(i)},e.unstable_next=function(De){switch(X){case 1:case 2:case 3:var Ke=3;break;default:Ke=X}var Ge=X;X=Ke;try{return De()}finally{X=Ge}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(De,Ke){switch(De){case 1:case 2:case 3:case 4:case 5:break;default:De=3}var Ge=X;X=De;try{return Ke()}finally{X=Ge}},e.unstable_scheduleCallback=function(De,Ke,Ge){var ft=e.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?ft+Ge:ft):Ge=ft,De){case 1:var Gt=-1;break;case 2:Gt=250;break;case 5:Gt=1073741823;break;case 4:Gt=1e4;break;default:Gt=5e3}return Gt=Ge+Gt,De={id:H++,callback:Ke,priorityLevel:De,startTime:Ge,expirationTime:Gt,sortIndex:-1},Ge>ft?(De.sortIndex=Ge,r(j,De),a(i)===null&&De===a(j)&&(le?(te(we),we=-1):le=!0,tt(ce,Ge-ft))):(De.sortIndex=Gt,r(i,De),ne||se||(ne=!0,Pe(fe))),De},e.unstable_shouldYield=ve,e.unstable_wrapCallback=function(De){var Ke=X;return function(){var Ge=X;X=Ke;try{return De.apply(this,arguments)}finally{X=Ge}}}})(ED);MD.exports=ED;var V5=MD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $5=Y,Gs=V5;function mr(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ID=new Set,ey={};function Qd(e,r){nf(e,r),nf(e+"Capture",r)}function nf(e,r){for(ey[e]=r,e=0;e<r.length;e++)ID.add(r[e])}var hc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uS=Object.prototype.hasOwnProperty,U5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mk={},Ek={};function W5(e){return uS.call(Ek,e)?!0:uS.call(Mk,e)?!1:U5.test(e)?Ek[e]=!0:(Mk[e]=!0,!1)}function G5(e,r,a,u){if(a!==null&&a.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return u?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function H5(e,r,a,u){if(r===null||typeof r>"u"||G5(e,r,a,u))return!0;if(u)return!1;if(a!==null)switch(a.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function ps(e,r,a,u,g,_,M){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=u,this.attributeNamespace=g,this.mustUseProperty=a,this.propertyName=e,this.type=r,this.sanitizeURL=_,this.removeEmptyString=M}var Fo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Fo[e]=new ps(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];Fo[r]=new ps(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Fo[e]=new ps(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Fo[e]=new ps(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Fo[e]=new ps(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Fo[e]=new ps(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Fo[e]=new ps(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Fo[e]=new ps(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Fo[e]=new ps(e,5,!1,e.toLowerCase(),null,!1,!1)});var TT=/[\-:]([a-z])/g;function CT(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(TT,CT);Fo[r]=new ps(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(TT,CT);Fo[r]=new ps(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(TT,CT);Fo[r]=new ps(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Fo[e]=new ps(e,1,!1,e.toLowerCase(),null,!1,!1)});Fo.xlinkHref=new ps("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Fo[e]=new ps(e,1,!1,e.toLowerCase(),null,!0,!0)});function MT(e,r,a,u){var g=Fo.hasOwnProperty(r)?Fo[r]:null;(g!==null?g.type!==0:u||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(H5(r,a,g,u)&&(a=null),u||g===null?W5(r)&&(a===null?e.removeAttribute(r):e.setAttribute(r,""+a)):g.mustUseProperty?e[g.propertyName]=a===null?g.type===3?!1:"":a:(r=g.attributeName,u=g.attributeNamespace,a===null?e.removeAttribute(r):(g=g.type,a=g===3||g===4&&a===!0?"":""+a,u?e.setAttributeNS(u,r,a):e.setAttribute(r,a))))}var _c=$5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L0=Symbol.for("react.element"),Ep=Symbol.for("react.portal"),Ip=Symbol.for("react.fragment"),ET=Symbol.for("react.strict_mode"),dS=Symbol.for("react.profiler"),kD=Symbol.for("react.provider"),PD=Symbol.for("react.context"),IT=Symbol.for("react.forward_ref"),hS=Symbol.for("react.suspense"),pS=Symbol.for("react.suspense_list"),kT=Symbol.for("react.memo"),mu=Symbol.for("react.lazy"),AD=Symbol.for("react.offscreen"),Ik=Symbol.iterator;function cg(e){return e===null||typeof e!="object"?null:(e=Ik&&e[Ik]||e["@@iterator"],typeof e=="function"?e:null)}var qi=Object.assign,bw;function Pg(e){if(bw===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);bw=r&&r[1]||""}return`
`+bw+e}var ww=!1;function Sw(e,r){if(!e||ww)return"";ww=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(j){var u=j}Reflect.construct(e,[],r)}else{try{r.call()}catch(j){u=j}e.call(r.prototype)}else{try{throw Error()}catch(j){u=j}e()}}catch(j){if(j&&u&&typeof j.stack=="string"){for(var g=j.stack.split(`
`),_=u.stack.split(`
`),M=g.length-1,D=_.length-1;1<=M&&0<=D&&g[M]!==_[D];)D--;for(;1<=M&&0<=D;M--,D--)if(g[M]!==_[D]){if(M!==1||D!==1)do if(M--,D--,0>D||g[M]!==_[D]){var i=`
`+g[M].replace(" at new "," at ");return e.displayName&&i.includes("<anonymous>")&&(i=i.replace("<anonymous>",e.displayName)),i}while(1<=M&&0<=D);break}}}finally{ww=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Pg(e):""}function q5(e){switch(e.tag){case 5:return Pg(e.type);case 16:return Pg("Lazy");case 13:return Pg("Suspense");case 19:return Pg("SuspenseList");case 0:case 2:case 15:return e=Sw(e.type,!1),e;case 11:return e=Sw(e.type.render,!1),e;case 1:return e=Sw(e.type,!0),e;default:return""}}function fS(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ip:return"Fragment";case Ep:return"Portal";case dS:return"Profiler";case ET:return"StrictMode";case hS:return"Suspense";case pS:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case PD:return(e.displayName||"Context")+".Consumer";case kD:return(e._context.displayName||"Context")+".Provider";case IT:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case kT:return r=e.displayName||null,r!==null?r:fS(e.type)||"Memo";case mu:r=e._payload,e=e._init;try{return fS(e(r))}catch{}}return null}function Z5(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return fS(r);case 8:return r===ET?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Pu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function DD(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Y5(e){var r=DD(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),u=""+e[r];if(!e.hasOwnProperty(r)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var g=a.get,_=a.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return g.call(this)},set:function(M){u=""+M,_.call(this,M)}}),Object.defineProperty(e,r,{enumerable:a.enumerable}),{getValue:function(){return u},setValue:function(M){u=""+M},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function z0(e){e._valueTracker||(e._valueTracker=Y5(e))}function RD(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var a=r.getValue(),u="";return e&&(u=DD(e)?e.checked?"true":"false":e.value),e=u,e!==a?(r.setValue(e),!0):!1}function Rx(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function mS(e,r){var a=r.checked;return qi({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function kk(e,r){var a=r.defaultValue==null?"":r.defaultValue,u=r.checked!=null?r.checked:r.defaultChecked;a=Pu(r.value!=null?r.value:a),e._wrapperState={initialChecked:u,initialValue:a,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function LD(e,r){r=r.checked,r!=null&&MT(e,"checked",r,!1)}function gS(e,r){LD(e,r);var a=Pu(r.value),u=r.type;if(a!=null)u==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?yS(e,r.type,a):r.hasOwnProperty("defaultValue")&&yS(e,r.type,Pu(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Pk(e,r,a){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var u=r.type;if(!(u!=="submit"&&u!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,a||r===e.value||(e.value=r),e.defaultValue=r}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function yS(e,r,a){(r!=="number"||Rx(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var Ag=Array.isArray;function Wp(e,r,a,u){if(e=e.options,r){r={};for(var g=0;g<a.length;g++)r["$"+a[g]]=!0;for(a=0;a<e.length;a++)g=r.hasOwnProperty("$"+e[a].value),e[a].selected!==g&&(e[a].selected=g),g&&u&&(e[a].defaultSelected=!0)}else{for(a=""+Pu(a),r=null,g=0;g<e.length;g++){if(e[g].value===a){e[g].selected=!0,u&&(e[g].defaultSelected=!0);return}r!==null||e[g].disabled||(r=e[g])}r!==null&&(r.selected=!0)}}function _S(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(mr(91));return qi({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ak(e,r){var a=r.value;if(a==null){if(a=r.children,r=r.defaultValue,a!=null){if(r!=null)throw Error(mr(92));if(Ag(a)){if(1<a.length)throw Error(mr(93));a=a[0]}r=a}r==null&&(r=""),a=r}e._wrapperState={initialValue:Pu(a)}}function zD(e,r){var a=Pu(r.value),u=Pu(r.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),r.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),u!=null&&(e.defaultValue=""+u)}function Dk(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function OD(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xS(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?OD(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var O0,FD=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,a,u,g){MSApp.execUnsafeLocalFunction(function(){return e(r,a,u,g)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(O0=O0||document.createElement("div"),O0.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=O0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function ty(e,r){if(r){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=r;return}}e.textContent=r}var Bg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},X5=["Webkit","ms","Moz","O"];Object.keys(Bg).forEach(function(e){X5.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),Bg[r]=Bg[e]})});function BD(e,r,a){return r==null||typeof r=="boolean"||r===""?"":a||typeof r!="number"||r===0||Bg.hasOwnProperty(e)&&Bg[e]?(""+r).trim():r+"px"}function jD(e,r){e=e.style;for(var a in r)if(r.hasOwnProperty(a)){var u=a.indexOf("--")===0,g=BD(a,r[a],u);a==="float"&&(a="cssFloat"),u?e.setProperty(a,g):e[a]=g}}var K5=qi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vS(e,r){if(r){if(K5[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(mr(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(mr(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(mr(61))}if(r.style!=null&&typeof r.style!="object")throw Error(mr(62))}}function bS(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wS=null;function PT(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var SS=null,Gp=null,Hp=null;function Rk(e){if(e=Iy(e)){if(typeof SS!="function")throw Error(mr(280));var r=e.stateNode;r&&(r=Tv(r),SS(e.stateNode,e.type,r))}}function ND(e){Gp?Hp?Hp.push(e):Hp=[e]:Gp=e}function VD(){if(Gp){var e=Gp,r=Hp;if(Hp=Gp=null,Rk(e),r)for(e=0;e<r.length;e++)Rk(r[e])}}function $D(e,r){return e(r)}function UD(){}var Tw=!1;function WD(e,r,a){if(Tw)return e(r,a);Tw=!0;try{return $D(e,r,a)}finally{Tw=!1,(Gp!==null||Hp!==null)&&(UD(),VD())}}function ry(e,r){var a=e.stateNode;if(a===null)return null;var u=Tv(a);if(u===null)return null;a=u[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(mr(231,r,typeof a));return a}var TS=!1;if(hc)try{var ug={};Object.defineProperty(ug,"passive",{get:function(){TS=!0}}),window.addEventListener("test",ug,ug),window.removeEventListener("test",ug,ug)}catch{TS=!1}function J5(e,r,a,u,g,_,M,D,i){var j=Array.prototype.slice.call(arguments,3);try{r.apply(a,j)}catch(H){this.onError(H)}}var jg=!1,Lx=null,zx=!1,CS=null,Q5={onError:function(e){jg=!0,Lx=e}};function eB(e,r,a,u,g,_,M,D,i){jg=!1,Lx=null,J5.apply(Q5,arguments)}function tB(e,r,a,u,g,_,M,D,i){if(eB.apply(this,arguments),jg){if(jg){var j=Lx;jg=!1,Lx=null}else throw Error(mr(198));zx||(zx=!0,CS=j)}}function eh(e){var r=e,a=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(a=r.return),e=r.return;while(e)}return r.tag===3?a:null}function GD(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function Lk(e){if(eh(e)!==e)throw Error(mr(188))}function rB(e){var r=e.alternate;if(!r){if(r=eh(e),r===null)throw Error(mr(188));return r!==e?null:e}for(var a=e,u=r;;){var g=a.return;if(g===null)break;var _=g.alternate;if(_===null){if(u=g.return,u!==null){a=u;continue}break}if(g.child===_.child){for(_=g.child;_;){if(_===a)return Lk(g),e;if(_===u)return Lk(g),r;_=_.sibling}throw Error(mr(188))}if(a.return!==u.return)a=g,u=_;else{for(var M=!1,D=g.child;D;){if(D===a){M=!0,a=g,u=_;break}if(D===u){M=!0,u=g,a=_;break}D=D.sibling}if(!M){for(D=_.child;D;){if(D===a){M=!0,a=_,u=g;break}if(D===u){M=!0,u=_,a=g;break}D=D.sibling}if(!M)throw Error(mr(189))}}if(a.alternate!==u)throw Error(mr(190))}if(a.tag!==3)throw Error(mr(188));return a.stateNode.current===a?e:r}function HD(e){return e=rB(e),e!==null?qD(e):null}function qD(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=qD(e);if(r!==null)return r;e=e.sibling}return null}var ZD=Gs.unstable_scheduleCallback,zk=Gs.unstable_cancelCallback,nB=Gs.unstable_shouldYield,iB=Gs.unstable_requestPaint,no=Gs.unstable_now,oB=Gs.unstable_getCurrentPriorityLevel,AT=Gs.unstable_ImmediatePriority,YD=Gs.unstable_UserBlockingPriority,Ox=Gs.unstable_NormalPriority,sB=Gs.unstable_LowPriority,XD=Gs.unstable_IdlePriority,vv=null,zl=null;function aB(e){if(zl&&typeof zl.onCommitFiberRoot=="function")try{zl.onCommitFiberRoot(vv,e,void 0,(e.current.flags&128)===128)}catch{}}var Ya=Math.clz32?Math.clz32:uB,lB=Math.log,cB=Math.LN2;function uB(e){return e>>>=0,e===0?32:31-(lB(e)/cB|0)|0}var F0=64,B0=4194304;function Dg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fx(e,r){var a=e.pendingLanes;if(a===0)return 0;var u=0,g=e.suspendedLanes,_=e.pingedLanes,M=a&268435455;if(M!==0){var D=M&~g;D!==0?u=Dg(D):(_&=M,_!==0&&(u=Dg(_)))}else M=a&~g,M!==0?u=Dg(M):_!==0&&(u=Dg(_));if(u===0)return 0;if(r!==0&&r!==u&&!(r&g)&&(g=u&-u,_=r&-r,g>=_||g===16&&(_&4194240)!==0))return r;if(u&4&&(u|=a&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=u;0<r;)a=31-Ya(r),g=1<<a,u|=e[a],r&=~g;return u}function dB(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hB(e,r){for(var a=e.suspendedLanes,u=e.pingedLanes,g=e.expirationTimes,_=e.pendingLanes;0<_;){var M=31-Ya(_),D=1<<M,i=g[M];i===-1?(!(D&a)||D&u)&&(g[M]=dB(D,r)):i<=r&&(e.expiredLanes|=D),_&=~D}}function MS(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function KD(){var e=F0;return F0<<=1,!(F0&4194240)&&(F0=64),e}function Cw(e){for(var r=[],a=0;31>a;a++)r.push(e);return r}function My(e,r,a){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Ya(r),e[r]=a}function pB(e,r){var a=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<a;){var g=31-Ya(a),_=1<<g;r[g]=0,u[g]=-1,e[g]=-1,a&=~_}}function DT(e,r){var a=e.entangledLanes|=r;for(e=e.entanglements;a;){var u=31-Ya(a),g=1<<u;g&r|e[u]&r&&(e[u]|=r),a&=~g}}var mi=0;function JD(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var QD,RT,eR,tR,rR,ES=!1,j0=[],wu=null,Su=null,Tu=null,ny=new Map,iy=new Map,yu=[],fB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ok(e,r){switch(e){case"focusin":case"focusout":wu=null;break;case"dragenter":case"dragleave":Su=null;break;case"mouseover":case"mouseout":Tu=null;break;case"pointerover":case"pointerout":ny.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":iy.delete(r.pointerId)}}function dg(e,r,a,u,g,_){return e===null||e.nativeEvent!==_?(e={blockedOn:r,domEventName:a,eventSystemFlags:u,nativeEvent:_,targetContainers:[g]},r!==null&&(r=Iy(r),r!==null&&RT(r)),e):(e.eventSystemFlags|=u,r=e.targetContainers,g!==null&&r.indexOf(g)===-1&&r.push(g),e)}function mB(e,r,a,u,g){switch(r){case"focusin":return wu=dg(wu,e,r,a,u,g),!0;case"dragenter":return Su=dg(Su,e,r,a,u,g),!0;case"mouseover":return Tu=dg(Tu,e,r,a,u,g),!0;case"pointerover":var _=g.pointerId;return ny.set(_,dg(ny.get(_)||null,e,r,a,u,g)),!0;case"gotpointercapture":return _=g.pointerId,iy.set(_,dg(iy.get(_)||null,e,r,a,u,g)),!0}return!1}function nR(e){var r=Fd(e.target);if(r!==null){var a=eh(r);if(a!==null){if(r=a.tag,r===13){if(r=GD(a),r!==null){e.blockedOn=r,rR(e.priority,function(){eR(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gx(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var a=IS(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);wS=u,a.target.dispatchEvent(u),wS=null}else return r=Iy(a),r!==null&&RT(r),e.blockedOn=a,!1;r.shift()}return!0}function Fk(e,r,a){gx(e)&&a.delete(r)}function gB(){ES=!1,wu!==null&&gx(wu)&&(wu=null),Su!==null&&gx(Su)&&(Su=null),Tu!==null&&gx(Tu)&&(Tu=null),ny.forEach(Fk),iy.forEach(Fk)}function hg(e,r){e.blockedOn===r&&(e.blockedOn=null,ES||(ES=!0,Gs.unstable_scheduleCallback(Gs.unstable_NormalPriority,gB)))}function oy(e){function r(g){return hg(g,e)}if(0<j0.length){hg(j0[0],e);for(var a=1;a<j0.length;a++){var u=j0[a];u.blockedOn===e&&(u.blockedOn=null)}}for(wu!==null&&hg(wu,e),Su!==null&&hg(Su,e),Tu!==null&&hg(Tu,e),ny.forEach(r),iy.forEach(r),a=0;a<yu.length;a++)u=yu[a],u.blockedOn===e&&(u.blockedOn=null);for(;0<yu.length&&(a=yu[0],a.blockedOn===null);)nR(a),a.blockedOn===null&&yu.shift()}var qp=_c.ReactCurrentBatchConfig,Bx=!0;function yB(e,r,a,u){var g=mi,_=qp.transition;qp.transition=null;try{mi=1,LT(e,r,a,u)}finally{mi=g,qp.transition=_}}function _B(e,r,a,u){var g=mi,_=qp.transition;qp.transition=null;try{mi=4,LT(e,r,a,u)}finally{mi=g,qp.transition=_}}function LT(e,r,a,u){if(Bx){var g=IS(e,r,a,u);if(g===null)zw(e,r,u,jx,a),Ok(e,u);else if(mB(g,e,r,a,u))u.stopPropagation();else if(Ok(e,u),r&4&&-1<fB.indexOf(e)){for(;g!==null;){var _=Iy(g);if(_!==null&&QD(_),_=IS(e,r,a,u),_===null&&zw(e,r,u,jx,a),_===g)break;g=_}g!==null&&u.stopPropagation()}else zw(e,r,u,null,a)}}var jx=null;function IS(e,r,a,u){if(jx=null,e=PT(u),e=Fd(e),e!==null)if(r=eh(e),r===null)e=null;else if(a=r.tag,a===13){if(e=GD(r),e!==null)return e;e=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return jx=e,null}function iR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oB()){case AT:return 1;case YD:return 4;case Ox:case sB:return 16;case XD:return 536870912;default:return 16}default:return 16}}var xu=null,zT=null,yx=null;function oR(){if(yx)return yx;var e,r=zT,a=r.length,u,g="value"in xu?xu.value:xu.textContent,_=g.length;for(e=0;e<a&&r[e]===g[e];e++);var M=a-e;for(u=1;u<=M&&r[a-u]===g[_-u];u++);return yx=g.slice(e,1<u?1-u:void 0)}function _x(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function N0(){return!0}function Bk(){return!1}function Ys(e){function r(a,u,g,_,M){this._reactName=a,this._targetInst=g,this.type=u,this.nativeEvent=_,this.target=M,this.currentTarget=null;for(var D in e)e.hasOwnProperty(D)&&(a=e[D],this[D]=a?a(_):_[D]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?N0:Bk,this.isPropagationStopped=Bk,this}return qi(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=N0)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=N0)},persist:function(){},isPersistent:N0}),r}var yf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},OT=Ys(yf),Ey=qi({},yf,{view:0,detail:0}),xB=Ys(Ey),Mw,Ew,pg,bv=qi({},Ey,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:FT,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pg&&(pg&&e.type==="mousemove"?(Mw=e.screenX-pg.screenX,Ew=e.screenY-pg.screenY):Ew=Mw=0,pg=e),Mw)},movementY:function(e){return"movementY"in e?e.movementY:Ew}}),jk=Ys(bv),vB=qi({},bv,{dataTransfer:0}),bB=Ys(vB),wB=qi({},Ey,{relatedTarget:0}),Iw=Ys(wB),SB=qi({},yf,{animationName:0,elapsedTime:0,pseudoElement:0}),TB=Ys(SB),CB=qi({},yf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),MB=Ys(CB),EB=qi({},yf,{data:0}),Nk=Ys(EB),IB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AB(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=PB[e])?!!r[e]:!1}function FT(){return AB}var DB=qi({},Ey,{key:function(e){if(e.key){var r=IB[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=_x(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?kB[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:FT,charCode:function(e){return e.type==="keypress"?_x(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_x(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),RB=Ys(DB),LB=qi({},bv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vk=Ys(LB),zB=qi({},Ey,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:FT}),OB=Ys(zB),FB=qi({},yf,{propertyName:0,elapsedTime:0,pseudoElement:0}),BB=Ys(FB),jB=qi({},bv,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),NB=Ys(jB),VB=[9,13,27,32],BT=hc&&"CompositionEvent"in window,Ng=null;hc&&"documentMode"in document&&(Ng=document.documentMode);var $B=hc&&"TextEvent"in window&&!Ng,sR=hc&&(!BT||Ng&&8<Ng&&11>=Ng),$k=" ",Uk=!1;function aR(e,r){switch(e){case"keyup":return VB.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var kp=!1;function UB(e,r){switch(e){case"compositionend":return lR(r);case"keypress":return r.which!==32?null:(Uk=!0,$k);case"textInput":return e=r.data,e===$k&&Uk?null:e;default:return null}}function WB(e,r){if(kp)return e==="compositionend"||!BT&&aR(e,r)?(e=oR(),yx=zT=xu=null,kp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return sR&&r.locale!=="ko"?null:r.data;default:return null}}var GB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wk(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!GB[e.type]:r==="textarea"}function cR(e,r,a,u){ND(u),r=Nx(r,"onChange"),0<r.length&&(a=new OT("onChange","change",null,a,u),e.push({event:a,listeners:r}))}var Vg=null,sy=null;function HB(e){vR(e,0)}function wv(e){var r=Dp(e);if(RD(r))return e}function qB(e,r){if(e==="change")return r}var uR=!1;if(hc){var kw;if(hc){var Pw="oninput"in document;if(!Pw){var Gk=document.createElement("div");Gk.setAttribute("oninput","return;"),Pw=typeof Gk.oninput=="function"}kw=Pw}else kw=!1;uR=kw&&(!document.documentMode||9<document.documentMode)}function Hk(){Vg&&(Vg.detachEvent("onpropertychange",dR),sy=Vg=null)}function dR(e){if(e.propertyName==="value"&&wv(sy)){var r=[];cR(r,sy,e,PT(e)),WD(HB,r)}}function ZB(e,r,a){e==="focusin"?(Hk(),Vg=r,sy=a,Vg.attachEvent("onpropertychange",dR)):e==="focusout"&&Hk()}function YB(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wv(sy)}function XB(e,r){if(e==="click")return wv(r)}function KB(e,r){if(e==="input"||e==="change")return wv(r)}function JB(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Qa=typeof Object.is=="function"?Object.is:JB;function ay(e,r){if(Qa(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var a=Object.keys(e),u=Object.keys(r);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var g=a[u];if(!uS.call(r,g)||!Qa(e[g],r[g]))return!1}return!0}function qk(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zk(e,r){var a=qk(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=r&&u>=r)return{node:a,offset:r-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=qk(a)}}function hR(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?hR(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function pR(){for(var e=window,r=Rx();r instanceof e.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)e=r.contentWindow;else break;r=Rx(e.document)}return r}function jT(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function QB(e){var r=pR(),a=e.focusedElem,u=e.selectionRange;if(r!==a&&a&&a.ownerDocument&&hR(a.ownerDocument.documentElement,a)){if(u!==null&&jT(a)){if(r=u.start,e=u.end,e===void 0&&(e=r),"selectionStart"in a)a.selectionStart=r,a.selectionEnd=Math.min(e,a.value.length);else if(e=(r=a.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var g=a.textContent.length,_=Math.min(u.start,g);u=u.end===void 0?_:Math.min(u.end,g),!e.extend&&_>u&&(g=u,u=_,_=g),g=Zk(a,_);var M=Zk(a,u);g&&M&&(e.rangeCount!==1||e.anchorNode!==g.node||e.anchorOffset!==g.offset||e.focusNode!==M.node||e.focusOffset!==M.offset)&&(r=r.createRange(),r.setStart(g.node,g.offset),e.removeAllRanges(),_>u?(e.addRange(r),e.extend(M.node,M.offset)):(r.setEnd(M.node,M.offset),e.addRange(r)))}}for(r=[],e=a;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<r.length;a++)e=r[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var e2=hc&&"documentMode"in document&&11>=document.documentMode,Pp=null,kS=null,$g=null,PS=!1;function Yk(e,r,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;PS||Pp==null||Pp!==Rx(u)||(u=Pp,"selectionStart"in u&&jT(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),$g&&ay($g,u)||($g=u,u=Nx(kS,"onSelect"),0<u.length&&(r=new OT("onSelect","select",null,r,a),e.push({event:r,listeners:u}),r.target=Pp)))}function V0(e,r){var a={};return a[e.toLowerCase()]=r.toLowerCase(),a["Webkit"+e]="webkit"+r,a["Moz"+e]="moz"+r,a}var Ap={animationend:V0("Animation","AnimationEnd"),animationiteration:V0("Animation","AnimationIteration"),animationstart:V0("Animation","AnimationStart"),transitionend:V0("Transition","TransitionEnd")},Aw={},fR={};hc&&(fR=document.createElement("div").style,"AnimationEvent"in window||(delete Ap.animationend.animation,delete Ap.animationiteration.animation,delete Ap.animationstart.animation),"TransitionEvent"in window||delete Ap.transitionend.transition);function Sv(e){if(Aw[e])return Aw[e];if(!Ap[e])return e;var r=Ap[e],a;for(a in r)if(r.hasOwnProperty(a)&&a in fR)return Aw[e]=r[a];return e}var mR=Sv("animationend"),gR=Sv("animationiteration"),yR=Sv("animationstart"),_R=Sv("transitionend"),xR=new Map,Xk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zu(e,r){xR.set(e,r),Qd(r,[e])}for(var Dw=0;Dw<Xk.length;Dw++){var Rw=Xk[Dw],t2=Rw.toLowerCase(),r2=Rw[0].toUpperCase()+Rw.slice(1);zu(t2,"on"+r2)}zu(mR,"onAnimationEnd");zu(gR,"onAnimationIteration");zu(yR,"onAnimationStart");zu("dblclick","onDoubleClick");zu("focusin","onFocus");zu("focusout","onBlur");zu(_R,"onTransitionEnd");nf("onMouseEnter",["mouseout","mouseover"]);nf("onMouseLeave",["mouseout","mouseover"]);nf("onPointerEnter",["pointerout","pointerover"]);nf("onPointerLeave",["pointerout","pointerover"]);Qd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rg));function Kk(e,r,a){var u=e.type||"unknown-event";e.currentTarget=a,tB(u,r,void 0,e),e.currentTarget=null}function vR(e,r){r=(r&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],g=u.event;u=u.listeners;e:{var _=void 0;if(r)for(var M=u.length-1;0<=M;M--){var D=u[M],i=D.instance,j=D.currentTarget;if(D=D.listener,i!==_&&g.isPropagationStopped())break e;Kk(g,D,j),_=i}else for(M=0;M<u.length;M++){if(D=u[M],i=D.instance,j=D.currentTarget,D=D.listener,i!==_&&g.isPropagationStopped())break e;Kk(g,D,j),_=i}}}if(zx)throw e=CS,zx=!1,CS=null,e}function Fi(e,r){var a=r[zS];a===void 0&&(a=r[zS]=new Set);var u=e+"__bubble";a.has(u)||(bR(r,e,2,!1),a.add(u))}function Lw(e,r,a){var u=0;r&&(u|=4),bR(a,e,u,r)}var $0="_reactListening"+Math.random().toString(36).slice(2);function ly(e){if(!e[$0]){e[$0]=!0,ID.forEach(function(a){a!=="selectionchange"&&(n2.has(a)||Lw(a,!1,e),Lw(a,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[$0]||(r[$0]=!0,Lw("selectionchange",!1,r))}}function bR(e,r,a,u){switch(iR(r)){case 1:var g=yB;break;case 4:g=_B;break;default:g=LT}a=g.bind(null,r,a,e),g=void 0,!TS||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(g=!0),u?g!==void 0?e.addEventListener(r,a,{capture:!0,passive:g}):e.addEventListener(r,a,!0):g!==void 0?e.addEventListener(r,a,{passive:g}):e.addEventListener(r,a,!1)}function zw(e,r,a,u,g){var _=u;if(!(r&1)&&!(r&2)&&u!==null)e:for(;;){if(u===null)return;var M=u.tag;if(M===3||M===4){var D=u.stateNode.containerInfo;if(D===g||D.nodeType===8&&D.parentNode===g)break;if(M===4)for(M=u.return;M!==null;){var i=M.tag;if((i===3||i===4)&&(i=M.stateNode.containerInfo,i===g||i.nodeType===8&&i.parentNode===g))return;M=M.return}for(;D!==null;){if(M=Fd(D),M===null)return;if(i=M.tag,i===5||i===6){u=_=M;continue e}D=D.parentNode}}u=u.return}WD(function(){var j=_,H=PT(a),q=[];e:{var X=xR.get(e);if(X!==void 0){var se=OT,ne=e;switch(e){case"keypress":if(_x(a)===0)break e;case"keydown":case"keyup":se=RB;break;case"focusin":ne="focus",se=Iw;break;case"focusout":ne="blur",se=Iw;break;case"beforeblur":case"afterblur":se=Iw;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=jk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=bB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=OB;break;case mR:case gR:case yR:se=TB;break;case _R:se=BB;break;case"scroll":se=xB;break;case"wheel":se=NB;break;case"copy":case"cut":case"paste":se=MB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=Vk}var le=(r&4)!==0,de=!le&&e==="scroll",te=le?X!==null?X+"Capture":null:X;le=[];for(var Q=j,K;Q!==null;){K=Q;var ce=K.stateNode;if(K.tag===5&&ce!==null&&(K=ce,te!==null&&(ce=ry(Q,te),ce!=null&&le.push(cy(Q,ce,K)))),de)break;Q=Q.return}0<le.length&&(X=new se(X,ne,null,a,H),q.push({event:X,listeners:le}))}}if(!(r&7)){e:{if(X=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",X&&a!==wS&&(ne=a.relatedTarget||a.fromElement)&&(Fd(ne)||ne[pc]))break e;if((se||X)&&(X=H.window===H?H:(X=H.ownerDocument)?X.defaultView||X.parentWindow:window,se?(ne=a.relatedTarget||a.toElement,se=j,ne=ne?Fd(ne):null,ne!==null&&(de=eh(ne),ne!==de||ne.tag!==5&&ne.tag!==6)&&(ne=null)):(se=null,ne=j),se!==ne)){if(le=jk,ce="onMouseLeave",te="onMouseEnter",Q="mouse",(e==="pointerout"||e==="pointerover")&&(le=Vk,ce="onPointerLeave",te="onPointerEnter",Q="pointer"),de=se==null?X:Dp(se),K=ne==null?X:Dp(ne),X=new le(ce,Q+"leave",se,a,H),X.target=de,X.relatedTarget=K,ce=null,Fd(H)===j&&(le=new le(te,Q+"enter",ne,a,H),le.target=K,le.relatedTarget=de,ce=le),de=ce,se&&ne)t:{for(le=se,te=ne,Q=0,K=le;K;K=mp(K))Q++;for(K=0,ce=te;ce;ce=mp(ce))K++;for(;0<Q-K;)le=mp(le),Q--;for(;0<K-Q;)te=mp(te),K--;for(;Q--;){if(le===te||te!==null&&le===te.alternate)break t;le=mp(le),te=mp(te)}le=null}else le=null;se!==null&&Jk(q,X,se,le,!1),ne!==null&&de!==null&&Jk(q,de,ne,le,!0)}}e:{if(X=j?Dp(j):window,se=X.nodeName&&X.nodeName.toLowerCase(),se==="select"||se==="input"&&X.type==="file")var fe=qB;else if(Wk(X))if(uR)fe=KB;else{fe=YB;var Ie=ZB}else(se=X.nodeName)&&se.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(fe=XB);if(fe&&(fe=fe(e,j))){cR(q,fe,a,H);break e}Ie&&Ie(e,X,j),e==="focusout"&&(Ie=X._wrapperState)&&Ie.controlled&&X.type==="number"&&yS(X,"number",X.value)}switch(Ie=j?Dp(j):window,e){case"focusin":(Wk(Ie)||Ie.contentEditable==="true")&&(Pp=Ie,kS=j,$g=null);break;case"focusout":$g=kS=Pp=null;break;case"mousedown":PS=!0;break;case"contextmenu":case"mouseup":case"dragend":PS=!1,Yk(q,a,H);break;case"selectionchange":if(e2)break;case"keydown":case"keyup":Yk(q,a,H)}var Ce;if(BT)e:{switch(e){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else kp?aR(e,a)&&(we="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(we="onCompositionStart");we&&(sR&&a.locale!=="ko"&&(kp||we!=="onCompositionStart"?we==="onCompositionEnd"&&kp&&(Ce=oR()):(xu=H,zT="value"in xu?xu.value:xu.textContent,kp=!0)),Ie=Nx(j,we),0<Ie.length&&(we=new Nk(we,e,null,a,H),q.push({event:we,listeners:Ie}),Ce?we.data=Ce:(Ce=lR(a),Ce!==null&&(we.data=Ce)))),(Ce=$B?UB(e,a):WB(e,a))&&(j=Nx(j,"onBeforeInput"),0<j.length&&(H=new Nk("onBeforeInput","beforeinput",null,a,H),q.push({event:H,listeners:j}),H.data=Ce))}vR(q,r)})}function cy(e,r,a){return{instance:e,listener:r,currentTarget:a}}function Nx(e,r){for(var a=r+"Capture",u=[];e!==null;){var g=e,_=g.stateNode;g.tag===5&&_!==null&&(g=_,_=ry(e,a),_!=null&&u.unshift(cy(e,_,g)),_=ry(e,r),_!=null&&u.push(cy(e,_,g))),e=e.return}return u}function mp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Jk(e,r,a,u,g){for(var _=r._reactName,M=[];a!==null&&a!==u;){var D=a,i=D.alternate,j=D.stateNode;if(i!==null&&i===u)break;D.tag===5&&j!==null&&(D=j,g?(i=ry(a,_),i!=null&&M.unshift(cy(a,i,D))):g||(i=ry(a,_),i!=null&&M.push(cy(a,i,D)))),a=a.return}M.length!==0&&e.push({event:r,listeners:M})}var i2=/\r\n?/g,o2=/\u0000|\uFFFD/g;function Qk(e){return(typeof e=="string"?e:""+e).replace(i2,`
`).replace(o2,"")}function U0(e,r,a){if(r=Qk(r),Qk(e)!==r&&a)throw Error(mr(425))}function Vx(){}var AS=null,DS=null;function RS(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var LS=typeof setTimeout=="function"?setTimeout:void 0,s2=typeof clearTimeout=="function"?clearTimeout:void 0,eP=typeof Promise=="function"?Promise:void 0,a2=typeof queueMicrotask=="function"?queueMicrotask:typeof eP<"u"?function(e){return eP.resolve(null).then(e).catch(l2)}:LS;function l2(e){setTimeout(function(){throw e})}function Ow(e,r){var a=r,u=0;do{var g=a.nextSibling;if(e.removeChild(a),g&&g.nodeType===8)if(a=g.data,a==="/$"){if(u===0){e.removeChild(g),oy(r);return}u--}else a!=="$"&&a!=="$?"&&a!=="$!"||u++;a=g}while(a);oy(r)}function Cu(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function tP(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(r===0)return e;r--}else a==="/$"&&r++}e=e.previousSibling}return null}var _f=Math.random().toString(36).slice(2),Dl="__reactFiber$"+_f,uy="__reactProps$"+_f,pc="__reactContainer$"+_f,zS="__reactEvents$"+_f,c2="__reactListeners$"+_f,u2="__reactHandles$"+_f;function Fd(e){var r=e[Dl];if(r)return r;for(var a=e.parentNode;a;){if(r=a[pc]||a[Dl]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(e=tP(e);e!==null;){if(a=e[Dl])return a;e=tP(e)}return r}e=a,a=e.parentNode}return null}function Iy(e){return e=e[Dl]||e[pc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Dp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(mr(33))}function Tv(e){return e[uy]||null}var OS=[],Rp=-1;function Ou(e){return{current:e}}function Bi(e){0>Rp||(e.current=OS[Rp],OS[Rp]=null,Rp--)}function Di(e,r){Rp++,OS[Rp]=e.current,e.current=r}var Au={},Jo=Ou(Au),Ts=Ou(!1),Gd=Au;function of(e,r){var a=e.type.contextTypes;if(!a)return Au;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===r)return u.__reactInternalMemoizedMaskedChildContext;var g={},_;for(_ in a)g[_]=r[_];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=g),g}function Cs(e){return e=e.childContextTypes,e!=null}function $x(){Bi(Ts),Bi(Jo)}function rP(e,r,a){if(Jo.current!==Au)throw Error(mr(168));Di(Jo,r),Di(Ts,a)}function wR(e,r,a){var u=e.stateNode;if(r=r.childContextTypes,typeof u.getChildContext!="function")return a;u=u.getChildContext();for(var g in u)if(!(g in r))throw Error(mr(108,Z5(e)||"Unknown",g));return qi({},a,u)}function Ux(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Au,Gd=Jo.current,Di(Jo,e),Di(Ts,Ts.current),!0}function nP(e,r,a){var u=e.stateNode;if(!u)throw Error(mr(169));a?(e=wR(e,r,Gd),u.__reactInternalMemoizedMergedChildContext=e,Bi(Ts),Bi(Jo),Di(Jo,e)):Bi(Ts),Di(Ts,a)}var sc=null,Cv=!1,Fw=!1;function SR(e){sc===null?sc=[e]:sc.push(e)}function d2(e){Cv=!0,SR(e)}function Fu(){if(!Fw&&sc!==null){Fw=!0;var e=0,r=mi;try{var a=sc;for(mi=1;e<a.length;e++){var u=a[e];do u=u(!0);while(u!==null)}sc=null,Cv=!1}catch(g){throw sc!==null&&(sc=sc.slice(e+1)),ZD(AT,Fu),g}finally{mi=r,Fw=!1}}return null}var Lp=[],zp=0,Wx=null,Gx=0,fa=[],ma=0,Hd=null,ac=1,lc="";function Rd(e,r){Lp[zp++]=Gx,Lp[zp++]=Wx,Wx=e,Gx=r}function TR(e,r,a){fa[ma++]=ac,fa[ma++]=lc,fa[ma++]=Hd,Hd=e;var u=ac;e=lc;var g=32-Ya(u)-1;u&=~(1<<g),a+=1;var _=32-Ya(r)+g;if(30<_){var M=g-g%5;_=(u&(1<<M)-1).toString(32),u>>=M,g-=M,ac=1<<32-Ya(r)+g|a<<g|u,lc=_+e}else ac=1<<_|a<<g|u,lc=e}function NT(e){e.return!==null&&(Rd(e,1),TR(e,1,0))}function VT(e){for(;e===Wx;)Wx=Lp[--zp],Lp[zp]=null,Gx=Lp[--zp],Lp[zp]=null;for(;e===Hd;)Hd=fa[--ma],fa[ma]=null,lc=fa[--ma],fa[ma]=null,ac=fa[--ma],fa[ma]=null}var Us=null,$s=null,Vi=!1,qa=null;function CR(e,r){var a=xa(5,null,null,0);a.elementType="DELETED",a.stateNode=r,a.return=e,r=e.deletions,r===null?(e.deletions=[a],e.flags|=16):r.push(a)}function iP(e,r){switch(e.tag){case 5:var a=e.type;return r=r.nodeType!==1||a.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,Us=e,$s=Cu(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,Us=e,$s=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(a=Hd!==null?{id:ac,overflow:lc}:null,e.memoizedState={dehydrated:r,treeContext:a,retryLane:1073741824},a=xa(18,null,null,0),a.stateNode=r,a.return=e,e.child=a,Us=e,$s=null,!0):!1;default:return!1}}function FS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function BS(e){if(Vi){var r=$s;if(r){var a=r;if(!iP(e,r)){if(FS(e))throw Error(mr(418));r=Cu(a.nextSibling);var u=Us;r&&iP(e,r)?CR(u,a):(e.flags=e.flags&-4097|2,Vi=!1,Us=e)}}else{if(FS(e))throw Error(mr(418));e.flags=e.flags&-4097|2,Vi=!1,Us=e}}}function oP(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Us=e}function W0(e){if(e!==Us)return!1;if(!Vi)return oP(e),Vi=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!RS(e.type,e.memoizedProps)),r&&(r=$s)){if(FS(e))throw MR(),Error(mr(418));for(;r;)CR(e,r),r=Cu(r.nextSibling)}if(oP(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(mr(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(r===0){$s=Cu(e.nextSibling);break e}r--}else a!=="$"&&a!=="$!"&&a!=="$?"||r++}e=e.nextSibling}$s=null}}else $s=Us?Cu(e.stateNode.nextSibling):null;return!0}function MR(){for(var e=$s;e;)e=Cu(e.nextSibling)}function sf(){$s=Us=null,Vi=!1}function $T(e){qa===null?qa=[e]:qa.push(e)}var h2=_c.ReactCurrentBatchConfig;function fg(e,r,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(mr(309));var u=a.stateNode}if(!u)throw Error(mr(147,e));var g=u,_=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===_?r.ref:(r=function(M){var D=g.refs;M===null?delete D[_]:D[_]=M},r._stringRef=_,r)}if(typeof e!="string")throw Error(mr(284));if(!a._owner)throw Error(mr(290,e))}return e}function G0(e,r){throw e=Object.prototype.toString.call(r),Error(mr(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function sP(e){var r=e._init;return r(e._payload)}function ER(e){function r(te,Q){if(e){var K=te.deletions;K===null?(te.deletions=[Q],te.flags|=16):K.push(Q)}}function a(te,Q){if(!e)return null;for(;Q!==null;)r(te,Q),Q=Q.sibling;return null}function u(te,Q){for(te=new Map;Q!==null;)Q.key!==null?te.set(Q.key,Q):te.set(Q.index,Q),Q=Q.sibling;return te}function g(te,Q){return te=ku(te,Q),te.index=0,te.sibling=null,te}function _(te,Q,K){return te.index=K,e?(K=te.alternate,K!==null?(K=K.index,K<Q?(te.flags|=2,Q):K):(te.flags|=2,Q)):(te.flags|=1048576,Q)}function M(te){return e&&te.alternate===null&&(te.flags|=2),te}function D(te,Q,K,ce){return Q===null||Q.tag!==6?(Q=Ww(K,te.mode,ce),Q.return=te,Q):(Q=g(Q,K),Q.return=te,Q)}function i(te,Q,K,ce){var fe=K.type;return fe===Ip?H(te,Q,K.props.children,ce,K.key):Q!==null&&(Q.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===mu&&sP(fe)===Q.type)?(ce=g(Q,K.props),ce.ref=fg(te,Q,K),ce.return=te,ce):(ce=Cx(K.type,K.key,K.props,null,te.mode,ce),ce.ref=fg(te,Q,K),ce.return=te,ce)}function j(te,Q,K,ce){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==K.containerInfo||Q.stateNode.implementation!==K.implementation?(Q=Gw(K,te.mode,ce),Q.return=te,Q):(Q=g(Q,K.children||[]),Q.return=te,Q)}function H(te,Q,K,ce,fe){return Q===null||Q.tag!==7?(Q=Wd(K,te.mode,ce,fe),Q.return=te,Q):(Q=g(Q,K),Q.return=te,Q)}function q(te,Q,K){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Ww(""+Q,te.mode,K),Q.return=te,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case L0:return K=Cx(Q.type,Q.key,Q.props,null,te.mode,K),K.ref=fg(te,null,Q),K.return=te,K;case Ep:return Q=Gw(Q,te.mode,K),Q.return=te,Q;case mu:var ce=Q._init;return q(te,ce(Q._payload),K)}if(Ag(Q)||cg(Q))return Q=Wd(Q,te.mode,K,null),Q.return=te,Q;G0(te,Q)}return null}function X(te,Q,K,ce){var fe=Q!==null?Q.key:null;if(typeof K=="string"&&K!==""||typeof K=="number")return fe!==null?null:D(te,Q,""+K,ce);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case L0:return K.key===fe?i(te,Q,K,ce):null;case Ep:return K.key===fe?j(te,Q,K,ce):null;case mu:return fe=K._init,X(te,Q,fe(K._payload),ce)}if(Ag(K)||cg(K))return fe!==null?null:H(te,Q,K,ce,null);G0(te,K)}return null}function se(te,Q,K,ce,fe){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return te=te.get(K)||null,D(Q,te,""+ce,fe);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case L0:return te=te.get(ce.key===null?K:ce.key)||null,i(Q,te,ce,fe);case Ep:return te=te.get(ce.key===null?K:ce.key)||null,j(Q,te,ce,fe);case mu:var Ie=ce._init;return se(te,Q,K,Ie(ce._payload),fe)}if(Ag(ce)||cg(ce))return te=te.get(K)||null,H(Q,te,ce,fe,null);G0(Q,ce)}return null}function ne(te,Q,K,ce){for(var fe=null,Ie=null,Ce=Q,we=Q=0,ot=null;Ce!==null&&we<K.length;we++){Ce.index>we?(ot=Ce,Ce=null):ot=Ce.sibling;var oe=X(te,Ce,K[we],ce);if(oe===null){Ce===null&&(Ce=ot);break}e&&Ce&&oe.alternate===null&&r(te,Ce),Q=_(oe,Q,we),Ie===null?fe=oe:Ie.sibling=oe,Ie=oe,Ce=ot}if(we===K.length)return a(te,Ce),Vi&&Rd(te,we),fe;if(Ce===null){for(;we<K.length;we++)Ce=q(te,K[we],ce),Ce!==null&&(Q=_(Ce,Q,we),Ie===null?fe=Ce:Ie.sibling=Ce,Ie=Ce);return Vi&&Rd(te,we),fe}for(Ce=u(te,Ce);we<K.length;we++)ot=se(Ce,te,we,K[we],ce),ot!==null&&(e&&ot.alternate!==null&&Ce.delete(ot.key===null?we:ot.key),Q=_(ot,Q,we),Ie===null?fe=ot:Ie.sibling=ot,Ie=ot);return e&&Ce.forEach(function(ve){return r(te,ve)}),Vi&&Rd(te,we),fe}function le(te,Q,K,ce){var fe=cg(K);if(typeof fe!="function")throw Error(mr(150));if(K=fe.call(K),K==null)throw Error(mr(151));for(var Ie=fe=null,Ce=Q,we=Q=0,ot=null,oe=K.next();Ce!==null&&!oe.done;we++,oe=K.next()){Ce.index>we?(ot=Ce,Ce=null):ot=Ce.sibling;var ve=X(te,Ce,oe.value,ce);if(ve===null){Ce===null&&(Ce=ot);break}e&&Ce&&ve.alternate===null&&r(te,Ce),Q=_(ve,Q,we),Ie===null?fe=ve:Ie.sibling=ve,Ie=ve,Ce=ot}if(oe.done)return a(te,Ce),Vi&&Rd(te,we),fe;if(Ce===null){for(;!oe.done;we++,oe=K.next())oe=q(te,oe.value,ce),oe!==null&&(Q=_(oe,Q,we),Ie===null?fe=oe:Ie.sibling=oe,Ie=oe);return Vi&&Rd(te,we),fe}for(Ce=u(te,Ce);!oe.done;we++,oe=K.next())oe=se(Ce,te,we,oe.value,ce),oe!==null&&(e&&oe.alternate!==null&&Ce.delete(oe.key===null?we:oe.key),Q=_(oe,Q,we),Ie===null?fe=oe:Ie.sibling=oe,Ie=oe);return e&&Ce.forEach(function(je){return r(te,je)}),Vi&&Rd(te,we),fe}function de(te,Q,K,ce){if(typeof K=="object"&&K!==null&&K.type===Ip&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case L0:e:{for(var fe=K.key,Ie=Q;Ie!==null;){if(Ie.key===fe){if(fe=K.type,fe===Ip){if(Ie.tag===7){a(te,Ie.sibling),Q=g(Ie,K.props.children),Q.return=te,te=Q;break e}}else if(Ie.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===mu&&sP(fe)===Ie.type){a(te,Ie.sibling),Q=g(Ie,K.props),Q.ref=fg(te,Ie,K),Q.return=te,te=Q;break e}a(te,Ie);break}else r(te,Ie);Ie=Ie.sibling}K.type===Ip?(Q=Wd(K.props.children,te.mode,ce,K.key),Q.return=te,te=Q):(ce=Cx(K.type,K.key,K.props,null,te.mode,ce),ce.ref=fg(te,Q,K),ce.return=te,te=ce)}return M(te);case Ep:e:{for(Ie=K.key;Q!==null;){if(Q.key===Ie)if(Q.tag===4&&Q.stateNode.containerInfo===K.containerInfo&&Q.stateNode.implementation===K.implementation){a(te,Q.sibling),Q=g(Q,K.children||[]),Q.return=te,te=Q;break e}else{a(te,Q);break}else r(te,Q);Q=Q.sibling}Q=Gw(K,te.mode,ce),Q.return=te,te=Q}return M(te);case mu:return Ie=K._init,de(te,Q,Ie(K._payload),ce)}if(Ag(K))return ne(te,Q,K,ce);if(cg(K))return le(te,Q,K,ce);G0(te,K)}return typeof K=="string"&&K!==""||typeof K=="number"?(K=""+K,Q!==null&&Q.tag===6?(a(te,Q.sibling),Q=g(Q,K),Q.return=te,te=Q):(a(te,Q),Q=Ww(K,te.mode,ce),Q.return=te,te=Q),M(te)):a(te,Q)}return de}var af=ER(!0),IR=ER(!1),Hx=Ou(null),qx=null,Op=null,UT=null;function WT(){UT=Op=qx=null}function GT(e){var r=Hx.current;Bi(Hx),e._currentValue=r}function jS(e,r,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,u!==null&&(u.childLanes|=r)):u!==null&&(u.childLanes&r)!==r&&(u.childLanes|=r),e===a)break;e=e.return}}function Zp(e,r){qx=e,UT=Op=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(Ss=!0),e.firstContext=null)}function Sa(e){var r=e._currentValue;if(UT!==e)if(e={context:e,memoizedValue:r,next:null},Op===null){if(qx===null)throw Error(mr(308));Op=e,qx.dependencies={lanes:0,firstContext:e}}else Op=Op.next=e;return r}var Bd=null;function HT(e){Bd===null?Bd=[e]:Bd.push(e)}function kR(e,r,a,u){var g=r.interleaved;return g===null?(a.next=a,HT(r)):(a.next=g.next,g.next=a),r.interleaved=a,fc(e,u)}function fc(e,r){e.lanes|=r;var a=e.alternate;for(a!==null&&(a.lanes|=r),a=e,e=e.return;e!==null;)e.childLanes|=r,a=e.alternate,a!==null&&(a.childLanes|=r),a=e,e=e.return;return a.tag===3?a.stateNode:null}var gu=!1;function qT(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function PR(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cc(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Mu(e,r,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,ii&2){var g=u.pending;return g===null?r.next=r:(r.next=g.next,g.next=r),u.pending=r,fc(e,a)}return g=u.interleaved,g===null?(r.next=r,HT(u)):(r.next=g.next,g.next=r),u.interleaved=r,fc(e,a)}function xx(e,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194240)!==0)){var u=r.lanes;u&=e.pendingLanes,a|=u,r.lanes=a,DT(e,a)}}function aP(e,r){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var g=null,_=null;if(a=a.firstBaseUpdate,a!==null){do{var M={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};_===null?g=_=M:_=_.next=M,a=a.next}while(a!==null);_===null?g=_=r:_=_.next=r}else g=_=r;a={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:_,shared:u.shared,effects:u.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=r:e.next=r,a.lastBaseUpdate=r}function Zx(e,r,a,u){var g=e.updateQueue;gu=!1;var _=g.firstBaseUpdate,M=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var i=D,j=i.next;i.next=null,M===null?_=j:M.next=j,M=i;var H=e.alternate;H!==null&&(H=H.updateQueue,D=H.lastBaseUpdate,D!==M&&(D===null?H.firstBaseUpdate=j:D.next=j,H.lastBaseUpdate=i))}if(_!==null){var q=g.baseState;M=0,H=j=i=null,D=_;do{var X=D.lane,se=D.eventTime;if((u&X)===X){H!==null&&(H=H.next={eventTime:se,lane:0,tag:D.tag,payload:D.payload,callback:D.callback,next:null});e:{var ne=e,le=D;switch(X=r,se=a,le.tag){case 1:if(ne=le.payload,typeof ne=="function"){q=ne.call(se,q,X);break e}q=ne;break e;case 3:ne.flags=ne.flags&-65537|128;case 0:if(ne=le.payload,X=typeof ne=="function"?ne.call(se,q,X):ne,X==null)break e;q=qi({},q,X);break e;case 2:gu=!0}}D.callback!==null&&D.lane!==0&&(e.flags|=64,X=g.effects,X===null?g.effects=[D]:X.push(D))}else se={eventTime:se,lane:X,tag:D.tag,payload:D.payload,callback:D.callback,next:null},H===null?(j=H=se,i=q):H=H.next=se,M|=X;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;X=D,D=X.next,X.next=null,g.lastBaseUpdate=X,g.shared.pending=null}}while(!0);if(H===null&&(i=q),g.baseState=i,g.firstBaseUpdate=j,g.lastBaseUpdate=H,r=g.shared.interleaved,r!==null){g=r;do M|=g.lane,g=g.next;while(g!==r)}else _===null&&(g.shared.lanes=0);Zd|=M,e.lanes=M,e.memoizedState=q}}function lP(e,r,a){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var u=e[r],g=u.callback;if(g!==null){if(u.callback=null,u=a,typeof g!="function")throw Error(mr(191,g));g.call(u)}}}var ky={},Ol=Ou(ky),dy=Ou(ky),hy=Ou(ky);function jd(e){if(e===ky)throw Error(mr(174));return e}function ZT(e,r){switch(Di(hy,r),Di(dy,e),Di(Ol,ky),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:xS(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=xS(r,e)}Bi(Ol),Di(Ol,r)}function lf(){Bi(Ol),Bi(dy),Bi(hy)}function AR(e){jd(hy.current);var r=jd(Ol.current),a=xS(r,e.type);r!==a&&(Di(dy,e),Di(Ol,a))}function YT(e){dy.current===e&&(Bi(Ol),Bi(dy))}var Gi=Ou(0);function Yx(e){for(var r=e;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Bw=[];function XT(){for(var e=0;e<Bw.length;e++)Bw[e]._workInProgressVersionPrimary=null;Bw.length=0}var vx=_c.ReactCurrentDispatcher,jw=_c.ReactCurrentBatchConfig,qd=0,Hi=null,mo=null,So=null,Xx=!1,Ug=!1,py=0,p2=0;function qo(){throw Error(mr(321))}function KT(e,r){if(r===null)return!1;for(var a=0;a<r.length&&a<e.length;a++)if(!Qa(e[a],r[a]))return!1;return!0}function JT(e,r,a,u,g,_){if(qd=_,Hi=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,vx.current=e===null||e.memoizedState===null?y2:_2,e=a(u,g),Ug){_=0;do{if(Ug=!1,py=0,25<=_)throw Error(mr(301));_+=1,So=mo=null,r.updateQueue=null,vx.current=x2,e=a(u,g)}while(Ug)}if(vx.current=Kx,r=mo!==null&&mo.next!==null,qd=0,So=mo=Hi=null,Xx=!1,r)throw Error(mr(300));return e}function QT(){var e=py!==0;return py=0,e}function Il(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return So===null?Hi.memoizedState=So=e:So=So.next=e,So}function Ta(){if(mo===null){var e=Hi.alternate;e=e!==null?e.memoizedState:null}else e=mo.next;var r=So===null?Hi.memoizedState:So.next;if(r!==null)So=r,mo=e;else{if(e===null)throw Error(mr(310));mo=e,e={memoizedState:mo.memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},So===null?Hi.memoizedState=So=e:So=So.next=e}return So}function fy(e,r){return typeof r=="function"?r(e):r}function Nw(e){var r=Ta(),a=r.queue;if(a===null)throw Error(mr(311));a.lastRenderedReducer=e;var u=mo,g=u.baseQueue,_=a.pending;if(_!==null){if(g!==null){var M=g.next;g.next=_.next,_.next=M}u.baseQueue=g=_,a.pending=null}if(g!==null){_=g.next,u=u.baseState;var D=M=null,i=null,j=_;do{var H=j.lane;if((qd&H)===H)i!==null&&(i=i.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),u=j.hasEagerState?j.eagerState:e(u,j.action);else{var q={lane:H,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};i===null?(D=i=q,M=u):i=i.next=q,Hi.lanes|=H,Zd|=H}j=j.next}while(j!==null&&j!==_);i===null?M=u:i.next=D,Qa(u,r.memoizedState)||(Ss=!0),r.memoizedState=u,r.baseState=M,r.baseQueue=i,a.lastRenderedState=u}if(e=a.interleaved,e!==null){g=e;do _=g.lane,Hi.lanes|=_,Zd|=_,g=g.next;while(g!==e)}else g===null&&(a.lanes=0);return[r.memoizedState,a.dispatch]}function Vw(e){var r=Ta(),a=r.queue;if(a===null)throw Error(mr(311));a.lastRenderedReducer=e;var u=a.dispatch,g=a.pending,_=r.memoizedState;if(g!==null){a.pending=null;var M=g=g.next;do _=e(_,M.action),M=M.next;while(M!==g);Qa(_,r.memoizedState)||(Ss=!0),r.memoizedState=_,r.baseQueue===null&&(r.baseState=_),a.lastRenderedState=_}return[_,u]}function DR(){}function RR(e,r){var a=Hi,u=Ta(),g=r(),_=!Qa(u.memoizedState,g);if(_&&(u.memoizedState=g,Ss=!0),u=u.queue,eC(OR.bind(null,a,u,e),[e]),u.getSnapshot!==r||_||So!==null&&So.memoizedState.tag&1){if(a.flags|=2048,my(9,zR.bind(null,a,u,g,r),void 0,null),To===null)throw Error(mr(349));qd&30||LR(a,r,g)}return g}function LR(e,r,a){e.flags|=16384,e={getSnapshot:r,value:a},r=Hi.updateQueue,r===null?(r={lastEffect:null,stores:null},Hi.updateQueue=r,r.stores=[e]):(a=r.stores,a===null?r.stores=[e]:a.push(e))}function zR(e,r,a,u){r.value=a,r.getSnapshot=u,FR(r)&&BR(e)}function OR(e,r,a){return a(function(){FR(r)&&BR(e)})}function FR(e){var r=e.getSnapshot;e=e.value;try{var a=r();return!Qa(e,a)}catch{return!0}}function BR(e){var r=fc(e,1);r!==null&&Xa(r,e,1,-1)}function cP(e){var r=Il();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fy,lastRenderedState:e},r.queue=e,e=e.dispatch=g2.bind(null,Hi,e),[r.memoizedState,e]}function my(e,r,a,u){return e={tag:e,create:r,destroy:a,deps:u,next:null},r=Hi.updateQueue,r===null?(r={lastEffect:null,stores:null},Hi.updateQueue=r,r.lastEffect=e.next=e):(a=r.lastEffect,a===null?r.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,r.lastEffect=e)),e}function jR(){return Ta().memoizedState}function bx(e,r,a,u){var g=Il();Hi.flags|=e,g.memoizedState=my(1|r,a,void 0,u===void 0?null:u)}function Mv(e,r,a,u){var g=Ta();u=u===void 0?null:u;var _=void 0;if(mo!==null){var M=mo.memoizedState;if(_=M.destroy,u!==null&&KT(u,M.deps)){g.memoizedState=my(r,a,_,u);return}}Hi.flags|=e,g.memoizedState=my(1|r,a,_,u)}function uP(e,r){return bx(8390656,8,e,r)}function eC(e,r){return Mv(2048,8,e,r)}function NR(e,r){return Mv(4,2,e,r)}function VR(e,r){return Mv(4,4,e,r)}function $R(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function UR(e,r,a){return a=a!=null?a.concat([e]):null,Mv(4,4,$R.bind(null,r,e),a)}function tC(){}function WR(e,r){var a=Ta();r=r===void 0?null:r;var u=a.memoizedState;return u!==null&&r!==null&&KT(r,u[1])?u[0]:(a.memoizedState=[e,r],e)}function GR(e,r){var a=Ta();r=r===void 0?null:r;var u=a.memoizedState;return u!==null&&r!==null&&KT(r,u[1])?u[0]:(e=e(),a.memoizedState=[e,r],e)}function HR(e,r,a){return qd&21?(Qa(a,r)||(a=KD(),Hi.lanes|=a,Zd|=a,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,Ss=!0),e.memoizedState=a)}function f2(e,r){var a=mi;mi=a!==0&&4>a?a:4,e(!0);var u=jw.transition;jw.transition={};try{e(!1),r()}finally{mi=a,jw.transition=u}}function qR(){return Ta().memoizedState}function m2(e,r,a){var u=Iu(e);if(a={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null},ZR(e))YR(r,a);else if(a=kR(e,r,a,u),a!==null){var g=ds();Xa(a,e,u,g),XR(a,r,u)}}function g2(e,r,a){var u=Iu(e),g={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null};if(ZR(e))YR(r,g);else{var _=e.alternate;if(e.lanes===0&&(_===null||_.lanes===0)&&(_=r.lastRenderedReducer,_!==null))try{var M=r.lastRenderedState,D=_(M,a);if(g.hasEagerState=!0,g.eagerState=D,Qa(D,M)){var i=r.interleaved;i===null?(g.next=g,HT(r)):(g.next=i.next,i.next=g),r.interleaved=g;return}}catch{}finally{}a=kR(e,r,g,u),a!==null&&(g=ds(),Xa(a,e,u,g),XR(a,r,u))}}function ZR(e){var r=e.alternate;return e===Hi||r!==null&&r===Hi}function YR(e,r){Ug=Xx=!0;var a=e.pending;a===null?r.next=r:(r.next=a.next,a.next=r),e.pending=r}function XR(e,r,a){if(a&4194240){var u=r.lanes;u&=e.pendingLanes,a|=u,r.lanes=a,DT(e,a)}}var Kx={readContext:Sa,useCallback:qo,useContext:qo,useEffect:qo,useImperativeHandle:qo,useInsertionEffect:qo,useLayoutEffect:qo,useMemo:qo,useReducer:qo,useRef:qo,useState:qo,useDebugValue:qo,useDeferredValue:qo,useTransition:qo,useMutableSource:qo,useSyncExternalStore:qo,useId:qo,unstable_isNewReconciler:!1},y2={readContext:Sa,useCallback:function(e,r){return Il().memoizedState=[e,r===void 0?null:r],e},useContext:Sa,useEffect:uP,useImperativeHandle:function(e,r,a){return a=a!=null?a.concat([e]):null,bx(4194308,4,$R.bind(null,r,e),a)},useLayoutEffect:function(e,r){return bx(4194308,4,e,r)},useInsertionEffect:function(e,r){return bx(4,2,e,r)},useMemo:function(e,r){var a=Il();return r=r===void 0?null:r,e=e(),a.memoizedState=[e,r],e},useReducer:function(e,r,a){var u=Il();return r=a!==void 0?a(r):r,u.memoizedState=u.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},u.queue=e,e=e.dispatch=m2.bind(null,Hi,e),[u.memoizedState,e]},useRef:function(e){var r=Il();return e={current:e},r.memoizedState=e},useState:cP,useDebugValue:tC,useDeferredValue:function(e){return Il().memoizedState=e},useTransition:function(){var e=cP(!1),r=e[0];return e=f2.bind(null,e[1]),Il().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,a){var u=Hi,g=Il();if(Vi){if(a===void 0)throw Error(mr(407));a=a()}else{if(a=r(),To===null)throw Error(mr(349));qd&30||LR(u,r,a)}g.memoizedState=a;var _={value:a,getSnapshot:r};return g.queue=_,uP(OR.bind(null,u,_,e),[e]),u.flags|=2048,my(9,zR.bind(null,u,_,a,r),void 0,null),a},useId:function(){var e=Il(),r=To.identifierPrefix;if(Vi){var a=lc,u=ac;a=(u&~(1<<32-Ya(u)-1)).toString(32)+a,r=":"+r+"R"+a,a=py++,0<a&&(r+="H"+a.toString(32)),r+=":"}else a=p2++,r=":"+r+"r"+a.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},_2={readContext:Sa,useCallback:WR,useContext:Sa,useEffect:eC,useImperativeHandle:UR,useInsertionEffect:NR,useLayoutEffect:VR,useMemo:GR,useReducer:Nw,useRef:jR,useState:function(){return Nw(fy)},useDebugValue:tC,useDeferredValue:function(e){var r=Ta();return HR(r,mo.memoizedState,e)},useTransition:function(){var e=Nw(fy)[0],r=Ta().memoizedState;return[e,r]},useMutableSource:DR,useSyncExternalStore:RR,useId:qR,unstable_isNewReconciler:!1},x2={readContext:Sa,useCallback:WR,useContext:Sa,useEffect:eC,useImperativeHandle:UR,useInsertionEffect:NR,useLayoutEffect:VR,useMemo:GR,useReducer:Vw,useRef:jR,useState:function(){return Vw(fy)},useDebugValue:tC,useDeferredValue:function(e){var r=Ta();return mo===null?r.memoizedState=e:HR(r,mo.memoizedState,e)},useTransition:function(){var e=Vw(fy)[0],r=Ta().memoizedState;return[e,r]},useMutableSource:DR,useSyncExternalStore:RR,useId:qR,unstable_isNewReconciler:!1};function Ga(e,r){if(e&&e.defaultProps){r=qi({},r),e=e.defaultProps;for(var a in e)r[a]===void 0&&(r[a]=e[a]);return r}return r}function NS(e,r,a,u){r=e.memoizedState,a=a(u,r),a=a==null?r:qi({},r,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var Ev={isMounted:function(e){return(e=e._reactInternals)?eh(e)===e:!1},enqueueSetState:function(e,r,a){e=e._reactInternals;var u=ds(),g=Iu(e),_=cc(u,g);_.payload=r,a!=null&&(_.callback=a),r=Mu(e,_,g),r!==null&&(Xa(r,e,g,u),xx(r,e,g))},enqueueReplaceState:function(e,r,a){e=e._reactInternals;var u=ds(),g=Iu(e),_=cc(u,g);_.tag=1,_.payload=r,a!=null&&(_.callback=a),r=Mu(e,_,g),r!==null&&(Xa(r,e,g,u),xx(r,e,g))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var a=ds(),u=Iu(e),g=cc(a,u);g.tag=2,r!=null&&(g.callback=r),r=Mu(e,g,u),r!==null&&(Xa(r,e,u,a),xx(r,e,u))}};function dP(e,r,a,u,g,_,M){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,_,M):r.prototype&&r.prototype.isPureReactComponent?!ay(a,u)||!ay(g,_):!0}function KR(e,r,a){var u=!1,g=Au,_=r.contextType;return typeof _=="object"&&_!==null?_=Sa(_):(g=Cs(r)?Gd:Jo.current,u=r.contextTypes,_=(u=u!=null)?of(e,g):Au),r=new r(a,_),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Ev,e.stateNode=r,r._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=g,e.__reactInternalMemoizedMaskedChildContext=_),r}function hP(e,r,a,u){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,u),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,u),r.state!==e&&Ev.enqueueReplaceState(r,r.state,null)}function VS(e,r,a,u){var g=e.stateNode;g.props=a,g.state=e.memoizedState,g.refs={},qT(e);var _=r.contextType;typeof _=="object"&&_!==null?g.context=Sa(_):(_=Cs(r)?Gd:Jo.current,g.context=of(e,_)),g.state=e.memoizedState,_=r.getDerivedStateFromProps,typeof _=="function"&&(NS(e,r,_,a),g.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(r=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),r!==g.state&&Ev.enqueueReplaceState(g,g.state,null),Zx(e,a,g,u),g.state=e.memoizedState),typeof g.componentDidMount=="function"&&(e.flags|=4194308)}function cf(e,r){try{var a="",u=r;do a+=q5(u),u=u.return;while(u);var g=a}catch(_){g=`
Error generating stack: `+_.message+`
`+_.stack}return{value:e,source:r,stack:g,digest:null}}function $w(e,r,a){return{value:e,source:null,stack:a??null,digest:r??null}}function $S(e,r){try{console.error(r.value)}catch(a){setTimeout(function(){throw a})}}var v2=typeof WeakMap=="function"?WeakMap:Map;function JR(e,r,a){a=cc(-1,a),a.tag=3,a.payload={element:null};var u=r.value;return a.callback=function(){Qx||(Qx=!0,JS=u),$S(e,r)},a}function QR(e,r,a){a=cc(-1,a),a.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var g=r.value;a.payload=function(){return u(g)},a.callback=function(){$S(e,r)}}var _=e.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(a.callback=function(){$S(e,r),typeof u!="function"&&(Eu===null?Eu=new Set([this]):Eu.add(this));var M=r.stack;this.componentDidCatch(r.value,{componentStack:M!==null?M:""})}),a}function pP(e,r,a){var u=e.pingCache;if(u===null){u=e.pingCache=new v2;var g=new Set;u.set(r,g)}else g=u.get(r),g===void 0&&(g=new Set,u.set(r,g));g.has(a)||(g.add(a),e=L2.bind(null,e,r,a),r.then(e,e))}function fP(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function mP(e,r,a,u,g){return e.mode&1?(e.flags|=65536,e.lanes=g,e):(e===r?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(r=cc(-1,1),r.tag=2,Mu(a,r,1))),a.lanes|=1),e)}var b2=_c.ReactCurrentOwner,Ss=!1;function cs(e,r,a,u){r.child=e===null?IR(r,null,a,u):af(r,e.child,a,u)}function gP(e,r,a,u,g){a=a.render;var _=r.ref;return Zp(r,g),u=JT(e,r,a,u,_,g),a=QT(),e!==null&&!Ss?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~g,mc(e,r,g)):(Vi&&a&&NT(r),r.flags|=1,cs(e,r,u,g),r.child)}function yP(e,r,a,u,g){if(e===null){var _=a.type;return typeof _=="function"&&!cC(_)&&_.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(r.tag=15,r.type=_,eL(e,r,_,u,g)):(e=Cx(a.type,null,u,r,r.mode,g),e.ref=r.ref,e.return=r,r.child=e)}if(_=e.child,!(e.lanes&g)){var M=_.memoizedProps;if(a=a.compare,a=a!==null?a:ay,a(M,u)&&e.ref===r.ref)return mc(e,r,g)}return r.flags|=1,e=ku(_,u),e.ref=r.ref,e.return=r,r.child=e}function eL(e,r,a,u,g){if(e!==null){var _=e.memoizedProps;if(ay(_,u)&&e.ref===r.ref)if(Ss=!1,r.pendingProps=u=_,(e.lanes&g)!==0)e.flags&131072&&(Ss=!0);else return r.lanes=e.lanes,mc(e,r,g)}return US(e,r,a,u,g)}function tL(e,r,a){var u=r.pendingProps,g=u.children,_=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},Di(Bp,Bs),Bs|=a;else{if(!(a&1073741824))return e=_!==null?_.baseLanes|a:a,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,Di(Bp,Bs),Bs|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=_!==null?_.baseLanes:a,Di(Bp,Bs),Bs|=u}else _!==null?(u=_.baseLanes|a,r.memoizedState=null):u=a,Di(Bp,Bs),Bs|=u;return cs(e,r,g,a),r.child}function rL(e,r){var a=r.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(r.flags|=512,r.flags|=2097152)}function US(e,r,a,u,g){var _=Cs(a)?Gd:Jo.current;return _=of(r,_),Zp(r,g),a=JT(e,r,a,u,_,g),u=QT(),e!==null&&!Ss?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~g,mc(e,r,g)):(Vi&&u&&NT(r),r.flags|=1,cs(e,r,a,g),r.child)}function _P(e,r,a,u,g){if(Cs(a)){var _=!0;Ux(r)}else _=!1;if(Zp(r,g),r.stateNode===null)wx(e,r),KR(r,a,u),VS(r,a,u,g),u=!0;else if(e===null){var M=r.stateNode,D=r.memoizedProps;M.props=D;var i=M.context,j=a.contextType;typeof j=="object"&&j!==null?j=Sa(j):(j=Cs(a)?Gd:Jo.current,j=of(r,j));var H=a.getDerivedStateFromProps,q=typeof H=="function"||typeof M.getSnapshotBeforeUpdate=="function";q||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(D!==u||i!==j)&&hP(r,M,u,j),gu=!1;var X=r.memoizedState;M.state=X,Zx(r,u,M,g),i=r.memoizedState,D!==u||X!==i||Ts.current||gu?(typeof H=="function"&&(NS(r,a,H,u),i=r.memoizedState),(D=gu||dP(r,a,D,u,X,i,j))?(q||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(r.flags|=4194308)):(typeof M.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=u,r.memoizedState=i),M.props=u,M.state=i,M.context=j,u=D):(typeof M.componentDidMount=="function"&&(r.flags|=4194308),u=!1)}else{M=r.stateNode,PR(e,r),D=r.memoizedProps,j=r.type===r.elementType?D:Ga(r.type,D),M.props=j,q=r.pendingProps,X=M.context,i=a.contextType,typeof i=="object"&&i!==null?i=Sa(i):(i=Cs(a)?Gd:Jo.current,i=of(r,i));var se=a.getDerivedStateFromProps;(H=typeof se=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(D!==q||X!==i)&&hP(r,M,u,i),gu=!1,X=r.memoizedState,M.state=X,Zx(r,u,M,g);var ne=r.memoizedState;D!==q||X!==ne||Ts.current||gu?(typeof se=="function"&&(NS(r,a,se,u),ne=r.memoizedState),(j=gu||dP(r,a,j,u,X,ne,i)||!1)?(H||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(u,ne,i),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(u,ne,i)),typeof M.componentDidUpdate=="function"&&(r.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof M.componentDidUpdate!="function"||D===e.memoizedProps&&X===e.memoizedState||(r.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||D===e.memoizedProps&&X===e.memoizedState||(r.flags|=1024),r.memoizedProps=u,r.memoizedState=ne),M.props=u,M.state=ne,M.context=i,u=j):(typeof M.componentDidUpdate!="function"||D===e.memoizedProps&&X===e.memoizedState||(r.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||D===e.memoizedProps&&X===e.memoizedState||(r.flags|=1024),u=!1)}return WS(e,r,a,u,_,g)}function WS(e,r,a,u,g,_){rL(e,r);var M=(r.flags&128)!==0;if(!u&&!M)return g&&nP(r,a,!1),mc(e,r,_);u=r.stateNode,b2.current=r;var D=M&&typeof a.getDerivedStateFromError!="function"?null:u.render();return r.flags|=1,e!==null&&M?(r.child=af(r,e.child,null,_),r.child=af(r,null,D,_)):cs(e,r,D,_),r.memoizedState=u.state,g&&nP(r,a,!0),r.child}function nL(e){var r=e.stateNode;r.pendingContext?rP(e,r.pendingContext,r.pendingContext!==r.context):r.context&&rP(e,r.context,!1),ZT(e,r.containerInfo)}function xP(e,r,a,u,g){return sf(),$T(g),r.flags|=256,cs(e,r,a,u),r.child}var GS={dehydrated:null,treeContext:null,retryLane:0};function HS(e){return{baseLanes:e,cachePool:null,transitions:null}}function iL(e,r,a){var u=r.pendingProps,g=Gi.current,_=!1,M=(r.flags&128)!==0,D;if((D=M)||(D=e!==null&&e.memoizedState===null?!1:(g&2)!==0),D?(_=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(g|=1),Di(Gi,g&1),e===null)return BS(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(M=u.children,e=u.fallback,_?(u=r.mode,_=r.child,M={mode:"hidden",children:M},!(u&1)&&_!==null?(_.childLanes=0,_.pendingProps=M):_=Pv(M,u,0,null),e=Wd(e,u,a,null),_.return=r,e.return=r,_.sibling=e,r.child=_,r.child.memoizedState=HS(a),r.memoizedState=GS,e):rC(r,M));if(g=e.memoizedState,g!==null&&(D=g.dehydrated,D!==null))return w2(e,r,M,u,D,g,a);if(_){_=u.fallback,M=r.mode,g=e.child,D=g.sibling;var i={mode:"hidden",children:u.children};return!(M&1)&&r.child!==g?(u=r.child,u.childLanes=0,u.pendingProps=i,r.deletions=null):(u=ku(g,i),u.subtreeFlags=g.subtreeFlags&14680064),D!==null?_=ku(D,_):(_=Wd(_,M,a,null),_.flags|=2),_.return=r,u.return=r,u.sibling=_,r.child=u,u=_,_=r.child,M=e.child.memoizedState,M=M===null?HS(a):{baseLanes:M.baseLanes|a,cachePool:null,transitions:M.transitions},_.memoizedState=M,_.childLanes=e.childLanes&~a,r.memoizedState=GS,u}return _=e.child,e=_.sibling,u=ku(_,{mode:"visible",children:u.children}),!(r.mode&1)&&(u.lanes=a),u.return=r,u.sibling=null,e!==null&&(a=r.deletions,a===null?(r.deletions=[e],r.flags|=16):a.push(e)),r.child=u,r.memoizedState=null,u}function rC(e,r){return r=Pv({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function H0(e,r,a,u){return u!==null&&$T(u),af(r,e.child,null,a),e=rC(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function w2(e,r,a,u,g,_,M){if(a)return r.flags&256?(r.flags&=-257,u=$w(Error(mr(422))),H0(e,r,M,u)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(_=u.fallback,g=r.mode,u=Pv({mode:"visible",children:u.children},g,0,null),_=Wd(_,g,M,null),_.flags|=2,u.return=r,_.return=r,u.sibling=_,r.child=u,r.mode&1&&af(r,e.child,null,M),r.child.memoizedState=HS(M),r.memoizedState=GS,_);if(!(r.mode&1))return H0(e,r,M,null);if(g.data==="$!"){if(u=g.nextSibling&&g.nextSibling.dataset,u)var D=u.dgst;return u=D,_=Error(mr(419)),u=$w(_,u,void 0),H0(e,r,M,u)}if(D=(M&e.childLanes)!==0,Ss||D){if(u=To,u!==null){switch(M&-M){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(u.suspendedLanes|M)?0:g,g!==0&&g!==_.retryLane&&(_.retryLane=g,fc(e,g),Xa(u,e,g,-1))}return lC(),u=$w(Error(mr(421))),H0(e,r,M,u)}return g.data==="$?"?(r.flags|=128,r.child=e.child,r=z2.bind(null,e),g._reactRetry=r,null):(e=_.treeContext,$s=Cu(g.nextSibling),Us=r,Vi=!0,qa=null,e!==null&&(fa[ma++]=ac,fa[ma++]=lc,fa[ma++]=Hd,ac=e.id,lc=e.overflow,Hd=r),r=rC(r,u.children),r.flags|=4096,r)}function vP(e,r,a){e.lanes|=r;var u=e.alternate;u!==null&&(u.lanes|=r),jS(e.return,r,a)}function Uw(e,r,a,u,g){var _=e.memoizedState;_===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:g}:(_.isBackwards=r,_.rendering=null,_.renderingStartTime=0,_.last=u,_.tail=a,_.tailMode=g)}function oL(e,r,a){var u=r.pendingProps,g=u.revealOrder,_=u.tail;if(cs(e,r,u.children,a),u=Gi.current,u&2)u=u&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vP(e,a,r);else if(e.tag===19)vP(e,a,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(Di(Gi,u),!(r.mode&1))r.memoizedState=null;else switch(g){case"forwards":for(a=r.child,g=null;a!==null;)e=a.alternate,e!==null&&Yx(e)===null&&(g=a),a=a.sibling;a=g,a===null?(g=r.child,r.child=null):(g=a.sibling,a.sibling=null),Uw(r,!1,g,a,_);break;case"backwards":for(a=null,g=r.child,r.child=null;g!==null;){if(e=g.alternate,e!==null&&Yx(e)===null){r.child=g;break}e=g.sibling,g.sibling=a,a=g,g=e}Uw(r,!0,a,null,_);break;case"together":Uw(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function wx(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function mc(e,r,a){if(e!==null&&(r.dependencies=e.dependencies),Zd|=r.lanes,!(a&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(mr(153));if(r.child!==null){for(e=r.child,a=ku(e,e.pendingProps),r.child=a,a.return=r;e.sibling!==null;)e=e.sibling,a=a.sibling=ku(e,e.pendingProps),a.return=r;a.sibling=null}return r.child}function S2(e,r,a){switch(r.tag){case 3:nL(r),sf();break;case 5:AR(r);break;case 1:Cs(r.type)&&Ux(r);break;case 4:ZT(r,r.stateNode.containerInfo);break;case 10:var u=r.type._context,g=r.memoizedProps.value;Di(Hx,u._currentValue),u._currentValue=g;break;case 13:if(u=r.memoizedState,u!==null)return u.dehydrated!==null?(Di(Gi,Gi.current&1),r.flags|=128,null):a&r.child.childLanes?iL(e,r,a):(Di(Gi,Gi.current&1),e=mc(e,r,a),e!==null?e.sibling:null);Di(Gi,Gi.current&1);break;case 19:if(u=(a&r.childLanes)!==0,e.flags&128){if(u)return oL(e,r,a);r.flags|=128}if(g=r.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Di(Gi,Gi.current),u)break;return null;case 22:case 23:return r.lanes=0,tL(e,r,a)}return mc(e,r,a)}var sL,qS,aL,lL;sL=function(e,r){for(var a=r.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};qS=function(){};aL=function(e,r,a,u){var g=e.memoizedProps;if(g!==u){e=r.stateNode,jd(Ol.current);var _=null;switch(a){case"input":g=mS(e,g),u=mS(e,u),_=[];break;case"select":g=qi({},g,{value:void 0}),u=qi({},u,{value:void 0}),_=[];break;case"textarea":g=_S(e,g),u=_S(e,u),_=[];break;default:typeof g.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=Vx)}vS(a,u);var M;a=null;for(j in g)if(!u.hasOwnProperty(j)&&g.hasOwnProperty(j)&&g[j]!=null)if(j==="style"){var D=g[j];for(M in D)D.hasOwnProperty(M)&&(a||(a={}),a[M]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(ey.hasOwnProperty(j)?_||(_=[]):(_=_||[]).push(j,null));for(j in u){var i=u[j];if(D=g!=null?g[j]:void 0,u.hasOwnProperty(j)&&i!==D&&(i!=null||D!=null))if(j==="style")if(D){for(M in D)!D.hasOwnProperty(M)||i&&i.hasOwnProperty(M)||(a||(a={}),a[M]="");for(M in i)i.hasOwnProperty(M)&&D[M]!==i[M]&&(a||(a={}),a[M]=i[M])}else a||(_||(_=[]),_.push(j,a)),a=i;else j==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,D=D?D.__html:void 0,i!=null&&D!==i&&(_=_||[]).push(j,i)):j==="children"?typeof i!="string"&&typeof i!="number"||(_=_||[]).push(j,""+i):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(ey.hasOwnProperty(j)?(i!=null&&j==="onScroll"&&Fi("scroll",e),_||D===i||(_=[])):(_=_||[]).push(j,i))}a&&(_=_||[]).push("style",a);var j=_;(r.updateQueue=j)&&(r.flags|=4)}};lL=function(e,r,a,u){a!==u&&(r.flags|=4)};function mg(e,r){if(!Vi)switch(e.tailMode){case"hidden":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Zo(e){var r=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(r)for(var g=e.child;g!==null;)a|=g.lanes|g.childLanes,u|=g.subtreeFlags&14680064,u|=g.flags&14680064,g.return=e,g=g.sibling;else for(g=e.child;g!==null;)a|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=e,g=g.sibling;return e.subtreeFlags|=u,e.childLanes=a,r}function T2(e,r,a){var u=r.pendingProps;switch(VT(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zo(r),null;case 1:return Cs(r.type)&&$x(),Zo(r),null;case 3:return u=r.stateNode,lf(),Bi(Ts),Bi(Jo),XT(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(W0(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,qa!==null&&(tT(qa),qa=null))),qS(e,r),Zo(r),null;case 5:YT(r);var g=jd(hy.current);if(a=r.type,e!==null&&r.stateNode!=null)aL(e,r,a,u,g),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!u){if(r.stateNode===null)throw Error(mr(166));return Zo(r),null}if(e=jd(Ol.current),W0(r)){u=r.stateNode,a=r.type;var _=r.memoizedProps;switch(u[Dl]=r,u[uy]=_,e=(r.mode&1)!==0,a){case"dialog":Fi("cancel",u),Fi("close",u);break;case"iframe":case"object":case"embed":Fi("load",u);break;case"video":case"audio":for(g=0;g<Rg.length;g++)Fi(Rg[g],u);break;case"source":Fi("error",u);break;case"img":case"image":case"link":Fi("error",u),Fi("load",u);break;case"details":Fi("toggle",u);break;case"input":kk(u,_),Fi("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!_.multiple},Fi("invalid",u);break;case"textarea":Ak(u,_),Fi("invalid",u)}vS(a,_),g=null;for(var M in _)if(_.hasOwnProperty(M)){var D=_[M];M==="children"?typeof D=="string"?u.textContent!==D&&(_.suppressHydrationWarning!==!0&&U0(u.textContent,D,e),g=["children",D]):typeof D=="number"&&u.textContent!==""+D&&(_.suppressHydrationWarning!==!0&&U0(u.textContent,D,e),g=["children",""+D]):ey.hasOwnProperty(M)&&D!=null&&M==="onScroll"&&Fi("scroll",u)}switch(a){case"input":z0(u),Pk(u,_,!0);break;case"textarea":z0(u),Dk(u);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(u.onclick=Vx)}u=g,r.updateQueue=u,u!==null&&(r.flags|=4)}else{M=g.nodeType===9?g:g.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=OD(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=M.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=M.createElement(a,{is:u.is}):(e=M.createElement(a),a==="select"&&(M=e,u.multiple?M.multiple=!0:u.size&&(M.size=u.size))):e=M.createElementNS(e,a),e[Dl]=r,e[uy]=u,sL(e,r,!1,!1),r.stateNode=e;e:{switch(M=bS(a,u),a){case"dialog":Fi("cancel",e),Fi("close",e),g=u;break;case"iframe":case"object":case"embed":Fi("load",e),g=u;break;case"video":case"audio":for(g=0;g<Rg.length;g++)Fi(Rg[g],e);g=u;break;case"source":Fi("error",e),g=u;break;case"img":case"image":case"link":Fi("error",e),Fi("load",e),g=u;break;case"details":Fi("toggle",e),g=u;break;case"input":kk(e,u),g=mS(e,u),Fi("invalid",e);break;case"option":g=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},g=qi({},u,{value:void 0}),Fi("invalid",e);break;case"textarea":Ak(e,u),g=_S(e,u),Fi("invalid",e);break;default:g=u}vS(a,g),D=g;for(_ in D)if(D.hasOwnProperty(_)){var i=D[_];_==="style"?jD(e,i):_==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,i!=null&&FD(e,i)):_==="children"?typeof i=="string"?(a!=="textarea"||i!=="")&&ty(e,i):typeof i=="number"&&ty(e,""+i):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(ey.hasOwnProperty(_)?i!=null&&_==="onScroll"&&Fi("scroll",e):i!=null&&MT(e,_,i,M))}switch(a){case"input":z0(e),Pk(e,u,!1);break;case"textarea":z0(e),Dk(e);break;case"option":u.value!=null&&e.setAttribute("value",""+Pu(u.value));break;case"select":e.multiple=!!u.multiple,_=u.value,_!=null?Wp(e,!!u.multiple,_,!1):u.defaultValue!=null&&Wp(e,!!u.multiple,u.defaultValue,!0);break;default:typeof g.onClick=="function"&&(e.onclick=Vx)}switch(a){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Zo(r),null;case 6:if(e&&r.stateNode!=null)lL(e,r,e.memoizedProps,u);else{if(typeof u!="string"&&r.stateNode===null)throw Error(mr(166));if(a=jd(hy.current),jd(Ol.current),W0(r)){if(u=r.stateNode,a=r.memoizedProps,u[Dl]=r,(_=u.nodeValue!==a)&&(e=Us,e!==null))switch(e.tag){case 3:U0(u.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&U0(u.nodeValue,a,(e.mode&1)!==0)}_&&(r.flags|=4)}else u=(a.nodeType===9?a:a.ownerDocument).createTextNode(u),u[Dl]=r,r.stateNode=u}return Zo(r),null;case 13:if(Bi(Gi),u=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Vi&&$s!==null&&r.mode&1&&!(r.flags&128))MR(),sf(),r.flags|=98560,_=!1;else if(_=W0(r),u!==null&&u.dehydrated!==null){if(e===null){if(!_)throw Error(mr(318));if(_=r.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(mr(317));_[Dl]=r}else sf(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;Zo(r),_=!1}else qa!==null&&(tT(qa),qa=null),_=!0;if(!_)return r.flags&65536?r:null}return r.flags&128?(r.lanes=a,r):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(r.child.flags|=8192,r.mode&1&&(e===null||Gi.current&1?go===0&&(go=3):lC())),r.updateQueue!==null&&(r.flags|=4),Zo(r),null);case 4:return lf(),qS(e,r),e===null&&ly(r.stateNode.containerInfo),Zo(r),null;case 10:return GT(r.type._context),Zo(r),null;case 17:return Cs(r.type)&&$x(),Zo(r),null;case 19:if(Bi(Gi),_=r.memoizedState,_===null)return Zo(r),null;if(u=(r.flags&128)!==0,M=_.rendering,M===null)if(u)mg(_,!1);else{if(go!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(M=Yx(e),M!==null){for(r.flags|=128,mg(_,!1),u=M.updateQueue,u!==null&&(r.updateQueue=u,r.flags|=4),r.subtreeFlags=0,u=a,a=r.child;a!==null;)_=a,e=u,_.flags&=14680066,M=_.alternate,M===null?(_.childLanes=0,_.lanes=e,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=M.childLanes,_.lanes=M.lanes,_.child=M.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=M.memoizedProps,_.memoizedState=M.memoizedState,_.updateQueue=M.updateQueue,_.type=M.type,e=M.dependencies,_.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return Di(Gi,Gi.current&1|2),r.child}e=e.sibling}_.tail!==null&&no()>uf&&(r.flags|=128,u=!0,mg(_,!1),r.lanes=4194304)}else{if(!u)if(e=Yx(M),e!==null){if(r.flags|=128,u=!0,a=e.updateQueue,a!==null&&(r.updateQueue=a,r.flags|=4),mg(_,!0),_.tail===null&&_.tailMode==="hidden"&&!M.alternate&&!Vi)return Zo(r),null}else 2*no()-_.renderingStartTime>uf&&a!==1073741824&&(r.flags|=128,u=!0,mg(_,!1),r.lanes=4194304);_.isBackwards?(M.sibling=r.child,r.child=M):(a=_.last,a!==null?a.sibling=M:r.child=M,_.last=M)}return _.tail!==null?(r=_.tail,_.rendering=r,_.tail=r.sibling,_.renderingStartTime=no(),r.sibling=null,a=Gi.current,Di(Gi,u?a&1|2:a&1),r):(Zo(r),null);case 22:case 23:return aC(),u=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(r.flags|=8192),u&&r.mode&1?Bs&1073741824&&(Zo(r),r.subtreeFlags&6&&(r.flags|=8192)):Zo(r),null;case 24:return null;case 25:return null}throw Error(mr(156,r.tag))}function C2(e,r){switch(VT(r),r.tag){case 1:return Cs(r.type)&&$x(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return lf(),Bi(Ts),Bi(Jo),XT(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return YT(r),null;case 13:if(Bi(Gi),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(mr(340));sf()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Bi(Gi),null;case 4:return lf(),null;case 10:return GT(r.type._context),null;case 22:case 23:return aC(),null;case 24:return null;default:return null}}var q0=!1,Xo=!1,M2=typeof WeakSet=="function"?WeakSet:Set,Gr=null;function Fp(e,r){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(u){Qi(e,r,u)}else a.current=null}function ZS(e,r,a){try{a()}catch(u){Qi(e,r,u)}}var bP=!1;function E2(e,r){if(AS=Bx,e=pR(),jT(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var g=u.anchorOffset,_=u.focusNode;u=u.focusOffset;try{a.nodeType,_.nodeType}catch{a=null;break e}var M=0,D=-1,i=-1,j=0,H=0,q=e,X=null;t:for(;;){for(var se;q!==a||g!==0&&q.nodeType!==3||(D=M+g),q!==_||u!==0&&q.nodeType!==3||(i=M+u),q.nodeType===3&&(M+=q.nodeValue.length),(se=q.firstChild)!==null;)X=q,q=se;for(;;){if(q===e)break t;if(X===a&&++j===g&&(D=M),X===_&&++H===u&&(i=M),(se=q.nextSibling)!==null)break;q=X,X=q.parentNode}q=se}a=D===-1||i===-1?null:{start:D,end:i}}else a=null}a=a||{start:0,end:0}}else a=null;for(DS={focusedElem:e,selectionRange:a},Bx=!1,Gr=r;Gr!==null;)if(r=Gr,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Gr=e;else for(;Gr!==null;){r=Gr;try{var ne=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(ne!==null){var le=ne.memoizedProps,de=ne.memoizedState,te=r.stateNode,Q=te.getSnapshotBeforeUpdate(r.elementType===r.type?le:Ga(r.type,le),de);te.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var K=r.stateNode.containerInfo;K.nodeType===1?K.textContent="":K.nodeType===9&&K.documentElement&&K.removeChild(K.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mr(163))}}catch(ce){Qi(r,r.return,ce)}if(e=r.sibling,e!==null){e.return=r.return,Gr=e;break}Gr=r.return}return ne=bP,bP=!1,ne}function Wg(e,r,a){var u=r.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var g=u=u.next;do{if((g.tag&e)===e){var _=g.destroy;g.destroy=void 0,_!==void 0&&ZS(r,a,_)}g=g.next}while(g!==u)}}function Iv(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var u=a.create;a.destroy=u()}a=a.next}while(a!==r)}}function YS(e){var r=e.ref;if(r!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof r=="function"?r(e):r.current=e}}function cL(e){var r=e.alternate;r!==null&&(e.alternate=null,cL(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Dl],delete r[uy],delete r[zS],delete r[c2],delete r[u2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uL(e){return e.tag===5||e.tag===3||e.tag===4}function wP(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||uL(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function XS(e,r,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,r?a.nodeType===8?a.parentNode.insertBefore(e,r):a.insertBefore(e,r):(a.nodeType===8?(r=a.parentNode,r.insertBefore(e,a)):(r=a,r.appendChild(e)),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=Vx));else if(u!==4&&(e=e.child,e!==null))for(XS(e,r,a),e=e.sibling;e!==null;)XS(e,r,a),e=e.sibling}function KS(e,r,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,r?a.insertBefore(e,r):a.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(KS(e,r,a),e=e.sibling;e!==null;)KS(e,r,a),e=e.sibling}var Lo=null,Ha=!1;function du(e,r,a){for(a=a.child;a!==null;)dL(e,r,a),a=a.sibling}function dL(e,r,a){if(zl&&typeof zl.onCommitFiberUnmount=="function")try{zl.onCommitFiberUnmount(vv,a)}catch{}switch(a.tag){case 5:Xo||Fp(a,r);case 6:var u=Lo,g=Ha;Lo=null,du(e,r,a),Lo=u,Ha=g,Lo!==null&&(Ha?(e=Lo,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):Lo.removeChild(a.stateNode));break;case 18:Lo!==null&&(Ha?(e=Lo,a=a.stateNode,e.nodeType===8?Ow(e.parentNode,a):e.nodeType===1&&Ow(e,a),oy(e)):Ow(Lo,a.stateNode));break;case 4:u=Lo,g=Ha,Lo=a.stateNode.containerInfo,Ha=!0,du(e,r,a),Lo=u,Ha=g;break;case 0:case 11:case 14:case 15:if(!Xo&&(u=a.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){g=u=u.next;do{var _=g,M=_.destroy;_=_.tag,M!==void 0&&(_&2||_&4)&&ZS(a,r,M),g=g.next}while(g!==u)}du(e,r,a);break;case 1:if(!Xo&&(Fp(a,r),u=a.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=a.memoizedProps,u.state=a.memoizedState,u.componentWillUnmount()}catch(D){Qi(a,r,D)}du(e,r,a);break;case 21:du(e,r,a);break;case 22:a.mode&1?(Xo=(u=Xo)||a.memoizedState!==null,du(e,r,a),Xo=u):du(e,r,a);break;default:du(e,r,a)}}function SP(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new M2),r.forEach(function(u){var g=O2.bind(null,e,u);a.has(u)||(a.add(u),u.then(g,g))})}}function Ua(e,r){var a=r.deletions;if(a!==null)for(var u=0;u<a.length;u++){var g=a[u];try{var _=e,M=r,D=M;e:for(;D!==null;){switch(D.tag){case 5:Lo=D.stateNode,Ha=!1;break e;case 3:Lo=D.stateNode.containerInfo,Ha=!0;break e;case 4:Lo=D.stateNode.containerInfo,Ha=!0;break e}D=D.return}if(Lo===null)throw Error(mr(160));dL(_,M,g),Lo=null,Ha=!1;var i=g.alternate;i!==null&&(i.return=null),g.return=null}catch(j){Qi(g,r,j)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)hL(r,e),r=r.sibling}function hL(e,r){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ua(r,e),Tl(e),u&4){try{Wg(3,e,e.return),Iv(3,e)}catch(le){Qi(e,e.return,le)}try{Wg(5,e,e.return)}catch(le){Qi(e,e.return,le)}}break;case 1:Ua(r,e),Tl(e),u&512&&a!==null&&Fp(a,a.return);break;case 5:if(Ua(r,e),Tl(e),u&512&&a!==null&&Fp(a,a.return),e.flags&32){var g=e.stateNode;try{ty(g,"")}catch(le){Qi(e,e.return,le)}}if(u&4&&(g=e.stateNode,g!=null)){var _=e.memoizedProps,M=a!==null?a.memoizedProps:_,D=e.type,i=e.updateQueue;if(e.updateQueue=null,i!==null)try{D==="input"&&_.type==="radio"&&_.name!=null&&LD(g,_),bS(D,M);var j=bS(D,_);for(M=0;M<i.length;M+=2){var H=i[M],q=i[M+1];H==="style"?jD(g,q):H==="dangerouslySetInnerHTML"?FD(g,q):H==="children"?ty(g,q):MT(g,H,q,j)}switch(D){case"input":gS(g,_);break;case"textarea":zD(g,_);break;case"select":var X=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!_.multiple;var se=_.value;se!=null?Wp(g,!!_.multiple,se,!1):X!==!!_.multiple&&(_.defaultValue!=null?Wp(g,!!_.multiple,_.defaultValue,!0):Wp(g,!!_.multiple,_.multiple?[]:"",!1))}g[uy]=_}catch(le){Qi(e,e.return,le)}}break;case 6:if(Ua(r,e),Tl(e),u&4){if(e.stateNode===null)throw Error(mr(162));g=e.stateNode,_=e.memoizedProps;try{g.nodeValue=_}catch(le){Qi(e,e.return,le)}}break;case 3:if(Ua(r,e),Tl(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{oy(r.containerInfo)}catch(le){Qi(e,e.return,le)}break;case 4:Ua(r,e),Tl(e);break;case 13:Ua(r,e),Tl(e),g=e.child,g.flags&8192&&(_=g.memoizedState!==null,g.stateNode.isHidden=_,!_||g.alternate!==null&&g.alternate.memoizedState!==null||(oC=no())),u&4&&SP(e);break;case 22:if(H=a!==null&&a.memoizedState!==null,e.mode&1?(Xo=(j=Xo)||H,Ua(r,e),Xo=j):Ua(r,e),Tl(e),u&8192){if(j=e.memoizedState!==null,(e.stateNode.isHidden=j)&&!H&&e.mode&1)for(Gr=e,H=e.child;H!==null;){for(q=Gr=H;Gr!==null;){switch(X=Gr,se=X.child,X.tag){case 0:case 11:case 14:case 15:Wg(4,X,X.return);break;case 1:Fp(X,X.return);var ne=X.stateNode;if(typeof ne.componentWillUnmount=="function"){u=X,a=X.return;try{r=u,ne.props=r.memoizedProps,ne.state=r.memoizedState,ne.componentWillUnmount()}catch(le){Qi(u,a,le)}}break;case 5:Fp(X,X.return);break;case 22:if(X.memoizedState!==null){CP(q);continue}}se!==null?(se.return=X,Gr=se):CP(q)}H=H.sibling}e:for(H=null,q=e;;){if(q.tag===5){if(H===null){H=q;try{g=q.stateNode,j?(_=g.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(D=q.stateNode,i=q.memoizedProps.style,M=i!=null&&i.hasOwnProperty("display")?i.display:null,D.style.display=BD("display",M))}catch(le){Qi(e,e.return,le)}}}else if(q.tag===6){if(H===null)try{q.stateNode.nodeValue=j?"":q.memoizedProps}catch(le){Qi(e,e.return,le)}}else if((q.tag!==22&&q.tag!==23||q.memoizedState===null||q===e)&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===e)break e;for(;q.sibling===null;){if(q.return===null||q.return===e)break e;H===q&&(H=null),q=q.return}H===q&&(H=null),q.sibling.return=q.return,q=q.sibling}}break;case 19:Ua(r,e),Tl(e),u&4&&SP(e);break;case 21:break;default:Ua(r,e),Tl(e)}}function Tl(e){var r=e.flags;if(r&2){try{e:{for(var a=e.return;a!==null;){if(uL(a)){var u=a;break e}a=a.return}throw Error(mr(160))}switch(u.tag){case 5:var g=u.stateNode;u.flags&32&&(ty(g,""),u.flags&=-33);var _=wP(e);KS(e,_,g);break;case 3:case 4:var M=u.stateNode.containerInfo,D=wP(e);XS(e,D,M);break;default:throw Error(mr(161))}}catch(i){Qi(e,e.return,i)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function I2(e,r,a){Gr=e,pL(e)}function pL(e,r,a){for(var u=(e.mode&1)!==0;Gr!==null;){var g=Gr,_=g.child;if(g.tag===22&&u){var M=g.memoizedState!==null||q0;if(!M){var D=g.alternate,i=D!==null&&D.memoizedState!==null||Xo;D=q0;var j=Xo;if(q0=M,(Xo=i)&&!j)for(Gr=g;Gr!==null;)M=Gr,i=M.child,M.tag===22&&M.memoizedState!==null?MP(g):i!==null?(i.return=M,Gr=i):MP(g);for(;_!==null;)Gr=_,pL(_),_=_.sibling;Gr=g,q0=D,Xo=j}TP(e)}else g.subtreeFlags&8772&&_!==null?(_.return=g,Gr=_):TP(e)}}function TP(e){for(;Gr!==null;){var r=Gr;if(r.flags&8772){var a=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Xo||Iv(5,r);break;case 1:var u=r.stateNode;if(r.flags&4&&!Xo)if(a===null)u.componentDidMount();else{var g=r.elementType===r.type?a.memoizedProps:Ga(r.type,a.memoizedProps);u.componentDidUpdate(g,a.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var _=r.updateQueue;_!==null&&lP(r,_,u);break;case 3:var M=r.updateQueue;if(M!==null){if(a=null,r.child!==null)switch(r.child.tag){case 5:a=r.child.stateNode;break;case 1:a=r.child.stateNode}lP(r,M,a)}break;case 5:var D=r.stateNode;if(a===null&&r.flags&4){a=D;var i=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":i.autoFocus&&a.focus();break;case"img":i.src&&(a.src=i.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var j=r.alternate;if(j!==null){var H=j.memoizedState;if(H!==null){var q=H.dehydrated;q!==null&&oy(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mr(163))}Xo||r.flags&512&&YS(r)}catch(X){Qi(r,r.return,X)}}if(r===e){Gr=null;break}if(a=r.sibling,a!==null){a.return=r.return,Gr=a;break}Gr=r.return}}function CP(e){for(;Gr!==null;){var r=Gr;if(r===e){Gr=null;break}var a=r.sibling;if(a!==null){a.return=r.return,Gr=a;break}Gr=r.return}}function MP(e){for(;Gr!==null;){var r=Gr;try{switch(r.tag){case 0:case 11:case 15:var a=r.return;try{Iv(4,r)}catch(i){Qi(r,a,i)}break;case 1:var u=r.stateNode;if(typeof u.componentDidMount=="function"){var g=r.return;try{u.componentDidMount()}catch(i){Qi(r,g,i)}}var _=r.return;try{YS(r)}catch(i){Qi(r,_,i)}break;case 5:var M=r.return;try{YS(r)}catch(i){Qi(r,M,i)}}}catch(i){Qi(r,r.return,i)}if(r===e){Gr=null;break}var D=r.sibling;if(D!==null){D.return=r.return,Gr=D;break}Gr=r.return}}var k2=Math.ceil,Jx=_c.ReactCurrentDispatcher,nC=_c.ReactCurrentOwner,wa=_c.ReactCurrentBatchConfig,ii=0,To=null,co=null,Oo=0,Bs=0,Bp=Ou(0),go=0,gy=null,Zd=0,kv=0,iC=0,Gg=null,bs=null,oC=0,uf=1/0,oc=null,Qx=!1,JS=null,Eu=null,Z0=!1,vu=null,ev=0,Hg=0,QS=null,Sx=-1,Tx=0;function ds(){return ii&6?no():Sx!==-1?Sx:Sx=no()}function Iu(e){return e.mode&1?ii&2&&Oo!==0?Oo&-Oo:h2.transition!==null?(Tx===0&&(Tx=KD()),Tx):(e=mi,e!==0||(e=window.event,e=e===void 0?16:iR(e.type)),e):1}function Xa(e,r,a,u){if(50<Hg)throw Hg=0,QS=null,Error(mr(185));My(e,a,u),(!(ii&2)||e!==To)&&(e===To&&(!(ii&2)&&(kv|=a),go===4&&_u(e,Oo)),Ms(e,u),a===1&&ii===0&&!(r.mode&1)&&(uf=no()+500,Cv&&Fu()))}function Ms(e,r){var a=e.callbackNode;hB(e,r);var u=Fx(e,e===To?Oo:0);if(u===0)a!==null&&zk(a),e.callbackNode=null,e.callbackPriority=0;else if(r=u&-u,e.callbackPriority!==r){if(a!=null&&zk(a),r===1)e.tag===0?d2(EP.bind(null,e)):SR(EP.bind(null,e)),a2(function(){!(ii&6)&&Fu()}),a=null;else{switch(JD(u)){case 1:a=AT;break;case 4:a=YD;break;case 16:a=Ox;break;case 536870912:a=XD;break;default:a=Ox}a=bL(a,fL.bind(null,e))}e.callbackPriority=r,e.callbackNode=a}}function fL(e,r){if(Sx=-1,Tx=0,ii&6)throw Error(mr(327));var a=e.callbackNode;if(Yp()&&e.callbackNode!==a)return null;var u=Fx(e,e===To?Oo:0);if(u===0)return null;if(u&30||u&e.expiredLanes||r)r=tv(e,u);else{r=u;var g=ii;ii|=2;var _=gL();(To!==e||Oo!==r)&&(oc=null,uf=no()+500,Ud(e,r));do try{D2();break}catch(D){mL(e,D)}while(!0);WT(),Jx.current=_,ii=g,co!==null?r=0:(To=null,Oo=0,r=go)}if(r!==0){if(r===2&&(g=MS(e),g!==0&&(u=g,r=eT(e,g))),r===1)throw a=gy,Ud(e,0),_u(e,u),Ms(e,no()),a;if(r===6)_u(e,u);else{if(g=e.current.alternate,!(u&30)&&!P2(g)&&(r=tv(e,u),r===2&&(_=MS(e),_!==0&&(u=_,r=eT(e,_))),r===1))throw a=gy,Ud(e,0),_u(e,u),Ms(e,no()),a;switch(e.finishedWork=g,e.finishedLanes=u,r){case 0:case 1:throw Error(mr(345));case 2:Ld(e,bs,oc);break;case 3:if(_u(e,u),(u&130023424)===u&&(r=oC+500-no(),10<r)){if(Fx(e,0)!==0)break;if(g=e.suspendedLanes,(g&u)!==u){ds(),e.pingedLanes|=e.suspendedLanes&g;break}e.timeoutHandle=LS(Ld.bind(null,e,bs,oc),r);break}Ld(e,bs,oc);break;case 4:if(_u(e,u),(u&4194240)===u)break;for(r=e.eventTimes,g=-1;0<u;){var M=31-Ya(u);_=1<<M,M=r[M],M>g&&(g=M),u&=~_}if(u=g,u=no()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*k2(u/1960))-u,10<u){e.timeoutHandle=LS(Ld.bind(null,e,bs,oc),u);break}Ld(e,bs,oc);break;case 5:Ld(e,bs,oc);break;default:throw Error(mr(329))}}}return Ms(e,no()),e.callbackNode===a?fL.bind(null,e):null}function eT(e,r){var a=Gg;return e.current.memoizedState.isDehydrated&&(Ud(e,r).flags|=256),e=tv(e,r),e!==2&&(r=bs,bs=a,r!==null&&tT(r)),e}function tT(e){bs===null?bs=e:bs.push.apply(bs,e)}function P2(e){for(var r=e;;){if(r.flags&16384){var a=r.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var u=0;u<a.length;u++){var g=a[u],_=g.getSnapshot;g=g.value;try{if(!Qa(_(),g))return!1}catch{return!1}}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function _u(e,r){for(r&=~iC,r&=~kv,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var a=31-Ya(r),u=1<<a;e[a]=-1,r&=~u}}function EP(e){if(ii&6)throw Error(mr(327));Yp();var r=Fx(e,0);if(!(r&1))return Ms(e,no()),null;var a=tv(e,r);if(e.tag!==0&&a===2){var u=MS(e);u!==0&&(r=u,a=eT(e,u))}if(a===1)throw a=gy,Ud(e,0),_u(e,r),Ms(e,no()),a;if(a===6)throw Error(mr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,Ld(e,bs,oc),Ms(e,no()),null}function sC(e,r){var a=ii;ii|=1;try{return e(r)}finally{ii=a,ii===0&&(uf=no()+500,Cv&&Fu())}}function Yd(e){vu!==null&&vu.tag===0&&!(ii&6)&&Yp();var r=ii;ii|=1;var a=wa.transition,u=mi;try{if(wa.transition=null,mi=1,e)return e()}finally{mi=u,wa.transition=a,ii=r,!(ii&6)&&Fu()}}function aC(){Bs=Bp.current,Bi(Bp)}function Ud(e,r){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,s2(a)),co!==null)for(a=co.return;a!==null;){var u=a;switch(VT(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&$x();break;case 3:lf(),Bi(Ts),Bi(Jo),XT();break;case 5:YT(u);break;case 4:lf();break;case 13:Bi(Gi);break;case 19:Bi(Gi);break;case 10:GT(u.type._context);break;case 22:case 23:aC()}a=a.return}if(To=e,co=e=ku(e.current,null),Oo=Bs=r,go=0,gy=null,iC=kv=Zd=0,bs=Gg=null,Bd!==null){for(r=0;r<Bd.length;r++)if(a=Bd[r],u=a.interleaved,u!==null){a.interleaved=null;var g=u.next,_=a.pending;if(_!==null){var M=_.next;_.next=g,u.next=M}a.pending=u}Bd=null}return e}function mL(e,r){do{var a=co;try{if(WT(),vx.current=Kx,Xx){for(var u=Hi.memoizedState;u!==null;){var g=u.queue;g!==null&&(g.pending=null),u=u.next}Xx=!1}if(qd=0,So=mo=Hi=null,Ug=!1,py=0,nC.current=null,a===null||a.return===null){go=1,gy=r,co=null;break}e:{var _=e,M=a.return,D=a,i=r;if(r=Oo,D.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){var j=i,H=D,q=H.tag;if(!(H.mode&1)&&(q===0||q===11||q===15)){var X=H.alternate;X?(H.updateQueue=X.updateQueue,H.memoizedState=X.memoizedState,H.lanes=X.lanes):(H.updateQueue=null,H.memoizedState=null)}var se=fP(M);if(se!==null){se.flags&=-257,mP(se,M,D,_,r),se.mode&1&&pP(_,j,r),r=se,i=j;var ne=r.updateQueue;if(ne===null){var le=new Set;le.add(i),r.updateQueue=le}else ne.add(i);break e}else{if(!(r&1)){pP(_,j,r),lC();break e}i=Error(mr(426))}}else if(Vi&&D.mode&1){var de=fP(M);if(de!==null){!(de.flags&65536)&&(de.flags|=256),mP(de,M,D,_,r),$T(cf(i,D));break e}}_=i=cf(i,D),go!==4&&(go=2),Gg===null?Gg=[_]:Gg.push(_),_=M;do{switch(_.tag){case 3:_.flags|=65536,r&=-r,_.lanes|=r;var te=JR(_,i,r);aP(_,te);break e;case 1:D=i;var Q=_.type,K=_.stateNode;if(!(_.flags&128)&&(typeof Q.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(Eu===null||!Eu.has(K)))){_.flags|=65536,r&=-r,_.lanes|=r;var ce=QR(_,D,r);aP(_,ce);break e}}_=_.return}while(_!==null)}_L(a)}catch(fe){r=fe,co===a&&a!==null&&(co=a=a.return);continue}break}while(!0)}function gL(){var e=Jx.current;return Jx.current=Kx,e===null?Kx:e}function lC(){(go===0||go===3||go===2)&&(go=4),To===null||!(Zd&268435455)&&!(kv&268435455)||_u(To,Oo)}function tv(e,r){var a=ii;ii|=2;var u=gL();(To!==e||Oo!==r)&&(oc=null,Ud(e,r));do try{A2();break}catch(g){mL(e,g)}while(!0);if(WT(),ii=a,Jx.current=u,co!==null)throw Error(mr(261));return To=null,Oo=0,go}function A2(){for(;co!==null;)yL(co)}function D2(){for(;co!==null&&!nB();)yL(co)}function yL(e){var r=vL(e.alternate,e,Bs);e.memoizedProps=e.pendingProps,r===null?_L(e):co=r,nC.current=null}function _L(e){var r=e;do{var a=r.alternate;if(e=r.return,r.flags&32768){if(a=C2(a,r),a!==null){a.flags&=32767,co=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{go=6,co=null;return}}else if(a=T2(a,r,Bs),a!==null){co=a;return}if(r=r.sibling,r!==null){co=r;return}co=r=e}while(r!==null);go===0&&(go=5)}function Ld(e,r,a){var u=mi,g=wa.transition;try{wa.transition=null,mi=1,R2(e,r,a,u)}finally{wa.transition=g,mi=u}return null}function R2(e,r,a,u){do Yp();while(vu!==null);if(ii&6)throw Error(mr(327));a=e.finishedWork;var g=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(mr(177));e.callbackNode=null,e.callbackPriority=0;var _=a.lanes|a.childLanes;if(pB(e,_),e===To&&(co=To=null,Oo=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||Z0||(Z0=!0,bL(Ox,function(){return Yp(),null})),_=(a.flags&15990)!==0,a.subtreeFlags&15990||_){_=wa.transition,wa.transition=null;var M=mi;mi=1;var D=ii;ii|=4,nC.current=null,E2(e,a),hL(a,e),QB(DS),Bx=!!AS,DS=AS=null,e.current=a,I2(a),iB(),ii=D,mi=M,wa.transition=_}else e.current=a;if(Z0&&(Z0=!1,vu=e,ev=g),_=e.pendingLanes,_===0&&(Eu=null),aB(a.stateNode),Ms(e,no()),r!==null)for(u=e.onRecoverableError,a=0;a<r.length;a++)g=r[a],u(g.value,{componentStack:g.stack,digest:g.digest});if(Qx)throw Qx=!1,e=JS,JS=null,e;return ev&1&&e.tag!==0&&Yp(),_=e.pendingLanes,_&1?e===QS?Hg++:(Hg=0,QS=e):Hg=0,Fu(),null}function Yp(){if(vu!==null){var e=JD(ev),r=wa.transition,a=mi;try{if(wa.transition=null,mi=16>e?16:e,vu===null)var u=!1;else{if(e=vu,vu=null,ev=0,ii&6)throw Error(mr(331));var g=ii;for(ii|=4,Gr=e.current;Gr!==null;){var _=Gr,M=_.child;if(Gr.flags&16){var D=_.deletions;if(D!==null){for(var i=0;i<D.length;i++){var j=D[i];for(Gr=j;Gr!==null;){var H=Gr;switch(H.tag){case 0:case 11:case 15:Wg(8,H,_)}var q=H.child;if(q!==null)q.return=H,Gr=q;else for(;Gr!==null;){H=Gr;var X=H.sibling,se=H.return;if(cL(H),H===j){Gr=null;break}if(X!==null){X.return=se,Gr=X;break}Gr=se}}}var ne=_.alternate;if(ne!==null){var le=ne.child;if(le!==null){ne.child=null;do{var de=le.sibling;le.sibling=null,le=de}while(le!==null)}}Gr=_}}if(_.subtreeFlags&2064&&M!==null)M.return=_,Gr=M;else e:for(;Gr!==null;){if(_=Gr,_.flags&2048)switch(_.tag){case 0:case 11:case 15:Wg(9,_,_.return)}var te=_.sibling;if(te!==null){te.return=_.return,Gr=te;break e}Gr=_.return}}var Q=e.current;for(Gr=Q;Gr!==null;){M=Gr;var K=M.child;if(M.subtreeFlags&2064&&K!==null)K.return=M,Gr=K;else e:for(M=Q;Gr!==null;){if(D=Gr,D.flags&2048)try{switch(D.tag){case 0:case 11:case 15:Iv(9,D)}}catch(fe){Qi(D,D.return,fe)}if(D===M){Gr=null;break e}var ce=D.sibling;if(ce!==null){ce.return=D.return,Gr=ce;break e}Gr=D.return}}if(ii=g,Fu(),zl&&typeof zl.onPostCommitFiberRoot=="function")try{zl.onPostCommitFiberRoot(vv,e)}catch{}u=!0}return u}finally{mi=a,wa.transition=r}}return!1}function IP(e,r,a){r=cf(a,r),r=JR(e,r,1),e=Mu(e,r,1),r=ds(),e!==null&&(My(e,1,r),Ms(e,r))}function Qi(e,r,a){if(e.tag===3)IP(e,e,a);else for(;r!==null;){if(r.tag===3){IP(r,e,a);break}else if(r.tag===1){var u=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Eu===null||!Eu.has(u))){e=cf(a,e),e=QR(r,e,1),r=Mu(r,e,1),e=ds(),r!==null&&(My(r,1,e),Ms(r,e));break}}r=r.return}}function L2(e,r,a){var u=e.pingCache;u!==null&&u.delete(r),r=ds(),e.pingedLanes|=e.suspendedLanes&a,To===e&&(Oo&a)===a&&(go===4||go===3&&(Oo&130023424)===Oo&&500>no()-oC?Ud(e,0):iC|=a),Ms(e,r)}function xL(e,r){r===0&&(e.mode&1?(r=B0,B0<<=1,!(B0&130023424)&&(B0=4194304)):r=1);var a=ds();e=fc(e,r),e!==null&&(My(e,r,a),Ms(e,a))}function z2(e){var r=e.memoizedState,a=0;r!==null&&(a=r.retryLane),xL(e,a)}function O2(e,r){var a=0;switch(e.tag){case 13:var u=e.stateNode,g=e.memoizedState;g!==null&&(a=g.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(mr(314))}u!==null&&u.delete(r),xL(e,a)}var vL;vL=function(e,r,a){if(e!==null)if(e.memoizedProps!==r.pendingProps||Ts.current)Ss=!0;else{if(!(e.lanes&a)&&!(r.flags&128))return Ss=!1,S2(e,r,a);Ss=!!(e.flags&131072)}else Ss=!1,Vi&&r.flags&1048576&&TR(r,Gx,r.index);switch(r.lanes=0,r.tag){case 2:var u=r.type;wx(e,r),e=r.pendingProps;var g=of(r,Jo.current);Zp(r,a),g=JT(null,r,u,e,g,a);var _=QT();return r.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Cs(u)?(_=!0,Ux(r)):_=!1,r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,qT(r),g.updater=Ev,r.stateNode=g,g._reactInternals=r,VS(r,u,e,a),r=WS(null,r,u,!0,_,a)):(r.tag=0,Vi&&_&&NT(r),cs(null,r,g,a),r=r.child),r;case 16:u=r.elementType;e:{switch(wx(e,r),e=r.pendingProps,g=u._init,u=g(u._payload),r.type=u,g=r.tag=B2(u),e=Ga(u,e),g){case 0:r=US(null,r,u,e,a);break e;case 1:r=_P(null,r,u,e,a);break e;case 11:r=gP(null,r,u,e,a);break e;case 14:r=yP(null,r,u,Ga(u.type,e),a);break e}throw Error(mr(306,u,""))}return r;case 0:return u=r.type,g=r.pendingProps,g=r.elementType===u?g:Ga(u,g),US(e,r,u,g,a);case 1:return u=r.type,g=r.pendingProps,g=r.elementType===u?g:Ga(u,g),_P(e,r,u,g,a);case 3:e:{if(nL(r),e===null)throw Error(mr(387));u=r.pendingProps,_=r.memoizedState,g=_.element,PR(e,r),Zx(r,u,null,a);var M=r.memoizedState;if(u=M.element,_.isDehydrated)if(_={element:u,isDehydrated:!1,cache:M.cache,pendingSuspenseBoundaries:M.pendingSuspenseBoundaries,transitions:M.transitions},r.updateQueue.baseState=_,r.memoizedState=_,r.flags&256){g=cf(Error(mr(423)),r),r=xP(e,r,u,a,g);break e}else if(u!==g){g=cf(Error(mr(424)),r),r=xP(e,r,u,a,g);break e}else for($s=Cu(r.stateNode.containerInfo.firstChild),Us=r,Vi=!0,qa=null,a=IR(r,null,u,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(sf(),u===g){r=mc(e,r,a);break e}cs(e,r,u,a)}r=r.child}return r;case 5:return AR(r),e===null&&BS(r),u=r.type,g=r.pendingProps,_=e!==null?e.memoizedProps:null,M=g.children,RS(u,g)?M=null:_!==null&&RS(u,_)&&(r.flags|=32),rL(e,r),cs(e,r,M,a),r.child;case 6:return e===null&&BS(r),null;case 13:return iL(e,r,a);case 4:return ZT(r,r.stateNode.containerInfo),u=r.pendingProps,e===null?r.child=af(r,null,u,a):cs(e,r,u,a),r.child;case 11:return u=r.type,g=r.pendingProps,g=r.elementType===u?g:Ga(u,g),gP(e,r,u,g,a);case 7:return cs(e,r,r.pendingProps,a),r.child;case 8:return cs(e,r,r.pendingProps.children,a),r.child;case 12:return cs(e,r,r.pendingProps.children,a),r.child;case 10:e:{if(u=r.type._context,g=r.pendingProps,_=r.memoizedProps,M=g.value,Di(Hx,u._currentValue),u._currentValue=M,_!==null)if(Qa(_.value,M)){if(_.children===g.children&&!Ts.current){r=mc(e,r,a);break e}}else for(_=r.child,_!==null&&(_.return=r);_!==null;){var D=_.dependencies;if(D!==null){M=_.child;for(var i=D.firstContext;i!==null;){if(i.context===u){if(_.tag===1){i=cc(-1,a&-a),i.tag=2;var j=_.updateQueue;if(j!==null){j=j.shared;var H=j.pending;H===null?i.next=i:(i.next=H.next,H.next=i),j.pending=i}}_.lanes|=a,i=_.alternate,i!==null&&(i.lanes|=a),jS(_.return,a,r),D.lanes|=a;break}i=i.next}}else if(_.tag===10)M=_.type===r.type?null:_.child;else if(_.tag===18){if(M=_.return,M===null)throw Error(mr(341));M.lanes|=a,D=M.alternate,D!==null&&(D.lanes|=a),jS(M,a,r),M=_.sibling}else M=_.child;if(M!==null)M.return=_;else for(M=_;M!==null;){if(M===r){M=null;break}if(_=M.sibling,_!==null){_.return=M.return,M=_;break}M=M.return}_=M}cs(e,r,g.children,a),r=r.child}return r;case 9:return g=r.type,u=r.pendingProps.children,Zp(r,a),g=Sa(g),u=u(g),r.flags|=1,cs(e,r,u,a),r.child;case 14:return u=r.type,g=Ga(u,r.pendingProps),g=Ga(u.type,g),yP(e,r,u,g,a);case 15:return eL(e,r,r.type,r.pendingProps,a);case 17:return u=r.type,g=r.pendingProps,g=r.elementType===u?g:Ga(u,g),wx(e,r),r.tag=1,Cs(u)?(e=!0,Ux(r)):e=!1,Zp(r,a),KR(r,u,g),VS(r,u,g,a),WS(null,r,u,!0,e,a);case 19:return oL(e,r,a);case 22:return tL(e,r,a)}throw Error(mr(156,r.tag))};function bL(e,r){return ZD(e,r)}function F2(e,r,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xa(e,r,a,u){return new F2(e,r,a,u)}function cC(e){return e=e.prototype,!(!e||!e.isReactComponent)}function B2(e){if(typeof e=="function")return cC(e)?1:0;if(e!=null){if(e=e.$$typeof,e===IT)return 11;if(e===kT)return 14}return 2}function ku(e,r){var a=e.alternate;return a===null?(a=xa(e.tag,r,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=r,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,r=e.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Cx(e,r,a,u,g,_){var M=2;if(u=e,typeof e=="function")cC(e)&&(M=1);else if(typeof e=="string")M=5;else e:switch(e){case Ip:return Wd(a.children,g,_,r);case ET:M=8,g|=8;break;case dS:return e=xa(12,a,r,g|2),e.elementType=dS,e.lanes=_,e;case hS:return e=xa(13,a,r,g),e.elementType=hS,e.lanes=_,e;case pS:return e=xa(19,a,r,g),e.elementType=pS,e.lanes=_,e;case AD:return Pv(a,g,_,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case kD:M=10;break e;case PD:M=9;break e;case IT:M=11;break e;case kT:M=14;break e;case mu:M=16,u=null;break e}throw Error(mr(130,e==null?e:typeof e,""))}return r=xa(M,a,r,g),r.elementType=e,r.type=u,r.lanes=_,r}function Wd(e,r,a,u){return e=xa(7,e,u,r),e.lanes=a,e}function Pv(e,r,a,u){return e=xa(22,e,u,r),e.elementType=AD,e.lanes=a,e.stateNode={isHidden:!1},e}function Ww(e,r,a){return e=xa(6,e,null,r),e.lanes=a,e}function Gw(e,r,a){return r=xa(4,e.children!==null?e.children:[],e.key,r),r.lanes=a,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function j2(e,r,a,u,g){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cw(0),this.expirationTimes=Cw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cw(0),this.identifierPrefix=u,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function uC(e,r,a,u,g,_,M,D,i){return e=new j2(e,r,a,D,i),r===1?(r=1,_===!0&&(r|=8)):r=0,_=xa(3,null,null,r),e.current=_,_.stateNode=e,_.memoizedState={element:u,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},qT(_),e}function N2(e,r,a){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ep,key:u==null?null:""+u,children:e,containerInfo:r,implementation:a}}function wL(e){if(!e)return Au;e=e._reactInternals;e:{if(eh(e)!==e||e.tag!==1)throw Error(mr(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Cs(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(mr(171))}if(e.tag===1){var a=e.type;if(Cs(a))return wR(e,a,r)}return r}function SL(e,r,a,u,g,_,M,D,i){return e=uC(a,u,!0,e,g,_,M,D,i),e.context=wL(null),a=e.current,u=ds(),g=Iu(a),_=cc(u,g),_.callback=r??null,Mu(a,_,g),e.current.lanes=g,My(e,g,u),Ms(e,u),e}function Av(e,r,a,u){var g=r.current,_=ds(),M=Iu(g);return a=wL(a),r.context===null?r.context=a:r.pendingContext=a,r=cc(_,M),r.payload={element:e},u=u===void 0?null:u,u!==null&&(r.callback=u),e=Mu(g,r,M),e!==null&&(Xa(e,g,M,_),xx(e,g,M)),M}function rv(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function kP(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<r?a:r}}function dC(e,r){kP(e,r),(e=e.alternate)&&kP(e,r)}function V2(){return null}var TL=typeof reportError=="function"?reportError:function(e){console.error(e)};function hC(e){this._internalRoot=e}Dv.prototype.render=hC.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(mr(409));Av(e,r,null,null)};Dv.prototype.unmount=hC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Yd(function(){Av(null,e,null,null)}),r[pc]=null}};function Dv(e){this._internalRoot=e}Dv.prototype.unstable_scheduleHydration=function(e){if(e){var r=tR();e={blockedOn:null,target:e,priority:r};for(var a=0;a<yu.length&&r!==0&&r<yu[a].priority;a++);yu.splice(a,0,e),a===0&&nR(e)}};function pC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function PP(){}function $2(e,r,a,u,g){if(g){if(typeof u=="function"){var _=u;u=function(){var j=rv(M);_.call(j)}}var M=SL(r,u,e,0,null,!1,!1,"",PP);return e._reactRootContainer=M,e[pc]=M.current,ly(e.nodeType===8?e.parentNode:e),Yd(),M}for(;g=e.lastChild;)e.removeChild(g);if(typeof u=="function"){var D=u;u=function(){var j=rv(i);D.call(j)}}var i=uC(e,0,!1,null,null,!1,!1,"",PP);return e._reactRootContainer=i,e[pc]=i.current,ly(e.nodeType===8?e.parentNode:e),Yd(function(){Av(r,i,a,u)}),i}function Lv(e,r,a,u,g){var _=a._reactRootContainer;if(_){var M=_;if(typeof g=="function"){var D=g;g=function(){var i=rv(M);D.call(i)}}Av(r,M,e,g)}else M=$2(a,r,e,g,u);return rv(M)}QD=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var a=Dg(r.pendingLanes);a!==0&&(DT(r,a|1),Ms(r,no()),!(ii&6)&&(uf=no()+500,Fu()))}break;case 13:Yd(function(){var u=fc(e,1);if(u!==null){var g=ds();Xa(u,e,1,g)}}),dC(e,1)}};RT=function(e){if(e.tag===13){var r=fc(e,134217728);if(r!==null){var a=ds();Xa(r,e,134217728,a)}dC(e,134217728)}};eR=function(e){if(e.tag===13){var r=Iu(e),a=fc(e,r);if(a!==null){var u=ds();Xa(a,e,r,u)}dC(e,r)}};tR=function(){return mi};rR=function(e,r){var a=mi;try{return mi=e,r()}finally{mi=a}};SS=function(e,r,a){switch(r){case"input":if(gS(e,a),r=a.name,a.type==="radio"&&r!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<a.length;r++){var u=a[r];if(u!==e&&u.form===e.form){var g=Tv(u);if(!g)throw Error(mr(90));RD(u),gS(u,g)}}}break;case"textarea":zD(e,a);break;case"select":r=a.value,r!=null&&Wp(e,!!a.multiple,r,!1)}};$D=sC;UD=Yd;var U2={usingClientEntryPoint:!1,Events:[Iy,Dp,Tv,ND,VD,sC]},gg={findFiberByHostInstance:Fd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},W2={bundleType:gg.bundleType,version:gg.version,rendererPackageName:gg.rendererPackageName,rendererConfig:gg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_c.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=HD(e),e===null?null:e.stateNode},findFiberByHostInstance:gg.findFiberByHostInstance||V2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Y0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Y0.isDisabled&&Y0.supportsFiber)try{vv=Y0.inject(W2),zl=Y0}catch{}}Zs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U2;Zs.createPortal=function(e,r){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pC(r))throw Error(mr(200));return N2(e,r,null,a)};Zs.createRoot=function(e,r){if(!pC(e))throw Error(mr(299));var a=!1,u="",g=TL;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(u=r.identifierPrefix),r.onRecoverableError!==void 0&&(g=r.onRecoverableError)),r=uC(e,1,!1,null,null,a,!1,u,g),e[pc]=r.current,ly(e.nodeType===8?e.parentNode:e),new hC(r)};Zs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(mr(188)):(e=Object.keys(e).join(","),Error(mr(268,e)));return e=HD(r),e=e===null?null:e.stateNode,e};Zs.flushSync=function(e){return Yd(e)};Zs.hydrate=function(e,r,a){if(!Rv(r))throw Error(mr(200));return Lv(null,e,r,!0,a)};Zs.hydrateRoot=function(e,r,a){if(!pC(e))throw Error(mr(405));var u=a!=null&&a.hydratedSources||null,g=!1,_="",M=TL;if(a!=null&&(a.unstable_strictMode===!0&&(g=!0),a.identifierPrefix!==void 0&&(_=a.identifierPrefix),a.onRecoverableError!==void 0&&(M=a.onRecoverableError)),r=SL(r,null,e,1,a??null,g,!1,_,M),e[pc]=r.current,ly(e),u)for(e=0;e<u.length;e++)a=u[e],g=a._getVersion,g=g(a._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[a,g]:r.mutableSourceEagerHydrationData.push(a,g);return new Dv(r)};Zs.render=function(e,r,a){if(!Rv(r))throw Error(mr(200));return Lv(null,e,r,!1,a)};Zs.unmountComponentAtNode=function(e){if(!Rv(e))throw Error(mr(40));return e._reactRootContainer?(Yd(function(){Lv(null,null,e,!1,function(){e._reactRootContainer=null,e[pc]=null})}),!0):!1};Zs.unstable_batchedUpdates=sC;Zs.unstable_renderSubtreeIntoContainer=function(e,r,a,u){if(!Rv(a))throw Error(mr(200));if(e==null||e._reactInternals===void 0)throw Error(mr(38));return Lv(e,r,a,!1,u)};Zs.version="18.3.1-next-f1338f8080-20240426";function CL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CL)}catch(e){console.error(e)}}CL(),CD.exports=Zs;var fC=CD.exports;const X0=Bl(fC);var ML,AP=fC;ML=AP.createRoot,AP.hydrateRoot;function gc(e,...r){const a=new URL(`https://mui.com/production-error/?code=${e}`);return r.forEach(u=>a.searchParams.append("args[]",u)),`Minified MUI error #${e}; visit ${a} for the full message.`}const Ka="$$material";function vt(){return vt=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var u in a)({}).hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},vt.apply(null,arguments)}function EL(e){var r=Object.create(null);return function(a){return r[a]===void 0&&(r[a]=e(a)),r[a]}}var G2=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,H2=EL(function(e){return G2.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),q2=!1;function Z2(e){if(e.sheet)return e.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===e)return document.styleSheets[r]}function Y2(e){var r=document.createElement("style");return r.setAttribute("data-emotion",e.key),e.nonce!==void 0&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var X2=function(){function e(a){var u=this;this._insertTag=function(g){var _;u.tags.length===0?u.insertionPoint?_=u.insertionPoint.nextSibling:u.prepend?_=u.container.firstChild:_=u.before:_=u.tags[u.tags.length-1].nextSibling,u.container.insertBefore(g,_),u.tags.push(g)},this.isSpeedy=a.speedy===void 0?!q2:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var r=e.prototype;return r.hydrate=function(u){u.forEach(this._insertTag)},r.insert=function(u){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Y2(this));var g=this.tags[this.tags.length-1];if(this.isSpeedy){var _=Z2(g);try{_.insertRule(u,_.cssRules.length)}catch{}}else g.appendChild(document.createTextNode(u));this.ctr++},r.flush=function(){this.tags.forEach(function(u){var g;return(g=u.parentNode)==null?void 0:g.removeChild(u)}),this.tags=[],this.ctr=0},e}(),Yo="-ms-",nv="-moz-",di="-webkit-",IL="comm",mC="rule",gC="decl",K2="@import",kL="@keyframes",J2="@layer",Q2=Math.abs,zv=String.fromCharCode,ej=Object.assign;function tj(e,r){return zo(e,0)^45?(((r<<2^zo(e,0))<<2^zo(e,1))<<2^zo(e,2))<<2^zo(e,3):0}function PL(e){return e.trim()}function rj(e,r){return(e=r.exec(e))?e[0]:e}function hi(e,r,a){return e.replace(r,a)}function rT(e,r){return e.indexOf(r)}function zo(e,r){return e.charCodeAt(r)|0}function yy(e,r,a){return e.slice(r,a)}function kl(e){return e.length}function yC(e){return e.length}function K0(e,r){return r.push(e),e}function nj(e,r){return e.map(r).join("")}var Ov=1,df=1,AL=0,Es=0,lo=0,xf="";function Fv(e,r,a,u,g,_,M){return{value:e,root:r,parent:a,type:u,props:g,children:_,line:Ov,column:df,length:M,return:""}}function yg(e,r){return ej(Fv("",null,null,"",null,null,0),e,{length:-e.length},r)}function ij(){return lo}function oj(){return lo=Es>0?zo(xf,--Es):0,df--,lo===10&&(df=1,Ov--),lo}function Ws(){return lo=Es<AL?zo(xf,Es++):0,df++,lo===10&&(df=1,Ov++),lo}function Fl(){return zo(xf,Es)}function Mx(){return Es}function Py(e,r){return yy(xf,e,r)}function _y(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function DL(e){return Ov=df=1,AL=kl(xf=e),Es=0,[]}function RL(e){return xf="",e}function Ex(e){return PL(Py(Es-1,nT(e===91?e+2:e===40?e+1:e)))}function sj(e){for(;(lo=Fl())&&lo<33;)Ws();return _y(e)>2||_y(lo)>3?"":" "}function aj(e,r){for(;--r&&Ws()&&!(lo<48||lo>102||lo>57&&lo<65||lo>70&&lo<97););return Py(e,Mx()+(r<6&&Fl()==32&&Ws()==32))}function nT(e){for(;Ws();)switch(lo){case e:return Es;case 34:case 39:e!==34&&e!==39&&nT(lo);break;case 40:e===41&&nT(e);break;case 92:Ws();break}return Es}function lj(e,r){for(;Ws()&&e+lo!==57;)if(e+lo===84&&Fl()===47)break;return"/*"+Py(r,Es-1)+"*"+zv(e===47?e:Ws())}function cj(e){for(;!_y(Fl());)Ws();return Py(e,Es)}function uj(e){return RL(Ix("",null,null,null,[""],e=DL(e),0,[0],e))}function Ix(e,r,a,u,g,_,M,D,i){for(var j=0,H=0,q=M,X=0,se=0,ne=0,le=1,de=1,te=1,Q=0,K="",ce=g,fe=_,Ie=u,Ce=K;de;)switch(ne=Q,Q=Ws()){case 40:if(ne!=108&&zo(Ce,q-1)==58){rT(Ce+=hi(Ex(Q),"&","&\f"),"&\f")!=-1&&(te=-1);break}case 34:case 39:case 91:Ce+=Ex(Q);break;case 9:case 10:case 13:case 32:Ce+=sj(ne);break;case 92:Ce+=aj(Mx()-1,7);continue;case 47:switch(Fl()){case 42:case 47:K0(dj(lj(Ws(),Mx()),r,a),i);break;default:Ce+="/"}break;case 123*le:D[j++]=kl(Ce)*te;case 125*le:case 59:case 0:switch(Q){case 0:case 125:de=0;case 59+H:te==-1&&(Ce=hi(Ce,/\f/g,"")),se>0&&kl(Ce)-q&&K0(se>32?RP(Ce+";",u,a,q-1):RP(hi(Ce," ","")+";",u,a,q-2),i);break;case 59:Ce+=";";default:if(K0(Ie=DP(Ce,r,a,j,H,g,D,K,ce=[],fe=[],q),_),Q===123)if(H===0)Ix(Ce,r,Ie,Ie,ce,_,q,D,fe);else switch(X===99&&zo(Ce,3)===110?100:X){case 100:case 108:case 109:case 115:Ix(e,Ie,Ie,u&&K0(DP(e,Ie,Ie,0,0,g,D,K,g,ce=[],q),fe),g,fe,q,D,u?ce:fe);break;default:Ix(Ce,Ie,Ie,Ie,[""],fe,0,D,fe)}}j=H=se=0,le=te=1,K=Ce="",q=M;break;case 58:q=1+kl(Ce),se=ne;default:if(le<1){if(Q==123)--le;else if(Q==125&&le++==0&&oj()==125)continue}switch(Ce+=zv(Q),Q*le){case 38:te=H>0?1:(Ce+="\f",-1);break;case 44:D[j++]=(kl(Ce)-1)*te,te=1;break;case 64:Fl()===45&&(Ce+=Ex(Ws())),X=Fl(),H=q=kl(K=Ce+=cj(Mx())),Q++;break;case 45:ne===45&&kl(Ce)==2&&(le=0)}}return _}function DP(e,r,a,u,g,_,M,D,i,j,H){for(var q=g-1,X=g===0?_:[""],se=yC(X),ne=0,le=0,de=0;ne<u;++ne)for(var te=0,Q=yy(e,q+1,q=Q2(le=M[ne])),K=e;te<se;++te)(K=PL(le>0?X[te]+" "+Q:hi(Q,/&\f/g,X[te])))&&(i[de++]=K);return Fv(e,r,a,g===0?mC:D,i,j,H)}function dj(e,r,a){return Fv(e,r,a,IL,zv(ij()),yy(e,2,-2),0)}function RP(e,r,a,u){return Fv(e,r,a,gC,yy(e,0,u),yy(e,u+1,-1),u)}function Xp(e,r){for(var a="",u=yC(e),g=0;g<u;g++)a+=r(e[g],g,e,r)||"";return a}function hj(e,r,a,u){switch(e.type){case J2:if(e.children.length)break;case K2:case gC:return e.return=e.return||e.value;case IL:return"";case kL:return e.return=e.value+"{"+Xp(e.children,u)+"}";case mC:e.value=e.props.join(",")}return kl(a=Xp(e.children,u))?e.return=e.value+"{"+a+"}":""}function pj(e){var r=yC(e);return function(a,u,g,_){for(var M="",D=0;D<r;D++)M+=e[D](a,u,g,_)||"";return M}}function fj(e){return function(r){r.root||(r=r.return)&&e(r)}}var mj=function(r,a,u){for(var g=0,_=0;g=_,_=Fl(),g===38&&_===12&&(a[u]=1),!_y(_);)Ws();return Py(r,Es)},gj=function(r,a){var u=-1,g=44;do switch(_y(g)){case 0:g===38&&Fl()===12&&(a[u]=1),r[u]+=mj(Es-1,a,u);break;case 2:r[u]+=Ex(g);break;case 4:if(g===44){r[++u]=Fl()===58?"&\f":"",a[u]=r[u].length;break}default:r[u]+=zv(g)}while(g=Ws());return r},yj=function(r,a){return RL(gj(DL(r),a))},LP=new WeakMap,_j=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var a=r.value,u=r.parent,g=r.column===u.column&&r.line===u.line;u.type!=="rule";)if(u=u.parent,!u)return;if(!(r.props.length===1&&a.charCodeAt(0)!==58&&!LP.get(u))&&!g){LP.set(r,!0);for(var _=[],M=yj(a,_),D=u.props,i=0,j=0;i<M.length;i++)for(var H=0;H<D.length;H++,j++)r.props[j]=_[i]?M[i].replace(/&\f/g,D[H]):D[H]+" "+M[i]}}},xj=function(r){if(r.type==="decl"){var a=r.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(r.return="",r.value="")}};function LL(e,r){switch(tj(e,r)){case 5103:return di+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return di+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return di+e+nv+e+Yo+e+e;case 6828:case 4268:return di+e+Yo+e+e;case 6165:return di+e+Yo+"flex-"+e+e;case 5187:return di+e+hi(e,/(\w+).+(:[^]+)/,di+"box-$1$2"+Yo+"flex-$1$2")+e;case 5443:return di+e+Yo+"flex-item-"+hi(e,/flex-|-self/,"")+e;case 4675:return di+e+Yo+"flex-line-pack"+hi(e,/align-content|flex-|-self/,"")+e;case 5548:return di+e+Yo+hi(e,"shrink","negative")+e;case 5292:return di+e+Yo+hi(e,"basis","preferred-size")+e;case 6060:return di+"box-"+hi(e,"-grow","")+di+e+Yo+hi(e,"grow","positive")+e;case 4554:return di+hi(e,/([^-])(transform)/g,"$1"+di+"$2")+e;case 6187:return hi(hi(hi(e,/(zoom-|grab)/,di+"$1"),/(image-set)/,di+"$1"),e,"")+e;case 5495:case 3959:return hi(e,/(image-set\([^]*)/,di+"$1$`$1");case 4968:return hi(hi(e,/(.+:)(flex-)?(.*)/,di+"box-pack:$3"+Yo+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+di+e+e;case 4095:case 3583:case 4068:case 2532:return hi(e,/(.+)-inline(.+)/,di+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(kl(e)-1-r>6)switch(zo(e,r+1)){case 109:if(zo(e,r+4)!==45)break;case 102:return hi(e,/(.+:)(.+)-([^]+)/,"$1"+di+"$2-$3$1"+nv+(zo(e,r+3)==108?"$3":"$2-$3"))+e;case 115:return~rT(e,"stretch")?LL(hi(e,"stretch","fill-available"),r)+e:e}break;case 4949:if(zo(e,r+1)!==115)break;case 6444:switch(zo(e,kl(e)-3-(~rT(e,"!important")&&10))){case 107:return hi(e,":",":"+di)+e;case 101:return hi(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+di+(zo(e,14)===45?"inline-":"")+"box$3$1"+di+"$2$3$1"+Yo+"$2box$3")+e}break;case 5936:switch(zo(e,r+11)){case 114:return di+e+Yo+hi(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return di+e+Yo+hi(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return di+e+Yo+hi(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return di+e+Yo+e+e}return e}var vj=function(r,a,u,g){if(r.length>-1&&!r.return)switch(r.type){case gC:r.return=LL(r.value,r.length);break;case kL:return Xp([yg(r,{value:hi(r.value,"@","@"+di)})],g);case mC:if(r.length)return nj(r.props,function(_){switch(rj(_,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Xp([yg(r,{props:[hi(_,/:(read-\w+)/,":"+nv+"$1")]})],g);case"::placeholder":return Xp([yg(r,{props:[hi(_,/:(plac\w+)/,":"+di+"input-$1")]}),yg(r,{props:[hi(_,/:(plac\w+)/,":"+nv+"$1")]}),yg(r,{props:[hi(_,/:(plac\w+)/,Yo+"input-$1")]})],g)}return""})}},bj=[vj],wj=function(r){var a=r.key;if(a==="css"){var u=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(u,function(le){var de=le.getAttribute("data-emotion");de.indexOf(" ")!==-1&&(document.head.appendChild(le),le.setAttribute("data-s",""))})}var g=r.stylisPlugins||bj,_={},M,D=[];M=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(le){for(var de=le.getAttribute("data-emotion").split(" "),te=1;te<de.length;te++)_[de[te]]=!0;D.push(le)});var i,j=[_j,xj];{var H,q=[hj,fj(function(le){H.insert(le)})],X=pj(j.concat(g,q)),se=function(de){return Xp(uj(de),X)};i=function(de,te,Q,K){H=Q,se(de?de+"{"+te.styles+"}":te.styles),K&&(ne.inserted[te.name]=!0)}}var ne={key:a,sheet:new X2({key:a,container:M,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:_,registered:{},insert:i};return ne.sheet.hydrate(D),ne},zL={exports:{}},gi={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mo=typeof Symbol=="function"&&Symbol.for,_C=Mo?Symbol.for("react.element"):60103,xC=Mo?Symbol.for("react.portal"):60106,Bv=Mo?Symbol.for("react.fragment"):60107,jv=Mo?Symbol.for("react.strict_mode"):60108,Nv=Mo?Symbol.for("react.profiler"):60114,Vv=Mo?Symbol.for("react.provider"):60109,$v=Mo?Symbol.for("react.context"):60110,vC=Mo?Symbol.for("react.async_mode"):60111,Uv=Mo?Symbol.for("react.concurrent_mode"):60111,Wv=Mo?Symbol.for("react.forward_ref"):60112,Gv=Mo?Symbol.for("react.suspense"):60113,Sj=Mo?Symbol.for("react.suspense_list"):60120,Hv=Mo?Symbol.for("react.memo"):60115,qv=Mo?Symbol.for("react.lazy"):60116,Tj=Mo?Symbol.for("react.block"):60121,Cj=Mo?Symbol.for("react.fundamental"):60117,Mj=Mo?Symbol.for("react.responder"):60118,Ej=Mo?Symbol.for("react.scope"):60119;function Xs(e){if(typeof e=="object"&&e!==null){var r=e.$$typeof;switch(r){case _C:switch(e=e.type,e){case vC:case Uv:case Bv:case Nv:case jv:case Gv:return e;default:switch(e=e&&e.$$typeof,e){case $v:case Wv:case qv:case Hv:case Vv:return e;default:return r}}case xC:return r}}}function OL(e){return Xs(e)===Uv}gi.AsyncMode=vC;gi.ConcurrentMode=Uv;gi.ContextConsumer=$v;gi.ContextProvider=Vv;gi.Element=_C;gi.ForwardRef=Wv;gi.Fragment=Bv;gi.Lazy=qv;gi.Memo=Hv;gi.Portal=xC;gi.Profiler=Nv;gi.StrictMode=jv;gi.Suspense=Gv;gi.isAsyncMode=function(e){return OL(e)||Xs(e)===vC};gi.isConcurrentMode=OL;gi.isContextConsumer=function(e){return Xs(e)===$v};gi.isContextProvider=function(e){return Xs(e)===Vv};gi.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===_C};gi.isForwardRef=function(e){return Xs(e)===Wv};gi.isFragment=function(e){return Xs(e)===Bv};gi.isLazy=function(e){return Xs(e)===qv};gi.isMemo=function(e){return Xs(e)===Hv};gi.isPortal=function(e){return Xs(e)===xC};gi.isProfiler=function(e){return Xs(e)===Nv};gi.isStrictMode=function(e){return Xs(e)===jv};gi.isSuspense=function(e){return Xs(e)===Gv};gi.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Bv||e===Uv||e===Nv||e===jv||e===Gv||e===Sj||typeof e=="object"&&e!==null&&(e.$$typeof===qv||e.$$typeof===Hv||e.$$typeof===Vv||e.$$typeof===$v||e.$$typeof===Wv||e.$$typeof===Cj||e.$$typeof===Mj||e.$$typeof===Ej||e.$$typeof===Tj)};gi.typeOf=Xs;zL.exports=gi;var Ij=zL.exports,FL=Ij,kj={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Pj={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},BL={};BL[FL.ForwardRef]=kj;BL[FL.Memo]=Pj;var Aj=!0;function Dj(e,r,a){var u="";return a.split(" ").forEach(function(g){e[g]!==void 0?r.push(e[g]+";"):g&&(u+=g+" ")}),u}var jL=function(r,a,u){var g=r.key+"-"+a.name;(u===!1||Aj===!1)&&r.registered[g]===void 0&&(r.registered[g]=a.styles)},NL=function(r,a,u){jL(r,a,u);var g=r.key+"-"+a.name;if(r.inserted[a.name]===void 0){var _=a;do r.insert(a===_?"."+g:"",_,r.sheet,!0),_=_.next;while(_!==void 0)}};function Rj(e){for(var r=0,a,u=0,g=e.length;g>=4;++u,g-=4)a=e.charCodeAt(u)&255|(e.charCodeAt(++u)&255)<<8|(e.charCodeAt(++u)&255)<<16|(e.charCodeAt(++u)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,r=(a&65535)*1540483477+((a>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(g){case 3:r^=(e.charCodeAt(u+2)&255)<<16;case 2:r^=(e.charCodeAt(u+1)&255)<<8;case 1:r^=e.charCodeAt(u)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var Lj={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},zj=!1,Oj=/[A-Z]|^ms/g,Fj=/_EMO_([^_]+?)_([^]*?)_EMO_/g,VL=function(r){return r.charCodeAt(1)===45},zP=function(r){return r!=null&&typeof r!="boolean"},Hw=EL(function(e){return VL(e)?e:e.replace(Oj,"-$&").toLowerCase()}),OP=function(r,a){switch(r){case"animation":case"animationName":if(typeof a=="string")return a.replace(Fj,function(u,g,_){return Pl={name:g,styles:_,next:Pl},g})}return Lj[r]!==1&&!VL(r)&&typeof a=="number"&&a!==0?a+"px":a},Bj="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function xy(e,r,a){if(a==null)return"";var u=a;if(u.__emotion_styles!==void 0)return u;switch(typeof a){case"boolean":return"";case"object":{var g=a;if(g.anim===1)return Pl={name:g.name,styles:g.styles,next:Pl},g.name;var _=a;if(_.styles!==void 0){var M=_.next;if(M!==void 0)for(;M!==void 0;)Pl={name:M.name,styles:M.styles,next:Pl},M=M.next;var D=_.styles+";";return D}return jj(e,r,a)}case"function":{if(e!==void 0){var i=Pl,j=a(e);return Pl=i,xy(e,r,j)}break}}var H=a;if(r==null)return H;var q=r[H];return q!==void 0?q:H}function jj(e,r,a){var u="";if(Array.isArray(a))for(var g=0;g<a.length;g++)u+=xy(e,r,a[g])+";";else for(var _ in a){var M=a[_];if(typeof M!="object"){var D=M;r!=null&&r[D]!==void 0?u+=_+"{"+r[D]+"}":zP(D)&&(u+=Hw(_)+":"+OP(_,D)+";")}else{if(_==="NO_COMPONENT_SELECTOR"&&zj)throw new Error(Bj);if(Array.isArray(M)&&typeof M[0]=="string"&&(r==null||r[M[0]]===void 0))for(var i=0;i<M.length;i++)zP(M[i])&&(u+=Hw(_)+":"+OP(_,M[i])+";");else{var j=xy(e,r,M);switch(_){case"animation":case"animationName":{u+=Hw(_)+":"+j+";";break}default:u+=_+"{"+j+"}"}}}}return u}var FP=/label:\s*([^\s;{]+)\s*(;|$)/g,Pl;function Zv(e,r,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var u=!0,g="";Pl=void 0;var _=e[0];if(_==null||_.raw===void 0)u=!1,g+=xy(a,r,_);else{var M=_;g+=M[0]}for(var D=1;D<e.length;D++)if(g+=xy(a,r,e[D]),u){var i=_;g+=i[D]}FP.lastIndex=0;for(var j="",H;(H=FP.exec(g))!==null;)j+="-"+H[1];var q=Rj(g)+j;return{name:q,styles:g,next:Pl}}var Nj=function(r){return r()},$L=Dx.useInsertionEffect?Dx.useInsertionEffect:!1,Vj=$L||Nj,BP=$L||Y.useLayoutEffect,UL=Y.createContext(typeof HTMLElement<"u"?wj({key:"css"}):null);UL.Provider;var WL=function(r){return Y.forwardRef(function(a,u){var g=Y.useContext(UL);return r(a,g,u)})},Yv=Y.createContext({}),$j=WL(function(e,r){var a=e.styles,u=Zv([a],void 0,Y.useContext(Yv)),g=Y.useRef();return BP(function(){var _=r.key+"-global",M=new r.sheet.constructor({key:_,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),D=!1,i=document.querySelector('style[data-emotion="'+_+" "+u.name+'"]');return r.sheet.tags.length&&(M.before=r.sheet.tags[0]),i!==null&&(D=!0,i.setAttribute("data-emotion",_),M.hydrate([i])),g.current=[M,D],function(){M.flush()}},[r]),BP(function(){var _=g.current,M=_[0],D=_[1];if(D){_[1]=!1;return}if(u.next!==void 0&&NL(r,u.next,!0),M.tags.length){var i=M.tags[M.tags.length-1].nextElementSibling;M.before=i,M.flush()}r.insert("",u,M,!1)},[r,u.name]),null});function Uj(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return Zv(r)}var bC=function(){var r=Uj.apply(void 0,arguments),a="animation-"+r.name;return{name:a,styles:"@keyframes "+a+"{"+r.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Wj=H2,Gj=function(r){return r!=="theme"},jP=function(r){return typeof r=="string"&&r.charCodeAt(0)>96?Wj:Gj},NP=function(r,a,u){var g;if(a){var _=a.shouldForwardProp;g=r.__emotion_forwardProp&&_?function(M){return r.__emotion_forwardProp(M)&&_(M)}:_}return typeof g!="function"&&u&&(g=r.__emotion_forwardProp),g},Hj=!1,qj=function(r){var a=r.cache,u=r.serialized,g=r.isStringTag;return jL(a,u,g),Vj(function(){return NL(a,u,g)}),null},Zj=function e(r,a){var u=r.__emotion_real===r,g=u&&r.__emotion_base||r,_,M;a!==void 0&&(_=a.label,M=a.target);var D=NP(r,a,u),i=D||jP(g),j=!i("as");return function(){var H=arguments,q=u&&r.__emotion_styles!==void 0?r.__emotion_styles.slice(0):[];if(_!==void 0&&q.push("label:"+_+";"),H[0]==null||H[0].raw===void 0)q.push.apply(q,H);else{q.push(H[0][0]);for(var X=H.length,se=1;se<X;se++)q.push(H[se],H[0][se])}var ne=WL(function(le,de,te){var Q=j&&le.as||g,K="",ce=[],fe=le;if(le.theme==null){fe={};for(var Ie in le)fe[Ie]=le[Ie];fe.theme=Y.useContext(Yv)}typeof le.className=="string"?K=Dj(de.registered,ce,le.className):le.className!=null&&(K=le.className+" ");var Ce=Zv(q.concat(ce),de.registered,fe);K+=de.key+"-"+Ce.name,M!==void 0&&(K+=" "+M);var we=j&&D===void 0?jP(Q):i,ot={};for(var oe in le)j&&oe==="as"||we(oe)&&(ot[oe]=le[oe]);return ot.className=K,te&&(ot.ref=te),Y.createElement(Y.Fragment,null,Y.createElement(qj,{cache:de,serialized:Ce,isStringTag:typeof Q=="string"}),Y.createElement(Q,ot))});return ne.displayName=_!==void 0?_:"Styled("+(typeof g=="string"?g:g.displayName||g.name||"Component")+")",ne.defaultProps=r.defaultProps,ne.__emotion_real=ne,ne.__emotion_base=g,ne.__emotion_styles=q,ne.__emotion_forwardProp=D,Object.defineProperty(ne,"toString",{value:function(){return M===void 0&&Hj?"NO_COMPONENT_SELECTOR":"."+M}}),ne.withComponent=function(le,de){return e(le,vt({},a,de,{shouldForwardProp:NP(ne,de,!0)})).apply(void 0,q)},ne}},Yj=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],iT=Zj.bind();Yj.forEach(function(e){iT[e]=iT(e)});var GL={exports:{}},Xj="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Kj=Xj,Jj=Kj;function HL(){}function qL(){}qL.resetWarningCache=HL;var Qj=function(){function e(u,g,_,M,D,i){if(i!==Jj){var j=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw j.name="Invariant Violation",j}}e.isRequired=e;function r(){return e}var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:qL,resetWarningCache:HL};return a.PropTypes=a,a};GL.exports=Qj();var eN=GL.exports;const Cr=Bl(eN);function tN(e){return e==null||Object.keys(e).length===0}function ZL(e){const{styles:r,defaultTheme:a={}}=e,u=typeof r=="function"?g=>r(tN(g)?a:g):r;return L.jsx($j,{styles:u})}/**
 * @mui/styled-engine v6.1.4
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function YL(e,r){return iT(e,r)}function rN(e,r){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=r(e.__emotion_styles))}const VP=[];function $P(e){return VP[0]=e,Zv(VP)}function Rl(e){if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function XL(e){if(!Rl(e))return e;const r={};return Object.keys(e).forEach(a=>{r[a]=XL(e[a])}),r}function Co(e,r,a={clone:!0}){const u=a.clone?{...e}:e;return Rl(e)&&Rl(r)&&Object.keys(r).forEach(g=>{Rl(r[g])&&Object.prototype.hasOwnProperty.call(e,g)&&Rl(e[g])?u[g]=Co(e[g],r[g],a):a.clone?u[g]=Rl(r[g])?XL(r[g]):r[g]:u[g]=r[g]}),u}const nN=e=>{const r=Object.keys(e).map(a=>({key:a,val:e[a]}))||[];return r.sort((a,u)=>a.val-u.val),r.reduce((a,u)=>({...a,[u.key]:u.val}),{})};function iN(e){const{values:r={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:u=5,...g}=e,_=nN(r),M=Object.keys(_);function D(X){return`@media (min-width:${typeof r[X]=="number"?r[X]:X}${a})`}function i(X){return`@media (max-width:${(typeof r[X]=="number"?r[X]:X)-u/100}${a})`}function j(X,se){const ne=M.indexOf(se);return`@media (min-width:${typeof r[X]=="number"?r[X]:X}${a}) and (max-width:${(ne!==-1&&typeof r[M[ne]]=="number"?r[M[ne]]:se)-u/100}${a})`}function H(X){return M.indexOf(X)+1<M.length?j(X,M[M.indexOf(X)+1]):D(X)}function q(X){const se=M.indexOf(X);return se===0?D(M[1]):se===M.length-1?i(M[se]):j(X,M[M.indexOf(X)+1]).replace("@media","@media not all and")}return{keys:M,values:_,up:D,down:i,between:j,only:H,not:q,unit:a,...g}}function oN(e,r){if(!e.containerQueries)return r;const a=Object.keys(r).filter(u=>u.startsWith("@container")).sort((u,g)=>{var M,D;const _=/min-width:\s*([0-9.]+)/;return+(((M=u.match(_))==null?void 0:M[1])||0)-+(((D=g.match(_))==null?void 0:D[1])||0)});return a.length?a.reduce((u,g)=>{const _=r[g];return delete u[g],u[g]=_,u},{...r}):r}function sN(e,r){return r==="@"||r.startsWith("@")&&(e.some(a=>r.startsWith(`@${a}`))||!!r.match(/^@\d/))}function aN(e,r){const a=r.match(/^@([^/]+)?\/?(.+)?$/);if(!a)return null;const[,u,g]=a,_=Number.isNaN(+u)?u||0:+u;return e.containerQueries(g).up(_)}function lN(e){const r=(_,M)=>_.replace("@media",M?`@container ${M}`:"@container");function a(_,M){_.up=(...D)=>r(e.breakpoints.up(...D),M),_.down=(...D)=>r(e.breakpoints.down(...D),M),_.between=(...D)=>r(e.breakpoints.between(...D),M),_.only=(...D)=>r(e.breakpoints.only(...D),M),_.not=(...D)=>{const i=r(e.breakpoints.not(...D),M);return i.includes("not all and")?i.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):i}}const u={},g=_=>(a(u,_),u);return a(g),{...e,containerQueries:g}}const cN={borderRadius:4};function qg(e,r){return r?Co(e,r,{clone:!1}):e}const Xv={xs:0,sm:600,md:900,lg:1200,xl:1536},UP={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Xv[e]}px)`},uN={containerQueries:e=>({up:r=>{let a=typeof r=="number"?r:Xv[r]||r;return typeof a=="number"&&(a=`${a}px`),e?`@container ${e} (min-width:${a})`:`@container (min-width:${a})`}})};function el(e,r,a){const u=e.theme||{};if(Array.isArray(r)){const _=u.breakpoints||UP;return r.reduce((M,D,i)=>(M[_.up(_.keys[i])]=a(r[i]),M),{})}if(typeof r=="object"){const _=u.breakpoints||UP;return Object.keys(r).reduce((M,D)=>{if(sN(_.keys,D)){const i=aN(u.containerQueries?u:uN,D);i&&(M[i]=a(r[D],D))}else if(Object.keys(_.values||Xv).includes(D)){const i=_.up(D);M[i]=a(r[D],D)}else{const i=D;M[i]=r[i]}return M},{})}return a(r)}function KL(e={}){var a;return((a=e.keys)==null?void 0:a.reduce((u,g)=>{const _=e.up(g);return u[_]={},u},{}))||{}}function JL(e,r){return e.reduce((a,u)=>{const g=a[u];return(!g||Object.keys(g).length===0)&&delete a[u],a},r)}function dN(e,...r){const a=KL(e),u=[a,...r].reduce((g,_)=>Co(g,_),{});return JL(Object.keys(a),u)}function hN(e,r){if(typeof e!="object")return{};const a={},u=Object.keys(r);return Array.isArray(e)?u.forEach((g,_)=>{_<e.length&&(a[g]=!0)}):u.forEach(g=>{e[g]!=null&&(a[g]=!0)}),a}function qw({values:e,breakpoints:r,base:a}){const u=a||hN(e,r),g=Object.keys(u);if(g.length===0)return e;let _;return g.reduce((M,D,i)=>(Array.isArray(e)?(M[D]=e[i]!=null?e[i]:e[_],_=i):typeof e=="object"?(M[D]=e[D]!=null?e[D]:e[_],_=D):M[D]=e,M),{})}function tr(e){if(typeof e!="string")throw new Error(gc(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Kv(e,r,a=!0){if(!r||typeof r!="string")return null;if(e&&e.vars&&a){const u=`vars.${r}`.split(".").reduce((g,_)=>g&&g[_]?g[_]:null,e);if(u!=null)return u}return r.split(".").reduce((u,g)=>u&&u[g]!=null?u[g]:null,e)}function iv(e,r,a,u=a){let g;return typeof e=="function"?g=e(a):Array.isArray(e)?g=e[a]||u:g=Kv(e,a)||u,r&&(g=r(g,u,e)),g}function oo(e){const{prop:r,cssProperty:a=e.prop,themeKey:u,transform:g}=e,_=M=>{if(M[r]==null)return null;const D=M[r],i=M.theme,j=Kv(i,u)||{};return el(M,D,q=>{let X=iv(j,g,q);return q===X&&typeof q=="string"&&(X=iv(j,g,`${r}${q==="default"?"":tr(q)}`,q)),a===!1?X:{[a]:X}})};return _.propTypes={},_.filterProps=[r],_}function pN(e){const r={};return a=>(r[a]===void 0&&(r[a]=e(a)),r[a])}const fN={m:"margin",p:"padding"},mN={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},WP={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},gN=pN(e=>{if(e.length>2)if(WP[e])e=WP[e];else return[e];const[r,a]=e.split(""),u=fN[r],g=mN[a]||"";return Array.isArray(g)?g.map(_=>u+_):[u+g]}),wC=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],SC=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...wC,...SC];function Ay(e,r,a,u){const g=Kv(e,r,!0)??a;return typeof g=="number"||typeof g=="string"?_=>typeof _=="string"?_:typeof g=="string"?`calc(${_} * ${g})`:g*_:Array.isArray(g)?_=>{if(typeof _=="string")return _;const M=Math.abs(_),D=g[M];return _>=0?D:typeof D=="number"?-D:`-${D}`}:typeof g=="function"?g:()=>{}}function Jv(e){return Ay(e,"spacing",8)}function Xd(e,r){return typeof r=="string"||r==null?r:e(r)}function yN(e,r){return a=>e.reduce((u,g)=>(u[g]=Xd(r,a),u),{})}function _N(e,r,a,u){if(!r.includes(a))return null;const g=gN(a),_=yN(g,u),M=e[a];return el(e,M,_)}function QL(e,r){const a=Jv(e.theme);return Object.keys(e).map(u=>_N(e,r,u,a)).reduce(qg,{})}function Ki(e){return QL(e,wC)}Ki.propTypes={};Ki.filterProps=wC;function Ji(e){return QL(e,SC)}Ji.propTypes={};Ji.filterProps=SC;function ez(e=8,r=Jv({spacing:e})){if(e.mui)return e;const a=(...u)=>(u.length===0?[1]:u).map(_=>{const M=r(_);return typeof M=="number"?`${M}px`:M}).join(" ");return a.mui=!0,a}function Qv(...e){const r=e.reduce((u,g)=>(g.filterProps.forEach(_=>{u[_]=g}),u),{}),a=u=>Object.keys(u).reduce((g,_)=>r[_]?qg(g,r[_](u)):g,{});return a.propTypes={},a.filterProps=e.reduce((u,g)=>u.concat(g.filterProps),[]),a}function ga(e){return typeof e!="number"?e:`${e}px solid`}function Ma(e,r){return oo({prop:e,themeKey:"borders",transform:r})}const xN=Ma("border",ga),vN=Ma("borderTop",ga),bN=Ma("borderRight",ga),wN=Ma("borderBottom",ga),SN=Ma("borderLeft",ga),TN=Ma("borderColor"),CN=Ma("borderTopColor"),MN=Ma("borderRightColor"),EN=Ma("borderBottomColor"),IN=Ma("borderLeftColor"),kN=Ma("outline",ga),PN=Ma("outlineColor"),e1=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const r=Ay(e.theme,"shape.borderRadius",4),a=u=>({borderRadius:Xd(r,u)});return el(e,e.borderRadius,a)}return null};e1.propTypes={};e1.filterProps=["borderRadius"];Qv(xN,vN,bN,wN,SN,TN,CN,MN,EN,IN,e1,kN,PN);const t1=e=>{if(e.gap!==void 0&&e.gap!==null){const r=Ay(e.theme,"spacing",8),a=u=>({gap:Xd(r,u)});return el(e,e.gap,a)}return null};t1.propTypes={};t1.filterProps=["gap"];const r1=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const r=Ay(e.theme,"spacing",8),a=u=>({columnGap:Xd(r,u)});return el(e,e.columnGap,a)}return null};r1.propTypes={};r1.filterProps=["columnGap"];const n1=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const r=Ay(e.theme,"spacing",8),a=u=>({rowGap:Xd(r,u)});return el(e,e.rowGap,a)}return null};n1.propTypes={};n1.filterProps=["rowGap"];const AN=oo({prop:"gridColumn"}),DN=oo({prop:"gridRow"}),RN=oo({prop:"gridAutoFlow"}),LN=oo({prop:"gridAutoColumns"}),zN=oo({prop:"gridAutoRows"}),ON=oo({prop:"gridTemplateColumns"}),FN=oo({prop:"gridTemplateRows"}),BN=oo({prop:"gridTemplateAreas"}),jN=oo({prop:"gridArea"});Qv(t1,r1,n1,AN,DN,RN,LN,zN,ON,FN,BN,jN);function Kp(e,r){return r==="grey"?r:e}const NN=oo({prop:"color",themeKey:"palette",transform:Kp}),VN=oo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Kp}),$N=oo({prop:"backgroundColor",themeKey:"palette",transform:Kp});Qv(NN,VN,$N);function Vs(e){return e<=1&&e!==0?`${e*100}%`:e}const UN=oo({prop:"width",transform:Vs}),TC=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const r=a=>{var g,_,M,D,i;const u=((M=(_=(g=e.theme)==null?void 0:g.breakpoints)==null?void 0:_.values)==null?void 0:M[a])||Xv[a];return u?((i=(D=e.theme)==null?void 0:D.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${u}${e.theme.breakpoints.unit}`}:{maxWidth:u}:{maxWidth:Vs(a)}};return el(e,e.maxWidth,r)}return null};TC.filterProps=["maxWidth"];const WN=oo({prop:"minWidth",transform:Vs}),GN=oo({prop:"height",transform:Vs}),HN=oo({prop:"maxHeight",transform:Vs}),qN=oo({prop:"minHeight",transform:Vs});oo({prop:"size",cssProperty:"width",transform:Vs});oo({prop:"size",cssProperty:"height",transform:Vs});const ZN=oo({prop:"boxSizing"});Qv(UN,TC,WN,GN,HN,qN,ZN);const Dy={border:{themeKey:"borders",transform:ga},borderTop:{themeKey:"borders",transform:ga},borderRight:{themeKey:"borders",transform:ga},borderBottom:{themeKey:"borders",transform:ga},borderLeft:{themeKey:"borders",transform:ga},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:ga},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:e1},color:{themeKey:"palette",transform:Kp},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Kp},backgroundColor:{themeKey:"palette",transform:Kp},p:{style:Ji},pt:{style:Ji},pr:{style:Ji},pb:{style:Ji},pl:{style:Ji},px:{style:Ji},py:{style:Ji},padding:{style:Ji},paddingTop:{style:Ji},paddingRight:{style:Ji},paddingBottom:{style:Ji},paddingLeft:{style:Ji},paddingX:{style:Ji},paddingY:{style:Ji},paddingInline:{style:Ji},paddingInlineStart:{style:Ji},paddingInlineEnd:{style:Ji},paddingBlock:{style:Ji},paddingBlockStart:{style:Ji},paddingBlockEnd:{style:Ji},m:{style:Ki},mt:{style:Ki},mr:{style:Ki},mb:{style:Ki},ml:{style:Ki},mx:{style:Ki},my:{style:Ki},margin:{style:Ki},marginTop:{style:Ki},marginRight:{style:Ki},marginBottom:{style:Ki},marginLeft:{style:Ki},marginX:{style:Ki},marginY:{style:Ki},marginInline:{style:Ki},marginInlineStart:{style:Ki},marginInlineEnd:{style:Ki},marginBlock:{style:Ki},marginBlockStart:{style:Ki},marginBlockEnd:{style:Ki},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:t1},rowGap:{style:n1},columnGap:{style:r1},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Vs},maxWidth:{style:TC},minWidth:{transform:Vs},height:{transform:Vs},maxHeight:{transform:Vs},minHeight:{transform:Vs},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function YN(...e){const r=e.reduce((u,g)=>u.concat(Object.keys(g)),[]),a=new Set(r);return e.every(u=>a.size===Object.keys(u).length)}function XN(e,r){return typeof e=="function"?e(r):e}function KN(){function e(a,u,g,_){const M={[a]:u,theme:g},D=_[a];if(!D)return{[a]:u};const{cssProperty:i=a,themeKey:j,transform:H,style:q}=D;if(u==null)return null;if(j==="typography"&&u==="inherit")return{[a]:u};const X=Kv(g,j)||{};return q?q(M):el(M,u,ne=>{let le=iv(X,H,ne);return ne===le&&typeof ne=="string"&&(le=iv(X,H,`${a}${ne==="default"?"":tr(ne)}`,ne)),i===!1?le:{[i]:le}})}function r(a){const{sx:u,theme:g={}}=a||{};if(!u)return null;const _=g.unstable_sxConfig??Dy;function M(D){let i=D;if(typeof D=="function")i=D(g);else if(typeof D!="object")return D;if(!i)return null;const j=KL(g.breakpoints),H=Object.keys(j);let q=j;return Object.keys(i).forEach(X=>{const se=XN(i[X],g);if(se!=null)if(typeof se=="object")if(_[X])q=qg(q,e(X,se,g,_));else{const ne=el({theme:g},se,le=>({[X]:le}));YN(ne,se)?q[X]=r({sx:se,theme:g}):q=qg(q,ne)}else q=qg(q,e(X,se,g,_))}),oN(g,JL(H,q))}return Array.isArray(u)?u.map(M):M(u)}return r}const Du=KN();Du.filterProps=["sx"];function JN(e,r){var u;const a=this;if(a.vars){if(!((u=a.colorSchemes)!=null&&u[e])||typeof a.getColorSchemeSelector!="function")return{};let g=a.getColorSchemeSelector(e);return g==="&"?r:((g.includes("data-")||g.includes("."))&&(g=`*:where(${g.replace(/\s*&$/,"")}) &`),{[g]:r})}return a.palette.mode===e?r:{}}function Ry(e={},...r){const{breakpoints:a={},palette:u={},spacing:g,shape:_={},...M}=e,D=iN(a),i=ez(g);let j=Co({breakpoints:D,direction:"ltr",components:{},palette:{mode:"light",...u},spacing:i,shape:{...cN,..._}},M);return j=lN(j),j.applyStyles=JN,j=r.reduce((H,q)=>Co(H,q),j),j.unstable_sxConfig={...Dy,...M==null?void 0:M.unstable_sxConfig},j.unstable_sx=function(q){return Du({sx:q,theme:this})},j}function QN(e){return Object.keys(e).length===0}function CC(e=null){const r=Y.useContext(Yv);return!r||QN(r)?e:r}const e6=Ry();function Ly(e=e6){return CC(e)}function t6({styles:e,themeId:r,defaultTheme:a={}}){const u=Ly(a),g=typeof e=="function"?e(r&&u[r]||u):e;return L.jsx(ZL,{styles:g})}const r6=e=>{var u;const r={systemProps:{},otherProps:{}},a=((u=e==null?void 0:e.theme)==null?void 0:u.unstable_sxConfig)??Dy;return Object.keys(e).forEach(g=>{a[g]?r.systemProps[g]=e[g]:r.otherProps[g]=e[g]}),r};function i1(e){const{sx:r,...a}=e,{systemProps:u,otherProps:g}=r6(a);let _;return Array.isArray(r)?_=[u,...r]:typeof r=="function"?_=(...M)=>{const D=r(...M);return Rl(D)?{...u,...D}:u}:_={...u,...r},{...g,sx:_}}const GP=e=>e,n6=()=>{let e=GP;return{configure(r){e=r},generate(r){return e(r)},reset(){e=GP}}},tz=n6();function rz(e){var r,a,u="";if(typeof e=="string"||typeof e=="number")u+=e;else if(typeof e=="object")if(Array.isArray(e)){var g=e.length;for(r=0;r<g;r++)e[r]&&(a=rz(e[r]))&&(u&&(u+=" "),u+=a)}else for(a in e)e[a]&&(u&&(u+=" "),u+=a);return u}function rr(){for(var e,r,a=0,u="",g=arguments.length;a<g;a++)(e=arguments[a])&&(r=rz(e))&&(u&&(u+=" "),u+=r);return u}function i6(e={}){const{themeId:r,defaultTheme:a,defaultClassName:u="MuiBox-root",generateClassName:g}=e,_=YL("div",{shouldForwardProp:D=>D!=="theme"&&D!=="sx"&&D!=="as"})(Du);return Y.forwardRef(function(i,j){const H=Ly(a),{className:q,component:X="div",...se}=i1(i);return L.jsx(_,{as:X,ref:j,className:rr(q,g?g(u):u),theme:r&&H[r]||H,...se})})}const o6={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Ir(e,r,a="Mui"){const u=o6[r];return u?`${a}-${u}`:`${tz.generate(e)}-${r}`}function Mr(e,r,a="Mui"){const u={};return r.forEach(g=>{u[g]=Ir(e,g,a)}),u}var vi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MC=Symbol.for("react.element"),EC=Symbol.for("react.portal"),o1=Symbol.for("react.fragment"),s1=Symbol.for("react.strict_mode"),a1=Symbol.for("react.profiler"),l1=Symbol.for("react.provider"),c1=Symbol.for("react.context"),s6=Symbol.for("react.server_context"),u1=Symbol.for("react.forward_ref"),d1=Symbol.for("react.suspense"),h1=Symbol.for("react.suspense_list"),p1=Symbol.for("react.memo"),f1=Symbol.for("react.lazy"),a6=Symbol.for("react.offscreen"),nz;nz=Symbol.for("react.module.reference");function Ea(e){if(typeof e=="object"&&e!==null){var r=e.$$typeof;switch(r){case MC:switch(e=e.type,e){case o1:case a1:case s1:case d1:case h1:return e;default:switch(e=e&&e.$$typeof,e){case s6:case c1:case u1:case f1:case p1:case l1:return e;default:return r}}case EC:return r}}}vi.ContextConsumer=c1;vi.ContextProvider=l1;vi.Element=MC;vi.ForwardRef=u1;vi.Fragment=o1;vi.Lazy=f1;vi.Memo=p1;vi.Portal=EC;vi.Profiler=a1;vi.StrictMode=s1;vi.Suspense=d1;vi.SuspenseList=h1;vi.isAsyncMode=function(){return!1};vi.isConcurrentMode=function(){return!1};vi.isContextConsumer=function(e){return Ea(e)===c1};vi.isContextProvider=function(e){return Ea(e)===l1};vi.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===MC};vi.isForwardRef=function(e){return Ea(e)===u1};vi.isFragment=function(e){return Ea(e)===o1};vi.isLazy=function(e){return Ea(e)===f1};vi.isMemo=function(e){return Ea(e)===p1};vi.isPortal=function(e){return Ea(e)===EC};vi.isProfiler=function(e){return Ea(e)===a1};vi.isStrictMode=function(e){return Ea(e)===s1};vi.isSuspense=function(e){return Ea(e)===d1};vi.isSuspenseList=function(e){return Ea(e)===h1};vi.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===o1||e===a1||e===s1||e===d1||e===h1||e===a6||typeof e=="object"&&e!==null&&(e.$$typeof===f1||e.$$typeof===p1||e.$$typeof===l1||e.$$typeof===c1||e.$$typeof===u1||e.$$typeof===nz||e.getModuleId!==void 0)};vi.typeOf=Ea;function iz(e){const{variants:r,...a}=e,u={variants:r,style:$P(a),isProcessed:!0};return u.style===a||r&&r.forEach(g=>{typeof g.style!="function"&&(g.style=$P(g.style))}),u}const l6=Ry();function kx(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function c6(e){return e?(r,a)=>a[e]:null}function u6(e,r,a){e.theme=h6(e.theme)?a:e.theme[r]||e.theme}function Px(e,r){const a=typeof r=="function"?r(e):r;if(Array.isArray(a))return a.flatMap(u=>Px(e,u));if(Array.isArray(a==null?void 0:a.variants)){let u;if(a.isProcessed)u=a.style;else{const{variants:g,..._}=a;u=_}return oz(e,a.variants,[u])}return a!=null&&a.isProcessed?a.style:a}function oz(e,r,a=[]){var g;let u;e:for(let _=0;_<r.length;_+=1){const M=r[_];if(typeof M.props=="function"){if(u??(u={...e,...e.ownerState,ownerState:e.ownerState}),!M.props(u))continue}else for(const D in M.props)if(e[D]!==M.props[D]&&((g=e.ownerState)==null?void 0:g[D])!==M.props[D])continue e;typeof M.style=="function"?(u??(u={...e,...e.ownerState,ownerState:e.ownerState}),a.push(M.style(u))):a.push(M.style)}return a}function sz(e={}){const{themeId:r,defaultTheme:a=l6,rootShouldForwardProp:u=kx,slotShouldForwardProp:g=kx}=e;function _(D){u6(D,r,a)}return(D,i={})=>{rN(D,fe=>fe.filter(Ie=>Ie!==Du));const{name:j,slot:H,skipVariantsResolver:q,skipSx:X,overridesResolver:se=c6(f6(H)),...ne}=i,le=q!==void 0?q:H&&H!=="Root"&&H!=="root"||!1,de=X||!1;let te=kx;H==="Root"||H==="root"?te=u:H?te=g:p6(D)&&(te=void 0);const Q=YL(D,{shouldForwardProp:te,label:d6(),...ne}),K=fe=>{if(typeof fe=="function"&&fe.__emotion_real!==fe)return function(Ce){return Px(Ce,fe)};if(Rl(fe)){const Ie=iz(fe);return Ie.variants?function(we){return Px(we,Ie)}:Ie.style}return fe},ce=(...fe)=>{const Ie=[],Ce=fe.map(K),we=[];if(Ie.push(_),j&&se&&we.push(function(je){var Pe,tt;const Le=(tt=(Pe=je.theme.components)==null?void 0:Pe[j])==null?void 0:tt.styleOverrides;if(!Le)return null;const ze={};for(const De in Le)ze[De]=Px(je,Le[De]);return se(je,ze)}),j&&!le&&we.push(function(je){var ze,Pe;const He=je.theme,Le=(Pe=(ze=He==null?void 0:He.components)==null?void 0:ze[j])==null?void 0:Pe.variants;return Le?oz(je,Le):null}),de||we.push(Du),Array.isArray(Ce[0])){const ve=Ce.shift(),je=new Array(Ie.length).fill(""),He=new Array(we.length).fill("");let Le;Le=[...je,...ve,...He],Le.raw=[...je,...ve.raw,...He],Ie.unshift(Le)}const ot=[...Ie,...Ce,...we],oe=Q(...ot);return D.muiName&&(oe.muiName=D.muiName),oe};return Q.withConfig&&(ce.withConfig=Q.withConfig),ce}}function d6(e,r){return void 0}function h6(e){for(const r in e)return!1;return!0}function p6(e){return typeof e=="string"&&e.charCodeAt(0)>96}function f6(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}const az=sz();function vy(e,r){const a={...r};for(const u in e)if(Object.prototype.hasOwnProperty.call(e,u)){const g=u;if(g==="components"||g==="slots")a[g]={...e[g],...a[g]};else if(g==="componentsProps"||g==="slotProps"){const _=e[g],M=r[g];if(!M)a[g]=_||{};else if(!_)a[g]=M;else{a[g]={...M};for(const D in _)if(Object.prototype.hasOwnProperty.call(_,D)){const i=D;a[g][i]=vy(_[i],M[i])}}}else a[g]===void 0&&(a[g]=e[g])}return a}function lz(e){const{theme:r,name:a,props:u}=e;return!r||!r.components||!r.components[a]||!r.components[a].defaultProps?u:vy(r.components[a].defaultProps,u)}function IC({props:e,name:r,defaultTheme:a,themeId:u}){let g=Ly(a);return u&&(g=g[u]||g),lz({theme:g,name:r,props:e})}const io=typeof window<"u"?Y.useLayoutEffect:Y.useEffect;function m6(e,r,a,u,g){const[_,M]=Y.useState(()=>g&&a?a(e).matches:u?u(e).matches:r);return io(()=>{if(!a)return;const D=a(e),i=()=>{M(D.matches)};return i(),D.addEventListener("change",i),()=>{D.removeEventListener("change",i)}},[e,a]),_}const g6={...Dx},cz=g6.useSyncExternalStore;function y6(e,r,a,u,g){const _=Y.useCallback(()=>r,[r]),M=Y.useMemo(()=>{if(g&&a)return()=>a(e).matches;if(u!==null){const{matches:H}=u(e);return()=>H}return _},[_,e,u,g,a]),[D,i]=Y.useMemo(()=>{if(a===null)return[_,()=>()=>{}];const H=a(e);return[()=>H.matches,q=>(H.addEventListener("change",q),()=>{H.removeEventListener("change",q)})]},[_,a,e]);return cz(i,D,M)}function _6(e,r={}){const a=CC(),u=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:g=!1,matchMedia:_=u?window.matchMedia:null,ssrMatchMedia:M=null,noSsr:D=!1}=lz({name:"MuiUseMediaQuery",props:r,theme:a});let i=e;return i=i.replace(/^@media( ?)/m,""),(cz!==void 0?y6:m6)(i,g,_,M,D)}function Sp(e,r=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(r,Math.min(e,a))}function kC(e,r=0,a=1){return Sp(e,r,a)}function x6(e){e=e.slice(1);const r=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let a=e.match(r);return a&&a[0].length===1&&(a=a.map(u=>u+u)),a?`rgb${a.length===4?"a":""}(${a.map((u,g)=>g<3?parseInt(u,16):Math.round(parseInt(u,16)/255*1e3)/1e3).join(", ")})`:""}function Ru(e){if(e.type)return e;if(e.charAt(0)==="#")return Ru(x6(e));const r=e.indexOf("("),a=e.substring(0,r);if(!["rgb","rgba","hsl","hsla","color"].includes(a))throw new Error(gc(9,e));let u=e.substring(r+1,e.length-1),g;if(a==="color"){if(u=u.split(" "),g=u.shift(),u.length===4&&u[3].charAt(0)==="/"&&(u[3]=u[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(g))throw new Error(gc(10,g))}else u=u.split(",");return u=u.map(_=>parseFloat(_)),{type:a,values:u,colorSpace:g}}const v6=e=>{const r=Ru(e);return r.values.slice(0,3).map((a,u)=>r.type.includes("hsl")&&u!==0?`${a}%`:a).join(" ")},Lg=(e,r)=>{try{return v6(e)}catch{return e}};function m1(e){const{type:r,colorSpace:a}=e;let{values:u}=e;return r.includes("rgb")?u=u.map((g,_)=>_<3?parseInt(g,10):g):r.includes("hsl")&&(u[1]=`${u[1]}%`,u[2]=`${u[2]}%`),r.includes("color")?u=`${a} ${u.join(" ")}`:u=`${u.join(", ")}`,`${r}(${u})`}function uz(e){e=Ru(e);const{values:r}=e,a=r[0],u=r[1]/100,g=r[2]/100,_=u*Math.min(g,1-g),M=(j,H=(j+a/30)%12)=>g-_*Math.max(Math.min(H-3,9-H,1),-1);let D="rgb";const i=[Math.round(M(0)*255),Math.round(M(8)*255),Math.round(M(4)*255)];return e.type==="hsla"&&(D+="a",i.push(r[3])),m1({type:D,values:i})}function oT(e){e=Ru(e);let r=e.type==="hsl"||e.type==="hsla"?Ru(uz(e)).values:e.values;return r=r.map(a=>(e.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*r[0]+.7152*r[1]+.0722*r[2]).toFixed(3))}function b6(e,r){const a=oT(e),u=oT(r);return(Math.max(a,u)+.05)/(Math.min(a,u)+.05)}function Bn(e,r){return e=Ru(e),r=kC(r),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${r}`:e.values[3]=r,m1(e)}function J0(e,r,a){try{return Bn(e,r)}catch{return e}}function hf(e,r){if(e=Ru(e),r=kC(r),e.type.includes("hsl"))e.values[2]*=1-r;else if(e.type.includes("rgb")||e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]*=1-r;return m1(e)}function Ci(e,r,a){try{return hf(e,r)}catch{return e}}function pf(e,r){if(e=Ru(e),r=kC(r),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*r;else if(e.type.includes("rgb"))for(let a=0;a<3;a+=1)e.values[a]+=(255-e.values[a])*r;else if(e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]+=(1-e.values[a])*r;return m1(e)}function Mi(e,r,a){try{return pf(e,r)}catch{return e}}function w6(e,r=.15){return oT(e)>.5?hf(e,r):pf(e,r)}function Q0(e,r,a){try{return w6(e,r)}catch{return e}}const S6=Cr.oneOfType([Cr.func,Cr.object]);function HP(...e){return e.reduce((r,a)=>a==null?r:function(...g){r.apply(this,g),a.apply(this,g)},()=>{})}function zy(e,r=166){let a;function u(...g){const _=()=>{e.apply(this,g)};clearTimeout(a),a=setTimeout(_,r)}return u.clear=()=>{clearTimeout(a)},u}function Zg(e,r){var a,u,g;return Y.isValidElement(e)&&r.indexOf(e.type.muiName??((g=(u=(a=e.type)==null?void 0:a._payload)==null?void 0:u.value)==null?void 0:g.muiName))!==-1}function Ko(e){return e&&e.ownerDocument||document}function Hs(e){return Ko(e).defaultView||window}function sT(e,r){typeof e=="function"?e(r):e&&(e.current=r)}let qP=0;function T6(e){const[r,a]=Y.useState(e),u=e||r;return Y.useEffect(()=>{r==null&&(qP+=1,a(`mui-${qP}`))},[r]),u}const C6={...Dx},ZP=C6.useId;function Bu(e){if(ZP!==void 0){const r=ZP();return e??r}return T6(e)}function tl({controlled:e,default:r,name:a,state:u="value"}){const{current:g}=Y.useRef(e!==void 0),[_,M]=Y.useState(r),D=g?e:_,i=Y.useCallback(j=>{g||M(j)},[]);return[D,i]}function Ar(e){const r=Y.useRef(e);return io(()=>{r.current=e}),Y.useRef((...a)=>(0,r.current)(...a)).current}function ai(...e){return Y.useMemo(()=>e.every(r=>r==null)?null:r=>{e.forEach(a=>{sT(a,r)})},e)}const YP={};function dz(e,r){const a=Y.useRef(YP);return a.current===YP&&(a.current=e(r)),a}const M6=[];function E6(e){Y.useEffect(e,M6)}class PC{constructor(){lg(this,"currentId",null);lg(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});lg(this,"disposeEffect",()=>this.clear)}static create(){return new PC}start(r,a){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,a()},r)}}function AC(){const e=dz(PC.create).current;return E6(e.disposeEffect),e}function ov(e){try{return e.matches(":focus-visible")}catch{}return!1}function hz(e=window){const r=e.document.documentElement.clientWidth;return e.innerWidth-r}const pz=e=>{const r=Y.useRef({});return Y.useEffect(()=>{r.current=e}),r.current},fz={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function Er(e,r,a=void 0){const u={};for(const g in e){const _=e[g];let M="",D=!0;for(let i=0;i<_.length;i+=1){const j=_[i];j&&(M+=(D===!0?"":" ")+r(j),D=!1,a&&a[j]&&(M+=" "+a[j]))}u[g]=M}return u}function I6(e){return typeof e=="string"}function mz(e,r,a){return e===void 0||I6(e)?r:{...r,ownerState:{...r.ownerState,...a}}}function Yg(e,r=[]){if(e===void 0)return{};const a={};return Object.keys(e).filter(u=>u.match(/^on[A-Z]/)&&typeof e[u]=="function"&&!r.includes(u)).forEach(u=>{a[u]=e[u]}),a}function XP(e){if(e===void 0)return{};const r={};return Object.keys(e).filter(a=>!(a.match(/^on[A-Z]/)&&typeof e[a]=="function")).forEach(a=>{r[a]=e[a]}),r}function gz(e){const{getSlotProps:r,additionalProps:a,externalSlotProps:u,externalForwardedProps:g,className:_}=e;if(!r){const se=rr(a==null?void 0:a.className,_,g==null?void 0:g.className,u==null?void 0:u.className),ne={...a==null?void 0:a.style,...g==null?void 0:g.style,...u==null?void 0:u.style},le={...a,...g,...u};return se.length>0&&(le.className=se),Object.keys(ne).length>0&&(le.style=ne),{props:le,internalRef:void 0}}const M=Yg({...g,...u}),D=XP(u),i=XP(g),j=r(M),H=rr(j==null?void 0:j.className,a==null?void 0:a.className,_,g==null?void 0:g.className,u==null?void 0:u.className),q={...j==null?void 0:j.style,...a==null?void 0:a.style,...g==null?void 0:g.style,...u==null?void 0:u.style},X={...j,...a,...i,...D};return H.length>0&&(X.className=H),Object.keys(q).length>0&&(X.style=q),{props:X,internalRef:j.ref}}function DC(e,r,a){return typeof e=="function"?e(r,a):e}function jn(e){var q;const{elementType:r,externalSlotProps:a,ownerState:u,skipResolvingSlotProps:g=!1,..._}=e,M=g?{}:DC(a,u),{props:D,internalRef:i}=gz({..._,externalSlotProps:M}),j=ai(i,M==null?void 0:M.ref,(q=e.additionalProps)==null?void 0:q.ref);return mz(r,{...D,ref:j},u)}function vf(e){var r;return parseInt(Y.version,10)>=19?((r=e==null?void 0:e.props)==null?void 0:r.ref)||null:(e==null?void 0:e.ref)||null}const yz=Y.createContext(null);function RC(){return Y.useContext(yz)}const k6=typeof Symbol=="function"&&Symbol.for,P6=k6?Symbol.for("mui.nested"):"__THEME_NESTED__";function A6(e,r){return typeof r=="function"?r(e):{...e,...r}}function D6(e){const{children:r,theme:a}=e,u=RC(),g=Y.useMemo(()=>{const _=u===null?{...a}:A6(u,a);return _!=null&&(_[P6]=u!==null),_},[a,u]);return L.jsx(yz.Provider,{value:g,children:r})}const _z=Y.createContext();function R6({value:e,...r}){return L.jsx(_z.Provider,{value:e??!0,...r})}const fs=()=>Y.useContext(_z)??!1,xz=Y.createContext(void 0);function L6({value:e,children:r}){return L.jsx(xz.Provider,{value:e,children:r})}function z6(e){const{theme:r,name:a,props:u}=e;if(!r||!r.components||!r.components[a])return u;const g=r.components[a];return g.defaultProps?vy(g.defaultProps,u):!g.styleOverrides&&!g.variants?vy(g,u):u}function O6({props:e,name:r}){const a=Y.useContext(xz);return z6({props:e,name:r,theme:{components:a}})}const KP={};function JP(e,r,a,u=!1){return Y.useMemo(()=>{const g=e&&r[e]||r;if(typeof a=="function"){const _=a(g),M=e?{...r,[e]:_}:_;return u?()=>M:M}return e?{...r,[e]:a}:{...r,...a}},[e,r,a,u])}function vz(e){const{children:r,theme:a,themeId:u}=e,g=CC(KP),_=RC()||KP,M=JP(u,g,a),D=JP(u,_,a,!0),i=M.direction==="rtl";return L.jsx(D6,{theme:D,children:L.jsx(Yv.Provider,{value:M,children:L.jsx(R6,{value:i,children:L.jsx(L6,{value:M==null?void 0:M.components,children:r})})})})}const QP={theme:void 0};function F6(e){let r,a;return function(g){let _=r;return(_===void 0||g.theme!==a)&&(QP.theme=g.theme,_=iz(e(QP)),r=_,a=g.theme),_}}const LC="mode",zC="color-scheme",B6="data-color-scheme";function j6(e){const{defaultLightColorScheme:r="light",defaultDarkColorScheme:a="dark",modeStorageKey:u=LC,colorSchemeStorageKey:g=zC,attribute:_=B6,colorSchemeNode:M="document.documentElement",nonce:D}=e||{};let i="",j=_;if(_==="class"&&(j=".%s"),_==="data"&&(j="[data-%s]"),j.startsWith(".")){const q=j.substring(1);i+=`${M}.classList.remove('${q}'.replace('%s', light), '${q}'.replace('%s', dark));
      ${M}.classList.add('${q}'.replace('%s', colorScheme));`}const H=j.match(/\[([^\]]+)\]/);if(H){const[q,X]=H[1].split("=");X||(i+=`${M}.removeAttribute('${q}'.replace('%s', light));
      ${M}.removeAttribute('${q}'.replace('%s', dark));`),i+=`
      ${M}.setAttribute('${q}'.replace('%s', colorScheme), ${X?`${X}.replace('%s', colorScheme)`:'""'});`}else i+=`${M}.setAttribute('${j}', colorScheme);`;return L.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?D:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${u}') || 'system';
  const dark = localStorage.getItem('${g}-dark') || '${a}';
  const light = localStorage.getItem('${g}-light') || '${r}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${i}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function eA(e){if(typeof window<"u"&&typeof window.matchMedia=="function"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function bz(e,r){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return r("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return r("dark")}function N6(e){return bz(e,r=>{if(r==="light")return e.lightColorScheme;if(r==="dark")return e.darkColorScheme})}function Zw(e,r){if(typeof window>"u")return;let a;try{a=localStorage.getItem(e)||void 0,a||localStorage.setItem(e,r)}catch{}return a||r}function V6(e){const{defaultMode:r="light",defaultLightColorScheme:a,defaultDarkColorScheme:u,supportedColorSchemes:g=[],modeStorageKey:_=LC,colorSchemeStorageKey:M=zC,storageWindow:D=typeof window>"u"?void 0:window}=e,i=g.join(","),j=g.length>1,[H,q]=Y.useState(()=>{const K=Zw(_,r),ce=Zw(`${M}-light`,a),fe=Zw(`${M}-dark`,u);return{mode:K,systemMode:eA(K),lightColorScheme:ce,darkColorScheme:fe}}),[,X]=Y.useState(!1),se=Y.useRef(!1);Y.useEffect(()=>{j&&X(!0),se.current=!0},[j]);const ne=N6(H),le=Y.useCallback(K=>{q(ce=>{if(K===ce.mode)return ce;const fe=K??r;try{localStorage.setItem(_,fe)}catch{}return{...ce,mode:fe,systemMode:eA(fe)}})},[_,r]),de=Y.useCallback(K=>{K?typeof K=="string"?K&&!i.includes(K)?console.error(`\`${K}\` does not exist in \`theme.colorSchemes\`.`):q(ce=>{const fe={...ce};return bz(ce,Ie=>{try{localStorage.setItem(`${M}-${Ie}`,K)}catch{}Ie==="light"&&(fe.lightColorScheme=K),Ie==="dark"&&(fe.darkColorScheme=K)}),fe}):q(ce=>{const fe={...ce},Ie=K.light===null?a:K.light,Ce=K.dark===null?u:K.dark;if(Ie)if(!i.includes(Ie))console.error(`\`${Ie}\` does not exist in \`theme.colorSchemes\`.`);else{fe.lightColorScheme=Ie;try{localStorage.setItem(`${M}-light`,Ie)}catch{}}if(Ce)if(!i.includes(Ce))console.error(`\`${Ce}\` does not exist in \`theme.colorSchemes\`.`);else{fe.darkColorScheme=Ce;try{localStorage.setItem(`${M}-dark`,Ce)}catch{}}return fe}):q(ce=>{try{localStorage.setItem(`${M}-light`,a),localStorage.setItem(`${M}-dark`,u)}catch{}return{...ce,lightColorScheme:a,darkColorScheme:u}})},[i,M,a,u]),te=Y.useCallback(K=>{H.mode==="system"&&q(ce=>{const fe=K!=null&&K.matches?"dark":"light";return ce.systemMode===fe?ce:{...ce,systemMode:fe}})},[H.mode]),Q=Y.useRef(te);return Q.current=te,Y.useEffect(()=>{if(typeof window.matchMedia!="function"||!j)return;const K=(...fe)=>Q.current(...fe),ce=window.matchMedia("(prefers-color-scheme: dark)");return ce.addListener(K),K(ce),()=>{ce.removeListener(K)}},[j]),Y.useEffect(()=>{if(D&&j){const K=ce=>{const fe=ce.newValue;typeof ce.key=="string"&&ce.key.startsWith(M)&&(!fe||i.match(fe))&&(ce.key.endsWith("light")&&de({light:fe}),ce.key.endsWith("dark")&&de({dark:fe})),ce.key===_&&(!fe||["light","dark","system"].includes(fe))&&le(fe||r)};return D.addEventListener("storage",K),()=>{D.removeEventListener("storage",K)}}},[de,le,_,M,i,r,D,j]),{...H,mode:se.current||!j?H.mode:void 0,systemMode:se.current||!j?H.systemMode:void 0,colorScheme:se.current||!j?ne:void 0,setMode:le,setColorScheme:de}}const $6="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function U6(e){const{themeId:r,theme:a={},modeStorageKey:u=LC,colorSchemeStorageKey:g=zC,disableTransitionOnChange:_=!1,defaultColorScheme:M,resolveTheme:D}=e,i={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},j=Y.createContext(void 0),H=()=>Y.useContext(j)||i;function q(le){var dn,Tt,ar,Xt,Hr;const{children:de,theme:te,modeStorageKey:Q=u,colorSchemeStorageKey:K=g,disableTransitionOnChange:ce=_,storageWindow:fe=typeof window>"u"?void 0:window,documentNode:Ie=typeof document>"u"?void 0:document,colorSchemeNode:Ce=typeof document>"u"?void 0:document.documentElement,disableNestedContext:we=!1,disableStyleSheetGeneration:ot=!1,defaultMode:oe="system"}=le,ve=Y.useRef(!1),je=RC(),He=Y.useContext(j),Le=!!He&&!we,ze=Y.useMemo(()=>te||(typeof a=="function"?a():a),[te]),Pe=ze[r],{colorSchemes:tt={},components:De={},cssVarPrefix:Ke,...Ge}=Pe||ze,ft=Object.keys(tt).filter(zr=>!!tt[zr]).join(","),Gt=Y.useMemo(()=>ft.split(","),[ft]),Ft=typeof M=="string"?M:M.light,wt=typeof M=="string"?M:M.dark,Rt=tt[Ft]&&tt[wt]?oe:((Tt=(dn=tt[Ge.defaultColorScheme])==null?void 0:dn.palette)==null?void 0:Tt.mode)||((ar=Ge.palette)==null?void 0:ar.mode),{mode:It,setMode:zt,systemMode:At,lightColorScheme:kt,darkColorScheme:Ot,colorScheme:be,setColorScheme:Ht}=V6({supportedColorSchemes:Gt,defaultLightColorScheme:Ft,defaultDarkColorScheme:wt,modeStorageKey:Q,colorSchemeStorageKey:K,defaultMode:Rt,storageWindow:fe});let xt=It,Bt=be;Le&&(xt=He.mode,Bt=He.colorScheme);const rt=Bt||Ge.defaultColorScheme,qt=((Xt=Ge.generateThemeVars)==null?void 0:Xt.call(Ge))||Ge.vars,Lt={...Ge,components:De,colorSchemes:tt,cssVarPrefix:Ke,vars:qt};if(typeof Lt.generateSpacing=="function"&&(Lt.spacing=Lt.generateSpacing()),rt){const zr=tt[rt];zr&&typeof zr=="object"&&Object.keys(zr).forEach(br=>{zr[br]&&typeof zr[br]=="object"?Lt[br]={...Lt[br],...zr[br]}:Lt[br]=zr[br]})}const Yt=Ge.colorSchemeSelector;Y.useEffect(()=>{if(Bt&&Ce&&Yt&&Yt!=="media"){const zr=Yt;let br=Yt;if(zr==="class"&&(br=".%s"),zr==="data"&&(br="[data-%s]"),zr!=null&&zr.startsWith("data-")&&!zr.includes("%s")&&(br=`[${zr}="%s"]`),br.startsWith("."))Ce.classList.remove(...Gt.map(Qr=>br.substring(1).replace("%s",Qr))),Ce.classList.add(br.substring(1).replace("%s",Bt));else{const Qr=br.replace("%s",Bt).match(/\[([^\]]+)\]/);if(Qr){const[pn,Wr]=Qr[1].split("=");Wr||Gt.forEach(Jn=>{Ce.removeAttribute(pn.replace(Bt,Jn))}),Ce.setAttribute(pn,Wr?Wr.replace(/"|'/g,""):"")}else Ce.setAttribute(br,Bt)}}},[Bt,Yt,Ce,Gt]),Y.useEffect(()=>{let zr;if(ce&&ve.current&&Ie){const br=Ie.createElement("style");br.appendChild(Ie.createTextNode($6)),Ie.head.appendChild(br),window.getComputedStyle(Ie.body),zr=setTimeout(()=>{Ie.head.removeChild(br)},1)}return()=>{clearTimeout(zr)}},[Bt,ce,Ie]),Y.useEffect(()=>(ve.current=!0,()=>{ve.current=!1}),[]);const Wt=Y.useMemo(()=>({allColorSchemes:Gt,colorScheme:Bt,darkColorScheme:Ot,lightColorScheme:kt,mode:xt,setColorScheme:Ht,setMode:zt,systemMode:At}),[Gt,Bt,Ot,kt,xt,Ht,zt,At]);let wr=!0;(ot||Ge.cssVariables===!1||Le&&(je==null?void 0:je.cssVarPrefix)===Ke)&&(wr=!1);const Sr=L.jsxs(Y.Fragment,{children:[L.jsx(vz,{themeId:Pe?r:void 0,theme:D?D(Lt):Lt,children:de}),wr&&L.jsx(ZL,{styles:((Hr=Lt.generateStyleSheets)==null?void 0:Hr.call(Lt))||[]})]});return Le?Sr:L.jsx(j.Provider,{value:Wt,children:Sr})}const X=typeof M=="string"?M:M.light,se=typeof M=="string"?M:M.dark;return{CssVarsProvider:q,useColorScheme:H,getInitColorSchemeScript:le=>j6({colorSchemeStorageKey:g,defaultLightColorScheme:X,defaultDarkColorScheme:se,modeStorageKey:u,...le})}}function W6(e=""){function r(...u){if(!u.length)return"";const g=u[0];return typeof g=="string"&&!g.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${g}${r(...u.slice(1))})`:`, ${g}`}return(u,...g)=>`var(--${e?`${e}-`:""}${u}${r(...g)})`}const tA=(e,r,a,u=[])=>{let g=e;r.forEach((_,M)=>{M===r.length-1?Array.isArray(g)?g[Number(_)]=a:g&&typeof g=="object"&&(g[_]=a):g&&typeof g=="object"&&(g[_]||(g[_]=u.includes(_)?[]:{}),g=g[_])})},G6=(e,r,a)=>{function u(g,_=[],M=[]){Object.entries(g).forEach(([D,i])=>{(!a||a&&!a([..._,D]))&&i!=null&&(typeof i=="object"&&Object.keys(i).length>0?u(i,[..._,D],Array.isArray(i)?[...M,D]:M):r([..._,D],i,M))})}u(e)},H6=(e,r)=>typeof r=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(u=>e.includes(u))||e[e.length-1].toLowerCase().includes("opacity")?r:`${r}px`:r;function Yw(e,r){const{prefix:a,shouldSkipGeneratingVar:u}=r||{},g={},_={},M={};return G6(e,(D,i,j)=>{if((typeof i=="string"||typeof i=="number")&&(!u||!u(D,i))){const H=`--${a?`${a}-`:""}${D.join("-")}`,q=H6(D,i);Object.assign(g,{[H]:q}),tA(_,D,`var(${H})`,j),tA(M,D,`var(${H}, ${q})`,j)}},D=>D[0]==="vars"),{css:g,vars:_,varsWithDefaults:M}}function q6(e,r={}){const{getSelector:a=de,disableCssColorScheme:u,colorSchemeSelector:g}=r,{colorSchemes:_={},components:M,defaultColorScheme:D="light",...i}=e,{vars:j,css:H,varsWithDefaults:q}=Yw(i,r);let X=q;const se={},{[D]:ne,...le}=_;if(Object.entries(le||{}).forEach(([K,ce])=>{const{vars:fe,css:Ie,varsWithDefaults:Ce}=Yw(ce,r);X=Co(X,Ce),se[K]={css:Ie,vars:fe}}),ne){const{css:K,vars:ce,varsWithDefaults:fe}=Yw(ne,r);X=Co(X,fe),se[D]={css:K,vars:ce}}function de(K,ce){var Ie,Ce;let fe=g;if(g==="class"&&(fe=".%s"),g==="data"&&(fe="[data-%s]"),g!=null&&g.startsWith("data-")&&!g.includes("%s")&&(fe=`[${g}="%s"]`),K){if(fe==="media")return e.defaultColorScheme===K?":root":{[`@media (prefers-color-scheme: ${((Ce=(Ie=_[K])==null?void 0:Ie.palette)==null?void 0:Ce.mode)||K})`]:{":root":ce}};if(fe)return e.defaultColorScheme===K?`:root, ${fe.replace("%s",String(K))}`:fe.replace("%s",String(K))}return":root"}return{vars:X,generateThemeVars:()=>{let K={...j};return Object.entries(se).forEach(([,{vars:ce}])=>{K=Co(K,ce)}),K},generateStyleSheets:()=>{var we,ot;const K=[],ce=e.defaultColorScheme||"light";function fe(oe,ve){Object.keys(ve).length&&K.push(typeof oe=="string"?{[oe]:{...ve}}:oe)}fe(a(void 0,{...H}),H);const{[ce]:Ie,...Ce}=se;if(Ie){const{css:oe}=Ie,ve=(ot=(we=_[ce])==null?void 0:we.palette)==null?void 0:ot.mode,je=!u&&ve?{colorScheme:ve,...oe}:{...oe};fe(a(ce,{...je}),je)}return Object.entries(Ce).forEach(([oe,{css:ve}])=>{var Le,ze;const je=(ze=(Le=_[oe])==null?void 0:Le.palette)==null?void 0:ze.mode,He=!u&&je?{colorScheme:je,...ve}:{...ve};fe(a(oe,{...He}),He)}),K}}}function Z6(e){return function(a){return e==="media"?`@media (prefers-color-scheme: ${a})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${a}"] &`:e==="class"?`.${a} &`:e==="data"?`[data-${a}] &`:`${e.replace("%s",a)} &`:"&"}}const Y6=(e,r)=>e.filter(a=>r.includes(a)),bf=(e,r,a)=>{const u=e.keys[0];Array.isArray(r)?r.forEach((g,_)=>{a((M,D)=>{_<=e.keys.length-1&&(_===0?Object.assign(M,D):M[e.up(e.keys[_])]=D)},g)}):r&&typeof r=="object"?(Object.keys(r).length>e.keys.length?e.keys:Y6(e.keys,Object.keys(r))).forEach(_=>{if(e.keys.includes(_)){const M=r[_];M!==void 0&&a((D,i)=>{u===_?Object.assign(D,i):D[e.up(_)]=i},M)}}):(typeof r=="number"||typeof r=="string")&&a((g,_)=>{Object.assign(g,_)},r)};function sv(e){return`--Grid-${e}Spacing`}function g1(e){return`--Grid-parent-${e}Spacing`}const rA="--Grid-columns",Jp="--Grid-parent-columns",X6=({theme:e,ownerState:r})=>{const a={};return bf(e.breakpoints,r.size,(u,g)=>{let _={};g==="grow"&&(_={flexBasis:0,flexGrow:1,maxWidth:"100%"}),g==="auto"&&(_={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof g=="number"&&(_={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${g} / var(${Jp}) - (var(${Jp}) - ${g}) * (var(${g1("column")}) / var(${Jp})))`}),u(a,_)}),a},K6=({theme:e,ownerState:r})=>{const a={};return bf(e.breakpoints,r.offset,(u,g)=>{let _={};g==="auto"&&(_={marginLeft:"auto"}),typeof g=="number"&&(_={marginLeft:g===0?"0px":`calc(100% * ${g} / var(${Jp}) + var(${g1("column")}) * ${g} / var(${Jp}))`}),u(a,_)}),a},J6=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={[rA]:12};return bf(e.breakpoints,r.columns,(u,g)=>{const _=g??12;u(a,{[rA]:_,"> *":{[Jp]:_}})}),a},Q6=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={};return bf(e.breakpoints,r.rowSpacing,(u,g)=>{var M;const _=typeof g=="string"?g:(M=e.spacing)==null?void 0:M.call(e,g);u(a,{[sv("row")]:_,"> *":{[g1("row")]:_}})}),a},eV=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={};return bf(e.breakpoints,r.columnSpacing,(u,g)=>{var M;const _=typeof g=="string"?g:(M=e.spacing)==null?void 0:M.call(e,g);u(a,{[sv("column")]:_,"> *":{[g1("column")]:_}})}),a},tV=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={};return bf(e.breakpoints,r.direction,(u,g)=>{u(a,{flexDirection:g})}),a},rV=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${sv("row")}) var(${sv("column")})`}}),nV=e=>{const r=[];return Object.entries(e).forEach(([a,u])=>{u!==!1&&u!==void 0&&r.push(`grid-${a}-${String(u)}`)}),r},iV=(e,r="xs")=>{function a(u){return u===void 0?!1:typeof u=="string"&&!Number.isNaN(Number(u))||typeof u=="number"&&u>0}if(a(e))return[`spacing-${r}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const u=[];return Object.entries(e).forEach(([g,_])=>{a(_)&&u.push(`spacing-${g}-${String(_)}`)}),u}return[]},oV=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([r,a])=>`direction-${r}-${a}`):[`direction-xs-${String(e)}`],sV=Ry(),aV=az("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,r)=>r.root});function lV(e){return IC({props:e,name:"MuiGrid",defaultTheme:sV})}function cV(e={}){const{createStyledComponent:r=aV,useThemeProps:a=lV,componentName:u="MuiGrid"}=e,g=(i,j)=>{const{container:H,direction:q,spacing:X,wrap:se,size:ne}=i,le={root:["root",H&&"container",se!=="wrap"&&`wrap-xs-${String(se)}`,...oV(q),...nV(ne),...H?iV(X,j.breakpoints.keys[0]):[]]};return Er(le,de=>Ir(u,de),{})};function _(i,j,H=()=>!0){const q={};return i===null||(Array.isArray(i)?i.forEach((X,se)=>{X!==null&&H(X)&&j.keys[se]&&(q[j.keys[se]]=X)}):typeof i=="object"?Object.keys(i).forEach(X=>{const se=i[X];se!=null&&H(se)&&(q[X]=se)}):q[j.keys[0]]=i),q}const M=r(J6,eV,Q6,X6,tV,rV,K6),D=Y.forwardRef(function(j,H){const q=Ly(),X=a(j),se=i1(X),{className:ne,children:le,columns:de=12,container:te=!1,component:Q="div",direction:K="row",wrap:ce="wrap",size:fe={},offset:Ie={},spacing:Ce=0,rowSpacing:we=Ce,columnSpacing:ot=Ce,unstable_level:oe=0,...ve}=se,je=_(fe,q.breakpoints,Ge=>Ge!==!1),He=_(Ie,q.breakpoints),Le=j.columns??(oe?void 0:de),ze=j.spacing??(oe?void 0:Ce),Pe=j.rowSpacing??j.spacing??(oe?void 0:we),tt=j.columnSpacing??j.spacing??(oe?void 0:ot),De={...se,level:oe,columns:Le,container:te,direction:K,wrap:ce,spacing:ze,rowSpacing:Pe,columnSpacing:tt,size:je,offset:He},Ke=g(De,q);return L.jsx(M,{ref:H,as:Q,ownerState:De,className:rr(Ke.root,ne),...ve,children:Y.Children.map(le,Ge=>{var ft;return Y.isValidElement(Ge)&&Zg(Ge,["Grid"])&&te&&Ge.props.container?Y.cloneElement(Ge,{unstable_level:((ft=Ge.props)==null?void 0:ft.unstable_level)??oe+1}):Ge})})});return D.muiName="Grid",D}const uV=Ry(),dV=az("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,r)=>r.root});function hV(e){return IC({props:e,name:"MuiStack",defaultTheme:uV})}function pV(e,r){const a=Y.Children.toArray(e).filter(Boolean);return a.reduce((u,g,_)=>(u.push(g),_<a.length-1&&u.push(Y.cloneElement(r,{key:`separator-${_}`})),u),[])}const fV=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],mV=({ownerState:e,theme:r})=>{let a={display:"flex",flexDirection:"column",...el({theme:r},qw({values:e.direction,breakpoints:r.breakpoints.values}),u=>({flexDirection:u}))};if(e.spacing){const u=Jv(r),g=Object.keys(r.breakpoints.values).reduce((i,j)=>((typeof e.spacing=="object"&&e.spacing[j]!=null||typeof e.direction=="object"&&e.direction[j]!=null)&&(i[j]=!0),i),{}),_=qw({values:e.direction,base:g}),M=qw({values:e.spacing,base:g});typeof _=="object"&&Object.keys(_).forEach((i,j,H)=>{if(!_[i]){const X=j>0?_[H[j-1]]:"column";_[i]=X}}),a=Co(a,el({theme:r},M,(i,j)=>e.useFlexGap?{gap:Xd(u,i)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${fV(j?_[j]:e.direction)}`]:Xd(u,i)}}))}return a=dN(r.breakpoints,a),a};function gV(e={}){const{createStyledComponent:r=dV,useThemeProps:a=hV,componentName:u="MuiStack"}=e,g=()=>Er({root:["root"]},i=>Ir(u,i),{}),_=r(mV);return Y.forwardRef(function(i,j){const H=a(i),q=i1(H),{component:X="div",direction:se="column",spacing:ne=0,divider:le,children:de,className:te,useFlexGap:Q=!1,...K}=q,ce={direction:se,spacing:ne,useFlexGap:Q},fe=g();return L.jsx(_,{as:X,ownerState:ce,ref:j,className:rr(fe.root,te),...K,children:le?pV(de,le):de})})}const by={black:"#000",white:"#fff"},wz={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},gp={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},yp={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},_g={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Al={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},_p={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},xp={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function Sz(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:by.white,default:by.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const yV=Sz();function Tz(){return{text:{primary:by.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:by.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const nA=Tz();function iA(e,r,a,u){const g=u.light||u,_=u.dark||u*1.5;e[r]||(e.hasOwnProperty(a)?e[r]=e[a]:r==="light"?e.light=pf(e.main,g):r==="dark"&&(e.dark=hf(e.main,_)))}function _V(e="light"){return e==="dark"?{main:Al[200],light:Al[50],dark:Al[400]}:{main:Al[700],light:Al[400],dark:Al[800]}}function xV(e="light"){return e==="dark"?{main:gp[200],light:gp[50],dark:gp[400]}:{main:gp[500],light:gp[300],dark:gp[700]}}function vV(e="light"){return e==="dark"?{main:yp[500],light:yp[300],dark:yp[700]}:{main:yp[700],light:yp[400],dark:yp[800]}}function bV(e="light"){return e==="dark"?{main:_p[400],light:_p[300],dark:_p[700]}:{main:_p[700],light:_p[500],dark:_p[900]}}function wV(e="light"){return e==="dark"?{main:xp[400],light:xp[300],dark:xp[700]}:{main:xp[800],light:xp[500],dark:xp[900]}}function SV(e="light"){return e==="dark"?{main:_g[400],light:_g[300],dark:_g[700]}:{main:"#ed6c02",light:_g[500],dark:_g[900]}}function OC(e){const{mode:r="light",contrastThreshold:a=3,tonalOffset:u=.2,...g}=e,_=e.primary||_V(r),M=e.secondary||xV(r),D=e.error||vV(r),i=e.info||bV(r),j=e.success||wV(r),H=e.warning||SV(r);function q(le){return b6(le,nA.text.primary)>=a?nA.text.primary:yV.text.primary}const X=({color:le,name:de,mainShade:te=500,lightShade:Q=300,darkShade:K=700})=>{if(le={...le},!le.main&&le[te]&&(le.main=le[te]),!le.hasOwnProperty("main"))throw new Error(gc(11,de?` (${de})`:"",te));if(typeof le.main!="string")throw new Error(gc(12,de?` (${de})`:"",JSON.stringify(le.main)));return iA(le,"light",Q,u),iA(le,"dark",K,u),le.contrastText||(le.contrastText=q(le.main)),le};let se;return r==="light"?se=Sz():r==="dark"&&(se=Tz()),Co({common:{...by},mode:r,primary:X({color:_,name:"primary"}),secondary:X({color:M,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:X({color:D,name:"error"}),warning:X({color:H,name:"warning"}),info:X({color:i,name:"info"}),success:X({color:j,name:"success"}),grey:wz,contrastThreshold:a,getContrastText:q,augmentColor:X,tonalOffset:u,...se},g)}function TV(e){const r={};return Object.entries(e).forEach(u=>{const[g,_]=u;typeof _=="object"&&(r[g]=`${_.fontStyle?`${_.fontStyle} `:""}${_.fontVariant?`${_.fontVariant} `:""}${_.fontWeight?`${_.fontWeight} `:""}${_.fontStretch?`${_.fontStretch} `:""}${_.fontSize||""}${_.lineHeight?`/${_.lineHeight} `:""}${_.fontFamily||""}`)}),r}function CV(e,r){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...r}}function MV(e){return Math.round(e*1e5)/1e5}const oA={textTransform:"uppercase"},sA='"Roboto", "Helvetica", "Arial", sans-serif';function Cz(e,r){const{fontFamily:a=sA,fontSize:u=14,fontWeightLight:g=300,fontWeightRegular:_=400,fontWeightMedium:M=500,fontWeightBold:D=700,htmlFontSize:i=16,allVariants:j,pxToRem:H,...q}=typeof r=="function"?r(e):r,X=u/14,se=H||(de=>`${de/i*X}rem`),ne=(de,te,Q,K,ce)=>({fontFamily:a,fontWeight:de,fontSize:se(te),lineHeight:Q,...a===sA?{letterSpacing:`${MV(K/te)}em`}:{},...ce,...j}),le={h1:ne(g,96,1.167,-1.5),h2:ne(g,60,1.2,-.5),h3:ne(_,48,1.167,0),h4:ne(_,34,1.235,.25),h5:ne(_,24,1.334,0),h6:ne(M,20,1.6,.15),subtitle1:ne(_,16,1.75,.15),subtitle2:ne(M,14,1.57,.1),body1:ne(_,16,1.5,.15),body2:ne(_,14,1.43,.15),button:ne(M,14,1.75,.4,oA),caption:ne(_,12,1.66,.4),overline:ne(_,12,2.66,1,oA),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Co({htmlFontSize:i,pxToRem:se,fontFamily:a,fontSize:u,fontWeightLight:g,fontWeightRegular:_,fontWeightMedium:M,fontWeightBold:D,...le},q,{clone:!1})}const EV=.2,IV=.14,kV=.12;function Ni(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${EV})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${IV})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${kV})`].join(",")}const PV=["none",Ni(0,2,1,-1,0,1,1,0,0,1,3,0),Ni(0,3,1,-2,0,2,2,0,0,1,5,0),Ni(0,3,3,-2,0,3,4,0,0,1,8,0),Ni(0,2,4,-1,0,4,5,0,0,1,10,0),Ni(0,3,5,-1,0,5,8,0,0,1,14,0),Ni(0,3,5,-1,0,6,10,0,0,1,18,0),Ni(0,4,5,-2,0,7,10,1,0,2,16,1),Ni(0,5,5,-3,0,8,10,1,0,3,14,2),Ni(0,5,6,-3,0,9,12,1,0,3,16,2),Ni(0,6,6,-3,0,10,14,1,0,4,18,3),Ni(0,6,7,-4,0,11,15,1,0,4,20,3),Ni(0,7,8,-4,0,12,17,2,0,5,22,4),Ni(0,7,8,-4,0,13,19,2,0,5,24,4),Ni(0,7,9,-4,0,14,21,2,0,5,26,4),Ni(0,8,9,-5,0,15,22,2,0,6,28,5),Ni(0,8,10,-5,0,16,24,2,0,6,30,5),Ni(0,8,11,-5,0,17,26,2,0,6,32,5),Ni(0,9,11,-5,0,18,28,2,0,7,34,6),Ni(0,9,12,-6,0,19,29,2,0,7,36,6),Ni(0,10,13,-6,0,20,31,3,0,8,38,7),Ni(0,10,13,-6,0,21,33,3,0,8,40,7),Ni(0,10,14,-6,0,22,35,3,0,8,42,7),Ni(0,11,14,-7,0,23,36,3,0,9,44,8),Ni(0,11,15,-7,0,24,38,3,0,9,46,8)],AV={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Mz={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function aA(e){return`${Math.round(e)}ms`}function DV(e){if(!e)return 0;const r=e/36;return Math.min(Math.round((4+15*r**.25+r/5)*10),3e3)}function RV(e){const r={...AV,...e.easing},a={...Mz,...e.duration};return{getAutoHeightDuration:DV,create:(g=["all"],_={})=>{const{duration:M=a.standard,easing:D=r.easeInOut,delay:i=0,...j}=_;return(Array.isArray(g)?g:[g]).map(H=>`${H} ${typeof M=="string"?M:aA(M)} ${D} ${typeof i=="string"?i:aA(i)}`).join(",")},...e,easing:r,duration:a}}const LV={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function aT(e={},...r){const{breakpoints:a,mixins:u={},spacing:g,palette:_={},transitions:M={},typography:D={},shape:i,...j}=e;if(e.vars)throw new Error(gc(20));const H=OC(_),q=Ry(e);let X=Co(q,{mixins:CV(q.breakpoints,u),palette:H,shadows:PV.slice(),typography:Cz(H,D),transitions:RV(M),zIndex:{...LV}});return X=Co(X,j),X=r.reduce((se,ne)=>Co(se,ne),X),X.unstable_sxConfig={...Dy,...j==null?void 0:j.unstable_sxConfig},X.unstable_sx=function(ne){return Du({sx:ne,theme:this})},X}function lT(e){let r;return e<1?r=5.11916*e**2:r=4.5*Math.log(e+1)+2,Math.round(r*10)/1e3}const zV=[...Array(25)].map((e,r)=>{if(r===0)return"none";const a=lT(r);return`linear-gradient(rgba(255 255 255 / ${a}), rgba(255 255 255 / ${a}))`});function Ez(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function Iz(e){return e==="dark"?zV:[]}function OV(e){const{palette:r={mode:"light"},opacity:a,overlays:u,...g}=e,_=OC(r);return{palette:_,opacity:{...Ez(_.mode),...a},overlays:u||Iz(_.mode),...g}}function FV(e){var r;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((r=e[1])!=null&&r.match(/(mode|contrastThreshold|tonalOffset)/))}const BV=e=>[...[...Array(25)].map((r,a)=>`--${e?`${e}-`:""}overlays-${a}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],jV=e=>(r,a)=>{const u=e.rootSelector||":root",g=e.colorSchemeSelector;let _=g;if(g==="class"&&(_=".%s"),g==="data"&&(_="[data-%s]"),g!=null&&g.startsWith("data-")&&!g.includes("%s")&&(_=`[${g}="%s"]`),e.defaultColorScheme===r){if(r==="dark"){const M={};return BV(e.cssVarPrefix).forEach(D=>{M[D]=a[D],delete a[D]}),_==="media"?{[u]:a,"@media (prefers-color-scheme: dark)":{[u]:M}}:_?{[_.replace("%s",r)]:M,[`${u}, ${_.replace("%s",r)}`]:a}:{[u]:{...a,...M}}}if(_&&_!=="media")return`${u}, ${_.replace("%s",String(r))}`}else if(r){if(_==="media")return{[`@media (prefers-color-scheme: ${String(r)})`]:{[u]:a}};if(_)return _.replace("%s",String(r))}return u};function NV(e){return Rl(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function VV(e={}){const r={...e};function a(u){const g=Object.entries(u);for(let _=0;_<g.length;_++){const[M,D]=g[_];!NV(D)||M.startsWith("unstable_")?delete u[M]:Rl(D)&&(u[M]={...D},a(u[M]))}}return a(r),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(r,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function $V(e,r){r.forEach(a=>{e[a]||(e[a]={})})}function Qt(e,r,a){!e[r]&&a&&(e[r]=a)}function zg(e){return!e||!e.startsWith("hsl")?e:uz(e)}function ic(e,r){`${r}Channel`in e||(e[`${r}Channel`]=Lg(zg(e[r]),`MUI: Can't create \`palette.${r}Channel\` because \`palette.${r}\` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().
To suppress this warning, you need to explicitly provide the \`palette.${r}Channel\` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.`))}function UV(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Cl=e=>{try{return e()}catch{}},WV=(e="mui")=>W6(e);function Xw(e,r,a,u){if(!r)return;r=r===!0?{}:r;const g=u==="dark"?"dark":"light";if(!a){e[u]=OV({...r,palette:{mode:g,...r==null?void 0:r.palette}});return}const{palette:_,...M}=aT({...a,palette:{mode:g,...r==null?void 0:r.palette}});return e[u]={...r,palette:_,opacity:{...Ez(g),...r==null?void 0:r.opacity},overlays:(r==null?void 0:r.overlays)||Iz(g)},M}function GV(e={},...r){const{colorSchemes:a={light:!0},defaultColorScheme:u,disableCssColorScheme:g=!1,cssVarPrefix:_="mui",shouldSkipGeneratingVar:M=FV,colorSchemeSelector:D=a.light&&a.dark?"media":void 0,rootSelector:i=":root",...j}=e,H=Object.keys(a)[0],q=u||(a.light&&H!=="light"?"light":H),X=WV(_),{[q]:se,light:ne,dark:le,...de}=a,te={...de};let Q=se;if((q==="dark"&&!("dark"in a)||q==="light"&&!("light"in a))&&(Q=!0),!Q)throw new Error(gc(21,q));const K=Xw(te,Q,j,q);ne&&!te.light&&Xw(te,ne,void 0,"light"),le&&!te.dark&&Xw(te,le,void 0,"dark");let ce={defaultColorScheme:q,...K,cssVarPrefix:_,colorSchemeSelector:D,rootSelector:i,getCssVar:X,colorSchemes:te,font:{...TV(K.typography),...K.font},spacing:UV(j.spacing)};Object.keys(ce.colorSchemes).forEach(ot=>{const oe=ce.colorSchemes[ot].palette,ve=je=>{const He=je.split("-"),Le=He[1],ze=He[2];return X(je,oe[Le][ze])};if(oe.mode==="light"&&(Qt(oe.common,"background","#fff"),Qt(oe.common,"onBackground","#000")),oe.mode==="dark"&&(Qt(oe.common,"background","#000"),Qt(oe.common,"onBackground","#fff")),$V(oe,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),oe.mode==="light"){Qt(oe.Alert,"errorColor",Ci(oe.error.light,.6)),Qt(oe.Alert,"infoColor",Ci(oe.info.light,.6)),Qt(oe.Alert,"successColor",Ci(oe.success.light,.6)),Qt(oe.Alert,"warningColor",Ci(oe.warning.light,.6)),Qt(oe.Alert,"errorFilledBg",ve("palette-error-main")),Qt(oe.Alert,"infoFilledBg",ve("palette-info-main")),Qt(oe.Alert,"successFilledBg",ve("palette-success-main")),Qt(oe.Alert,"warningFilledBg",ve("palette-warning-main")),Qt(oe.Alert,"errorFilledColor",Cl(()=>oe.getContrastText(oe.error.main))),Qt(oe.Alert,"infoFilledColor",Cl(()=>oe.getContrastText(oe.info.main))),Qt(oe.Alert,"successFilledColor",Cl(()=>oe.getContrastText(oe.success.main))),Qt(oe.Alert,"warningFilledColor",Cl(()=>oe.getContrastText(oe.warning.main))),Qt(oe.Alert,"errorStandardBg",Mi(oe.error.light,.9)),Qt(oe.Alert,"infoStandardBg",Mi(oe.info.light,.9)),Qt(oe.Alert,"successStandardBg",Mi(oe.success.light,.9)),Qt(oe.Alert,"warningStandardBg",Mi(oe.warning.light,.9)),Qt(oe.Alert,"errorIconColor",ve("palette-error-main")),Qt(oe.Alert,"infoIconColor",ve("palette-info-main")),Qt(oe.Alert,"successIconColor",ve("palette-success-main")),Qt(oe.Alert,"warningIconColor",ve("palette-warning-main")),Qt(oe.AppBar,"defaultBg",ve("palette-grey-100")),Qt(oe.Avatar,"defaultBg",ve("palette-grey-400")),Qt(oe.Button,"inheritContainedBg",ve("palette-grey-300")),Qt(oe.Button,"inheritContainedHoverBg",ve("palette-grey-A100")),Qt(oe.Chip,"defaultBorder",ve("palette-grey-400")),Qt(oe.Chip,"defaultAvatarColor",ve("palette-grey-700")),Qt(oe.Chip,"defaultIconColor",ve("palette-grey-700")),Qt(oe.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Qt(oe.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Qt(oe.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Qt(oe.LinearProgress,"primaryBg",Mi(oe.primary.main,.62)),Qt(oe.LinearProgress,"secondaryBg",Mi(oe.secondary.main,.62)),Qt(oe.LinearProgress,"errorBg",Mi(oe.error.main,.62)),Qt(oe.LinearProgress,"infoBg",Mi(oe.info.main,.62)),Qt(oe.LinearProgress,"successBg",Mi(oe.success.main,.62)),Qt(oe.LinearProgress,"warningBg",Mi(oe.warning.main,.62)),Qt(oe.Skeleton,"bg",`rgba(${ve("palette-text-primaryChannel")} / 0.11)`),Qt(oe.Slider,"primaryTrack",Mi(oe.primary.main,.62)),Qt(oe.Slider,"secondaryTrack",Mi(oe.secondary.main,.62)),Qt(oe.Slider,"errorTrack",Mi(oe.error.main,.62)),Qt(oe.Slider,"infoTrack",Mi(oe.info.main,.62)),Qt(oe.Slider,"successTrack",Mi(oe.success.main,.62)),Qt(oe.Slider,"warningTrack",Mi(oe.warning.main,.62));const je=Q0(oe.background.default,.8);Qt(oe.SnackbarContent,"bg",je),Qt(oe.SnackbarContent,"color",Cl(()=>oe.getContrastText(je))),Qt(oe.SpeedDialAction,"fabHoverBg",Q0(oe.background.paper,.15)),Qt(oe.StepConnector,"border",ve("palette-grey-400")),Qt(oe.StepContent,"border",ve("palette-grey-400")),Qt(oe.Switch,"defaultColor",ve("palette-common-white")),Qt(oe.Switch,"defaultDisabledColor",ve("palette-grey-100")),Qt(oe.Switch,"primaryDisabledColor",Mi(oe.primary.main,.62)),Qt(oe.Switch,"secondaryDisabledColor",Mi(oe.secondary.main,.62)),Qt(oe.Switch,"errorDisabledColor",Mi(oe.error.main,.62)),Qt(oe.Switch,"infoDisabledColor",Mi(oe.info.main,.62)),Qt(oe.Switch,"successDisabledColor",Mi(oe.success.main,.62)),Qt(oe.Switch,"warningDisabledColor",Mi(oe.warning.main,.62)),Qt(oe.TableCell,"border",Mi(J0(oe.divider,1),.88)),Qt(oe.Tooltip,"bg",J0(oe.grey[700],.92))}if(oe.mode==="dark"){Qt(oe.Alert,"errorColor",Mi(oe.error.light,.6)),Qt(oe.Alert,"infoColor",Mi(oe.info.light,.6)),Qt(oe.Alert,"successColor",Mi(oe.success.light,.6)),Qt(oe.Alert,"warningColor",Mi(oe.warning.light,.6)),Qt(oe.Alert,"errorFilledBg",ve("palette-error-dark")),Qt(oe.Alert,"infoFilledBg",ve("palette-info-dark")),Qt(oe.Alert,"successFilledBg",ve("palette-success-dark")),Qt(oe.Alert,"warningFilledBg",ve("palette-warning-dark")),Qt(oe.Alert,"errorFilledColor",Cl(()=>oe.getContrastText(oe.error.dark))),Qt(oe.Alert,"infoFilledColor",Cl(()=>oe.getContrastText(oe.info.dark))),Qt(oe.Alert,"successFilledColor",Cl(()=>oe.getContrastText(oe.success.dark))),Qt(oe.Alert,"warningFilledColor",Cl(()=>oe.getContrastText(oe.warning.dark))),Qt(oe.Alert,"errorStandardBg",Ci(oe.error.light,.9)),Qt(oe.Alert,"infoStandardBg",Ci(oe.info.light,.9)),Qt(oe.Alert,"successStandardBg",Ci(oe.success.light,.9)),Qt(oe.Alert,"warningStandardBg",Ci(oe.warning.light,.9)),Qt(oe.Alert,"errorIconColor",ve("palette-error-main")),Qt(oe.Alert,"infoIconColor",ve("palette-info-main")),Qt(oe.Alert,"successIconColor",ve("palette-success-main")),Qt(oe.Alert,"warningIconColor",ve("palette-warning-main")),Qt(oe.AppBar,"defaultBg",ve("palette-grey-900")),Qt(oe.AppBar,"darkBg",ve("palette-background-paper")),Qt(oe.AppBar,"darkColor",ve("palette-text-primary")),Qt(oe.Avatar,"defaultBg",ve("palette-grey-600")),Qt(oe.Button,"inheritContainedBg",ve("palette-grey-800")),Qt(oe.Button,"inheritContainedHoverBg",ve("palette-grey-700")),Qt(oe.Chip,"defaultBorder",ve("palette-grey-700")),Qt(oe.Chip,"defaultAvatarColor",ve("palette-grey-300")),Qt(oe.Chip,"defaultIconColor",ve("palette-grey-300")),Qt(oe.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Qt(oe.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Qt(oe.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Qt(oe.LinearProgress,"primaryBg",Ci(oe.primary.main,.5)),Qt(oe.LinearProgress,"secondaryBg",Ci(oe.secondary.main,.5)),Qt(oe.LinearProgress,"errorBg",Ci(oe.error.main,.5)),Qt(oe.LinearProgress,"infoBg",Ci(oe.info.main,.5)),Qt(oe.LinearProgress,"successBg",Ci(oe.success.main,.5)),Qt(oe.LinearProgress,"warningBg",Ci(oe.warning.main,.5)),Qt(oe.Skeleton,"bg",`rgba(${ve("palette-text-primaryChannel")} / 0.13)`),Qt(oe.Slider,"primaryTrack",Ci(oe.primary.main,.5)),Qt(oe.Slider,"secondaryTrack",Ci(oe.secondary.main,.5)),Qt(oe.Slider,"errorTrack",Ci(oe.error.main,.5)),Qt(oe.Slider,"infoTrack",Ci(oe.info.main,.5)),Qt(oe.Slider,"successTrack",Ci(oe.success.main,.5)),Qt(oe.Slider,"warningTrack",Ci(oe.warning.main,.5));const je=Q0(oe.background.default,.98);Qt(oe.SnackbarContent,"bg",je),Qt(oe.SnackbarContent,"color",Cl(()=>oe.getContrastText(je))),Qt(oe.SpeedDialAction,"fabHoverBg",Q0(oe.background.paper,.15)),Qt(oe.StepConnector,"border",ve("palette-grey-600")),Qt(oe.StepContent,"border",ve("palette-grey-600")),Qt(oe.Switch,"defaultColor",ve("palette-grey-300")),Qt(oe.Switch,"defaultDisabledColor",ve("palette-grey-600")),Qt(oe.Switch,"primaryDisabledColor",Ci(oe.primary.main,.55)),Qt(oe.Switch,"secondaryDisabledColor",Ci(oe.secondary.main,.55)),Qt(oe.Switch,"errorDisabledColor",Ci(oe.error.main,.55)),Qt(oe.Switch,"infoDisabledColor",Ci(oe.info.main,.55)),Qt(oe.Switch,"successDisabledColor",Ci(oe.success.main,.55)),Qt(oe.Switch,"warningDisabledColor",Ci(oe.warning.main,.55)),Qt(oe.TableCell,"border",Ci(J0(oe.divider,1),.68)),Qt(oe.Tooltip,"bg",J0(oe.grey[700],.92))}ic(oe.background,"default"),ic(oe.background,"paper"),ic(oe.common,"background"),ic(oe.common,"onBackground"),ic(oe,"divider"),Object.keys(oe).forEach(je=>{const He=oe[je];He&&typeof He=="object"&&(He.main&&Qt(oe[je],"mainChannel",Lg(zg(He.main))),He.light&&Qt(oe[je],"lightChannel",Lg(zg(He.light))),He.dark&&Qt(oe[je],"darkChannel",Lg(zg(He.dark))),He.contrastText&&Qt(oe[je],"contrastTextChannel",Lg(zg(He.contrastText))),je==="text"&&(ic(oe[je],"primary"),ic(oe[je],"secondary")),je==="action"&&(He.active&&ic(oe[je],"active"),He.selected&&ic(oe[je],"selected")))})}),ce=r.reduce((ot,oe)=>Co(ot,oe),ce);const fe={prefix:_,disableCssColorScheme:g,shouldSkipGeneratingVar:M,getSelector:jV(ce)},{vars:Ie,generateThemeVars:Ce,generateStyleSheets:we}=q6(ce,fe);return ce.vars=Ie,Object.entries(ce.colorSchemes[ce.defaultColorScheme]).forEach(([ot,oe])=>{ce[ot]=oe}),ce.generateThemeVars=Ce,ce.generateStyleSheets=we,ce.generateSpacing=function(){return ez(j.spacing,Jv(this))},ce.getColorSchemeSelector=Z6(D),ce.spacing=ce.generateSpacing(),ce.shouldSkipGeneratingVar=M,ce.unstable_sxConfig={...Dy,...j==null?void 0:j.unstable_sxConfig},ce.unstable_sx=function(oe){return Du({sx:oe,theme:this})},ce.toRuntimeSource=VV,ce}function lA(e,r,a){e.colorSchemes&&a&&(e.colorSchemes[r]={...a!==!0&&a,palette:OC({...a===!0?{}:a.palette,mode:r})})}function Oy(e={},...r){const{palette:a,cssVariables:u=!1,colorSchemes:g=a?void 0:{light:!0},defaultColorScheme:_=a==null?void 0:a.mode,...M}=e,D=_||"light",i=g==null?void 0:g[D],j={...g,...a?{[D]:{...typeof i!="boolean"&&i,palette:a}}:void 0};if(u===!1){if(!("colorSchemes"in e))return aT(e,...r);let H=a;"palette"in e||j[D]&&(j[D]!==!0?H=j[D].palette:D==="dark"&&(H={mode:"dark"}));const q=aT({...e,palette:H},...r);return q.defaultColorScheme=D,q.colorSchemes=j,q.palette.mode==="light"&&(q.colorSchemes.light={...j.light!==!0&&j.light,palette:q.palette},lA(q,"dark",j.dark)),q.palette.mode==="dark"&&(q.colorSchemes.dark={...j.dark!==!0&&j.dark,palette:q.palette},lA(q,"light",j.light)),q}return!a&&!("light"in j)&&D==="light"&&(j.light=!0),GV({...M,colorSchemes:j,defaultColorScheme:D,...typeof u!="boolean"&&u},...r)}const y1=Oy();function jl(){const e=Ly(y1);return e[Ka]||e}function oi({props:e,name:r}){return IC({props:e,name:r,defaultTheme:y1,themeId:Ka})}function _1(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Qo=e=>_1(e)&&e!=="classes",bt=sz({themeId:Ka,defaultTheme:y1,rootShouldForwardProp:Qo});function cA({theme:e,...r}){const a=Ka in e?e[Ka]:void 0;return L.jsx(vz,{...r,themeId:a?Ka:void 0,theme:a||e})}const ex={attribute:"data-mui-color-scheme",colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:HV,useColorScheme:qV,getInitColorSchemeScript:_X}=U6({themeId:Ka,theme:()=>Oy({cssVariables:!0}),colorSchemeStorageKey:ex.colorSchemeStorageKey,modeStorageKey:ex.modeStorageKey,defaultColorScheme:{light:ex.defaultLightColorScheme,dark:ex.defaultDarkColorScheme},resolveTheme:e=>{const r={...e,typography:Cz(e.palette,e.typography)};return r.unstable_sx=function(u){return Du({sx:u,theme:this})},r}}),ZV=HV;function kz({theme:e,...r}){return typeof e=="function"?L.jsx(cA,{theme:e,...r}):"colorSchemes"in(Ka in e?e[Ka]:e)?L.jsx(ZV,{theme:e,...r}):L.jsx(cA,{theme:e,...r})}const YV=Y.createContext(null),Kw={didCatch:!1,error:null};class cT extends Y.Component{constructor(r){super(r),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Kw}static getDerivedStateFromError(r){return{didCatch:!0,error:r}}resetErrorBoundary(){const{error:r}=this.state;if(r!==null){for(var a,u,g=arguments.length,_=new Array(g),M=0;M<g;M++)_[M]=arguments[M];(a=(u=this.props).onReset)===null||a===void 0||a.call(u,{args:_,reason:"imperative-api"}),this.setState(Kw)}}componentDidCatch(r,a){var u,g;(u=(g=this.props).onError)===null||u===void 0||u.call(g,r,a)}componentDidUpdate(r,a){const{didCatch:u}=this.state,{resetKeys:g}=this.props;if(u&&a.error!==null&&XV(r.resetKeys,g)){var _,M;(_=(M=this.props).onReset)===null||_===void 0||_.call(M,{next:g,prev:r.resetKeys,reason:"keys"}),this.setState(Kw)}}render(){const{children:r,fallbackRender:a,FallbackComponent:u,fallback:g}=this.props,{didCatch:_,error:M}=this.state;let D=r;if(_){const i={error:M,resetErrorBoundary:this.resetErrorBoundary};if(typeof a=="function")D=a(i);else if(u)D=Y.createElement(u,i);else if(g!==void 0)D=g;else throw M}return Y.createElement(YV.Provider,{value:{didCatch:_,error:M,resetErrorBoundary:this.resetErrorBoundary}},D)}}function XV(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==r.length||e.some((a,u)=>!Object.is(a,r[u]))}function KV(e){return L.jsx(t6,{...e,defaultTheme:y1,themeId:Ka})}function JV(e){return function(a){return L.jsx(KV,{styles:typeof e=="function"?u=>e({theme:u,...a}):e})}}function QV(){return i1}const ln=F6;function _n(e){return O6(e)}function e$(e){return Ir("MuiSvgIcon",e)}Mr("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const t$=e=>{const{color:r,fontSize:a,classes:u}=e,g={root:["root",r!=="inherit"&&`color${tr(r)}`,`fontSize${tr(a)}`]};return Er(g,e$,u)},r$=bt("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.color!=="inherit"&&r[`color${tr(a.color)}`],r[`fontSize${tr(a.fontSize)}`]]}})(ln(({theme:e})=>{var r,a,u,g,_,M,D,i,j,H,q,X,se,ne;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(g=(r=e.transitions)==null?void 0:r.create)==null?void 0:g.call(r,"fill",{duration:(u=(a=(e.vars??e).transitions)==null?void 0:a.duration)==null?void 0:u.shorter}),variants:[{props:le=>!le.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((M=(_=e.typography)==null?void 0:_.pxToRem)==null?void 0:M.call(_,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((i=(D=e.typography)==null?void 0:D.pxToRem)==null?void 0:i.call(D,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((H=(j=e.typography)==null?void 0:j.pxToRem)==null?void 0:H.call(j,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,le])=>le&&le.main).map(([le])=>{var de,te;return{props:{color:le},style:{color:(te=(de=(e.vars??e).palette)==null?void 0:de[le])==null?void 0:te.main}}}),{props:{color:"action"},style:{color:(X=(q=(e.vars??e).palette)==null?void 0:q.action)==null?void 0:X.active}},{props:{color:"disabled"},style:{color:(ne=(se=(e.vars??e).palette)==null?void 0:se.action)==null?void 0:ne.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),av=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiSvgIcon"}),{children:g,className:_,color:M="inherit",component:D="svg",fontSize:i="medium",htmlColor:j,inheritViewBox:H=!1,titleAccess:q,viewBox:X="0 0 24 24",...se}=u,ne=Y.isValidElement(g)&&g.type==="svg",le={...u,color:M,component:D,fontSize:i,instanceFontSize:r.fontSize,inheritViewBox:H,viewBox:X,hasSvgAsChild:ne},de={};H||(de.viewBox=X);const te=t$(le);return L.jsxs(r$,{as:D,className:rr(te.root,_),focusable:"false",color:j,"aria-hidden":q?void 0:!0,role:q?"img":void 0,ref:a,...de,...se,...ne&&g.props,ownerState:le,children:[ne?g.props.children:g,q?L.jsx("title",{children:q}):null]})});av&&(av.muiName="SvgIcon");function si(e,r){function a(u,g){return L.jsx(av,{"data-testid":`${r}Icon`,ref:g,...u,children:e})}return a.muiName=av.muiName,Y.memo(Y.forwardRef(a))}const n$=si(L.jsx("path",{d:"m20.5 3-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z"}),"Map"),tx=si(L.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"}),"ReportProblem");function Sn(e,r){if(e==null)return{};var a={};for(var u in e)if({}.hasOwnProperty.call(e,u)){if(r.indexOf(u)!==-1)continue;a[u]=e[u]}return a}function uT(e,r){return uT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,u){return a.__proto__=u,a},uT(e,r)}function FC(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,uT(e,r)}function i$(e,r){return e.classList?!!r&&e.classList.contains(r):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+r+" ")!==-1}function o$(e,r){e.classList?e.classList.add(r):i$(e,r)||(typeof e.className=="string"?e.className=e.className+" "+r:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+r))}function uA(e,r){return e.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function s$(e,r){e.classList?e.classList.remove(r):typeof e.className=="string"?e.className=uA(e.className,r):e.setAttribute("class",uA(e.className&&e.className.baseVal||"",r))}const dA={disabled:!1},lv=Fn.createContext(null);var Pz=function(r){return r.scrollTop},Og="unmounted",zd="exited",Od="entering",Tp="entered",dT="exiting",Ks=function(e){FC(r,e);function r(u,g){var _;_=e.call(this,u,g)||this;var M=g,D=M&&!M.isMounting?u.enter:u.appear,i;return _.appearStatus=null,u.in?D?(i=zd,_.appearStatus=Od):i=Tp:u.unmountOnExit||u.mountOnEnter?i=Og:i=zd,_.state={status:i},_.nextCallback=null,_}r.getDerivedStateFromProps=function(g,_){var M=g.in;return M&&_.status===Og?{status:zd}:null};var a=r.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(g){var _=null;if(g!==this.props){var M=this.state.status;this.props.in?M!==Od&&M!==Tp&&(_=Od):(M===Od||M===Tp)&&(_=dT)}this.updateStatus(!1,_)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var g=this.props.timeout,_,M,D;return _=M=D=g,g!=null&&typeof g!="number"&&(_=g.exit,M=g.enter,D=g.appear!==void 0?g.appear:M),{exit:_,enter:M,appear:D}},a.updateStatus=function(g,_){if(g===void 0&&(g=!1),_!==null)if(this.cancelNextCallback(),_===Od){if(this.props.unmountOnExit||this.props.mountOnEnter){var M=this.props.nodeRef?this.props.nodeRef.current:X0.findDOMNode(this);M&&Pz(M)}this.performEnter(g)}else this.performExit();else this.props.unmountOnExit&&this.state.status===zd&&this.setState({status:Og})},a.performEnter=function(g){var _=this,M=this.props.enter,D=this.context?this.context.isMounting:g,i=this.props.nodeRef?[D]:[X0.findDOMNode(this),D],j=i[0],H=i[1],q=this.getTimeouts(),X=D?q.appear:q.enter;if(!g&&!M||dA.disabled){this.safeSetState({status:Tp},function(){_.props.onEntered(j)});return}this.props.onEnter(j,H),this.safeSetState({status:Od},function(){_.props.onEntering(j,H),_.onTransitionEnd(X,function(){_.safeSetState({status:Tp},function(){_.props.onEntered(j,H)})})})},a.performExit=function(){var g=this,_=this.props.exit,M=this.getTimeouts(),D=this.props.nodeRef?void 0:X0.findDOMNode(this);if(!_||dA.disabled){this.safeSetState({status:zd},function(){g.props.onExited(D)});return}this.props.onExit(D),this.safeSetState({status:dT},function(){g.props.onExiting(D),g.onTransitionEnd(M.exit,function(){g.safeSetState({status:zd},function(){g.props.onExited(D)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(g,_){_=this.setNextCallback(_),this.setState(g,_)},a.setNextCallback=function(g){var _=this,M=!0;return this.nextCallback=function(D){M&&(M=!1,_.nextCallback=null,g(D))},this.nextCallback.cancel=function(){M=!1},this.nextCallback},a.onTransitionEnd=function(g,_){this.setNextCallback(_);var M=this.props.nodeRef?this.props.nodeRef.current:X0.findDOMNode(this),D=g==null&&!this.props.addEndListener;if(!M||D){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[M,this.nextCallback],j=i[0],H=i[1];this.props.addEndListener(j,H)}g!=null&&setTimeout(this.nextCallback,g)},a.render=function(){var g=this.state.status;if(g===Og)return null;var _=this.props,M=_.children;_.in,_.mountOnEnter,_.unmountOnExit,_.appear,_.enter,_.exit,_.timeout,_.addEndListener,_.onEnter,_.onEntering,_.onEntered,_.onExit,_.onExiting,_.onExited,_.nodeRef;var D=Sn(_,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Fn.createElement(lv.Provider,{value:null},typeof M=="function"?M(g,D):Fn.cloneElement(Fn.Children.only(M),D))},r}(Fn.Component);Ks.contextType=lv;Ks.propTypes={};function vp(){}Ks.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:vp,onEntering:vp,onEntered:vp,onExit:vp,onExiting:vp,onExited:vp};Ks.UNMOUNTED=Og;Ks.EXITED=zd;Ks.ENTERING=Od;Ks.ENTERED=Tp;Ks.EXITING=dT;var a$=function(r,a){return r&&a&&a.split(" ").forEach(function(u){return o$(r,u)})},Jw=function(r,a){return r&&a&&a.split(" ").forEach(function(u){return s$(r,u)})},BC=function(e){FC(r,e);function r(){for(var u,g=arguments.length,_=new Array(g),M=0;M<g;M++)_[M]=arguments[M];return u=e.call.apply(e,[this].concat(_))||this,u.appliedClasses={appear:{},enter:{},exit:{}},u.onEnter=function(D,i){var j=u.resolveArguments(D,i),H=j[0],q=j[1];u.removeClasses(H,"exit"),u.addClass(H,q?"appear":"enter","base"),u.props.onEnter&&u.props.onEnter(D,i)},u.onEntering=function(D,i){var j=u.resolveArguments(D,i),H=j[0],q=j[1],X=q?"appear":"enter";u.addClass(H,X,"active"),u.props.onEntering&&u.props.onEntering(D,i)},u.onEntered=function(D,i){var j=u.resolveArguments(D,i),H=j[0],q=j[1],X=q?"appear":"enter";u.removeClasses(H,X),u.addClass(H,X,"done"),u.props.onEntered&&u.props.onEntered(D,i)},u.onExit=function(D){var i=u.resolveArguments(D),j=i[0];u.removeClasses(j,"appear"),u.removeClasses(j,"enter"),u.addClass(j,"exit","base"),u.props.onExit&&u.props.onExit(D)},u.onExiting=function(D){var i=u.resolveArguments(D),j=i[0];u.addClass(j,"exit","active"),u.props.onExiting&&u.props.onExiting(D)},u.onExited=function(D){var i=u.resolveArguments(D),j=i[0];u.removeClasses(j,"exit"),u.addClass(j,"exit","done"),u.props.onExited&&u.props.onExited(D)},u.resolveArguments=function(D,i){return u.props.nodeRef?[u.props.nodeRef.current,D]:[D,i]},u.getClassNames=function(D){var i=u.props.classNames,j=typeof i=="string",H=j&&i?i+"-":"",q=j?""+H+D:i[D],X=j?q+"-active":i[D+"Active"],se=j?q+"-done":i[D+"Done"];return{baseClassName:q,activeClassName:X,doneClassName:se}},u}var a=r.prototype;return a.addClass=function(g,_,M){var D=this.getClassNames(_)[M+"ClassName"],i=this.getClassNames("enter"),j=i.doneClassName;_==="appear"&&M==="done"&&j&&(D+=" "+j),M==="active"&&g&&Pz(g),D&&(this.appliedClasses[_][M]=D,a$(g,D))},a.removeClasses=function(g,_){var M=this.appliedClasses[_],D=M.base,i=M.active,j=M.done;this.appliedClasses[_]={},D&&Jw(g,D),i&&Jw(g,i),j&&Jw(g,j)},a.render=function(){var g=this.props;g.classNames;var _=Sn(g,["classNames"]);return Fn.createElement(Ks,vt({},_,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r}(Fn.Component);BC.defaultProps={classNames:""};BC.propTypes={};function l$(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jC(e,r){var a=function(_){return r&&Y.isValidElement(_)?r(_):_},u=Object.create(null);return e&&Y.Children.map(e,function(g){return g}).forEach(function(g){u[g.key]=a(g)}),u}function c$(e,r){e=e||{},r=r||{};function a(H){return H in r?r[H]:e[H]}var u=Object.create(null),g=[];for(var _ in e)_ in r?g.length&&(u[_]=g,g=[]):g.push(_);var M,D={};for(var i in r){if(u[i])for(M=0;M<u[i].length;M++){var j=u[i][M];D[u[i][M]]=a(j)}D[i]=a(i)}for(M=0;M<g.length;M++)D[g[M]]=a(g[M]);return D}function Nd(e,r,a){return a[r]!=null?a[r]:e.props[r]}function u$(e,r){return jC(e.children,function(a){return Y.cloneElement(a,{onExited:r.bind(null,a),in:!0,appear:Nd(a,"appear",e),enter:Nd(a,"enter",e),exit:Nd(a,"exit",e)})})}function d$(e,r,a){var u=jC(e.children),g=c$(r,u);return Object.keys(g).forEach(function(_){var M=g[_];if(Y.isValidElement(M)){var D=_ in r,i=_ in u,j=r[_],H=Y.isValidElement(j)&&!j.props.in;i&&(!D||H)?g[_]=Y.cloneElement(M,{onExited:a.bind(null,M),in:!0,exit:Nd(M,"exit",e),enter:Nd(M,"enter",e)}):!i&&D&&!H?g[_]=Y.cloneElement(M,{in:!1}):i&&D&&Y.isValidElement(j)&&(g[_]=Y.cloneElement(M,{onExited:a.bind(null,M),in:j.props.in,exit:Nd(M,"exit",e),enter:Nd(M,"enter",e)}))}}),g}var h$=Object.values||function(e){return Object.keys(e).map(function(r){return e[r]})},p$={component:"div",childFactory:function(r){return r}},Fy=function(e){FC(r,e);function r(u,g){var _;_=e.call(this,u,g)||this;var M=_.handleExited.bind(l$(_));return _.state={contextValue:{isMounting:!0},handleExited:M,firstRender:!0},_}var a=r.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(g,_){var M=_.children,D=_.handleExited,i=_.firstRender;return{children:i?u$(g,D):d$(g,M,D),firstRender:!1}},a.handleExited=function(g,_){var M=jC(this.props.children);g.key in M||(g.props.onExited&&g.props.onExited(_),this.mounted&&this.setState(function(D){var i=vt({},D.children);return delete i[g.key],{children:i}}))},a.render=function(){var g=this.props,_=g.component,M=g.childFactory,D=Sn(g,["component","childFactory"]),i=this.state.contextValue,j=h$(this.state.children).map(M);return delete D.appear,delete D.enter,delete D.exit,_===null?Fn.createElement(lv.Provider,{value:i},j):Fn.createElement(lv.Provider,{value:i},Fn.createElement(_,D,j))},r}(Fn.Component);Fy.propTypes={};Fy.defaultProps=p$;const NC=e=>e.scrollTop;function Lu(e,r){const{timeout:a,easing:u,style:g={}}=e;return{duration:g.transitionDuration??(typeof a=="number"?a:a[r.mode]||0),easing:g.transitionTimingFunction??(typeof u=="object"?u[r.mode]:u),delay:g.transitionDelay}}function f$(e){return Ir("MuiCollapse",e)}Mr("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const m$=e=>{const{orientation:r,classes:a}=e,u={root:["root",`${r}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${r}`],wrapperInner:["wrapperInner",`${r}`]};return Er(u,f$,a)},g$=bt("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.orientation],a.state==="entered"&&r.entered,a.state==="exited"&&!a.in&&a.collapsedSize==="0px"&&r.hidden]}})(ln(({theme:e})=>({height:0,overflow:"hidden",transition:e.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:e.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:r})=>r.state==="exited"&&!r.in&&r.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),y$=bt("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(e,r)=>r.wrapper})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),_$=bt("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(e,r)=>r.wrapperInner})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),bu=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiCollapse"}),{addEndListener:g,children:_,className:M,collapsedSize:D="0px",component:i,easing:j,in:H,onEnter:q,onEntered:X,onEntering:se,onExit:ne,onExited:le,onExiting:de,orientation:te="vertical",style:Q,timeout:K=Mz.standard,TransitionComponent:ce=Ks,...fe}=u,Ie={...u,orientation:te,collapsedSize:D},Ce=m$(Ie),we=jl(),ot=AC(),oe=Y.useRef(null),ve=Y.useRef(),je=typeof D=="number"?`${D}px`:D,He=te==="horizontal",Le=He?"width":"height",ze=Y.useRef(null),Pe=ai(a,ze),tt=It=>zt=>{if(It){const At=ze.current;zt===void 0?It(At):It(At,zt)}},De=()=>oe.current?oe.current[He?"clientWidth":"clientHeight"]:0,Ke=tt((It,zt)=>{oe.current&&He&&(oe.current.style.position="absolute"),It.style[Le]=je,q&&q(It,zt)}),Ge=tt((It,zt)=>{const At=De();oe.current&&He&&(oe.current.style.position="");const{duration:kt,easing:Ot}=Lu({style:Q,timeout:K,easing:j},{mode:"enter"});if(K==="auto"){const be=we.transitions.getAutoHeightDuration(At);It.style.transitionDuration=`${be}ms`,ve.current=be}else It.style.transitionDuration=typeof kt=="string"?kt:`${kt}ms`;It.style[Le]=`${At}px`,It.style.transitionTimingFunction=Ot,se&&se(It,zt)}),ft=tt((It,zt)=>{It.style[Le]="auto",X&&X(It,zt)}),Gt=tt(It=>{It.style[Le]=`${De()}px`,ne&&ne(It)}),Ft=tt(le),wt=tt(It=>{const zt=De(),{duration:At,easing:kt}=Lu({style:Q,timeout:K,easing:j},{mode:"exit"});if(K==="auto"){const Ot=we.transitions.getAutoHeightDuration(zt);It.style.transitionDuration=`${Ot}ms`,ve.current=Ot}else It.style.transitionDuration=typeof At=="string"?At:`${At}ms`;It.style[Le]=je,It.style.transitionTimingFunction=kt,de&&de(It)}),Rt=It=>{K==="auto"&&ot.start(ve.current||0,It),g&&g(ze.current,It)};return L.jsx(ce,{in:H,onEnter:Ke,onEntered:ft,onEntering:Ge,onExit:Gt,onExited:Ft,onExiting:wt,addEndListener:Rt,nodeRef:ze,timeout:K==="auto"?null:K,...fe,children:(It,zt)=>L.jsx(g$,{as:i,className:rr(Ce.root,M,{entered:Ce.entered,exited:!H&&je==="0px"&&Ce.hidden}[It]),style:{[He?"minWidth":"minHeight"]:je,...Q},ref:Pe,...zt,ownerState:{...Ie,state:It},children:L.jsx(y$,{ownerState:{...Ie,state:It},className:Ce.wrapper,ref:oe,children:L.jsx(_$,{ownerState:{...Ie,state:It},className:Ce.wrapperInner,children:_})})})})});bu&&(bu.muiSupportAuto=!0);function x$(e){return Ir("MuiPaper",e)}Mr("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const v$=e=>{const{square:r,elevation:a,variant:u,classes:g}=e,_={root:["root",u,!r&&"rounded",u==="elevation"&&`elevation${a}`]};return Er(_,x$,g)},b$=bt("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],!a.square&&r.rounded,a.variant==="elevation"&&r[`elevation${a.elevation}`]]}})(ln(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:r})=>!r.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),wf=Y.forwardRef(function(r,a){var se;const u=_n({props:r,name:"MuiPaper"}),g=jl(),{className:_,component:M="div",elevation:D=1,square:i=!1,variant:j="elevation",...H}=u,q={...u,component:M,elevation:D,square:i,variant:j},X=v$(q);return L.jsx(b$,{as:M,ownerState:q,className:rr(X.root,_),ref:a,...H,style:{...j==="elevation"&&{"--Paper-shadow":(g.vars||g).shadows[D],...g.vars&&{"--Paper-overlay":(se=g.vars.overlays)==null?void 0:se[D]},...!g.vars&&g.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Bn("#fff",lT(D))}, ${Bn("#fff",lT(D))})`}},...H.style}})});function _a(e,r){const{className:a,elementType:u,ownerState:g,externalForwardedProps:_,getSlotOwnerState:M,internalForwardedProps:D,...i}=r,{component:j,slots:H={[e]:void 0},slotProps:q={[e]:void 0},...X}=_,se=H[e]||u,ne=DC(q[e],g),{props:{component:le,...de},internalRef:te}=gz({className:a,...i,externalForwardedProps:e==="root"?X:void 0,externalSlotProps:ne}),Q=ai(te,ne==null?void 0:ne.ref,r.ref),K=M?M(de):{},ce={...g,...K},fe=e==="root"?le||j:le,Ie=mz(se,{...e==="root"&&!j&&!H[e]&&D,...e!=="root"&&!H[e]&&D,...de,...fe&&{as:fe},ref:Q},ce);return Object.keys(K).forEach(Ce=>{delete Ie[Ce]}),[se,Ie]}class cv{constructor(){lg(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new cv}static use(){const r=dz(cv.create).current,[a,u]=Y.useState(!1);return r.shouldMount=a,r.setShouldMount=u,Y.useEffect(r.mountEffect,[a]),r}mount(){return this.mounted||(this.mounted=S$(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...r){this.mount().then(()=>{var a;return(a=this.ref.current)==null?void 0:a.start(...r)})}stop(...r){this.mount().then(()=>{var a;return(a=this.ref.current)==null?void 0:a.stop(...r)})}pulsate(...r){this.mount().then(()=>{var a;return(a=this.ref.current)==null?void 0:a.pulsate(...r)})}}function w$(){return cv.use()}function S$(){let e,r;const a=new Promise((u,g)=>{e=u,r=g});return a.resolve=e,a.reject=r,a}function T$(e){const{className:r,classes:a,pulsate:u=!1,rippleX:g,rippleY:_,rippleSize:M,in:D,onExited:i,timeout:j}=e,[H,q]=Y.useState(!1),X=rr(r,a.ripple,a.rippleVisible,u&&a.ripplePulsate),se={width:M,height:M,top:-(M/2)+_,left:-(M/2)+g},ne=rr(a.child,H&&a.childLeaving,u&&a.childPulsate);return!D&&!H&&q(!0),Y.useEffect(()=>{if(!D&&i!=null){const le=setTimeout(i,j);return()=>{clearTimeout(le)}}},[i,D,j]),L.jsx("span",{className:X,style:se,children:L.jsx("span",{className:ne})})}const pa=Mr("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),hT=550,C$=80,M$=bC`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,E$=bC`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,I$=bC`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,k$=bt("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),P$=bt(T$,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${pa.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${M$};
    animation-duration: ${hT}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${pa.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${pa.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${pa.childLeaving} {
    opacity: 0;
    animation-name: ${E$};
    animation-duration: ${hT}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${pa.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${I$};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,A$=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiTouchRipple"}),{center:g=!1,classes:_={},className:M,...D}=u,[i,j]=Y.useState([]),H=Y.useRef(0),q=Y.useRef(null);Y.useEffect(()=>{q.current&&(q.current(),q.current=null)},[i]);const X=Y.useRef(!1),se=AC(),ne=Y.useRef(null),le=Y.useRef(null),de=Y.useCallback(ce=>{const{pulsate:fe,rippleX:Ie,rippleY:Ce,rippleSize:we,cb:ot}=ce;j(oe=>[...oe,L.jsx(P$,{classes:{ripple:rr(_.ripple,pa.ripple),rippleVisible:rr(_.rippleVisible,pa.rippleVisible),ripplePulsate:rr(_.ripplePulsate,pa.ripplePulsate),child:rr(_.child,pa.child),childLeaving:rr(_.childLeaving,pa.childLeaving),childPulsate:rr(_.childPulsate,pa.childPulsate)},timeout:hT,pulsate:fe,rippleX:Ie,rippleY:Ce,rippleSize:we},H.current)]),H.current+=1,q.current=ot},[_]),te=Y.useCallback((ce={},fe={},Ie=()=>{})=>{const{pulsate:Ce=!1,center:we=g||fe.pulsate,fakeElement:ot=!1}=fe;if((ce==null?void 0:ce.type)==="mousedown"&&X.current){X.current=!1;return}(ce==null?void 0:ce.type)==="touchstart"&&(X.current=!0);const oe=ot?null:le.current,ve=oe?oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let je,He,Le;if(we||ce===void 0||ce.clientX===0&&ce.clientY===0||!ce.clientX&&!ce.touches)je=Math.round(ve.width/2),He=Math.round(ve.height/2);else{const{clientX:ze,clientY:Pe}=ce.touches&&ce.touches.length>0?ce.touches[0]:ce;je=Math.round(ze-ve.left),He=Math.round(Pe-ve.top)}if(we)Le=Math.sqrt((2*ve.width**2+ve.height**2)/3),Le%2===0&&(Le+=1);else{const ze=Math.max(Math.abs((oe?oe.clientWidth:0)-je),je)*2+2,Pe=Math.max(Math.abs((oe?oe.clientHeight:0)-He),He)*2+2;Le=Math.sqrt(ze**2+Pe**2)}ce!=null&&ce.touches?ne.current===null&&(ne.current=()=>{de({pulsate:Ce,rippleX:je,rippleY:He,rippleSize:Le,cb:Ie})},se.start(C$,()=>{ne.current&&(ne.current(),ne.current=null)})):de({pulsate:Ce,rippleX:je,rippleY:He,rippleSize:Le,cb:Ie})},[g,de,se]),Q=Y.useCallback(()=>{te({},{pulsate:!0})},[te]),K=Y.useCallback((ce,fe)=>{if(se.clear(),(ce==null?void 0:ce.type)==="touchend"&&ne.current){ne.current(),ne.current=null,se.start(0,()=>{K(ce,fe)});return}ne.current=null,j(Ie=>Ie.length>0?Ie.slice(1):Ie),q.current=fe},[se]);return Y.useImperativeHandle(a,()=>({pulsate:Q,start:te,stop:K}),[Q,te,K]),L.jsx(k$,{className:rr(pa.root,_.root,M),ref:le,...D,children:L.jsx(Fy,{component:null,exit:!0,children:i})})});function D$(e){return Ir("MuiButtonBase",e)}const R$=Mr("MuiButtonBase",["root","disabled","focusVisible"]),L$=e=>{const{disabled:r,focusVisible:a,focusVisibleClassName:u,classes:g}=e,M=Er({root:["root",r&&"disabled",a&&"focusVisible"]},D$,g);return a&&u&&(M.root+=` ${u}`),M},z$=bt("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${R$.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),rl=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiButtonBase"}),{action:g,centerRipple:_=!1,children:M,className:D,component:i="button",disabled:j=!1,disableRipple:H=!1,disableTouchRipple:q=!1,focusRipple:X=!1,focusVisibleClassName:se,LinkComponent:ne="a",onBlur:le,onClick:de,onContextMenu:te,onDragLeave:Q,onFocus:K,onFocusVisible:ce,onKeyDown:fe,onKeyUp:Ie,onMouseDown:Ce,onMouseLeave:we,onMouseUp:ot,onTouchEnd:oe,onTouchMove:ve,onTouchStart:je,tabIndex:He=0,TouchRippleProps:Le,touchRippleRef:ze,type:Pe,...tt}=u,De=Y.useRef(null),Ke=w$(),Ge=ai(Ke.ref,ze),[ft,Gt]=Y.useState(!1);j&&ft&&Gt(!1),Y.useImperativeHandle(g,()=>({focusVisible:()=>{Gt(!0),De.current.focus()}}),[]);const Ft=Ke.shouldMount&&!H&&!j;Y.useEffect(()=>{ft&&X&&!H&&Ke.pulsate()},[H,X,ft,Ke]);function wt(Tt,ar,Xt=q){return Ar(Hr=>(ar&&ar(Hr),Xt||Ke[Tt](Hr),!0))}const Rt=wt("start",Ce),It=wt("stop",te),zt=wt("stop",Q),At=wt("stop",ot),kt=wt("stop",Tt=>{ft&&Tt.preventDefault(),we&&we(Tt)}),Ot=wt("start",je),be=wt("stop",oe),Ht=wt("stop",ve),xt=wt("stop",Tt=>{ov(Tt.target)||Gt(!1),le&&le(Tt)},!1),Bt=Ar(Tt=>{De.current||(De.current=Tt.currentTarget),ov(Tt.target)&&(Gt(!0),ce&&ce(Tt)),K&&K(Tt)}),rt=()=>{const Tt=De.current;return i&&i!=="button"&&!(Tt.tagName==="A"&&Tt.href)},qt=Ar(Tt=>{X&&!Tt.repeat&&ft&&Tt.key===" "&&Ke.stop(Tt,()=>{Ke.start(Tt)}),Tt.target===Tt.currentTarget&&rt()&&Tt.key===" "&&Tt.preventDefault(),fe&&fe(Tt),Tt.target===Tt.currentTarget&&rt()&&Tt.key==="Enter"&&!j&&(Tt.preventDefault(),de&&de(Tt))}),Lt=Ar(Tt=>{X&&Tt.key===" "&&ft&&!Tt.defaultPrevented&&Ke.stop(Tt,()=>{Ke.pulsate(Tt)}),Ie&&Ie(Tt),de&&Tt.target===Tt.currentTarget&&rt()&&Tt.key===" "&&!Tt.defaultPrevented&&de(Tt)});let Yt=i;Yt==="button"&&(tt.href||tt.to)&&(Yt=ne);const Wt={};Yt==="button"?(Wt.type=Pe===void 0?"button":Pe,Wt.disabled=j):(!tt.href&&!tt.to&&(Wt.role="button"),j&&(Wt["aria-disabled"]=j));const wr=ai(a,De),Sr={...u,centerRipple:_,component:i,disabled:j,disableRipple:H,disableTouchRipple:q,focusRipple:X,tabIndex:He,focusVisible:ft},dn=L$(Sr);return L.jsxs(z$,{as:Yt,className:rr(dn.root,D),ownerState:Sr,onBlur:xt,onClick:de,onContextMenu:It,onFocus:Bt,onKeyDown:qt,onKeyUp:Lt,onMouseDown:Rt,onMouseLeave:kt,onMouseUp:At,onDragLeave:zt,onTouchEnd:be,onTouchMove:Ht,onTouchStart:Ot,ref:wr,tabIndex:j?-1:He,type:Pe,...Wt,...tt,children:[M,Ft?L.jsx(A$,{ref:Ge,center:_,...Le}):null]})});function O$(e){return typeof e.main=="string"}function F$(e,r=[]){if(!O$(e))return!1;for(const a of r)if(!e.hasOwnProperty(a)||typeof e[a]!="string")return!1;return!0}function yo(e=[]){return([,r])=>r&&F$(r,e)}function B$(e){return Ir("MuiIconButton",e)}const j$=Mr("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),N$=e=>{const{classes:r,disabled:a,color:u,edge:g,size:_}=e,M={root:["root",a&&"disabled",u!=="default"&&`color${tr(u)}`,g&&`edge${tr(g)}`,`size${tr(_)}`]};return Er(M,B$,r)},V$=bt(rl,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.color!=="default"&&r[`color${tr(a.color)}`],a.edge&&r[`edge${tr(a.edge)}`],r[`size${tr(a.size)}`]]}})(ln(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:r=>!r.disableRipple,style:{"--IconButton-hoverBg":e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.action.active,e.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ln(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(yo()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}})),...Object.entries(e.palette).filter(yo()).map(([r])=>({props:{color:r},style:{"--IconButton-hoverBg":e.vars?`rgba(${(e.vars||e).palette[r].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn((e.vars||e).palette[r].main,e.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${j$.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}}))),Sf=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiIconButton"}),{edge:g=!1,children:_,className:M,color:D="default",disabled:i=!1,disableFocusRipple:j=!1,size:H="medium",...q}=u,X={...u,edge:g,color:D,disabled:i,disableFocusRipple:j,size:H},se=N$(X);return L.jsx(V$,{className:rr(se.root,M),centerRipple:!0,focusRipple:!j,disabled:i,ref:a,...q,ownerState:X,children:_})});function $$(e){return Ir("MuiTypography",e)}const hA=Mr("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),U$={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},W$=QV(),G$=e=>{const{align:r,gutterBottom:a,noWrap:u,paragraph:g,variant:_,classes:M}=e,D={root:["root",_,e.align!=="inherit"&&`align${tr(r)}`,a&&"gutterBottom",u&&"noWrap",g&&"paragraph"]};return Er(D,$$,M)},H$=bt("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.variant&&r[a.variant],a.align!=="inherit"&&r[`align${tr(a.align)}`],a.noWrap&&r.noWrap,a.gutterBottom&&r.gutterBottom,a.paragraph&&r.paragraph]}})(ln(({theme:e})=>{var r;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([a,u])=>a!=="inherit"&&u&&typeof u=="object").map(([a,u])=>({props:{variant:a},style:u})),...Object.entries(e.palette).filter(yo()).map(([a])=>({props:{color:a},style:{color:(e.vars||e).palette[a].main}})),...Object.entries(((r=e.palette)==null?void 0:r.text)||{}).filter(([,a])=>typeof a=="string").map(([a])=>({props:{color:`text${tr(a)}`},style:{color:(e.vars||e).palette.text[a]}})),{props:({ownerState:a})=>a.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:a})=>a.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:a})=>a.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:a})=>a.paragraph,style:{marginBottom:16}}]}})),pA={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},nn=Y.forwardRef(function(r,a){const{color:u,...g}=_n({props:r,name:"MuiTypography"}),_=!U$[u],M=W$({...g,..._&&{color:u}}),{align:D="inherit",className:i,component:j,gutterBottom:H=!1,noWrap:q=!1,paragraph:X=!1,variant:se="body1",variantMapping:ne=pA,...le}=M,de={...M,align:D,color:u,className:i,component:j,gutterBottom:H,noWrap:q,paragraph:X,variant:se,variantMapping:ne},te=j||(X?"p":ne[se]||pA[se])||"span",Q=G$(de);return L.jsx(H$,{as:te,ref:a,className:rr(Q.root,i),...le,ownerState:de,style:{...D!=="inherit"&&{"--Typography-textAlign":D},...le.style}})});function q$(e){return Ir("MuiAppBar",e)}Mr("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Z$=e=>{const{color:r,position:a,classes:u}=e,g={root:["root",`color${tr(r)}`,`position${tr(a)}`]};return Er(g,q$,u)},fA=(e,r)=>e?`${e==null?void 0:e.replace(")","")}, ${r})`:r,Y$=bt(wf,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`position${tr(a.position)}`],r[`color${tr(a.color)}`]]}})(ln(({theme:e})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":e.vars?e.vars.palette.AppBar.defaultBg:e.palette.grey[100],"--AppBar-color":e.vars?e.vars.palette.text.primary:e.palette.getContrastText(e.palette.grey[100]),...e.applyStyles("dark",{"--AppBar-background":e.vars?e.vars.palette.AppBar.defaultBg:e.palette.grey[900],"--AppBar-color":e.vars?e.vars.palette.text.primary:e.palette.getContrastText(e.palette.grey[900])})}},...Object.entries(e.palette).filter(yo(["contrastText"])).map(([r])=>({props:{color:r},style:{"--AppBar-background":(e.vars??e).palette[r].main,"--AppBar-color":(e.vars??e).palette[r].contrastText}})),{props:r=>r.enableColorOnDark===!0&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:r=>r.enableColorOnDark===!1&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...e.applyStyles("dark",{backgroundColor:e.vars?fA(e.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:e.vars?fA(e.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...e.applyStyles("dark",{backgroundImage:"none"})}}]}))),X$=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiAppBar"}),{className:g,color:_="primary",enableColorOnDark:M=!1,position:D="fixed",...i}=u,j={...u,color:_,position:D,enableColorOnDark:M},H=Z$(j);return L.jsx(Y$,{square:!0,component:"header",ownerState:j,elevation:4,className:rr(H.root,g,D==="fixed"&&"mui-fixed"),ref:a,...i})});function K$(e){return typeof e=="function"?e():e}const J$=Y.forwardRef(function(r,a){const{children:u,container:g,disablePortal:_=!1}=r,[M,D]=Y.useState(null),i=ai(Y.isValidElement(u)?vf(u):null,a);if(io(()=>{_||D(K$(g)||document.body)},[g,_]),io(()=>{if(M&&!_)return sT(a,M),()=>{sT(a,null)}},[a,M,_]),_){if(Y.isValidElement(u)){const j={ref:i};return Y.cloneElement(u,j)}return L.jsx(Y.Fragment,{children:u})}return L.jsx(Y.Fragment,{children:M&&fC.createPortal(u,M)})});function Q$(e){return Ir("MuiListSubheader",e)}Mr("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const eU=e=>{const{classes:r,color:a,disableGutters:u,inset:g,disableSticky:_}=e,M={root:["root",a!=="default"&&`color${tr(a)}`,!u&&"gutters",g&&"inset",!_&&"sticky"]};return Er(M,Q$,r)},tU=bt("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.color!=="default"&&r[`color${tr(a.color)}`],!a.disableGutters&&r.gutters,a.inset&&r.inset,!a.disableSticky&&r.sticky]}})(ln(({theme:e})=>({boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(e.vars||e).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.inset,style:{paddingLeft:72}},{props:({ownerState:r})=>!r.disableSticky,style:{position:"sticky",top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),jp=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiListSubheader"}),{className:g,color:_="default",component:M="li",disableGutters:D=!1,disableSticky:i=!1,inset:j=!1,...H}=u,q={...u,color:_,component:M,disableGutters:D,disableSticky:i,inset:j},X=eU(q);return L.jsx(tU,{as:M,className:rr(X.root,g),ref:a,ownerState:q,...H})});jp&&(jp.muiSkipListHighlight=!0);const rU=si(L.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function nU(e){return Ir("MuiChip",e)}const Gn=Mr("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),iU=e=>{const{classes:r,disabled:a,size:u,color:g,iconColor:_,onDelete:M,clickable:D,variant:i}=e,j={root:["root",i,a&&"disabled",`size${tr(u)}`,`color${tr(g)}`,D&&"clickable",D&&`clickableColor${tr(g)}`,M&&"deletable",M&&`deletableColor${tr(g)}`,`${i}${tr(g)}`],label:["label",`label${tr(u)}`],avatar:["avatar",`avatar${tr(u)}`,`avatarColor${tr(g)}`],icon:["icon",`icon${tr(u)}`,`iconColor${tr(_)}`],deleteIcon:["deleteIcon",`deleteIcon${tr(u)}`,`deleteIconColor${tr(g)}`,`deleteIcon${tr(i)}Color${tr(g)}`]};return Er(j,nU,r)},oU=bt("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e,{color:u,iconColor:g,clickable:_,onDelete:M,size:D,variant:i}=a;return[{[`& .${Gn.avatar}`]:r.avatar},{[`& .${Gn.avatar}`]:r[`avatar${tr(D)}`]},{[`& .${Gn.avatar}`]:r[`avatarColor${tr(u)}`]},{[`& .${Gn.icon}`]:r.icon},{[`& .${Gn.icon}`]:r[`icon${tr(D)}`]},{[`& .${Gn.icon}`]:r[`iconColor${tr(g)}`]},{[`& .${Gn.deleteIcon}`]:r.deleteIcon},{[`& .${Gn.deleteIcon}`]:r[`deleteIcon${tr(D)}`]},{[`& .${Gn.deleteIcon}`]:r[`deleteIconColor${tr(u)}`]},{[`& .${Gn.deleteIcon}`]:r[`deleteIcon${tr(i)}Color${tr(u)}`]},r.root,r[`size${tr(D)}`],r[`color${tr(u)}`],_&&r.clickable,_&&u!=="default"&&r[`clickableColor${tr(u)})`],M&&r.deletable,M&&u!=="default"&&r[`deletableColor${tr(u)}`],r[i],r[`${i}${tr(u)}`]]}})(ln(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[700]:e.palette.grey[300];return{maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${Gn.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${Gn.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:r,fontSize:e.typography.pxToRem(12)},[`& .${Gn.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${Gn.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${Gn.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${Gn.icon}`]:{marginLeft:5,marginRight:-6},[`& .${Gn.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.26)`:Bn(e.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:Bn(e.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${Gn.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${Gn.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(e.palette).filter(yo(["contrastText"])).map(([a])=>({props:{color:a},style:{backgroundColor:(e.vars||e).palette[a].main,color:(e.vars||e).palette[a].contrastText,[`& .${Gn.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[a].contrastTextChannel} / 0.7)`:Bn(e.palette[a].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[a].contrastText}}}})),{props:a=>a.iconColor===a.color,style:{[`& .${Gn.icon}`]:{color:e.vars?e.vars.palette.Chip.defaultIconColor:r}}},{props:a=>a.iconColor===a.color&&a.color!=="default",style:{[`& .${Gn.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${Gn.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Bn(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}}},...Object.entries(e.palette).filter(yo(["dark"])).map(([a])=>({props:{color:a,onDelete:!0},style:{[`&.${Gn.focusVisible}`]:{background:(e.vars||e).palette[a].dark}}})),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Bn(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)},[`&.${Gn.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Bn(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},"&:active":{boxShadow:(e.vars||e).shadows[1]}}},...Object.entries(e.palette).filter(yo(["dark"])).map(([a])=>({props:{color:a,clickable:!0},style:{[`&:hover, &.${Gn.focusVisible}`]:{backgroundColor:(e.vars||e).palette[a].dark}}})),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${Gn.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${Gn.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${Gn.avatar}`]:{marginLeft:4},[`& .${Gn.avatarSmall}`]:{marginLeft:2},[`& .${Gn.icon}`]:{marginLeft:4},[`& .${Gn.iconSmall}`]:{marginLeft:2},[`& .${Gn.deleteIcon}`]:{marginRight:5},[`& .${Gn.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(e.palette).filter(yo()).map(([a])=>({props:{variant:"outlined",color:a},style:{color:(e.vars||e).palette[a].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[a].mainChannel} / 0.7)`:Bn(e.palette[a].main,.7)}`,[`&.${Gn.clickable}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[a].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette[a].main,e.palette.action.hoverOpacity)},[`&.${Gn.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[a].mainChannel} / ${e.vars.palette.action.focusOpacity})`:Bn(e.palette[a].main,e.palette.action.focusOpacity)},[`& .${Gn.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[a].mainChannel} / 0.7)`:Bn(e.palette[a].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[a].main}}}}))]}})),sU=bt("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,r)=>{const{ownerState:a}=e,{size:u}=a;return[r.label,r[`label${tr(u)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function mA(e){return e.key==="Backspace"||e.key==="Delete"}const aU=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiChip"}),{avatar:g,className:_,clickable:M,color:D="default",component:i,deleteIcon:j,disabled:H=!1,icon:q,label:X,onClick:se,onDelete:ne,onKeyDown:le,onKeyUp:de,size:te="medium",variant:Q="filled",tabIndex:K,skipFocusWhenDisabled:ce=!1,...fe}=u,Ie=Y.useRef(null),Ce=ai(Ie,a),we=Ke=>{Ke.stopPropagation(),ne&&ne(Ke)},ot=Ke=>{Ke.currentTarget===Ke.target&&mA(Ke)&&Ke.preventDefault(),le&&le(Ke)},oe=Ke=>{Ke.currentTarget===Ke.target&&ne&&mA(Ke)&&ne(Ke),de&&de(Ke)},ve=M!==!1&&se?!0:M,je=ve||ne?rl:i||"div",He={...u,component:je,disabled:H,size:te,color:D,iconColor:Y.isValidElement(q)&&q.props.color||D,onDelete:!!ne,clickable:ve,variant:Q},Le=iU(He),ze=je===rl?{component:i||"div",focusVisibleClassName:Le.focusVisible,...ne&&{disableRipple:!0}}:{};let Pe=null;ne&&(Pe=j&&Y.isValidElement(j)?Y.cloneElement(j,{className:rr(j.props.className,Le.deleteIcon),onClick:we}):L.jsx(rU,{className:rr(Le.deleteIcon),onClick:we}));let tt=null;g&&Y.isValidElement(g)&&(tt=Y.cloneElement(g,{className:rr(Le.avatar,g.props.className)}));let De=null;return q&&Y.isValidElement(q)&&(De=Y.cloneElement(q,{className:rr(Le.icon,q.props.className)})),L.jsxs(oU,{as:je,className:rr(Le.root,_),disabled:ve&&H?!0:void 0,onClick:se,onKeyDown:ot,onKeyUp:oe,ref:Ce,tabIndex:ce&&H?-1:K,ownerState:He,...ze,...fe,children:[tt||De,L.jsx(sU,{className:rr(Le.label),ownerState:He,children:X}),Pe]})});function rx(e){return parseInt(e,10)||0}const lU={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function cU(e){return e==null||Object.keys(e).length===0||e.outerHeightStyle===0&&!e.overflowing}const uU=Y.forwardRef(function(r,a){const{onChange:u,maxRows:g,minRows:_=1,style:M,value:D,...i}=r,{current:j}=Y.useRef(D!=null),H=Y.useRef(null),q=ai(a,H),X=Y.useRef(null),se=Y.useRef(null),ne=Y.useCallback(()=>{const te=H.current,K=Hs(te).getComputedStyle(te);if(K.width==="0px")return{outerHeightStyle:0,overflowing:!1};const ce=se.current;ce.style.width=K.width,ce.value=te.value||r.placeholder||"x",ce.value.slice(-1)===`
`&&(ce.value+=" ");const fe=K.boxSizing,Ie=rx(K.paddingBottom)+rx(K.paddingTop),Ce=rx(K.borderBottomWidth)+rx(K.borderTopWidth),we=ce.scrollHeight;ce.value="x";const ot=ce.scrollHeight;let oe=we;_&&(oe=Math.max(Number(_)*ot,oe)),g&&(oe=Math.min(Number(g)*ot,oe)),oe=Math.max(oe,ot);const ve=oe+(fe==="border-box"?Ie+Ce:0),je=Math.abs(oe-we)<=1;return{outerHeightStyle:ve,overflowing:je}},[g,_,r.placeholder]),le=Y.useCallback(()=>{const te=ne();if(cU(te))return;const Q=te.outerHeightStyle,K=H.current;X.current!==Q&&(X.current=Q,K.style.height=`${Q}px`),K.style.overflow=te.overflowing?"hidden":""},[ne]);io(()=>{const te=()=>{le()};let Q;const K=zy(te),ce=H.current,fe=Hs(ce);fe.addEventListener("resize",K);let Ie;return typeof ResizeObserver<"u"&&(Ie=new ResizeObserver(te),Ie.observe(ce)),()=>{K.clear(),cancelAnimationFrame(Q),fe.removeEventListener("resize",K),Ie&&Ie.disconnect()}},[ne,le]),io(()=>{le()});const de=te=>{j||le(),u&&u(te)};return L.jsxs(Y.Fragment,{children:[L.jsx("textarea",{value:D,onChange:de,ref:q,rows:_,style:M,...i}),L.jsx("textarea",{"aria-hidden":!0,className:r.className,readOnly:!0,ref:se,tabIndex:-1,style:{...lU.shadow,...M,paddingTop:0,paddingBottom:0}})]})});function uc(e){return typeof e=="string"}function th({props:e,states:r,muiFormControl:a}){return r.reduce((u,g)=>(u[g]=e[g],a&&typeof e[g]>"u"&&(u[g]=a[g]),u),{})}const x1=Y.createContext(void 0);function Js(){return Y.useContext(x1)}function gA(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function uv(e,r=!1){return e&&(gA(e.value)&&e.value!==""||r&&gA(e.defaultValue)&&e.defaultValue!=="")}function dU(e){return e.startAdornment}function hU(e){return Ir("MuiInputBase",e)}const ff=Mr("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var yA;const v1=(e,r)=>{const{ownerState:a}=e;return[r.root,a.formControl&&r.formControl,a.startAdornment&&r.adornedStart,a.endAdornment&&r.adornedEnd,a.error&&r.error,a.size==="small"&&r.sizeSmall,a.multiline&&r.multiline,a.color&&r[`color${tr(a.color)}`],a.fullWidth&&r.fullWidth,a.hiddenLabel&&r.hiddenLabel]},b1=(e,r)=>{const{ownerState:a}=e;return[r.input,a.size==="small"&&r.inputSizeSmall,a.multiline&&r.inputMultiline,a.type==="search"&&r.inputTypeSearch,a.startAdornment&&r.inputAdornedStart,a.endAdornment&&r.inputAdornedEnd,a.hiddenLabel&&r.inputHiddenLabel]},pU=e=>{const{classes:r,color:a,disabled:u,error:g,endAdornment:_,focused:M,formControl:D,fullWidth:i,hiddenLabel:j,multiline:H,readOnly:q,size:X,startAdornment:se,type:ne}=e,le={root:["root",`color${tr(a)}`,u&&"disabled",g&&"error",i&&"fullWidth",M&&"focused",D&&"formControl",X&&X!=="medium"&&`size${tr(X)}`,H&&"multiline",se&&"adornedStart",_&&"adornedEnd",j&&"hiddenLabel",q&&"readOnly"],input:["input",u&&"disabled",ne==="search"&&"inputTypeSearch",H&&"inputMultiline",X==="small"&&"inputSizeSmall",j&&"inputHiddenLabel",se&&"inputAdornedStart",_&&"inputAdornedEnd",q&&"readOnly"]};return Er(le,hU,r)},w1=bt("div",{name:"MuiInputBase",slot:"Root",overridesResolver:v1})(ln(({theme:e})=>({...e.typography.body1,color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${ff.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:r})=>r.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:r,size:a})=>r.multiline&&a==="small",style:{paddingTop:1}},{props:({ownerState:r})=>r.fullWidth,style:{width:"100%"}}]}))),S1=bt("input",{name:"MuiInputBase",slot:"Input",overridesResolver:b1})(ln(({theme:e})=>{const r=e.palette.mode==="light",a={color:"currentColor",...e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},u={opacity:"0 !important"},g=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&::-ms-input-placeholder":a,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${ff.formControl} &`]:{"&::-webkit-input-placeholder":u,"&::-moz-placeholder":u,"&::-ms-input-placeholder":u,"&:focus::-webkit-input-placeholder":g,"&:focus::-moz-placeholder":g,"&:focus::-ms-input-placeholder":g},[`&.${ff.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},variants:[{props:({ownerState:_})=>!_.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:_})=>_.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),_A=JV({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),VC=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiInputBase"}),{"aria-describedby":g,autoComplete:_,autoFocus:M,className:D,color:i,components:j={},componentsProps:H={},defaultValue:q,disabled:X,disableInjectingGlobalStyles:se,endAdornment:ne,error:le,fullWidth:de=!1,id:te,inputComponent:Q="input",inputProps:K={},inputRef:ce,margin:fe,maxRows:Ie,minRows:Ce,multiline:we=!1,name:ot,onBlur:oe,onChange:ve,onClick:je,onFocus:He,onKeyDown:Le,onKeyUp:ze,placeholder:Pe,readOnly:tt,renderSuffix:De,rows:Ke,size:Ge,slotProps:ft={},slots:Gt={},startAdornment:Ft,type:wt="text",value:Rt,...It}=u,zt=K.value!=null?K.value:Rt,{current:At}=Y.useRef(zt!=null),kt=Y.useRef(),Ot=Y.useCallback(Wr=>{},[]),be=ai(kt,ce,K.ref,Ot),[Ht,xt]=Y.useState(!1),Bt=Js(),rt=th({props:u,muiFormControl:Bt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});rt.focused=Bt?Bt.focused:Ht,Y.useEffect(()=>{!Bt&&X&&Ht&&(xt(!1),oe&&oe())},[Bt,X,Ht,oe]);const qt=Bt&&Bt.onFilled,Lt=Bt&&Bt.onEmpty,Yt=Y.useCallback(Wr=>{uv(Wr)?qt&&qt():Lt&&Lt()},[qt,Lt]);io(()=>{At&&Yt({value:zt})},[zt,Yt,At]);const Wt=Wr=>{He&&He(Wr),K.onFocus&&K.onFocus(Wr),Bt&&Bt.onFocus?Bt.onFocus(Wr):xt(!0)},wr=Wr=>{oe&&oe(Wr),K.onBlur&&K.onBlur(Wr),Bt&&Bt.onBlur?Bt.onBlur(Wr):xt(!1)},Sr=(Wr,...Jn)=>{if(!At){const li=Wr.target||kt.current;if(li==null)throw new Error(gc(1));Yt({value:li.value})}K.onChange&&K.onChange(Wr,...Jn),ve&&ve(Wr,...Jn)};Y.useEffect(()=>{Yt(kt.current)},[]);const dn=Wr=>{kt.current&&Wr.currentTarget===Wr.target&&kt.current.focus(),je&&je(Wr)};let Tt=Q,ar=K;we&&Tt==="input"&&(Ke?ar={type:void 0,minRows:Ke,maxRows:Ke,...ar}:ar={type:void 0,maxRows:Ie,minRows:Ce,...ar},Tt=uU);const Xt=Wr=>{Yt(Wr.animationName==="mui-auto-fill-cancel"?kt.current:{value:"x"})};Y.useEffect(()=>{Bt&&Bt.setAdornedStart(!!Ft)},[Bt,Ft]);const Hr={...u,color:rt.color||"primary",disabled:rt.disabled,endAdornment:ne,error:rt.error,focused:rt.focused,formControl:Bt,fullWidth:de,hiddenLabel:rt.hiddenLabel,multiline:we,size:rt.size,startAdornment:Ft,type:wt},zr=pU(Hr),br=Gt.root||j.Root||w1,Qr=ft.root||H.root||{},pn=Gt.input||j.Input||S1;return ar={...ar,...ft.input??H.input},L.jsxs(Y.Fragment,{children:[!se&&typeof _A=="function"&&(yA||(yA=L.jsx(_A,{}))),L.jsxs(br,{...Qr,ref:a,onClick:dn,...It,...!uc(br)&&{ownerState:{...Hr,...Qr.ownerState}},className:rr(zr.root,Qr.className,D,tt&&"MuiInputBase-readOnly"),children:[Ft,L.jsx(x1.Provider,{value:null,children:L.jsx(pn,{"aria-invalid":rt.error,"aria-describedby":g,autoComplete:_,autoFocus:M,defaultValue:q,disabled:rt.disabled,id:te,onAnimationStart:Xt,name:ot,placeholder:Pe,readOnly:tt,required:rt.required,rows:Ke,value:zt,onKeyDown:Le,onKeyUp:ze,type:wt,...ar,...!uc(pn)&&{as:Tt,ownerState:{...Hr,...ar.ownerState}},ref:be,className:rr(zr.input,ar.className,tt&&"MuiInputBase-readOnly"),onBlur:wr,onChange:Sr,onFocus:Wt})}),ne,De?De({...rt,startAdornment:Ft}):null]})]})});function fU(e){return Ir("MuiInput",e)}const xg={...ff,...Mr("MuiInput",["root","underline","input"])};function mU(e){return Ir("MuiOutlinedInput",e)}const Ml={...ff,...Mr("MuiOutlinedInput",["root","notchedOutline","input"])};function gU(e){return Ir("MuiFilledInput",e)}const Ed={...ff,...Mr("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},yU=si(L.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),_U={entering:{opacity:1},entered:{opacity:1}},By=Y.forwardRef(function(r,a){const u=jl(),g={enter:u.transitions.duration.enteringScreen,exit:u.transitions.duration.leavingScreen},{addEndListener:_,appear:M=!0,children:D,easing:i,in:j,onEnter:H,onEntered:q,onEntering:X,onExit:se,onExited:ne,onExiting:le,style:de,timeout:te=g,TransitionComponent:Q=Ks,...K}=r,ce=Y.useRef(null),fe=ai(ce,vf(D),a),Ie=Le=>ze=>{if(Le){const Pe=ce.current;ze===void 0?Le(Pe):Le(Pe,ze)}},Ce=Ie(X),we=Ie((Le,ze)=>{NC(Le);const Pe=Lu({style:de,timeout:te,easing:i},{mode:"enter"});Le.style.webkitTransition=u.transitions.create("opacity",Pe),Le.style.transition=u.transitions.create("opacity",Pe),H&&H(Le,ze)}),ot=Ie(q),oe=Ie(le),ve=Ie(Le=>{const ze=Lu({style:de,timeout:te,easing:i},{mode:"exit"});Le.style.webkitTransition=u.transitions.create("opacity",ze),Le.style.transition=u.transitions.create("opacity",ze),se&&se(Le)}),je=Ie(ne),He=Le=>{_&&_(ce.current,Le)};return L.jsx(Q,{appear:M,in:j,nodeRef:ce,onEnter:we,onEntered:ot,onEntering:Ce,onExit:ve,onExited:je,onExiting:oe,addEndListener:He,timeout:te,...K,children:(Le,ze)=>Y.cloneElement(D,{style:{opacity:0,visibility:Le==="exited"&&!j?"hidden":void 0,..._U[Le],...de,...D.props.style},ref:fe,...ze})})});function xU(e){return Ir("MuiBackdrop",e)}Mr("MuiBackdrop",["root","invisible"]);const vU=e=>{const{ownerState:r,...a}=e;return a},bU=e=>{const{classes:r,invisible:a}=e;return Er({root:["root",a&&"invisible"]},xU,r)},wU=bt("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.invisible&&r.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Az=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiBackdrop"}),{children:g,className:_,component:M="div",invisible:D=!1,open:i,components:j={},componentsProps:H={},slotProps:q={},slots:X={},TransitionComponent:se,transitionDuration:ne,...le}=u,de={...u,component:M,invisible:D},te=bU(de),Q={transition:se,root:j.Root,...X},K={...H,...q},ce={slots:Q,slotProps:K},[fe,Ie]=_a("root",{elementType:wU,externalForwardedProps:ce,className:rr(te.root,_),ownerState:de}),[Ce,we]=_a("transition",{elementType:By,externalForwardedProps:ce,ownerState:de}),ot=vU(we);return L.jsx(Ce,{in:i,timeout:ne,...le,...ot,children:L.jsx(fe,{"aria-hidden":!0,...Ie,classes:te,ref:a,children:g})})});function SU(e){const{badgeContent:r,invisible:a=!1,max:u=99,showZero:g=!1}=e,_=pz({badgeContent:r,max:u});let M=a;a===!1&&r===0&&!g&&(M=!0);const{badgeContent:D,max:i=u}=M?_:e,j=D&&Number(D)>i?`${i}+`:D;return{badgeContent:D,invisible:M,max:i,displayValue:j}}function TU(e){return Ir("MuiBadge",e)}const hu=Mr("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),Qw=10,eS=4,CU=e=>{const{color:r,anchorOrigin:a,invisible:u,overlap:g,variant:_,classes:M={}}=e,D={root:["root"],badge:["badge",_,u&&"invisible",`anchorOrigin${tr(a.vertical)}${tr(a.horizontal)}`,`anchorOrigin${tr(a.vertical)}${tr(a.horizontal)}${tr(g)}`,`overlap${tr(g)}`,r!=="default"&&`color${tr(r)}`]};return Er(D,TU,M)},MU=bt("span",{name:"MuiBadge",slot:"Root",overridesResolver:(e,r)=>r.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),EU=bt("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.badge,r[a.variant],r[`anchorOrigin${tr(a.anchorOrigin.vertical)}${tr(a.anchorOrigin.horizontal)}${tr(a.overlap)}`],a.color!=="default"&&r[`color${tr(a.color)}`],a.invisible&&r.invisible]}})(ln(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(12),minWidth:Qw*2,lineHeight:1,padding:"0 6px",height:Qw*2,borderRadius:Qw,zIndex:1,transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.enteringScreen}),variants:[...Object.entries(e.palette).filter(yo(["contrastText"])).map(([r])=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main,color:(e.vars||e).palette[r].contrastText}})),{props:{variant:"dot"},style:{borderRadius:eS,height:eS*2,minWidth:eS*2,padding:0}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="right"&&r.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="top"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:r})=>r.anchorOrigin.vertical==="bottom"&&r.anchorOrigin.horizontal==="left"&&r.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${hu.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:e.transitions.create("transform",{easing:e.transitions.easing.easeInOut,duration:e.transitions.duration.leavingScreen})}}]})));function xA(e){return{vertical:(e==null?void 0:e.vertical)??"top",horizontal:(e==null?void 0:e.horizontal)??"right"}}const Dz=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiBadge"}),{anchorOrigin:g,className:_,classes:M,component:D,components:i={},componentsProps:j={},children:H,overlap:q="rectangular",color:X="default",invisible:se=!1,max:ne=99,badgeContent:le,slots:de,slotProps:te,showZero:Q=!1,variant:K="standard",...ce}=u,{badgeContent:fe,invisible:Ie,max:Ce,displayValue:we}=SU({max:ne,invisible:se,badgeContent:le,showZero:Q}),ot=pz({anchorOrigin:xA(g),color:X,overlap:q,variant:K,badgeContent:le}),oe=Ie||fe==null&&K!=="dot",{color:ve=X,overlap:je=q,anchorOrigin:He,variant:Le=K}=oe?ot:u,ze=xA(He),Pe=Le!=="dot"?we:void 0,tt={...u,badgeContent:fe,invisible:oe,max:Ce,displayValue:Pe,showZero:Q,anchorOrigin:ze,color:ve,overlap:je,variant:Le},De=CU(tt),Ke=(de==null?void 0:de.root)??i.Root??MU,Ge=(de==null?void 0:de.badge)??i.Badge??EU,ft=(te==null?void 0:te.root)??j.root,Gt=(te==null?void 0:te.badge)??j.badge,Ft=jn({elementType:Ke,externalSlotProps:ft,externalForwardedProps:ce,additionalProps:{ref:a,as:D},ownerState:tt,className:rr(ft==null?void 0:ft.className,De.root,_)}),wt=jn({elementType:Ge,externalSlotProps:Gt,ownerState:tt,className:rr(De.badge,Gt==null?void 0:Gt.className)});return L.jsxs(Ke,{...Ft,children:[H,L.jsx(Ge,{...wt,children:Pe})]})}),IU=Mr("MuiBox",["root"]),kU=Oy(),zn=i6({themeId:Ka,defaultTheme:kU,defaultClassName:IU.root,generateClassName:tz.generate});function PU(e){return Ir("MuiButton",e)}const bp=Mr("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),AU=Y.createContext({}),DU=Y.createContext(void 0),RU=e=>{const{color:r,disableElevation:a,fullWidth:u,size:g,variant:_,classes:M}=e,D={root:["root",_,`${_}${tr(r)}`,`size${tr(g)}`,`${_}Size${tr(g)}`,`color${tr(r)}`,a&&"disableElevation",u&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${tr(g)}`],endIcon:["icon","endIcon",`iconSize${tr(g)}`]},i=Er(D,PU,M);return{...M,...i}},Rz=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],LU=bt(rl,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`${a.variant}${tr(a.color)}`],r[`size${tr(a.size)}`],r[`${a.variant}Size${tr(a.size)}`],a.color==="inherit"&&r.colorInherit,a.disableElevation&&r.disableElevation,a.fullWidth&&r.fullWidth]}})(ln(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],a=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${bp.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${bp.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${bp.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${bp.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(yo()).map(([u])=>({props:{color:u},style:{"--variant-textColor":(e.vars||e).palette[u].main,"--variant-outlinedColor":(e.vars||e).palette[u].main,"--variant-outlinedBorder":e.vars?`rgba(${e.vars.palette[u].mainChannel} / 0.5)`:Bn(e.palette[u].main,.5),"--variant-containedColor":(e.vars||e).palette[u].contrastText,"--variant-containedBg":(e.vars||e).palette[u].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[u].dark,"--variant-textBg":e.vars?`rgba(${e.vars.palette[u].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette[u].main,e.palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[u].main,"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette[u].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette[u].main,e.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:r,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:a,"--variant-textBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.text.primary,e.palette.action.hoverOpacity),"--variant-outlinedBg":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.text.primary,e.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${bp.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${bp.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}}]}})),zU=bt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.startIcon,r[`iconSize${tr(a.size)}`]]}})({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},...Rz]}),OU=bt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.endIcon,r[`iconSize${tr(a.size)}`]]}})({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},...Rz]}),va=Y.forwardRef(function(r,a){const u=Y.useContext(AU),g=Y.useContext(DU),_=vy(u,r),M=_n({props:_,name:"MuiButton"}),{children:D,color:i="primary",component:j="button",className:H,disabled:q=!1,disableElevation:X=!1,disableFocusRipple:se=!1,endIcon:ne,focusVisibleClassName:le,fullWidth:de=!1,size:te="medium",startIcon:Q,type:K,variant:ce="text",...fe}=M,Ie={...M,color:i,component:j,disabled:q,disableElevation:X,disableFocusRipple:se,fullWidth:de,size:te,type:K,variant:ce},Ce=RU(Ie),we=Q&&L.jsx(zU,{className:Ce.startIcon,ownerState:Ie,children:Q}),ot=ne&&L.jsx(OU,{className:Ce.endIcon,ownerState:Ie,children:ne}),oe=g||"";return L.jsxs(LU,{ownerState:Ie,className:rr(u.className,Ce.root,H,oe),component:j,disabled:q,focusRipple:!se,focusVisibleClassName:rr(Ce.focusVisible,le),ref:a,type:K,...fe,classes:Ce,children:[we,D,ot]})});function FU(e){return Ir("MuiCard",e)}Mr("MuiCard",["root"]);const BU=e=>{const{classes:r}=e;return Er({root:["root"]},FU,r)},jU=bt(wf,{name:"MuiCard",slot:"Root",overridesResolver:(e,r)=>r.root})({overflow:"hidden"}),Qp=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiCard"}),{className:g,raised:_=!1,...M}=u,D={...u,raised:_},i=BU(D);return L.jsx(jU,{className:rr(i.root,g),elevation:_?8:void 0,ref:a,ownerState:D,...M})});function NU(e){return Ir("MuiCardContent",e)}Mr("MuiCardContent",["root"]);const VU=e=>{const{classes:r}=e;return Er({root:["root"]},NU,r)},$U=bt("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,r)=>r.root})({padding:16,"&:last-child":{paddingBottom:24}}),UU=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiCardContent"}),{className:g,component:_="div",...M}=u,D={...u,component:_},i=VU(D);return L.jsx($U,{as:_,className:rr(i.root,g),ownerState:D,ref:a,...M})});function WU(e){return Ir("PrivateSwitchBase",e)}Mr("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const GU=e=>{const{classes:r,checked:a,disabled:u,edge:g}=e,_={root:["root",a&&"checked",u&&"disabled",g&&`edge${tr(g)}`],input:["input"]};return Er(_,WU,r)},HU=bt(rl)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:r})=>e==="start"&&r.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:r})=>e==="end"&&r.size!=="small",style:{marginRight:-12}}]}),qU=bt("input",{shouldForwardProp:Qo})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),ZU=Y.forwardRef(function(r,a){const{autoFocus:u,checked:g,checkedIcon:_,className:M,defaultChecked:D,disabled:i,disableFocusRipple:j=!1,edge:H=!1,icon:q,id:X,inputProps:se,inputRef:ne,name:le,onBlur:de,onChange:te,onFocus:Q,readOnly:K,required:ce=!1,tabIndex:fe,type:Ie,value:Ce,...we}=r,[ot,oe]=tl({controlled:g,default:!!D,name:"SwitchBase",state:"checked"}),ve=Js(),je=Ke=>{Q&&Q(Ke),ve&&ve.onFocus&&ve.onFocus(Ke)},He=Ke=>{de&&de(Ke),ve&&ve.onBlur&&ve.onBlur(Ke)},Le=Ke=>{if(Ke.nativeEvent.defaultPrevented)return;const Ge=Ke.target.checked;oe(Ge),te&&te(Ke,Ge)};let ze=i;ve&&typeof ze>"u"&&(ze=ve.disabled);const Pe=Ie==="checkbox"||Ie==="radio",tt={...r,checked:ot,disabled:ze,disableFocusRipple:j,edge:H},De=GU(tt);return L.jsxs(HU,{component:"span",className:rr(De.root,M),centerRipple:!0,focusRipple:!j,disabled:ze,tabIndex:null,role:void 0,onFocus:je,onBlur:He,ownerState:tt,ref:a,...we,children:[L.jsx(qU,{autoFocus:u,checked:g,defaultChecked:D,className:De.input,disabled:ze,id:Pe?X:void 0,name:le,onChange:Le,readOnly:K,ref:ne,required:ce,ownerState:tt,tabIndex:fe,type:Ie,...Ie==="checkbox"&&Ce===void 0?{}:{value:Ce},...se}),ot?_:q]})});function YU(e){const r=Ko(e);return r.body===e?Hs(e).innerWidth>r.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function Xg(e,r){r?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function vA(e){return parseInt(Hs(e).getComputedStyle(e).paddingRight,10)||0}function XU(e){const a=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),u=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return a||u}function bA(e,r,a,u,g){const _=[r,a,...u];[].forEach.call(e.children,M=>{const D=!_.includes(M),i=!XU(M);D&&i&&Xg(M,g)})}function tS(e,r){let a=-1;return e.some((u,g)=>r(u)?(a=g,!0):!1),a}function KU(e,r){const a=[],u=e.container;if(!r.disableScrollLock){if(YU(u)){const M=hz(Hs(u));a.push({value:u.style.paddingRight,property:"padding-right",el:u}),u.style.paddingRight=`${vA(u)+M}px`;const D=Ko(u).querySelectorAll(".mui-fixed");[].forEach.call(D,i=>{a.push({value:i.style.paddingRight,property:"padding-right",el:i}),i.style.paddingRight=`${vA(i)+M}px`})}let _;if(u.parentNode instanceof DocumentFragment)_=Ko(u).body;else{const M=u.parentElement,D=Hs(u);_=(M==null?void 0:M.nodeName)==="HTML"&&D.getComputedStyle(M).overflowY==="scroll"?M:u}a.push({value:_.style.overflow,property:"overflow",el:_},{value:_.style.overflowX,property:"overflow-x",el:_},{value:_.style.overflowY,property:"overflow-y",el:_}),_.style.overflow="hidden"}return()=>{a.forEach(({value:_,el:M,property:D})=>{_?M.style.setProperty(D,_):M.style.removeProperty(D)})}}function JU(e){const r=[];return[].forEach.call(e.children,a=>{a.getAttribute("aria-hidden")==="true"&&r.push(a)}),r}class QU{constructor(){this.modals=[],this.containers=[]}add(r,a){let u=this.modals.indexOf(r);if(u!==-1)return u;u=this.modals.length,this.modals.push(r),r.modalRef&&Xg(r.modalRef,!1);const g=JU(a);bA(a,r.mount,r.modalRef,g,!0);const _=tS(this.containers,M=>M.container===a);return _!==-1?(this.containers[_].modals.push(r),u):(this.containers.push({modals:[r],container:a,restore:null,hiddenSiblings:g}),u)}mount(r,a){const u=tS(this.containers,_=>_.modals.includes(r)),g=this.containers[u];g.restore||(g.restore=KU(g,a))}remove(r,a=!0){const u=this.modals.indexOf(r);if(u===-1)return u;const g=tS(this.containers,M=>M.modals.includes(r)),_=this.containers[g];if(_.modals.splice(_.modals.indexOf(r),1),this.modals.splice(u,1),_.modals.length===0)_.restore&&_.restore(),r.modalRef&&Xg(r.modalRef,a),bA(_.container,r.mount,r.modalRef,_.hiddenSiblings,!1),this.containers.splice(g,1);else{const M=_.modals[_.modals.length-1];M.modalRef&&Xg(M.modalRef,!1)}return u}isTopModal(r){return this.modals.length>0&&this.modals[this.modals.length-1]===r}}const e3=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function t3(e){const r=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(r)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:r}function r3(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const r=u=>e.ownerDocument.querySelector(`input[type="radio"]${u}`);let a=r(`[name="${e.name}"]:checked`);return a||(a=r(`[name="${e.name}"]`)),a!==e}function n3(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||r3(e))}function i3(e){const r=[],a=[];return Array.from(e.querySelectorAll(e3)).forEach((u,g)=>{const _=t3(u);_===-1||!n3(u)||(_===0?r.push(u):a.push({documentOrder:g,tabIndex:_,node:u}))}),a.sort((u,g)=>u.tabIndex===g.tabIndex?u.documentOrder-g.documentOrder:u.tabIndex-g.tabIndex).map(u=>u.node).concat(r)}function o3(){return!0}function s3(e){const{children:r,disableAutoFocus:a=!1,disableEnforceFocus:u=!1,disableRestoreFocus:g=!1,getTabbable:_=i3,isEnabled:M=o3,open:D}=e,i=Y.useRef(!1),j=Y.useRef(null),H=Y.useRef(null),q=Y.useRef(null),X=Y.useRef(null),se=Y.useRef(!1),ne=Y.useRef(null),le=ai(vf(r),ne),de=Y.useRef(null);Y.useEffect(()=>{!D||!ne.current||(se.current=!a)},[a,D]),Y.useEffect(()=>{if(!D||!ne.current)return;const K=Ko(ne.current);return ne.current.contains(K.activeElement)||(ne.current.hasAttribute("tabIndex")||ne.current.setAttribute("tabIndex","-1"),se.current&&ne.current.focus()),()=>{g||(q.current&&q.current.focus&&(i.current=!0,q.current.focus()),q.current=null)}},[D]),Y.useEffect(()=>{if(!D||!ne.current)return;const K=Ko(ne.current),ce=Ce=>{de.current=Ce,!(u||!M()||Ce.key!=="Tab")&&K.activeElement===ne.current&&Ce.shiftKey&&(i.current=!0,H.current&&H.current.focus())},fe=()=>{var ot,oe;const Ce=ne.current;if(Ce===null)return;if(!K.hasFocus()||!M()||i.current){i.current=!1;return}if(Ce.contains(K.activeElement)||u&&K.activeElement!==j.current&&K.activeElement!==H.current)return;if(K.activeElement!==X.current)X.current=null;else if(X.current!==null)return;if(!se.current)return;let we=[];if((K.activeElement===j.current||K.activeElement===H.current)&&(we=_(ne.current)),we.length>0){const ve=!!((ot=de.current)!=null&&ot.shiftKey&&((oe=de.current)==null?void 0:oe.key)==="Tab"),je=we[0],He=we[we.length-1];typeof je!="string"&&typeof He!="string"&&(ve?He.focus():je.focus())}else Ce.focus()};K.addEventListener("focusin",fe),K.addEventListener("keydown",ce,!0);const Ie=setInterval(()=>{K.activeElement&&K.activeElement.tagName==="BODY"&&fe()},50);return()=>{clearInterval(Ie),K.removeEventListener("focusin",fe),K.removeEventListener("keydown",ce,!0)}},[a,u,g,M,D,_]);const te=K=>{q.current===null&&(q.current=K.relatedTarget),se.current=!0,X.current=K.target;const ce=r.props.onFocus;ce&&ce(K)},Q=K=>{q.current===null&&(q.current=K.relatedTarget),se.current=!0};return L.jsxs(Y.Fragment,{children:[L.jsx("div",{tabIndex:D?0:-1,onFocus:Q,ref:j,"data-testid":"sentinelStart"}),Y.cloneElement(r,{ref:le,onFocus:te}),L.jsx("div",{tabIndex:D?0:-1,onFocus:Q,ref:H,"data-testid":"sentinelEnd"})]})}function a3(e){return typeof e=="function"?e():e}function l3(e){return e?e.props.hasOwnProperty("in"):!1}const nx=new QU;function c3(e){const{container:r,disableEscapeKeyDown:a=!1,disableScrollLock:u=!1,closeAfterTransition:g=!1,onTransitionEnter:_,onTransitionExited:M,children:D,onClose:i,open:j,rootRef:H}=e,q=Y.useRef({}),X=Y.useRef(null),se=Y.useRef(null),ne=ai(se,H),[le,de]=Y.useState(!j),te=l3(D);let Q=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(Q=!1);const K=()=>Ko(X.current),ce=()=>(q.current.modalRef=se.current,q.current.mount=X.current,q.current),fe=()=>{nx.mount(ce(),{disableScrollLock:u}),se.current&&(se.current.scrollTop=0)},Ie=Ar(()=>{const ze=a3(r)||K().body;nx.add(ce(),ze),se.current&&fe()}),Ce=()=>nx.isTopModal(ce()),we=Ar(ze=>{X.current=ze,ze&&(j&&Ce()?fe():se.current&&Xg(se.current,Q))}),ot=Y.useCallback(()=>{nx.remove(ce(),Q)},[Q]);Y.useEffect(()=>()=>{ot()},[ot]),Y.useEffect(()=>{j?Ie():(!te||!g)&&ot()},[j,ot,te,g,Ie]);const oe=ze=>Pe=>{var tt;(tt=ze.onKeyDown)==null||tt.call(ze,Pe),!(Pe.key!=="Escape"||Pe.which===229||!Ce())&&(a||(Pe.stopPropagation(),i&&i(Pe,"escapeKeyDown")))},ve=ze=>Pe=>{var tt;(tt=ze.onClick)==null||tt.call(ze,Pe),Pe.target===Pe.currentTarget&&i&&i(Pe,"backdropClick")};return{getRootProps:(ze={})=>{const Pe=Yg(e);delete Pe.onTransitionEnter,delete Pe.onTransitionExited;const tt={...Pe,...ze};return{role:"presentation",...tt,onKeyDown:oe(tt),ref:ne}},getBackdropProps:(ze={})=>{const Pe=ze;return{"aria-hidden":!0,...Pe,onClick:ve(Pe),open:j}},getTransitionProps:()=>{const ze=()=>{de(!1),_&&_()},Pe=()=>{de(!0),M&&M(),g&&ot()};return{onEnter:HP(ze,D==null?void 0:D.props.onEnter),onExited:HP(Pe,D==null?void 0:D.props.onExited)}},rootRef:ne,portalRef:we,isTopModal:Ce,exited:le,hasTransition:te}}function u3(e){return Ir("MuiModal",e)}Mr("MuiModal",["root","hidden","backdrop"]);const d3=e=>{const{open:r,exited:a,classes:u}=e;return Er({root:["root",!r&&a&&"hidden"],backdrop:["backdrop"]},u3,u)},h3=bt("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.open&&a.exited&&r.hidden]}})(ln(({theme:e})=>({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:r})=>!r.open&&r.exited,style:{visibility:"hidden"}}]}))),p3=bt(Az,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,r)=>r.backdrop})({zIndex:-1}),$C=Y.forwardRef(function(r,a){const u=_n({name:"MuiModal",props:r}),{BackdropComponent:g=p3,BackdropProps:_,classes:M,className:D,closeAfterTransition:i=!1,children:j,container:H,component:q,components:X={},componentsProps:se={},disableAutoFocus:ne=!1,disableEnforceFocus:le=!1,disableEscapeKeyDown:de=!1,disablePortal:te=!1,disableRestoreFocus:Q=!1,disableScrollLock:K=!1,hideBackdrop:ce=!1,keepMounted:fe=!1,onBackdropClick:Ie,onClose:Ce,onTransitionEnter:we,onTransitionExited:ot,open:oe,slotProps:ve={},slots:je={},theme:He,...Le}=u,ze={...u,closeAfterTransition:i,disableAutoFocus:ne,disableEnforceFocus:le,disableEscapeKeyDown:de,disablePortal:te,disableRestoreFocus:Q,disableScrollLock:K,hideBackdrop:ce,keepMounted:fe},{getRootProps:Pe,getBackdropProps:tt,getTransitionProps:De,portalRef:Ke,isTopModal:Ge,exited:ft,hasTransition:Gt}=c3({...ze,rootRef:a}),Ft={...ze,exited:ft},wt=d3(Ft),Rt={};if(j.props.tabIndex===void 0&&(Rt.tabIndex="-1"),Gt){const{onEnter:Ht,onExited:xt}=De();Rt.onEnter=Ht,Rt.onExited=xt}const It={...Le,slots:{root:X.Root,backdrop:X.Backdrop,...je},slotProps:{...se,...ve}},[zt,At]=_a("root",{elementType:h3,externalForwardedProps:It,getSlotProps:Pe,additionalProps:{ref:a,as:q},ownerState:Ft,className:rr(D,wt==null?void 0:wt.root,!Ft.open&&Ft.exited&&(wt==null?void 0:wt.hidden))}),[kt,Ot]=_a("backdrop",{elementType:g,externalForwardedProps:It,additionalProps:_,getSlotProps:Ht=>tt({...Ht,onClick:xt=>{Ie&&Ie(xt),Ht!=null&&Ht.onClick&&Ht.onClick(xt)}}),className:rr(_==null?void 0:_.className,wt==null?void 0:wt.backdrop),ownerState:Ft}),be=ai(_==null?void 0:_.ref,Ot.ref);return!fe&&!oe&&(!Gt||ft)?null:L.jsx(J$,{ref:Ke,container:H,disablePortal:te,children:L.jsxs(zt,{...At,children:[!ce&&g?L.jsx(kt,{...Ot,ref:be}):null,L.jsx(s3,{disableEnforceFocus:le,disableAutoFocus:ne,disableRestoreFocus:Q,isEnabled:Ge,open:oe,children:Y.cloneElement(j,Rt)})]})})});function f3(e){return Ir("MuiDialog",e)}const Kg=Mr("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),m3=Y.createContext({}),g3=bt(Az,{name:"MuiDialog",slot:"Backdrop",overrides:(e,r)=>r.backdrop})({zIndex:-1}),y3=e=>{const{classes:r,scroll:a,maxWidth:u,fullWidth:g,fullScreen:_}=e,M={root:["root"],container:["container",`scroll${tr(a)}`],paper:["paper",`paperScroll${tr(a)}`,`paperWidth${tr(String(u))}`,g&&"paperFullWidth",_&&"paperFullScreen"]};return Er(M,f3,r)},_3=bt($C,{name:"MuiDialog",slot:"Root",overridesResolver:(e,r)=>r.root})({"@media print":{position:"absolute !important"}}),x3=bt("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.container,r[`scroll${tr(a.scroll)}`]]}})({height:"100%","@media print":{height:"auto"},outline:0,variants:[{props:{scroll:"paper"},style:{display:"flex",justifyContent:"center",alignItems:"center"}},{props:{scroll:"body"},style:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}}}]}),v3=bt(wf,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.paper,r[`scrollPaper${tr(a.scroll)}`],r[`paperWidth${tr(String(a.maxWidth))}`],a.fullWidth&&r.paperFullWidth,a.fullScreen&&r.paperFullScreen]}})(ln(({theme:e})=>({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"},variants:[{props:{scroll:"paper"},style:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"}},{props:{scroll:"body"},style:{display:"inline-block",verticalAlign:"middle",textAlign:"initial"}},{props:({ownerState:r})=>!r.maxWidth,style:{maxWidth:"calc(100% - 64px)"}},{props:{maxWidth:"xs"},style:{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${Kg.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}}},...Object.keys(e.breakpoints.values).filter(r=>r!=="xs").map(r=>({props:{maxWidth:r},style:{maxWidth:`${e.breakpoints.values[r]}${e.breakpoints.unit}`,[`&.${Kg.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[r]+32*2)]:{maxWidth:"calc(100% - 64px)"}}}})),{props:({ownerState:r})=>r.fullWidth,style:{width:"calc(100% - 64px)"}},{props:({ownerState:r})=>r.fullScreen,style:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${Kg.paperScrollBody}`]:{margin:0,maxWidth:"100%"}}}]}))),Ia=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiDialog"}),g=jl(),_={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen},{"aria-describedby":M,"aria-labelledby":D,BackdropComponent:i,BackdropProps:j,children:H,className:q,disableEscapeKeyDown:X=!1,fullScreen:se=!1,fullWidth:ne=!1,maxWidth:le="sm",onBackdropClick:de,onClick:te,onClose:Q,open:K,PaperComponent:ce=wf,PaperProps:fe={},scroll:Ie="paper",TransitionComponent:Ce=By,transitionDuration:we=_,TransitionProps:ot,...oe}=u,ve={...u,disableEscapeKeyDown:X,fullScreen:se,fullWidth:ne,maxWidth:le,scroll:Ie},je=y3(ve),He=Y.useRef(),Le=De=>{He.current=De.target===De.currentTarget},ze=De=>{te&&te(De),He.current&&(He.current=null,de&&de(De),Q&&Q(De,"backdropClick"))},Pe=Bu(D),tt=Y.useMemo(()=>({titleId:Pe}),[Pe]);return L.jsx(_3,{className:rr(je.root,q),closeAfterTransition:!0,components:{Backdrop:g3},componentsProps:{backdrop:{transitionDuration:we,as:i,...j}},disableEscapeKeyDown:X,onClose:Q,open:K,ref:a,onClick:ze,ownerState:ve,...oe,children:L.jsx(Ce,{appear:!0,in:K,timeout:we,role:"presentation",...ot,children:L.jsx(x3,{className:rr(je.container),onMouseDown:Le,ownerState:ve,children:L.jsx(v3,{as:ce,elevation:24,role:"dialog","aria-describedby":M,"aria-labelledby":Pe,...fe,className:rr(je.paper,fe.className),ownerState:ve,children:L.jsx(m3.Provider,{value:tt,children:H})})})})})});function b3(e){return Ir("MuiDialogActions",e)}Mr("MuiDialogActions",["root","spacing"]);const w3=e=>{const{classes:r,disableSpacing:a}=e;return Er({root:["root",!a&&"spacing"]},b3,r)},S3=bt("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disableSpacing&&r.spacing]}})({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto",variants:[{props:({ownerState:e})=>!e.disableSpacing,style:{"& > :not(style) ~ :not(style)":{marginLeft:8}}}]}),T3=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiDialogActions"}),{className:g,disableSpacing:_=!1,...M}=u,D={...u,disableSpacing:_},i=w3(D);return L.jsx(S3,{className:rr(i.root,g),ownerState:D,ref:a,...M})});function C3(e){return Ir("MuiDialogContent",e)}Mr("MuiDialogContent",["root","dividers"]);const M3=Mr("MuiDialogTitle",["root"]),E3=e=>{const{classes:r,dividers:a}=e;return Er({root:["root",a&&"dividers"]},C3,r)},I3=bt("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.dividers&&r.dividers]}})(ln(({theme:e})=>({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px",variants:[{props:({ownerState:r})=>r.dividers,style:{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>!r.dividers,style:{[`.${M3.root} + &`]:{paddingTop:0}}}]}))),k3=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiDialogContent"}),{className:g,dividers:_=!1,...M}=u,D={...u,dividers:_},i=E3(D);return L.jsx(I3,{className:rr(i.root,g),ownerState:D,ref:a,...M})});function P3(e){return Ir("MuiDivider",e)}const wA=Mr("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),A3=e=>{const{absolute:r,children:a,classes:u,flexItem:g,light:_,orientation:M,textAlign:D,variant:i}=e;return Er({root:["root",r&&"absolute",i,_&&"light",M==="vertical"&&"vertical",g&&"flexItem",a&&"withChildren",a&&M==="vertical"&&"withChildrenVertical",D==="right"&&M!=="vertical"&&"textAlignRight",D==="left"&&M!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",M==="vertical"&&"wrapperVertical"]},P3,u)},D3=bt("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.absolute&&r.absolute,r[a.variant],a.light&&r.light,a.orientation==="vertical"&&r.vertical,a.flexItem&&r.flexItem,a.children&&r.withChildren,a.children&&a.orientation==="vertical"&&r.withChildrenVertical,a.textAlign==="right"&&a.orientation!=="vertical"&&r.textAlignRight,a.textAlign==="left"&&a.orientation!=="vertical"&&r.textAlignLeft]}})(ln(({theme:e})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:e.vars?`rgba(${e.vars.palette.dividerChannel} / 0.08)`:Bn(e.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:e.spacing(2),marginRight:e.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:r})=>!!r.children,style:{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:r})=>r.children&&r.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:r})=>r.orientation==="vertical"&&r.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:r})=>r.textAlign==="right"&&r.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:r})=>r.textAlign==="left"&&r.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),R3=bt("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.wrapper,a.orientation==="vertical"&&r.wrapperVertical]}})(ln(({theme:e})=>({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`,variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`}}]}))),ya=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiDivider"}),{absolute:g=!1,children:_,className:M,orientation:D="horizontal",component:i=_||D==="vertical"?"div":"hr",flexItem:j=!1,light:H=!1,role:q=i!=="hr"?"separator":void 0,textAlign:X="center",variant:se="fullWidth",...ne}=u,le={...u,absolute:g,component:i,flexItem:j,light:H,orientation:D,role:q,textAlign:X,variant:se},de=A3(le);return L.jsx(D3,{as:i,className:rr(de.root,M),role:q,ref:a,ownerState:le,"aria-orientation":q==="separator"&&(i!=="hr"||D==="vertical")?D:void 0,...ne,children:_?L.jsx(R3,{className:de.wrapper,ownerState:le,children:_}):null})});ya&&(ya.muiSkipListHighlight=!0);function L3(e,r,a){const u=r.getBoundingClientRect(),g=a&&a.getBoundingClientRect(),_=Hs(r);let M;if(r.fakeTransform)M=r.fakeTransform;else{const j=_.getComputedStyle(r);M=j.getPropertyValue("-webkit-transform")||j.getPropertyValue("transform")}let D=0,i=0;if(M&&M!=="none"&&typeof M=="string"){const j=M.split("(")[1].split(")")[0].split(",");D=parseInt(j[4],10),i=parseInt(j[5],10)}return e==="left"?g?`translateX(${g.right+D-u.left}px)`:`translateX(${_.innerWidth+D-u.left}px)`:e==="right"?g?`translateX(-${u.right-g.left-D}px)`:`translateX(-${u.left+u.width-D}px)`:e==="up"?g?`translateY(${g.bottom+i-u.top}px)`:`translateY(${_.innerHeight+i-u.top}px)`:g?`translateY(-${u.top-g.top+u.height-i}px)`:`translateY(-${u.top+u.height-i}px)`}function z3(e){return typeof e=="function"?e():e}function ix(e,r,a){const u=z3(a),g=L3(e,r,u);g&&(r.style.webkitTransform=g,r.style.transform=g)}const O3=Y.forwardRef(function(r,a){const u=jl(),g={enter:u.transitions.easing.easeOut,exit:u.transitions.easing.sharp},_={enter:u.transitions.duration.enteringScreen,exit:u.transitions.duration.leavingScreen},{addEndListener:M,appear:D=!0,children:i,container:j,direction:H="down",easing:q=g,in:X,onEnter:se,onEntered:ne,onEntering:le,onExit:de,onExited:te,onExiting:Q,style:K,timeout:ce=_,TransitionComponent:fe=Ks,...Ie}=r,Ce=Y.useRef(null),we=ai(vf(i),Ce,a),ot=De=>Ke=>{De&&(Ke===void 0?De(Ce.current):De(Ce.current,Ke))},oe=ot((De,Ke)=>{ix(H,De,j),NC(De),se&&se(De,Ke)}),ve=ot((De,Ke)=>{const Ge=Lu({timeout:ce,style:K,easing:q},{mode:"enter"});De.style.webkitTransition=u.transitions.create("-webkit-transform",{...Ge}),De.style.transition=u.transitions.create("transform",{...Ge}),De.style.webkitTransform="none",De.style.transform="none",le&&le(De,Ke)}),je=ot(ne),He=ot(Q),Le=ot(De=>{const Ke=Lu({timeout:ce,style:K,easing:q},{mode:"exit"});De.style.webkitTransition=u.transitions.create("-webkit-transform",Ke),De.style.transition=u.transitions.create("transform",Ke),ix(H,De,j),de&&de(De)}),ze=ot(De=>{De.style.webkitTransition="",De.style.transition="",te&&te(De)}),Pe=De=>{M&&M(Ce.current,De)},tt=Y.useCallback(()=>{Ce.current&&ix(H,Ce.current,j)},[H,j]);return Y.useEffect(()=>{if(X||H==="down"||H==="right")return;const De=zy(()=>{Ce.current&&ix(H,Ce.current,j)}),Ke=Hs(Ce.current);return Ke.addEventListener("resize",De),()=>{De.clear(),Ke.removeEventListener("resize",De)}},[H,X,j]),Y.useEffect(()=>{X||tt()},[X,tt]),L.jsx(fe,{nodeRef:Ce,onEnter:oe,onEntered:je,onEntering:ve,onExit:Le,onExited:ze,onExiting:He,addEndListener:Pe,appear:D,in:X,timeout:ce,...Ie,children:(De,Ke)=>Y.cloneElement(i,{ref:we,style:{visibility:De==="exited"&&!X?"hidden":void 0,...K,...i.props.style},...Ke})})});function F3(e){return Ir("MuiDrawer",e)}Mr("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const Lz=(e,r)=>{const{ownerState:a}=e;return[r.root,(a.variant==="permanent"||a.variant==="persistent")&&r.docked,r.modal]},B3=e=>{const{classes:r,anchor:a,variant:u}=e,g={root:["root"],docked:[(u==="permanent"||u==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${tr(a)}`,u!=="temporary"&&`paperAnchorDocked${tr(a)}`]};return Er(g,F3,r)},j3=bt($C,{name:"MuiDrawer",slot:"Root",overridesResolver:Lz})(ln(({theme:e})=>({zIndex:(e.vars||e).zIndex.drawer}))),SA=bt("div",{shouldForwardProp:Qo,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:Lz})({flex:"0 0 auto"}),N3=bt(wf,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.paper,r[`paperAnchor${tr(a.anchor)}`],a.variant!=="temporary"&&r[`paperAnchorDocked${tr(a.anchor)}`]]}})(ln(({theme:e})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(e.vars||e).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:r})=>r.anchor==="left"&&r.variant!=="temporary",style:{borderRight:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="top"&&r.variant!=="temporary",style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="right"&&r.variant!=="temporary",style:{borderLeft:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="bottom"&&r.variant!=="temporary",style:{borderTop:`1px solid ${(e.vars||e).palette.divider}`}}]}))),zz={left:"right",right:"left",top:"down",bottom:"up"};function V3(e){return["left","right"].includes(e)}function $3({direction:e},r){return e==="rtl"&&V3(r)?zz[r]:r}const U3=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiDrawer"}),g=jl(),_=fs(),M={enter:g.transitions.duration.enteringScreen,exit:g.transitions.duration.leavingScreen},{anchor:D="left",BackdropProps:i,children:j,className:H,elevation:q=16,hideBackdrop:X=!1,ModalProps:{BackdropProps:se,...ne}={},onClose:le,open:de=!1,PaperProps:te={},SlideProps:Q,TransitionComponent:K=O3,transitionDuration:ce=M,variant:fe="temporary",...Ie}=u,Ce=Y.useRef(!1);Y.useEffect(()=>{Ce.current=!0},[]);const we=$3({direction:_?"rtl":"ltr"},D),oe={...u,anchor:D,elevation:q,open:de,variant:fe,...Ie},ve=B3(oe),je=L.jsx(N3,{elevation:fe==="temporary"?q:0,square:!0,...te,className:rr(ve.paper,te.className),ownerState:oe,children:j});if(fe==="permanent")return L.jsx(SA,{className:rr(ve.root,ve.docked,H),ownerState:oe,ref:a,...Ie,children:je});const He=L.jsx(K,{in:de,direction:zz[we],timeout:ce,appear:Ce.current,...Q,children:je});return fe==="persistent"?L.jsx(SA,{className:rr(ve.root,ve.docked,H),ownerState:oe,ref:a,...Ie,children:He}):L.jsx(j3,{BackdropProps:{...i,...se,transitionDuration:ce},className:rr(ve.root,ve.modal,H),open:de,ownerState:oe,onClose:le,hideBackdrop:X,ref:a,...Ie,...ne,children:He})});function W3(e){return Ir("MuiFab",e)}const TA=Mr("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),G3=e=>{const{color:r,variant:a,classes:u,size:g}=e,_={root:["root",a,`size${tr(g)}`,r==="inherit"?"colorInherit":r]},M=Er(_,W3,u);return{...u,...M}},H3=bt(rl,{name:"MuiFab",slot:"Root",shouldForwardProp:e=>Qo(e)||e==="classes",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`size${tr(a.size)}`],a.color==="inherit"&&r.colorInherit,r[tr(a.size)],r[a.color]]}})(ln(({theme:e})=>{var r,a;return{...e.typography.button,minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(e.vars||e).zIndex.fab,boxShadow:(e.vars||e).shadows[6],"&:active":{boxShadow:(e.vars||e).shadows[12]},color:e.vars?e.vars.palette.text.primary:(a=(r=e.palette).getContrastText)==null?void 0:a.call(r,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],"&:hover":{backgroundColor:(e.vars||e).palette.grey.A100,"@media (hover: none)":{backgroundColor:(e.vars||e).palette.grey[300]},textDecoration:"none"},[`&.${TA.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),ln(({theme:e})=>({variants:[...Object.entries(e.palette).filter(yo(["dark","contrastText"])).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].contrastText,backgroundColor:(e.vars||e).palette[r].main,"&:hover":{backgroundColor:(e.vars||e).palette[r].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[r].main}}}}))]})),ln(({theme:e})=>({[`&.${TA.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}))),Id=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiFab"}),{children:g,className:_,color:M="default",component:D="button",disabled:i=!1,disableFocusRipple:j=!1,focusVisibleClassName:H,size:q="large",variant:X="circular",...se}=u,ne={...u,color:M,component:D,disabled:i,disableFocusRipple:j,size:q,variant:X},le=G3(ne);return L.jsx(H3,{className:rr(le.root,_),component:D,disabled:i,focusRipple:!j,focusVisibleClassName:rr(le.focusVisible,H),ownerState:ne,ref:a,...se,classes:le,children:g})}),q3=e=>{const{classes:r,disableUnderline:a,startAdornment:u,endAdornment:g,size:_,hiddenLabel:M,multiline:D}=e,i={root:["root",!a&&"underline",u&&"adornedStart",g&&"adornedEnd",_==="small"&&`size${tr(_)}`,M&&"hiddenLabel",D&&"multiline"],input:["input"]},j=Er(i,gU,r);return{...r,...j}},Z3=bt(w1,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[...v1(e,r),!a.disableUnderline&&r.underline]}})(ln(({theme:e})=>{const r=e.palette.mode==="light",a=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",u=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",g=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",_=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:u,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:g,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:u}},[`&.${Ed.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:u},[`&.${Ed.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:_},variants:[{props:({ownerState:M})=>!M.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ed.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ed.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ed.disabled}, .${Ed.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Ed.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(yo()).map(([M])=>{var D;return{props:{disableUnderline:!1,color:M},style:{"&::after":{borderBottom:`2px solid ${(D=(e.vars||e).palette[M])==null?void 0:D.main}`}}}}),{props:({ownerState:M})=>M.startAdornment,style:{paddingLeft:12}},{props:({ownerState:M})=>M.endAdornment,style:{paddingRight:12}},{props:({ownerState:M})=>M.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:M,size:D})=>M.multiline&&D==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:M})=>M.multiline&&M.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:M})=>M.multiline&&M.hiddenLabel&&M.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),Y3=bt(S1,{name:"MuiFilledInput",slot:"Input",overridesResolver:b1})(ln(({theme:e})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:r})=>r.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}},{props:({ownerState:r})=>r.hiddenLabel&&r.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:r})=>r.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),dv=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiFilledInput"}),{disableUnderline:g=!1,components:_={},componentsProps:M,fullWidth:D=!1,hiddenLabel:i,inputComponent:j="input",multiline:H=!1,slotProps:q,slots:X={},type:se="text",...ne}=u,le={...u,disableUnderline:g,fullWidth:D,inputComponent:j,multiline:H,type:se},de=q3(u),te={root:{ownerState:le},input:{ownerState:le}},Q=q??M?Co(te,q??M):te,K=X.root??_.Root??Z3,ce=X.input??_.Input??Y3;return L.jsx(VC,{slots:{root:K,input:ce},componentsProps:Q,fullWidth:D,inputComponent:j,multiline:H,ref:a,type:se,...ne,classes:de})});dv&&(dv.muiName="Input");function X3(e){return Ir("MuiFormControl",e)}Mr("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const K3=e=>{const{classes:r,margin:a,fullWidth:u}=e,g={root:["root",a!=="none"&&`margin${tr(a)}`,u&&"fullWidth"]};return Er(g,X3,r)},J3=bt("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:e},r)=>({...r.root,...r[`margin${tr(e.margin)}`],...e.fullWidth&&r.fullWidth})})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),jy=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiFormControl"}),{children:g,className:_,color:M="primary",component:D="div",disabled:i=!1,error:j=!1,focused:H,fullWidth:q=!1,hiddenLabel:X=!1,margin:se="none",required:ne=!1,size:le="medium",variant:de="outlined",...te}=u,Q={...u,color:M,component:D,disabled:i,error:j,fullWidth:q,hiddenLabel:X,margin:se,required:ne,size:le,variant:de},K=K3(Q),[ce,fe]=Y.useState(()=>{let He=!1;return g&&Y.Children.forEach(g,Le=>{if(!Zg(Le,["Input","Select"]))return;const ze=Zg(Le,["Select"])?Le.props.input:Le;ze&&dU(ze.props)&&(He=!0)}),He}),[Ie,Ce]=Y.useState(()=>{let He=!1;return g&&Y.Children.forEach(g,Le=>{Zg(Le,["Input","Select"])&&(uv(Le.props,!0)||uv(Le.props.inputProps,!0))&&(He=!0)}),He}),[we,ot]=Y.useState(!1);i&&we&&ot(!1);const oe=H!==void 0&&!i?H:we;let ve;Y.useRef(!1);const je=Y.useMemo(()=>({adornedStart:ce,setAdornedStart:fe,color:M,disabled:i,error:j,filled:Ie,focused:oe,fullWidth:q,hiddenLabel:X,size:le,onBlur:()=>{ot(!1)},onEmpty:()=>{Ce(!1)},onFilled:()=>{Ce(!0)},onFocus:()=>{ot(!0)},registerEffect:ve,required:ne,variant:de}),[ce,M,i,j,Ie,oe,q,X,ve,ne,le,de]);return L.jsx(x1.Provider,{value:je,children:L.jsx(J3,{as:D,ownerState:Q,className:rr(K.root,_),ref:a,...te,children:g})})});function Q3(e){return Ir("MuiFormControlLabel",e)}const Fg=Mr("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),e8=e=>{const{classes:r,disabled:a,labelPlacement:u,error:g,required:_}=e,M={root:["root",a&&"disabled",`labelPlacement${tr(u)}`,g&&"error",_&&"required"],label:["label",a&&"disabled"],asterisk:["asterisk",g&&"error"]};return Er(M,Q3,r)},t8=bt("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${Fg.label}`]:r.label},r.root,r[`labelPlacement${tr(a.labelPlacement)}`]]}})(ln(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Fg.disabled}`]:{cursor:"default"},[`& .${Fg.label}`]:{[`&.${Fg.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:r})=>r==="start"||r==="top"||r==="bottom",style:{marginLeft:16}}]}))),r8=bt("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,r)=>r.asterisk})(ln(({theme:e})=>({[`&.${Fg.error}`]:{color:(e.vars||e).palette.error.main}}))),hv=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiFormControlLabel"}),{checked:g,className:_,componentsProps:M={},control:D,disabled:i,disableTypography:j,inputRef:H,label:q,labelPlacement:X="end",name:se,onChange:ne,required:le,slots:de={},slotProps:te={},value:Q,...K}=u,ce=Js(),fe=i??D.props.disabled??(ce==null?void 0:ce.disabled),Ie=le??D.props.required,Ce={disabled:fe,required:Ie};["checked","name","onChange","value","inputRef"].forEach(ze=>{typeof D.props[ze]>"u"&&typeof u[ze]<"u"&&(Ce[ze]=u[ze])});const we=th({props:u,muiFormControl:ce,states:["error"]}),ot={...u,disabled:fe,labelPlacement:X,required:Ie,error:we.error},oe=e8(ot),ve={slots:de,slotProps:{...M,...te}},[je,He]=_a("typography",{elementType:nn,externalForwardedProps:ve,ownerState:ot});let Le=q;return Le!=null&&Le.type!==nn&&!j&&(Le=L.jsx(je,{component:"span",...He,className:rr(oe.label,He==null?void 0:He.className),children:Le})),L.jsxs(t8,{className:rr(oe.root,_),ownerState:ot,ref:a,...K,children:[Y.cloneElement(D,Ce),Ie?L.jsxs("div",{children:[Le,L.jsxs(r8,{ownerState:ot,"aria-hidden":!0,className:oe.asterisk,children:["","*"]})]}):Le]})});function n8(e){return Ir("MuiFormHelperText",e)}const CA=Mr("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var MA;const i8=e=>{const{classes:r,contained:a,size:u,disabled:g,error:_,filled:M,focused:D,required:i}=e,j={root:["root",g&&"disabled",_&&"error",u&&`size${tr(u)}`,a&&"contained",D&&"focused",M&&"filled",i&&"required"]};return Er(j,n8,r)},o8=bt("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.size&&r[`size${tr(a.size)}`],a.contained&&r.contained,a.filled&&r.filled]}})(ln(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${CA.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${CA.error}`]:{color:(e.vars||e).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:r})=>r.contained,style:{marginLeft:14,marginRight:14}}]}))),Oz=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiFormHelperText"}),{children:g,className:_,component:M="p",disabled:D,error:i,filled:j,focused:H,margin:q,required:X,variant:se,...ne}=u,le=Js(),de=th({props:u,muiFormControl:le,states:["variant","size","disabled","error","filled","focused","required"]}),te={...u,component:M,contained:de.variant==="filled"||de.variant==="outlined",variant:de.variant,size:de.size,disabled:de.disabled,error:de.error,filled:de.filled,focused:de.focused,required:de.required};delete te.ownerState;const Q=i8(te);return L.jsx(o8,{as:M,className:rr(Q.root,_),ref:a,...ne,ownerState:te,children:g===" "?MA||(MA=L.jsx("span",{className:"notranslate",children:""})):g})});function s8(e){return Ir("MuiFormLabel",e)}const Jg=Mr("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),a8=e=>{const{classes:r,color:a,focused:u,disabled:g,error:_,filled:M,required:D}=e,i={root:["root",`color${tr(a)}`,g&&"disabled",_&&"error",M&&"filled",u&&"focused",D&&"required"],asterisk:["asterisk",_&&"error"]};return Er(i,s8,r)},l8=bt("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:e},r)=>({...r.root,...e.color==="secondary"&&r.colorSecondary,...e.filled&&r.filled})})(ln(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(e.palette).filter(yo()).map(([r])=>({props:{color:r},style:{[`&.${Jg.focused}`]:{color:(e.vars||e).palette[r].main}}})),{props:{},style:{[`&.${Jg.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${Jg.error}`]:{color:(e.vars||e).palette.error.main}}}]}))),c8=bt("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(e,r)=>r.asterisk})(ln(({theme:e})=>({[`&.${Jg.error}`]:{color:(e.vars||e).palette.error.main}}))),u8=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiFormLabel"}),{children:g,className:_,color:M,component:D="label",disabled:i,error:j,filled:H,focused:q,required:X,...se}=u,ne=Js(),le=th({props:u,muiFormControl:ne,states:["color","required","focused","disabled","error","filled"]}),de={...u,color:le.color||"primary",component:D,disabled:le.disabled,error:le.error,filled:le.filled,focused:le.focused,required:le.required},te=a8(de);return L.jsxs(l8,{as:D,ownerState:de,className:rr(te.root,_),ref:a,...se,children:[g,le.required&&L.jsxs(c8,{ownerState:de,"aria-hidden":!0,className:te.asterisk,children:["","*"]})]})}),Rr=cV({createStyledComponent:bt("div",{name:"MuiGrid2",slot:"Root",overridesResolver:(e,r)=>r.root}),componentName:"MuiGrid2",useThemeProps:e=>oi({props:e,name:"MuiGrid2"})});function pT(e){return`scale(${e}, ${e**2})`}const d8={entering:{opacity:1,transform:pT(1)},entered:{opacity:1,transform:"none"}},rS=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),fT=Y.forwardRef(function(r,a){const{addEndListener:u,appear:g=!0,children:_,easing:M,in:D,onEnter:i,onEntered:j,onEntering:H,onExit:q,onExited:X,onExiting:se,style:ne,timeout:le="auto",TransitionComponent:de=Ks,...te}=r,Q=AC(),K=Y.useRef(),ce=jl(),fe=Y.useRef(null),Ie=ai(fe,vf(_),a),Ce=ze=>Pe=>{if(ze){const tt=fe.current;Pe===void 0?ze(tt):ze(tt,Pe)}},we=Ce(H),ot=Ce((ze,Pe)=>{NC(ze);const{duration:tt,delay:De,easing:Ke}=Lu({style:ne,timeout:le,easing:M},{mode:"enter"});let Ge;le==="auto"?(Ge=ce.transitions.getAutoHeightDuration(ze.clientHeight),K.current=Ge):Ge=tt,ze.style.transition=[ce.transitions.create("opacity",{duration:Ge,delay:De}),ce.transitions.create("transform",{duration:rS?Ge:Ge*.666,delay:De,easing:Ke})].join(","),i&&i(ze,Pe)}),oe=Ce(j),ve=Ce(se),je=Ce(ze=>{const{duration:Pe,delay:tt,easing:De}=Lu({style:ne,timeout:le,easing:M},{mode:"exit"});let Ke;le==="auto"?(Ke=ce.transitions.getAutoHeightDuration(ze.clientHeight),K.current=Ke):Ke=Pe,ze.style.transition=[ce.transitions.create("opacity",{duration:Ke,delay:tt}),ce.transitions.create("transform",{duration:rS?Ke:Ke*.666,delay:rS?tt:tt||Ke*.333,easing:De})].join(","),ze.style.opacity=0,ze.style.transform=pT(.75),q&&q(ze)}),He=Ce(X),Le=ze=>{le==="auto"&&Q.start(K.current||0,ze),u&&u(fe.current,ze)};return L.jsx(de,{appear:g,in:D,nodeRef:fe,onEnter:ot,onEntered:oe,onEntering:we,onExit:je,onExited:He,onExiting:ve,addEndListener:Le,timeout:le==="auto"?null:le,...te,children:(ze,Pe)=>Y.cloneElement(_,{style:{opacity:0,transform:pT(.75),visibility:ze==="exited"&&!D?"hidden":void 0,...d8[ze],...ne,..._.props.style},ref:Ie,...Pe})})});fT&&(fT.muiSupportAuto=!0);const h8=e=>{const{classes:r,disableUnderline:a}=e,g=Er({root:["root",!a&&"underline"],input:["input"]},fU,r);return{...r,...g}},p8=bt(w1,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[...v1(e,r),!a.disableUnderline&&r.underline]}})(ln(({theme:e})=>{let a=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(a=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),{position:"relative",variants:[{props:({ownerState:u})=>u.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:u})=>!u.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${xg.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${xg.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${xg.disabled}, .${xg.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${a}`}},[`&.${xg.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(yo()).map(([u])=>({props:{color:u,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[u].main}`}}}))]}})),f8=bt(S1,{name:"MuiInput",slot:"Input",overridesResolver:b1})({}),pv=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiInput"}),{disableUnderline:g=!1,components:_={},componentsProps:M,fullWidth:D=!1,inputComponent:i="input",multiline:j=!1,slotProps:H,slots:q={},type:X="text",...se}=u,ne=h8(u),de={root:{ownerState:{disableUnderline:g}}},te=H??M?Co(H??M,de):de,Q=q.root??_.Root??p8,K=q.input??_.Input??f8;return L.jsx(VC,{slots:{root:Q,input:K},slotProps:te,fullWidth:D,inputComponent:i,multiline:j,ref:a,type:X,...se,classes:ne})});pv&&(pv.muiName="Input");function m8(e){return Ir("MuiInputAdornment",e)}const EA=Mr("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var IA;const g8=(e,r)=>{const{ownerState:a}=e;return[r.root,r[`position${tr(a.position)}`],a.disablePointerEvents===!0&&r.disablePointerEvents,r[a.variant]]},y8=e=>{const{classes:r,disablePointerEvents:a,hiddenLabel:u,position:g,size:_,variant:M}=e,D={root:["root",a&&"disablePointerEvents",g&&`position${tr(g)}`,M,u&&"hiddenLabel",_&&`size${tr(_)}`]};return Er(D,m8,r)},_8=bt("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:g8})(ln(({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${EA.positionStart}&:not(.${EA.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),x8=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiInputAdornment"}),{children:g,className:_,component:M="div",disablePointerEvents:D=!1,disableTypography:i=!1,position:j,variant:H,...q}=u,X=Js()||{};let se=H;H&&X.variant,X&&!se&&(se=X.variant);const ne={...u,hiddenLabel:X.hiddenLabel,size:X.size,disablePointerEvents:D,position:j,variant:se},le=y8(ne);return L.jsx(x1.Provider,{value:null,children:L.jsx(_8,{as:M,ownerState:ne,className:rr(le.root,_),ref:a,...q,children:typeof g=="string"&&!i?L.jsx(nn,{color:"textSecondary",children:g}):L.jsxs(Y.Fragment,{children:[j==="start"?IA||(IA=L.jsx("span",{className:"notranslate",children:""})):null,g]})})})});function v8(e){return Ir("MuiInputLabel",e)}Mr("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const b8=e=>{const{classes:r,formControl:a,size:u,shrink:g,disableAnimation:_,variant:M,required:D}=e,i={root:["root",a&&"formControl",!_&&"animated",g&&"shrink",u&&u!=="normal"&&`size${tr(u)}`,M],asterisk:[D&&"asterisk"]},j=Er(i,v8,r);return{...r,...j}},w8=bt(u8,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${Jg.asterisk}`]:r.asterisk},r.root,a.formControl&&r.formControl,a.size==="small"&&r.sizeSmall,a.shrink&&r.shrink,!a.disableAnimation&&r.animated,a.focused&&r.focused,r[a.variant]]}})(ln(({theme:e})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:r})=>r.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:r})=>r.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:r})=>!r.disableAnimation,style:{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:r,ownerState:a})=>r==="filled"&&a.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:r,ownerState:a,size:u})=>r==="filled"&&a.shrink&&u==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:r,ownerState:a})=>r==="outlined"&&a.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),T1=Y.forwardRef(function(r,a){const u=_n({name:"MuiInputLabel",props:r}),{disableAnimation:g=!1,margin:_,shrink:M,variant:D,className:i,...j}=u,H=Js();let q=M;typeof q>"u"&&H&&(q=H.filled||H.focused||H.adornedStart);const X=th({props:u,muiFormControl:H,states:["size","variant","required","focused"]}),se={...u,disableAnimation:g,formControl:H,shrink:q,size:X.size,variant:X.variant,required:X.required,focused:X.focused},ne=b8(se);return L.jsx(w8,{"data-shrink":q,ref:a,className:rr(ne.root,i),...j,ownerState:se,classes:ne})}),Ja=Y.createContext({});function S8(e){return Ir("MuiList",e)}Mr("MuiList",["root","padding","dense","subheader"]);const T8=e=>{const{classes:r,disablePadding:a,dense:u,subheader:g}=e;return Er({root:["root",!a&&"padding",u&&"dense",g&&"subheader"]},S8,r)},C8=bt("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disablePadding&&r.padding,a.dense&&r.dense,a.subheader&&r.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>e.subheader,style:{paddingTop:0}}]}),Ns=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiList"}),{children:g,className:_,component:M="ul",dense:D=!1,disablePadding:i=!1,subheader:j,...H}=u,q=Y.useMemo(()=>({dense:D}),[D]),X={...u,component:M,dense:D,disablePadding:i},se=T8(X);return L.jsx(Ja.Provider,{value:q,children:L.jsxs(C8,{as:M,className:rr(se.root,_),ref:a,ownerState:X,...H,children:[j,g]})})});function M8(e){return Ir("MuiListItem",e)}Mr("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);function E8(e){return Ir("MuiListItemButton",e)}const Cp=Mr("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]),I8=(e,r)=>{const{ownerState:a}=e;return[r.root,a.dense&&r.dense,a.alignItems==="flex-start"&&r.alignItemsFlexStart,a.divider&&r.divider,!a.disableGutters&&r.gutters]},k8=e=>{const{alignItems:r,classes:a,dense:u,disabled:g,disableGutters:_,divider:M,selected:D}=e,j=Er({root:["root",u&&"dense",!_&&"gutters",M&&"divider",g&&"disabled",r==="flex-start"&&"alignItemsFlexStart",D&&"selected"]},E8,a);return{...a,...j}},P8=bt(rl,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiListItemButton",slot:"Root",overridesResolver:I8})(ln(({theme:e})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Cp.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${Cp.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${Cp.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${Cp.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Cp.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.dense,style:{paddingTop:4,paddingBottom:4}}]}))),Kn=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiListItemButton"}),{alignItems:g="center",autoFocus:_=!1,component:M="div",children:D,dense:i=!1,disableGutters:j=!1,divider:H=!1,focusVisibleClassName:q,selected:X=!1,className:se,...ne}=u,le=Y.useContext(Ja),de=Y.useMemo(()=>({dense:i||le.dense||!1,alignItems:g,disableGutters:j}),[g,le.dense,i,j]),te=Y.useRef(null);io(()=>{_&&te.current&&te.current.focus()},[_]);const Q={...u,alignItems:g,dense:de.dense,disableGutters:j,divider:H,selected:X},K=k8(Q),ce=ai(te,a);return L.jsx(Ja.Provider,{value:de,children:L.jsx(P8,{ref:ce,href:ne.href||ne.to,component:(ne.href||ne.to)&&M==="div"?"button":M,focusVisibleClassName:rr(K.focusVisible,q),ownerState:Q,className:rr(K.root,se),...ne,classes:K,children:D})})});function A8(e){return Ir("MuiListItemSecondaryAction",e)}Mr("MuiListItemSecondaryAction",["root","disableGutters"]);const D8=e=>{const{disableGutters:r,classes:a}=e;return Er({root:["root",r&&"disableGutters"]},A8,a)},R8=bt("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.disableGutters&&r.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),Fz=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiListItemSecondaryAction"}),{className:g,..._}=u,M=Y.useContext(Ja),D={...u,disableGutters:M.disableGutters},i=D8(D);return L.jsx(R8,{className:rr(i.root,g),ownerState:D,ref:a,..._})});Fz.muiName="ListItemSecondaryAction";const L8=(e,r)=>{const{ownerState:a}=e;return[r.root,a.dense&&r.dense,a.alignItems==="flex-start"&&r.alignItemsFlexStart,a.divider&&r.divider,!a.disableGutters&&r.gutters,!a.disablePadding&&r.padding,a.hasSecondaryAction&&r.secondaryAction]},z8=e=>{const{alignItems:r,classes:a,dense:u,disableGutters:g,disablePadding:_,divider:M,hasSecondaryAction:D}=e;return Er({root:["root",u&&"dense",!g&&"gutters",!_&&"padding",M&&"divider",r==="flex-start"&&"alignItemsFlexStart",D&&"secondaryAction"],container:["container"]},M8,a)},O8=bt("div",{name:"MuiListItem",slot:"Root",overridesResolver:L8})(ln(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:r})=>!r.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:r})=>!r.disablePadding&&r.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:r})=>!r.disablePadding&&!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>!r.disablePadding&&!!r.secondaryAction,style:{paddingRight:48}},{props:({ownerState:r})=>!!r.secondaryAction,style:{[`& > .${Cp.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>r.button,style:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:r})=>r.hasSecondaryAction,style:{paddingRight:48}}]}))),F8=bt("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,r)=>r.container})({position:"relative"}),Vn=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiListItem"}),{alignItems:g="center",children:_,className:M,component:D,components:i={},componentsProps:j={},ContainerComponent:H="li",ContainerProps:{className:q,...X}={},dense:se=!1,disableGutters:ne=!1,disablePadding:le=!1,divider:de=!1,secondaryAction:te,slotProps:Q={},slots:K={},...ce}=u,fe=Y.useContext(Ja),Ie=Y.useMemo(()=>({dense:se||fe.dense||!1,alignItems:g,disableGutters:ne}),[g,fe.dense,se,ne]),Ce=Y.useRef(null),we=Y.Children.toArray(_),ot=we.length&&Zg(we[we.length-1],["ListItemSecondaryAction"]),oe={...u,alignItems:g,dense:Ie.dense,disableGutters:ne,disablePadding:le,divider:de,hasSecondaryAction:ot},ve=z8(oe),je=ai(Ce,a),He=K.root||i.Root||O8,Le=Q.root||j.root||{},ze={className:rr(ve.root,Le.className,M),...ce};let Pe=D||"li";return ot?(Pe=!ze.component&&!D?"div":Pe,H==="li"&&(Pe==="li"?Pe="div":ze.component==="li"&&(ze.component="div")),L.jsx(Ja.Provider,{value:Ie,children:L.jsxs(F8,{as:H,className:rr(ve.container,q),ref:je,ownerState:oe,...X,children:[L.jsx(He,{...Le,...!uc(He)&&{as:Pe,ownerState:{...oe,...Le.ownerState}},...ze,children:we}),we.pop()]})})):L.jsx(Ja.Provider,{value:Ie,children:L.jsxs(He,{...Le,as:Pe,ref:je,...!uc(He)&&{ownerState:{...oe,...Le.ownerState}},...ze,children:[we,te&&L.jsx(Fz,{children:te})]})})});function B8(e){return Ir("MuiListItemIcon",e)}const kA=Mr("MuiListItemIcon",["root","alignItemsFlexStart"]),j8=e=>{const{alignItems:r,classes:a}=e;return Er({root:["root",r==="flex-start"&&"alignItemsFlexStart"]},B8,a)},N8=bt("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.alignItems==="flex-start"&&r.alignItemsFlexStart]}})(ln(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),ni=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiListItemIcon"}),{className:g,..._}=u,M=Y.useContext(Ja),D={...u,alignItems:M.alignItems},i=j8(D);return L.jsx(N8,{className:rr(i.root,g),ownerState:D,ref:a,..._})});function V8(e){return Ir("MuiListItemText",e)}const Np=Mr("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),$8=e=>{const{classes:r,inset:a,primary:u,secondary:g,dense:_}=e;return Er({root:["root",a&&"inset",_&&"dense",u&&g&&"multiline"],primary:["primary"],secondary:["secondary"]},V8,r)},U8=bt("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${Np.primary}`]:r.primary},{[`& .${Np.secondary}`]:r.secondary},r.root,a.inset&&r.inset,a.primary&&a.secondary&&r.multiline,a.dense&&r.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${hA.root}:where(& .${Np.primary})`]:{display:"block"},[`.${hA.root}:where(& .${Np.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),kn=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiListItemText"}),{children:g,className:_,disableTypography:M=!1,inset:D=!1,primary:i,primaryTypographyProps:j,secondary:H,secondaryTypographyProps:q,...X}=u,{dense:se}=Y.useContext(Ja);let ne=i??g,le=H;const de={...u,disableTypography:M,inset:D,primary:!!ne,secondary:!!le,dense:se},te=$8(de);return ne!=null&&ne.type!==nn&&!M&&(ne=L.jsx(nn,{variant:se?"body2":"body1",className:te.primary,component:j!=null&&j.variant?void 0:"span",...j,children:ne})),le!=null&&le.type!==nn&&!M&&(le=L.jsx(nn,{variant:"body2",className:te.secondary,color:"textSecondary",...q,children:le})),L.jsxs(U8,{className:rr(te.root,_),ownerState:de,ref:a,...X,children:[ne,le]})});function nS(e,r,a){return e===r?e.firstChild:r&&r.nextElementSibling?r.nextElementSibling:a?null:e.firstChild}function PA(e,r,a){return e===r?a?e.firstChild:e.lastChild:r&&r.previousElementSibling?r.previousElementSibling:a?null:e.lastChild}function Bz(e,r){if(r===void 0)return!0;let a=e.innerText;return a===void 0&&(a=e.textContent),a=a.trim().toLowerCase(),a.length===0?!1:r.repeating?a[0]===r.keys[0]:a.startsWith(r.keys.join(""))}function vg(e,r,a,u,g,_){let M=!1,D=g(e,r,r?a:!1);for(;D;){if(D===e.firstChild){if(M)return!1;M=!0}const i=u?!1:D.disabled||D.getAttribute("aria-disabled")==="true";if(!D.hasAttribute("tabindex")||!Bz(D,_)||i)D=g(e,D,a);else return D.focus(),!0}return!1}const W8=Y.forwardRef(function(r,a){const{actions:u,autoFocus:g=!1,autoFocusItem:_=!1,children:M,className:D,disabledItemsFocusable:i=!1,disableListWrap:j=!1,onKeyDown:H,variant:q="selectedMenu",...X}=r,se=Y.useRef(null),ne=Y.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});io(()=>{g&&se.current.focus()},[g]),Y.useImperativeHandle(u,()=>({adjustStyleForScrollbar:(K,{direction:ce})=>{const fe=!se.current.style.width;if(K.clientHeight<se.current.clientHeight&&fe){const Ie=`${hz(Hs(K))}px`;se.current.style[ce==="rtl"?"paddingLeft":"paddingRight"]=Ie,se.current.style.width=`calc(100% + ${Ie})`}return se.current}}),[]);const le=K=>{const ce=se.current,fe=K.key;if(K.ctrlKey||K.metaKey||K.altKey){H&&H(K);return}const Ce=Ko(ce).activeElement;if(fe==="ArrowDown")K.preventDefault(),vg(ce,Ce,j,i,nS);else if(fe==="ArrowUp")K.preventDefault(),vg(ce,Ce,j,i,PA);else if(fe==="Home")K.preventDefault(),vg(ce,null,j,i,nS);else if(fe==="End")K.preventDefault(),vg(ce,null,j,i,PA);else if(fe.length===1){const we=ne.current,ot=fe.toLowerCase(),oe=performance.now();we.keys.length>0&&(oe-we.lastTime>500?(we.keys=[],we.repeating=!0,we.previousKeyMatched=!0):we.repeating&&ot!==we.keys[0]&&(we.repeating=!1)),we.lastTime=oe,we.keys.push(ot);const ve=Ce&&!we.repeating&&Bz(Ce,we);we.previousKeyMatched&&(ve||vg(ce,Ce,!1,i,nS,we))?K.preventDefault():we.previousKeyMatched=!1}H&&H(K)},de=ai(se,a);let te=-1;Y.Children.forEach(M,(K,ce)=>{if(!Y.isValidElement(K)){te===ce&&(te+=1,te>=M.length&&(te=-1));return}K.props.disabled||(q==="selectedMenu"&&K.props.selected||te===-1)&&(te=ce),te===ce&&(K.props.disabled||K.props.muiSkipListHighlight||K.type.muiSkipListHighlight)&&(te+=1,te>=M.length&&(te=-1))});const Q=Y.Children.map(M,(K,ce)=>{if(ce===te){const fe={};return _&&(fe.autoFocus=!0),K.props.tabIndex===void 0&&q==="selectedMenu"&&(fe.tabIndex=0),Y.cloneElement(K,fe)}return K});return L.jsx(Ns,{role:"menu",ref:de,className:D,onKeyDown:le,tabIndex:g?0:-1,...X,children:Q})});function G8(e){return Ir("MuiPopover",e)}Mr("MuiPopover",["root","paper"]);function AA(e,r){let a=0;return typeof r=="number"?a=r:r==="center"?a=e.height/2:r==="bottom"&&(a=e.height),a}function DA(e,r){let a=0;return typeof r=="number"?a=r:r==="center"?a=e.width/2:r==="right"&&(a=e.width),a}function RA(e){return[e.horizontal,e.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function iS(e){return typeof e=="function"?e():e}const H8=e=>{const{classes:r}=e;return Er({root:["root"],paper:["paper"]},G8,r)},q8=bt($C,{name:"MuiPopover",slot:"Root",overridesResolver:(e,r)=>r.root})({}),jz=bt(wf,{name:"MuiPopover",slot:"Paper",overridesResolver:(e,r)=>r.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Nz=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiPopover"}),{action:g,anchorEl:_,anchorOrigin:M={vertical:"top",horizontal:"left"},anchorPosition:D,anchorReference:i="anchorEl",children:j,className:H,container:q,elevation:X=8,marginThreshold:se=16,open:ne,PaperProps:le={},slots:de={},slotProps:te={},transformOrigin:Q={vertical:"top",horizontal:"left"},TransitionComponent:K=fT,transitionDuration:ce="auto",TransitionProps:{onEntering:fe,...Ie}={},disableScrollLock:Ce=!1,...we}=u,ot=(te==null?void 0:te.paper)??le,oe=Y.useRef(),ve={...u,anchorOrigin:M,anchorReference:i,elevation:X,marginThreshold:se,externalPaperSlotProps:ot,transformOrigin:Q,TransitionComponent:K,transitionDuration:ce,TransitionProps:Ie},je=H8(ve),He=Y.useCallback(()=>{if(i==="anchorPosition")return D;const Ot=iS(_),Ht=(Ot&&Ot.nodeType===1?Ot:Ko(oe.current).body).getBoundingClientRect();return{top:Ht.top+AA(Ht,M.vertical),left:Ht.left+DA(Ht,M.horizontal)}},[_,M.horizontal,M.vertical,D,i]),Le=Y.useCallback(Ot=>({vertical:AA(Ot,Q.vertical),horizontal:DA(Ot,Q.horizontal)}),[Q.horizontal,Q.vertical]),ze=Y.useCallback(Ot=>{const be={width:Ot.offsetWidth,height:Ot.offsetHeight},Ht=Le(be);if(i==="none")return{top:null,left:null,transformOrigin:RA(Ht)};const xt=He();let Bt=xt.top-Ht.vertical,rt=xt.left-Ht.horizontal;const qt=Bt+be.height,Lt=rt+be.width,Yt=Hs(iS(_)),Wt=Yt.innerHeight-se,wr=Yt.innerWidth-se;if(se!==null&&Bt<se){const Sr=Bt-se;Bt-=Sr,Ht.vertical+=Sr}else if(se!==null&&qt>Wt){const Sr=qt-Wt;Bt-=Sr,Ht.vertical+=Sr}if(se!==null&&rt<se){const Sr=rt-se;rt-=Sr,Ht.horizontal+=Sr}else if(Lt>wr){const Sr=Lt-wr;rt-=Sr,Ht.horizontal+=Sr}return{top:`${Math.round(Bt)}px`,left:`${Math.round(rt)}px`,transformOrigin:RA(Ht)}},[_,i,He,Le,se]),[Pe,tt]=Y.useState(ne),De=Y.useCallback(()=>{const Ot=oe.current;if(!Ot)return;const be=ze(Ot);be.top!==null&&Ot.style.setProperty("top",be.top),be.left!==null&&(Ot.style.left=be.left),Ot.style.transformOrigin=be.transformOrigin,tt(!0)},[ze]);Y.useEffect(()=>(Ce&&window.addEventListener("scroll",De),()=>window.removeEventListener("scroll",De)),[_,Ce,De]);const Ke=(Ot,be)=>{fe&&fe(Ot,be),De()},Ge=()=>{tt(!1)};Y.useEffect(()=>{ne&&De()}),Y.useImperativeHandle(g,()=>ne?{updatePosition:()=>{De()}}:null,[ne,De]),Y.useEffect(()=>{if(!ne)return;const Ot=zy(()=>{De()}),be=Hs(_);return be.addEventListener("resize",Ot),()=>{Ot.clear(),be.removeEventListener("resize",Ot)}},[_,ne,De]);let ft=ce;ce==="auto"&&!K.muiSupportAuto&&(ft=void 0);const Gt=q||(_?Ko(iS(_)).body:void 0),Ft={slots:de,slotProps:{...te,paper:ot}},[wt,Rt]=_a("paper",{elementType:jz,externalForwardedProps:Ft,additionalProps:{elevation:X,className:rr(je.paper,ot==null?void 0:ot.className),style:Pe?ot.style:{...ot.style,opacity:0}},ownerState:ve}),[It,{slotProps:zt,...At}]=_a("root",{elementType:q8,externalForwardedProps:Ft,additionalProps:{slotProps:{backdrop:{invisible:!0}},container:Gt,open:ne},ownerState:ve,className:rr(je.root,H)}),kt=ai(oe,Rt.ref);return L.jsx(It,{...At,...!uc(It)&&{slotProps:zt,disableScrollLock:Ce},...we,ref:a,children:L.jsx(K,{appear:!0,in:ne,onEntering:Ke,onExited:Ge,timeout:ft,...Ie,children:L.jsx(wt,{...Rt,ref:kt,children:j})})})});function Z8(e){return Ir("MuiMenu",e)}Mr("MuiMenu",["root","paper","list"]);const Y8={vertical:"top",horizontal:"right"},X8={vertical:"top",horizontal:"left"},K8=e=>{const{classes:r}=e;return Er({root:["root"],paper:["paper"],list:["list"]},Z8,r)},J8=bt(Nz,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(e,r)=>r.root})({}),Q8=bt(jz,{name:"MuiMenu",slot:"Paper",overridesResolver:(e,r)=>r.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),eW=bt(W8,{name:"MuiMenu",slot:"List",overridesResolver:(e,r)=>r.list})({outline:0}),tW=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiMenu"}),{autoFocus:g=!0,children:_,className:M,disableAutoFocusItem:D=!1,MenuListProps:i={},onClose:j,open:H,PaperProps:q={},PopoverClasses:X,transitionDuration:se="auto",TransitionProps:{onEntering:ne,...le}={},variant:de="selectedMenu",slots:te={},slotProps:Q={},...K}=u,ce=fs(),fe={...u,autoFocus:g,disableAutoFocusItem:D,MenuListProps:i,onEntering:ne,PaperProps:q,transitionDuration:se,TransitionProps:le,variant:de},Ie=K8(fe),Ce=g&&!D&&H,we=Y.useRef(null),ot=(Pe,tt)=>{we.current&&we.current.adjustStyleForScrollbar(Pe,{direction:ce?"rtl":"ltr"}),ne&&ne(Pe,tt)},oe=Pe=>{Pe.key==="Tab"&&(Pe.preventDefault(),j&&j(Pe,"tabKeyDown"))};let ve=-1;Y.Children.map(_,(Pe,tt)=>{Y.isValidElement(Pe)&&(Pe.props.disabled||(de==="selectedMenu"&&Pe.props.selected||ve===-1)&&(ve=tt))});const je=te.paper??Q8,He=Q.paper??q,Le=jn({elementType:te.root,externalSlotProps:Q.root,ownerState:fe,className:[Ie.root,M]}),ze=jn({elementType:je,externalSlotProps:He,ownerState:fe,className:Ie.paper});return L.jsx(J8,{onClose:j,anchorOrigin:{vertical:"bottom",horizontal:ce?"right":"left"},transformOrigin:ce?Y8:X8,slots:{paper:je,root:te.root},slotProps:{root:Le,paper:ze},open:H,ref:a,transitionDuration:se,TransitionProps:{onEntering:ot,...le},ownerState:fe,...K,classes:X,children:L.jsx(eW,{onKeyDown:oe,actions:we,autoFocus:g&&(ve===-1||D),autoFocusItem:Ce,variant:de,...i,className:rr(Ie.list,i.className),children:_})})});function rW(e){return Ir("MuiMenuItem",e)}const bg=Mr("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),nW=(e,r)=>{const{ownerState:a}=e;return[r.root,a.dense&&r.dense,a.divider&&r.divider,!a.disableGutters&&r.gutters]},iW=e=>{const{disabled:r,dense:a,divider:u,disableGutters:g,selected:_,classes:M}=e,i=Er({root:["root",a&&"dense",r&&"disabled",!g&&"gutters",u&&"divider",_&&"selected"]},rW,M);return{...M,...i}},oW=bt(rl,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:nW})(ln(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${bg.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${bg.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${bg.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Bn(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${bg.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${bg.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${wA.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${wA.inset}`]:{marginLeft:52},[`& .${Np.root}`]:{marginTop:0,marginBottom:0},[`& .${Np.inset}`]:{paddingLeft:36},[`& .${kA.root}`]:{minWidth:36},variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>!r.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:r})=>r.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${kA.root} svg`]:{fontSize:"1.25rem"}}}]}))),Ur=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiMenuItem"}),{autoFocus:g=!1,component:_="li",dense:M=!1,divider:D=!1,disableGutters:i=!1,focusVisibleClassName:j,role:H="menuitem",tabIndex:q,className:X,...se}=u,ne=Y.useContext(Ja),le=Y.useMemo(()=>({dense:M||ne.dense||!1,disableGutters:i}),[ne.dense,M,i]),de=Y.useRef(null);io(()=>{g&&de.current&&de.current.focus()},[g]);const te={...u,dense:le.dense,divider:D,disableGutters:i},Q=iW(u),K=ai(de,a);let ce;return u.disabled||(ce=q!==void 0?q:-1),L.jsx(Ja.Provider,{value:le,children:L.jsx(oW,{ref:K,role:H,tabIndex:ce,component:_,focusVisibleClassName:rr(Q.focusVisible,j),className:rr(Q.root,X),...se,ownerState:te,classes:Q})})});function sW(e){return Ir("MuiNativeSelect",e)}const UC=Mr("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),aW=e=>{const{classes:r,variant:a,disabled:u,multiple:g,open:_,error:M}=e,D={select:["select",a,u&&"disabled",g&&"multiple",M&&"error"],icon:["icon",`icon${tr(a)}`,_&&"iconOpen",u&&"disabled"]};return Er(D,sW,r)},Vz=bt("select")(({theme:e})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${UC.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},variants:[{props:({ownerState:r})=>r.variant!=="filled"&&r.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}}]})),lW=bt(Vz,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Qo,overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.select,r[a.variant],a.error&&r.error,{[`&.${UC.multiple}`]:r.multiple}]}})({}),$z=bt("svg")(({theme:e})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${UC.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:({ownerState:r})=>r.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),cW=bt($z,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.icon,a.variant&&r[`icon${tr(a.variant)}`],a.open&&r.iconOpen]}})({}),uW=Y.forwardRef(function(r,a){const{className:u,disabled:g,error:_,IconComponent:M,inputRef:D,variant:i="standard",...j}=r,H={...r,disabled:g,variant:i,error:_},q=aW(H);return L.jsxs(Y.Fragment,{children:[L.jsx(lW,{ownerState:H,className:rr(q.select,u),disabled:g,ref:D||a,...j}),r.multiple?null:L.jsx(cW,{as:M,ownerState:H,className:q.icon})]})});var LA;const dW=bt("fieldset",{shouldForwardProp:Qo})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),hW=bt("legend",{shouldForwardProp:Qo})(ln(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:r})=>!r.withLabel,style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:({ownerState:r})=>r.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:r})=>r.withLabel&&r.notched,style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]})));function pW(e){const{children:r,classes:a,className:u,label:g,notched:_,...M}=e,D=g!=null&&g!=="",i={...e,notched:_,withLabel:D};return L.jsx(dW,{"aria-hidden":!0,className:u,ownerState:i,...M,children:L.jsx(hW,{ownerState:i,children:D?L.jsx("span",{children:g}):LA||(LA=L.jsx("span",{className:"notranslate",children:""}))})})}const fW=e=>{const{classes:r}=e,u=Er({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},mU,r);return{...r,...u}},mW=bt(w1,{shouldForwardProp:e=>Qo(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:v1})(ln(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${Ml.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${Ml.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${Ml.focused} .${Ml.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(e.palette).filter(yo()).map(([a])=>({props:{color:a},style:{[`&.${Ml.focused} .${Ml.notchedOutline}`]:{borderColor:(e.vars||e).palette[a].main}}})),{props:{},style:{[`&.${Ml.error} .${Ml.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${Ml.disabled} .${Ml.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}}},{props:({ownerState:a})=>a.startAdornment,style:{paddingLeft:14}},{props:({ownerState:a})=>a.endAdornment,style:{paddingRight:14}},{props:({ownerState:a})=>a.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:a,size:u})=>a.multiline&&u==="small",style:{padding:"8.5px 14px"}}]}})),gW=bt(pW,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,r)=>r.notchedOutline})(ln(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}})),yW=bt(S1,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:b1})(ln(({theme:e})=>({padding:"16.5px 14px",...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:r})=>r.multiline,style:{padding:0}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}}]}))),fv=Y.forwardRef(function(r,a){var u;const g=_n({props:r,name:"MuiOutlinedInput"}),{components:_={},fullWidth:M=!1,inputComponent:D="input",label:i,multiline:j=!1,notched:H,slots:q={},type:X="text",...se}=g,ne=fW(g),le=Js(),de=th({props:g,muiFormControl:le,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),te={...g,color:de.color||"primary",disabled:de.disabled,error:de.error,focused:de.focused,formControl:le,fullWidth:M,hiddenLabel:de.hiddenLabel,multiline:j,size:de.size,type:X},Q=q.root??_.Root??mW,K=q.input??_.Input??yW;return L.jsx(VC,{slots:{root:Q,input:K},renderSuffix:ce=>L.jsx(gW,{ownerState:te,className:ne.notchedOutline,label:i!=null&&i!==""&&de.required?u||(u=L.jsxs(Y.Fragment,{children:[i,"","*"]})):i,notched:typeof H<"u"?H:!!(ce.startAdornment||ce.filled||ce.focused)}),fullWidth:M,inputComponent:D,multiline:j,ref:a,type:X,...se,classes:{...ne,notchedOutline:null}})});fv&&(fv.muiName="Input");function _W(e){return Ir("MuiSelect",e)}const wg=Mr("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var zA;const xW=bt(Vz,{name:"MuiSelect",slot:"Select",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`&.${wg.select}`]:r.select},{[`&.${wg.select}`]:r[a.variant]},{[`&.${wg.error}`]:r.error},{[`&.${wg.multiple}`]:r.multiple}]}})({[`&.${wg.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),vW=bt($z,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.icon,a.variant&&r[`icon${tr(a.variant)}`],a.open&&r.iconOpen]}})({}),bW=bt("input",{shouldForwardProp:e=>_1(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(e,r)=>r.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function OA(e,r){return typeof r=="object"&&r!==null?e===r:String(e)===String(r)}function wW(e){return e==null||typeof e=="string"&&!e.trim()}const SW=e=>{const{classes:r,variant:a,disabled:u,multiple:g,open:_,error:M}=e,D={select:["select",a,u&&"disabled",g&&"multiple",M&&"error"],icon:["icon",`icon${tr(a)}`,_&&"iconOpen",u&&"disabled"],nativeInput:["nativeInput"]};return Er(D,_W,r)},TW=Y.forwardRef(function(r,a){var li;const{"aria-describedby":u,"aria-label":g,autoFocus:_,autoWidth:M,children:D,className:i,defaultOpen:j,defaultValue:H,disabled:q,displayEmpty:X,error:se=!1,IconComponent:ne,inputRef:le,labelId:de,MenuProps:te={},multiple:Q,name:K,onBlur:ce,onChange:fe,onClose:Ie,onFocus:Ce,onOpen:we,open:ot,readOnly:oe,renderValue:ve,SelectDisplayProps:je={},tabIndex:He,type:Le,value:ze,variant:Pe="standard",...tt}=r,[De,Ke]=tl({controlled:ze,default:H,name:"Select"}),[Ge,ft]=tl({controlled:ot,default:j,name:"Select"}),Gt=Y.useRef(null),Ft=Y.useRef(null),[wt,Rt]=Y.useState(null),{current:It}=Y.useRef(ot!=null),[zt,At]=Y.useState(),kt=ai(a,le),Ot=Y.useCallback(Dr=>{Ft.current=Dr,Dr&&Rt(Dr)},[]),be=wt==null?void 0:wt.parentNode;Y.useImperativeHandle(kt,()=>({focus:()=>{Ft.current.focus()},node:Gt.current,value:De}),[De]),Y.useEffect(()=>{j&&Ge&&wt&&!It&&(At(M?null:be.clientWidth),Ft.current.focus())},[wt,M]),Y.useEffect(()=>{_&&Ft.current.focus()},[_]),Y.useEffect(()=>{if(!de)return;const Dr=Ko(Ft.current).getElementById(de);if(Dr){const dr=()=>{getSelection().isCollapsed&&Ft.current.focus()};return Dr.addEventListener("click",dr),()=>{Dr.removeEventListener("click",dr)}}},[de]);const Ht=(Dr,dr)=>{Dr?we&&we(dr):Ie&&Ie(dr),It||(At(M?null:be.clientWidth),ft(Dr))},xt=Dr=>{Dr.button===0&&(Dr.preventDefault(),Ft.current.focus(),Ht(!0,Dr))},Bt=Dr=>{Ht(!1,Dr)},rt=Y.Children.toArray(D),qt=Dr=>{const dr=rt.find(gr=>gr.props.value===Dr.target.value);dr!==void 0&&(Ke(dr.props.value),fe&&fe(Dr,dr))},Lt=Dr=>dr=>{let gr;if(dr.currentTarget.hasAttribute("tabindex")){if(Q){gr=Array.isArray(De)?De.slice():[];const Zr=De.indexOf(Dr.props.value);Zr===-1?gr.push(Dr.props.value):gr.splice(Zr,1)}else gr=Dr.props.value;if(Dr.props.onClick&&Dr.props.onClick(dr),De!==gr&&(Ke(gr),fe)){const Zr=dr.nativeEvent||dr,hn=new Zr.constructor(Zr.type,Zr);Object.defineProperty(hn,"target",{writable:!0,value:{value:gr,name:K}}),fe(hn,Dr)}Q||Ht(!1,dr)}},Yt=Dr=>{oe||[" ","ArrowUp","ArrowDown","Enter"].includes(Dr.key)&&(Dr.preventDefault(),Ht(!0,Dr))},Wt=wt!==null&&Ge,wr=Dr=>{!Wt&&ce&&(Object.defineProperty(Dr,"target",{writable:!0,value:{value:De,name:K}}),ce(Dr))};delete tt["aria-invalid"];let Sr,dn;const Tt=[];let ar=!1;(uv({value:De})||X)&&(ve?Sr=ve(De):ar=!0);const Xt=rt.map(Dr=>{if(!Y.isValidElement(Dr))return null;let dr;if(Q){if(!Array.isArray(De))throw new Error(gc(2));dr=De.some(gr=>OA(gr,Dr.props.value)),dr&&ar&&Tt.push(Dr.props.children)}else dr=OA(De,Dr.props.value),dr&&ar&&(dn=Dr.props.children);return Y.cloneElement(Dr,{"aria-selected":dr?"true":"false",onClick:Lt(Dr),onKeyUp:gr=>{gr.key===" "&&gr.preventDefault(),Dr.props.onKeyUp&&Dr.props.onKeyUp(gr)},role:"option",selected:dr,value:void 0,"data-value":Dr.props.value})});ar&&(Q?Tt.length===0?Sr=null:Sr=Tt.reduce((Dr,dr,gr)=>(Dr.push(dr),gr<Tt.length-1&&Dr.push(", "),Dr),[]):Sr=dn);let Hr=zt;!M&&It&&wt&&(Hr=be.clientWidth);let zr;typeof He<"u"?zr=He:zr=q?null:0;const br=je.id||(K?`mui-component-select-${K}`:void 0),Qr={...r,variant:Pe,value:De,open:Wt,error:se},pn=SW(Qr),Wr={...te.PaperProps,...(li=te.slotProps)==null?void 0:li.paper},Jn=Bu();return L.jsxs(Y.Fragment,{children:[L.jsx(xW,{as:"div",ref:Ot,tabIndex:zr,role:"combobox","aria-controls":Jn,"aria-disabled":q?"true":void 0,"aria-expanded":Wt?"true":"false","aria-haspopup":"listbox","aria-label":g,"aria-labelledby":[de,br].filter(Boolean).join(" ")||void 0,"aria-describedby":u,onKeyDown:Yt,onMouseDown:q||oe?null:xt,onBlur:wr,onFocus:Ce,...je,ownerState:Qr,className:rr(je.className,pn.select,i),id:br,children:wW(Sr)?zA||(zA=L.jsx("span",{className:"notranslate",children:""})):Sr}),L.jsx(bW,{"aria-invalid":se,value:Array.isArray(De)?De.join(","):De,name:K,ref:Gt,"aria-hidden":!0,onChange:qt,tabIndex:-1,disabled:q,className:pn.nativeInput,autoFocus:_,...tt,ownerState:Qr}),L.jsx(vW,{as:ne,className:pn.icon,ownerState:Qr}),L.jsx(tW,{id:`menu-${K||""}`,anchorEl:be,open:Wt,onClose:Bt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...te,MenuListProps:{"aria-labelledby":de,role:"listbox","aria-multiselectable":Q?"true":void 0,disableListWrap:!0,id:Jn,...te.MenuListProps},slotProps:{...te.slotProps,paper:{...Wr,style:{minWidth:Hr,...Wr!=null?Wr.style:null}}},children:Xt})]})}),CW=e=>{const{classes:r}=e;return r},WC={name:"MuiSelect",overridesResolver:(e,r)=>r.root,shouldForwardProp:e=>Qo(e)&&e!=="variant",slot:"Root"},MW=bt(pv,WC)(""),EW=bt(fv,WC)(""),IW=bt(dv,WC)(""),Ny=Y.forwardRef(function(r,a){const u=oi({name:"MuiSelect",props:r}),{autoWidth:g=!1,children:_,classes:M={},className:D,defaultOpen:i=!1,displayEmpty:j=!1,IconComponent:H=yU,id:q,input:X,inputProps:se,label:ne,labelId:le,MenuProps:de,multiple:te=!1,native:Q=!1,onClose:K,onOpen:ce,open:fe,renderValue:Ie,SelectDisplayProps:Ce,variant:we="outlined",...ot}=u,oe=Q?uW:TW,ve=Js(),je=th({props:u,muiFormControl:ve,states:["variant","error"]}),He=je.variant||we,Le={...u,variant:He,classes:M},ze=CW(Le),{root:Pe,...tt}=ze,De=X||{standard:L.jsx(MW,{ownerState:Le}),outlined:L.jsx(EW,{label:ne,ownerState:Le}),filled:L.jsx(IW,{ownerState:Le})}[He],Ke=ai(a,vf(De));return L.jsx(Y.Fragment,{children:Y.cloneElement(De,{inputComponent:oe,inputProps:{children:_,error:je.error,IconComponent:H,variant:He,type:void 0,multiple:te,...Q?{id:q}:{autoWidth:g,defaultOpen:i,displayEmpty:j,labelId:le,MenuProps:de,onClose:K,onOpen:ce,open:fe,renderValue:Ie,SelectDisplayProps:{id:q,...Ce}},...se,classes:se?Co(tt,se.classes):tt,...X?X.props.inputProps:{}},...(te&&Q||j)&&He==="outlined"?{notched:!0}:{},ref:Ke,className:rr(De.props.className,D,ze.root),...!X&&{variant:He},...ot})})});Ny.muiName="Select";function kW(e,r,a=(u,g)=>u===g){return e.length===r.length&&e.every((u,g)=>a(u,r[g]))}const PW=2;function Uz(e,r){return e-r}function FA(e,r){const{index:a}=e.reduce((u,g,_)=>{const M=Math.abs(r-g);return u===null||M<u.distance||M===u.distance?{distance:M,index:_}:u},null)??{};return a}function ox(e,r){if(r.current!==void 0&&e.changedTouches){const a=e;for(let u=0;u<a.changedTouches.length;u+=1){const g=a.changedTouches[u];if(g.identifier===r.current)return{x:g.clientX,y:g.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function mv(e,r,a){return(e-r)*100/(a-r)}function AW(e,r,a){return(a-r)*e+r}function DW(e){if(Math.abs(e)<1){const a=e.toExponential().split("e-"),u=a[0].split(".")[1];return(u?u.length:0)+parseInt(a[1],10)}const r=e.toString().split(".")[1];return r?r.length:0}function RW(e,r,a){const u=Math.round((e-a)/r)*r+a;return Number(u.toFixed(DW(r)))}function BA({values:e,newValue:r,index:a}){const u=e.slice();return u[a]=r,u.sort(Uz)}function sx({sliderRef:e,activeIndex:r,setActive:a}){var g,_,M;const u=Ko(e.current);(!((g=e.current)!=null&&g.contains(u.activeElement))||Number((_=u==null?void 0:u.activeElement)==null?void 0:_.getAttribute("data-index"))!==r)&&((M=e.current)==null||M.querySelector(`[type="range"][data-index="${r}"]`).focus()),a&&a(r)}function ax(e,r){return typeof e=="number"&&typeof r=="number"?e===r:typeof e=="object"&&typeof r=="object"?kW(e,r):!1}const LW={horizontal:{offset:e=>({left:`${e}%`}),leap:e=>({width:`${e}%`})},"horizontal-reverse":{offset:e=>({right:`${e}%`}),leap:e=>({width:`${e}%`})},vertical:{offset:e=>({bottom:`${e}%`}),leap:e=>({height:`${e}%`})}},zW=e=>e;let lx;function jA(){return lx===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?lx=CSS.supports("touch-action","none"):lx=!0),lx}function OW(e){const{"aria-labelledby":r,defaultValue:a,disabled:u=!1,disableSwap:g=!1,isRtl:_=!1,marks:M=!1,max:D=100,min:i=0,name:j,onChange:H,onChangeCommitted:q,orientation:X="horizontal",rootRef:se,scale:ne=zW,step:le=1,shiftStep:de=10,tabIndex:te,value:Q}=e,K=Y.useRef(void 0),[ce,fe]=Y.useState(-1),[Ie,Ce]=Y.useState(-1),[we,ot]=Y.useState(!1),oe=Y.useRef(0),[ve,je]=tl({controlled:Q,default:a??i,name:"Slider"}),He=H&&((Tt,ar,Xt)=>{const Hr=Tt.nativeEvent||Tt,zr=new Hr.constructor(Hr.type,Hr);Object.defineProperty(zr,"target",{writable:!0,value:{value:ar,name:j}}),H(zr,ar,Xt)}),Le=Array.isArray(ve);let ze=Le?ve.slice().sort(Uz):[ve];ze=ze.map(Tt=>Tt==null?i:Sp(Tt,i,D));const Pe=M===!0&&le!==null?[...Array(Math.floor((D-i)/le)+1)].map((Tt,ar)=>({value:i+le*ar})):M||[],tt=Pe.map(Tt=>Tt.value),[De,Ke]=Y.useState(-1),Ge=Y.useRef(null),ft=ai(se,Ge),Gt=Tt=>ar=>{var Hr;const Xt=Number(ar.currentTarget.getAttribute("data-index"));ov(ar.target)&&Ke(Xt),Ce(Xt),(Hr=Tt==null?void 0:Tt.onFocus)==null||Hr.call(Tt,ar)},Ft=Tt=>ar=>{var Xt;ov(ar.target)||Ke(-1),Ce(-1),(Xt=Tt==null?void 0:Tt.onBlur)==null||Xt.call(Tt,ar)},wt=(Tt,ar)=>{const Xt=Number(Tt.currentTarget.getAttribute("data-index")),Hr=ze[Xt],zr=tt.indexOf(Hr);let br=ar;if(Pe&&le==null){const Qr=tt[tt.length-1];br>Qr?br=Qr:br<tt[0]?br=tt[0]:br=br<Hr?tt[zr-1]:tt[zr+1]}if(br=Sp(br,i,D),Le){g&&(br=Sp(br,ze[Xt-1]||-1/0,ze[Xt+1]||1/0));const Qr=br;br=BA({values:ze,newValue:br,index:Xt});let pn=Xt;g||(pn=br.indexOf(Qr)),sx({sliderRef:Ge,activeIndex:pn})}je(br),Ke(Xt),He&&!ax(br,ve)&&He(Tt,br,Xt),q&&q(Tt,br)},Rt=Tt=>ar=>{var Xt;if(le!==null){const Hr=Number(ar.currentTarget.getAttribute("data-index")),zr=ze[Hr];let br=null;(ar.key==="ArrowLeft"||ar.key==="ArrowDown")&&ar.shiftKey||ar.key==="PageDown"?br=Math.max(zr-de,i):((ar.key==="ArrowRight"||ar.key==="ArrowUp")&&ar.shiftKey||ar.key==="PageUp")&&(br=Math.min(zr+de,D)),br!==null&&(wt(ar,br),ar.preventDefault())}(Xt=Tt==null?void 0:Tt.onKeyDown)==null||Xt.call(Tt,ar)};io(()=>{var Tt;u&&Ge.current.contains(document.activeElement)&&((Tt=document.activeElement)==null||Tt.blur())},[u]),u&&ce!==-1&&fe(-1),u&&De!==-1&&Ke(-1);const It=Tt=>ar=>{var Xt;(Xt=Tt.onChange)==null||Xt.call(Tt,ar),wt(ar,ar.target.valueAsNumber)},zt=Y.useRef(void 0);let At=X;_&&X==="horizontal"&&(At+="-reverse");const kt=({finger:Tt,move:ar=!1})=>{const{current:Xt}=Ge,{width:Hr,height:zr,bottom:br,left:Qr}=Xt.getBoundingClientRect();let pn;At.startsWith("vertical")?pn=(br-Tt.y)/zr:pn=(Tt.x-Qr)/Hr,At.includes("-reverse")&&(pn=1-pn);let Wr;if(Wr=AW(pn,i,D),le)Wr=RW(Wr,le,i);else{const li=FA(tt,Wr);Wr=tt[li]}Wr=Sp(Wr,i,D);let Jn=0;if(Le){ar?Jn=zt.current:Jn=FA(ze,Wr),g&&(Wr=Sp(Wr,ze[Jn-1]||-1/0,ze[Jn+1]||1/0));const li=Wr;Wr=BA({values:ze,newValue:Wr,index:Jn}),g&&ar||(Jn=Wr.indexOf(li),zt.current=Jn)}return{newValue:Wr,activeIndex:Jn}},Ot=Ar(Tt=>{const ar=ox(Tt,K);if(!ar)return;if(oe.current+=1,Tt.type==="mousemove"&&Tt.buttons===0){be(Tt);return}const{newValue:Xt,activeIndex:Hr}=kt({finger:ar,move:!0});sx({sliderRef:Ge,activeIndex:Hr,setActive:fe}),je(Xt),!we&&oe.current>PW&&ot(!0),He&&!ax(Xt,ve)&&He(Tt,Xt,Hr)}),be=Ar(Tt=>{const ar=ox(Tt,K);if(ot(!1),!ar)return;const{newValue:Xt}=kt({finger:ar,move:!0});fe(-1),Tt.type==="touchend"&&Ce(-1),q&&q(Tt,Xt),K.current=void 0,xt()}),Ht=Ar(Tt=>{if(u)return;jA()||Tt.preventDefault();const ar=Tt.changedTouches[0];ar!=null&&(K.current=ar.identifier);const Xt=ox(Tt,K);if(Xt!==!1){const{newValue:zr,activeIndex:br}=kt({finger:Xt});sx({sliderRef:Ge,activeIndex:br,setActive:fe}),je(zr),He&&!ax(zr,ve)&&He(Tt,zr,br)}oe.current=0;const Hr=Ko(Ge.current);Hr.addEventListener("touchmove",Ot,{passive:!0}),Hr.addEventListener("touchend",be,{passive:!0})}),xt=Y.useCallback(()=>{const Tt=Ko(Ge.current);Tt.removeEventListener("mousemove",Ot),Tt.removeEventListener("mouseup",be),Tt.removeEventListener("touchmove",Ot),Tt.removeEventListener("touchend",be)},[be,Ot]);Y.useEffect(()=>{const{current:Tt}=Ge;return Tt.addEventListener("touchstart",Ht,{passive:jA()}),()=>{Tt.removeEventListener("touchstart",Ht),xt()}},[xt,Ht]),Y.useEffect(()=>{u&&xt()},[u,xt]);const Bt=Tt=>ar=>{var zr;if((zr=Tt.onMouseDown)==null||zr.call(Tt,ar),u||ar.defaultPrevented||ar.button!==0)return;ar.preventDefault();const Xt=ox(ar,K);if(Xt!==!1){const{newValue:br,activeIndex:Qr}=kt({finger:Xt});sx({sliderRef:Ge,activeIndex:Qr,setActive:fe}),je(br),He&&!ax(br,ve)&&He(ar,br,Qr)}oe.current=0;const Hr=Ko(Ge.current);Hr.addEventListener("mousemove",Ot,{passive:!0}),Hr.addEventListener("mouseup",be)},rt=mv(Le?ze[0]:i,i,D),qt=mv(ze[ze.length-1],i,D)-rt,Lt=(Tt={})=>{const ar=Yg(Tt),Xt={onMouseDown:Bt(ar||{})},Hr={...ar,...Xt};return{...Tt,ref:ft,...Hr}},Yt=Tt=>ar=>{var Hr;(Hr=Tt.onMouseOver)==null||Hr.call(Tt,ar);const Xt=Number(ar.currentTarget.getAttribute("data-index"));Ce(Xt)},Wt=Tt=>ar=>{var Xt;(Xt=Tt.onMouseLeave)==null||Xt.call(Tt,ar),Ce(-1)};return{active:ce,axis:At,axisProps:LW,dragging:we,focusedThumbIndex:De,getHiddenInputProps:(Tt={})=>{const ar=Yg(Tt),Xt={onChange:It(ar||{}),onFocus:Gt(ar||{}),onBlur:Ft(ar||{}),onKeyDown:Rt(ar||{})},Hr={...ar,...Xt};return{tabIndex:te,"aria-labelledby":r,"aria-orientation":X,"aria-valuemax":ne(D),"aria-valuemin":ne(i),name:j,type:"range",min:e.min,max:e.max,step:e.step===null&&e.marks?"any":e.step??void 0,disabled:u,...Tt,...Hr,style:{...fz,direction:_?"rtl":"ltr",width:"100%",height:"100%"}}},getRootProps:Lt,getThumbProps:(Tt={})=>{const ar=Yg(Tt),Xt={onMouseOver:Yt(ar||{}),onMouseLeave:Wt(ar||{})};return{...Tt,...ar,...Xt}},marks:Pe,open:Ie,range:Le,rootRef:ft,trackLeap:qt,trackOffset:rt,values:ze,getThumbStyle:Tt=>({pointerEvents:ce!==-1&&ce!==Tt?"none":void 0})}}const FW=e=>!e||!uc(e);function BW(e){return Ir("MuiSlider",e)}const ba=Mr("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),jW=e=>{const{open:r}=e;return{offset:rr(r&&ba.valueLabelOpen),circle:ba.valueLabelCircle,label:ba.valueLabelLabel}};function NW(e){const{children:r,className:a,value:u}=e,g=jW(e);return r?Y.cloneElement(r,{className:rr(r.props.className)},L.jsxs(Y.Fragment,{children:[r.props.children,L.jsx("span",{className:rr(g.offset,a),"aria-hidden":!0,children:L.jsx("span",{className:g.circle,children:L.jsx("span",{className:g.label,children:u})})})]})):null}function NA(e){return e}const VW=bt("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`color${tr(a.color)}`],a.size!=="medium"&&r[`size${tr(a.size)}`],a.marked&&r.marked,a.orientation==="vertical"&&r.vertical,a.track==="inverted"&&r.trackInverted,a.track===!1&&r.trackFalse]}})(ln(({theme:e})=>({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${ba.disabled}`]:{pointerEvents:"none",cursor:"default",color:(e.vars||e).palette.grey[400]},[`&.${ba.dragging}`]:{[`& .${ba.thumb}, & .${ba.track}`]:{transition:"none"}},variants:[...Object.entries(e.palette).filter(yo()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}))),$W=bt("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(e,r)=>r.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),UW=bt("span",{name:"MuiSlider",slot:"Track",overridesResolver:(e,r)=>r.track})(ln(({theme:e})=>({display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:e.transitions.create(["left","width","bottom","height"],{duration:e.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(e.palette).filter(yo()).map(([r])=>({props:{color:r,track:"inverted"},style:{...e.vars?{backgroundColor:e.vars.palette.Slider[`${r}Track`],borderColor:e.vars.palette.Slider[`${r}Track`]}:{backgroundColor:pf(e.palette[r].main,.62),borderColor:pf(e.palette[r].main,.62),...e.applyStyles("dark",{backgroundColor:hf(e.palette[r].main,.5)}),...e.applyStyles("dark",{borderColor:hf(e.palette[r].main,.5)})}}}))]}))),WW=bt("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.thumb,r[`thumbColor${tr(a.color)}`],a.size!=="medium"&&r[`thumbSize${tr(a.size)}`]]}})(ln(({theme:e})=>({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow","left","bottom"],{duration:e.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(e.vars||e).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${ba.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(e.palette).filter(yo()).map(([r])=>({props:{color:r},style:{[`&:hover, &.${ba.focusVisible}`]:{...e.vars?{boxShadow:`0px 0px 0px 8px rgba(${e.vars.palette[r].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${Bn(e.palette[r].main,.16)}`},"@media (hover: none)":{boxShadow:"none"}},[`&.${ba.active}`]:{...e.vars?{boxShadow:`0px 0px 0px 14px rgba(${e.vars.palette[r].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${Bn(e.palette[r].main,.16)}`}}}}))]}))),GW=bt(NW,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(e,r)=>r.valueLabel})(ln(({theme:e})=>({zIndex:1,whiteSpace:"nowrap",...e.typography.body2,fontWeight:500,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),position:"absolute",backgroundColor:(e.vars||e).palette.grey[600],borderRadius:2,color:(e.vars||e).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${ba.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${ba.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:e.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]}))),HW=bt("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>_1(e)&&e!=="markActive",overridesResolver:(e,r)=>{const{markActive:a}=e;return[r.mark,a&&r.markActive]}})(ln(({theme:e})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(e.vars||e).palette.background.paper,opacity:.8}}]}))),qW=bt("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>_1(e)&&e!=="markLabelActive",overridesResolver:(e,r)=>r.markLabel})(ln(({theme:e})=>({...e.typography.body2,color:(e.vars||e).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(e.vars||e).palette.text.primary}}]}))),ZW=e=>{const{disabled:r,dragging:a,marked:u,orientation:g,track:_,classes:M,color:D,size:i}=e,j={root:["root",r&&"disabled",a&&"dragging",u&&"marked",g==="vertical"&&"vertical",_==="inverted"&&"trackInverted",_===!1&&"trackFalse",D&&`color${tr(D)}`,i&&`size${tr(i)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",r&&"disabled",i&&`thumbSize${tr(i)}`,D&&`thumbColor${tr(D)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return Er(j,BW,M)},YW=({children:e})=>e,Vd=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiSlider"}),g=fs(),{"aria-label":_,"aria-valuetext":M,"aria-labelledby":D,component:i="span",components:j={},componentsProps:H={},color:q="primary",classes:X,className:se,disableSwap:ne=!1,disabled:le=!1,getAriaLabel:de,getAriaValueText:te,marks:Q=!1,max:K=100,min:ce=0,name:fe,onChange:Ie,onChangeCommitted:Ce,orientation:we="horizontal",shiftStep:ot=10,size:oe="medium",step:ve=1,scale:je=NA,slotProps:He,slots:Le,tabIndex:ze,track:Pe="normal",value:tt,valueLabelDisplay:De="off",valueLabelFormat:Ke=NA,...Ge}=u,ft={...u,isRtl:g,max:K,min:ce,classes:X,disabled:le,disableSwap:ne,orientation:we,marks:Q,color:q,size:oe,step:ve,shiftStep:ot,scale:je,track:Pe,valueLabelDisplay:De,valueLabelFormat:Ke},{axisProps:Gt,getRootProps:Ft,getHiddenInputProps:wt,getThumbProps:Rt,open:It,active:zt,axis:At,focusedThumbIndex:kt,range:Ot,dragging:be,marks:Ht,values:xt,trackOffset:Bt,trackLeap:rt,getThumbStyle:qt}=OW({...ft,rootRef:a});ft.marked=Ht.length>0&&Ht.some(sn=>sn.label),ft.dragging=be,ft.focusedThumbIndex=kt;const Lt=ZW(ft),Yt=(Le==null?void 0:Le.root)??j.Root??VW,Wt=(Le==null?void 0:Le.rail)??j.Rail??$W,wr=(Le==null?void 0:Le.track)??j.Track??UW,Sr=(Le==null?void 0:Le.thumb)??j.Thumb??WW,dn=(Le==null?void 0:Le.valueLabel)??j.ValueLabel??GW,Tt=(Le==null?void 0:Le.mark)??j.Mark??HW,ar=(Le==null?void 0:Le.markLabel)??j.MarkLabel??qW,Xt=(Le==null?void 0:Le.input)??j.Input??"input",Hr=(He==null?void 0:He.root)??H.root,zr=(He==null?void 0:He.rail)??H.rail,br=(He==null?void 0:He.track)??H.track,Qr=(He==null?void 0:He.thumb)??H.thumb,pn=(He==null?void 0:He.valueLabel)??H.valueLabel,Wr=(He==null?void 0:He.mark)??H.mark,Jn=(He==null?void 0:He.markLabel)??H.markLabel,li=(He==null?void 0:He.input)??H.input,Dr=jn({elementType:Yt,getSlotProps:Ft,externalSlotProps:Hr,externalForwardedProps:Ge,additionalProps:{...FW(Yt)&&{as:i}},ownerState:{...ft,...Hr==null?void 0:Hr.ownerState},className:[Lt.root,se]}),dr=jn({elementType:Wt,externalSlotProps:zr,ownerState:ft,className:Lt.rail}),gr=jn({elementType:wr,externalSlotProps:br,additionalProps:{style:{...Gt[At].offset(Bt),...Gt[At].leap(rt)}},ownerState:{...ft,...br==null?void 0:br.ownerState},className:Lt.track}),Zr=jn({elementType:Sr,getSlotProps:Rt,externalSlotProps:Qr,ownerState:{...ft,...Qr==null?void 0:Qr.ownerState},className:Lt.thumb}),hn=jn({elementType:dn,externalSlotProps:pn,ownerState:{...ft,...pn==null?void 0:pn.ownerState},className:Lt.valueLabel}),hr=jn({elementType:Tt,externalSlotProps:Wr,ownerState:ft,className:Lt.mark}),Mn=jn({elementType:ar,externalSlotProps:Jn,ownerState:ft,className:Lt.markLabel}),bi=jn({elementType:Xt,getSlotProps:wt,externalSlotProps:li,ownerState:ft});return L.jsxs(Yt,{...Dr,children:[L.jsx(Wt,{...dr}),L.jsx(wr,{...gr}),Ht.filter(sn=>sn.value>=ce&&sn.value<=K).map((sn,qn)=>{const uo=mv(sn.value,ce,K),_o=Gt[At].offset(uo);let eo;return Pe===!1?eo=xt.includes(sn.value):eo=Pe==="normal"&&(Ot?sn.value>=xt[0]&&sn.value<=xt[xt.length-1]:sn.value<=xt[0])||Pe==="inverted"&&(Ot?sn.value<=xt[0]||sn.value>=xt[xt.length-1]:sn.value>=xt[0]),L.jsxs(Y.Fragment,{children:[L.jsx(Tt,{"data-index":qn,...hr,...!uc(Tt)&&{markActive:eo},style:{..._o,...hr.style},className:rr(hr.className,eo&&Lt.markActive)}),sn.label!=null?L.jsx(ar,{"aria-hidden":!0,"data-index":qn,...Mn,...!uc(ar)&&{markLabelActive:eo},style:{..._o,...Mn.style},className:rr(Lt.markLabel,Mn.className,eo&&Lt.markLabelActive),children:sn.label}):null]},qn)}),xt.map((sn,qn)=>{const uo=mv(sn,ce,K),_o=Gt[At].offset(uo),eo=De==="off"?YW:dn;return L.jsx(eo,{...!uc(eo)&&{valueLabelFormat:Ke,valueLabelDisplay:De,value:typeof Ke=="function"?Ke(je(sn),qn):Ke,index:qn,open:It===qn||zt===qn||De==="on",disabled:le},...hn,children:L.jsx(Sr,{"data-index":qn,...Zr,className:rr(Lt.thumb,Zr.className,zt===qn&&Lt.active,kt===qn&&Lt.focusVisible),style:{..._o,...qt(qn),...Zr.style},children:L.jsx(Xt,{"data-index":qn,"aria-label":de?de(qn):_,"aria-valuenow":je(sn),"aria-labelledby":D,"aria-valuetext":te?te(je(sn),qn):M,value:xt[qn],...bi})})},qn)})]})}),Wz=gV({createStyledComponent:bt("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,r)=>r.root}),useThemeProps:e=>oi({props:e,name:"MuiStack"})}),VA=Mr("MuiStack",["root"]);function XW(e){return Ir("MuiSwitch",e)}const ls=Mr("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),KW=e=>{const{classes:r,edge:a,size:u,color:g,checked:_,disabled:M}=e,D={root:["root",a&&`edge${tr(a)}`,`size${tr(u)}`],switchBase:["switchBase",`color${tr(g)}`,_&&"checked",M&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},i=Er(D,XW,r);return{...r,...i}},JW=bt("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.edge&&r[`edge${tr(a.edge)}`],r[`size${tr(a.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${ls.thumb}`]:{width:16,height:16},[`& .${ls.switchBase}`]:{padding:4,[`&.${ls.checked}`]:{transform:"translateX(16px)"}}}}]}),QW=bt(ZU,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.switchBase,{[`& .${ls.input}`]:r.input},a.color!=="default"&&r[`color${tr(a.color)}`]]}})(ln(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${ls.checked}`]:{transform:"translateX(20px)"},[`&.${ls.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${ls.checked} + .${ls.track}`]:{opacity:.5},[`&.${ls.disabled} + .${ls.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${ls.input}`]:{left:"-100%",width:"300%"}})),ln(({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(yo(["light"])).map(([r])=>({props:{color:r},style:{[`&.${ls.checked}`]:{color:(e.vars||e).palette[r].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[r].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette[r].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${ls.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${r}DisabledColor`]:`${e.palette.mode==="light"?pf(e.palette[r].main,.62):hf(e.palette[r].main,.55)}`}},[`&.${ls.checked} + .${ls.track}`]:{backgroundColor:(e.vars||e).palette[r].main}}}))]}))),eG=bt("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,r)=>r.track})(ln(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),tG=bt("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,r)=>r.thumb})(ln(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),yc=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiSwitch"}),{className:g,color:_="primary",edge:M=!1,size:D="medium",sx:i,...j}=u,H={...u,color:_,edge:M,size:D},q=KW(H),X=L.jsx(tG,{className:q.thumb,ownerState:H});return L.jsxs(JW,{className:rr(q.root,g),sx:i,ownerState:H,children:[L.jsx(QW,{type:"checkbox",icon:X,checkedIcon:X,ref:a,ownerState:H,...j,classes:{...q,root:q.switchBase}}),L.jsx(eG,{className:q.track,ownerState:H})]})});function rG(e){return Ir("MuiTab",e)}const da=Mr("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper","icon"]),nG=e=>{const{classes:r,textColor:a,fullWidth:u,wrapped:g,icon:_,label:M,selected:D,disabled:i}=e,j={root:["root",_&&M&&"labelIcon",`textColor${tr(a)}`,u&&"fullWidth",g&&"wrapped",D&&"selected",i&&"disabled"],icon:["iconWrapper","icon"]};return Er(j,rG,r)},iG=bt(rl,{name:"MuiTab",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.label&&a.icon&&r.labelIcon,r[`textColor${tr(a.textColor)}`],a.fullWidth&&r.fullWidth,a.wrapped&&r.wrapped,{[`& .${da.iconWrapper}`]:r.iconWrapper},{[`& .${da.icon}`]:r.icon}]}})(ln(({theme:e})=>({...e.typography.button,maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center",lineHeight:1.25,variants:[{props:({ownerState:r})=>r.label&&(r.iconPosition==="top"||r.iconPosition==="bottom"),style:{flexDirection:"column"}},{props:({ownerState:r})=>r.label&&r.iconPosition!=="top"&&r.iconPosition!=="bottom",style:{flexDirection:"row"}},{props:({ownerState:r})=>r.icon&&r.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:r,iconPosition:a})=>r.icon&&r.label&&a==="top",style:{[`& > .${da.icon}`]:{marginBottom:6}}},{props:({ownerState:r,iconPosition:a})=>r.icon&&r.label&&a==="bottom",style:{[`& > .${da.icon}`]:{marginTop:6}}},{props:({ownerState:r,iconPosition:a})=>r.icon&&r.label&&a==="start",style:{[`& > .${da.icon}`]:{marginRight:e.spacing(1)}}},{props:({ownerState:r,iconPosition:a})=>r.icon&&r.label&&a==="end",style:{[`& > .${da.icon}`]:{marginLeft:e.spacing(1)}}},{props:{textColor:"inherit"},style:{color:"inherit",opacity:.6,[`&.${da.selected}`]:{opacity:1},[`&.${da.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}}},{props:{textColor:"primary"},style:{color:(e.vars||e).palette.text.secondary,[`&.${da.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${da.disabled}`]:{color:(e.vars||e).palette.text.disabled}}},{props:{textColor:"secondary"},style:{color:(e.vars||e).palette.text.secondary,[`&.${da.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${da.disabled}`]:{color:(e.vars||e).palette.text.disabled}}},{props:({ownerState:r})=>r.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"}},{props:({ownerState:r})=>r.wrapped,style:{fontSize:e.typography.pxToRem(12)}}]}))),$A=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiTab"}),{className:g,disabled:_=!1,disableFocusRipple:M=!1,fullWidth:D,icon:i,iconPosition:j="top",indicator:H,label:q,onChange:X,onClick:se,onFocus:ne,selected:le,selectionFollowsFocus:de,textColor:te="inherit",value:Q,wrapped:K=!1,...ce}=u,fe={...u,disabled:_,disableFocusRipple:M,selected:le,icon:!!i,iconPosition:j,label:!!q,fullWidth:D,textColor:te,wrapped:K},Ie=nG(fe),Ce=i&&q&&Y.isValidElement(i)?Y.cloneElement(i,{className:rr(Ie.icon,i.props.className)}):i,we=oe=>{!le&&X&&X(oe,Q),se&&se(oe)},ot=oe=>{de&&!le&&X&&X(oe,Q),ne&&ne(oe)};return L.jsxs(iG,{focusRipple:!M,className:rr(Ie.root,g),ref:a,role:"tab","aria-selected":le,disabled:_,onClick:we,onFocus:ot,ownerState:fe,tabIndex:le?0:-1,...ce,children:[j==="top"||j==="start"?L.jsxs(Y.Fragment,{children:[Ce,q]}):L.jsxs(Y.Fragment,{children:[q,Ce]}),H]})});function oG(e){return Ir("MuiToolbar",e)}Mr("MuiToolbar",["root","gutters","regular","dense"]);const sG=e=>{const{classes:r,disableGutters:a,variant:u}=e;return Er({root:["root",!a&&"gutters",u]},oG,r)},aG=bt("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disableGutters&&r.gutters,r[a.variant]]}})(ln(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:e.mixins.toolbar}]}))),lG=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiToolbar"}),{className:g,component:_="div",disableGutters:M=!1,variant:D="regular",...i}=u,j={...u,component:_,disableGutters:M,variant:D},H=sG(j);return L.jsx(aG,{as:_,className:rr(H.root,g),ref:a,ownerState:j,...i})}),cG=si(L.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"}),"KeyboardArrowLeft"),uG=si(L.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}),"KeyboardArrowRight");function dG(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}function hG(e,r,a,u={},g=()=>{}){const{ease:_=dG,duration:M=300}=u;let D=null;const i=r[e];let j=!1;const H=()=>{j=!0},q=X=>{if(j){g(new Error("Animation cancelled"));return}D===null&&(D=X);const se=Math.min(1,(X-D)/M);if(r[e]=_(se)*(a-i)+i,se>=1){requestAnimationFrame(()=>{g(null)});return}requestAnimationFrame(q)};return i===a?(g(new Error("Element already at target position")),H):(requestAnimationFrame(q),H)}const pG={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};function fG(e){const{onChange:r,...a}=e,u=Y.useRef(),g=Y.useRef(null),_=()=>{u.current=g.current.offsetHeight-g.current.clientHeight};return io(()=>{const M=zy(()=>{const i=u.current;_(),i!==u.current&&r(u.current)}),D=Hs(g.current);return D.addEventListener("resize",M),()=>{M.clear(),D.removeEventListener("resize",M)}},[r]),Y.useEffect(()=>{_(),r(u.current)},[r]),L.jsx("div",{style:pG,ref:g,...a})}function mG(e){return Ir("MuiTabScrollButton",e)}const gG=Mr("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),yG=e=>{const{classes:r,orientation:a,disabled:u}=e;return Er({root:["root",a,u&&"disabled"]},mG,r)},_G=bt(rl,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.orientation&&r[a.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${gG.disabled}`]:{opacity:0},variants:[{props:{orientation:"vertical"},style:{width:"100%",height:40,"& svg":{transform:"var(--TabScrollButton-svgRotate)"}}}]}),xG=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiTabScrollButton"}),{className:g,slots:_={},slotProps:M={},direction:D,orientation:i,disabled:j,...H}=u,q=fs(),X={isRtl:q,...u},se=yG(X),ne=_.StartScrollButtonIcon??cG,le=_.EndScrollButtonIcon??uG,de=jn({elementType:ne,externalSlotProps:M.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:X}),te=jn({elementType:le,externalSlotProps:M.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:X});return L.jsx(_G,{component:"div",className:rr(se.root,g),ref:a,role:null,ownerState:X,tabIndex:null,...H,style:{...H.style,...i==="vertical"&&{"--TabScrollButton-svgRotate":`rotate(${q?-90:90}deg)`}},children:D==="left"?L.jsx(ne,{...de}):L.jsx(le,{...te})})});function vG(e){return Ir("MuiTabs",e)}const Ax=Mr("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),UA=(e,r)=>e===r?e.firstChild:r&&r.nextElementSibling?r.nextElementSibling:e.firstChild,WA=(e,r)=>e===r?e.lastChild:r&&r.previousElementSibling?r.previousElementSibling:e.lastChild,cx=(e,r,a)=>{let u=!1,g=a(e,r);for(;g;){if(g===e.firstChild){if(u)return;u=!0}const _=g.disabled||g.getAttribute("aria-disabled")==="true";if(!g.hasAttribute("tabindex")||_)g=a(e,g);else{g.focus();return}}},bG=e=>{const{vertical:r,fixed:a,hideScrollbar:u,scrollableX:g,scrollableY:_,centered:M,scrollButtonsHideMobile:D,classes:i}=e;return Er({root:["root",r&&"vertical"],scroller:["scroller",a&&"fixed",u&&"hideScrollbar",g&&"scrollableX",_&&"scrollableY"],flexContainer:["flexContainer",r&&"flexContainerVertical",M&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",D&&"scrollButtonsHideMobile"],scrollableX:[g&&"scrollableX"],hideScrollbar:[u&&"hideScrollbar"]},vG,i)},wG=bt("div",{name:"MuiTabs",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${Ax.scrollButtons}`]:r.scrollButtons},{[`& .${Ax.scrollButtons}`]:a.scrollButtonsHideMobile&&r.scrollButtonsHideMobile},r.root,a.vertical&&r.vertical]}})(ln(({theme:e})=>({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex",variants:[{props:({ownerState:r})=>r.vertical,style:{flexDirection:"column"}},{props:({ownerState:r})=>r.scrollButtonsHideMobile,style:{[`& .${Ax.scrollButtons}`]:{[e.breakpoints.down("sm")]:{display:"none"}}}}]}))),SG=bt("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.scroller,a.fixed&&r.fixed,a.hideScrollbar&&r.hideScrollbar,a.scrollableX&&r.scrollableX,a.scrollableY&&r.scrollableY]}})({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap",variants:[{props:({ownerState:e})=>e.fixed,style:{overflowX:"hidden",width:"100%"}},{props:({ownerState:e})=>e.hideScrollbar,style:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}},{props:({ownerState:e})=>e.scrollableX,style:{overflowX:"auto",overflowY:"hidden"}},{props:({ownerState:e})=>e.scrollableY,style:{overflowY:"auto",overflowX:"hidden"}}]}),TG=bt("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.flexContainer,a.vertical&&r.flexContainerVertical,a.centered&&r.centered]}})({display:"flex",variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:"column"}},{props:({ownerState:e})=>e.centered,style:{justifyContent:"center"}}]}),CG=bt("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:(e,r)=>r.indicator})(ln(({theme:e})=>({position:"absolute",height:2,bottom:0,width:"100%",transition:e.transitions.create(),variants:[{props:{indicatorColor:"primary"},style:{backgroundColor:(e.vars||e).palette.primary.main}},{props:{indicatorColor:"secondary"},style:{backgroundColor:(e.vars||e).palette.secondary.main}},{props:({ownerState:r})=>r.vertical,style:{height:"100%",width:2,right:0}}]}))),MG=bt(fG)({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),GA={},EG=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiTabs"}),g=jl(),_=fs(),{"aria-label":M,"aria-labelledby":D,action:i,centered:j=!1,children:H,className:q,component:X="div",allowScrollButtonsMobile:se=!1,indicatorColor:ne="primary",onChange:le,orientation:de="horizontal",ScrollButtonComponent:te=xG,scrollButtons:Q="auto",selectionFollowsFocus:K,slots:ce={},slotProps:fe={},TabIndicatorProps:Ie={},TabScrollButtonProps:Ce={},textColor:we="primary",value:ot,variant:oe="standard",visibleScrollbar:ve=!1,...je}=u,He=oe==="scrollable",Le=de==="vertical",ze=Le?"scrollTop":"scrollLeft",Pe=Le?"top":"left",tt=Le?"bottom":"right",De=Le?"clientHeight":"clientWidth",Ke=Le?"height":"width",Ge={...u,component:X,allowScrollButtonsMobile:se,indicatorColor:ne,orientation:de,vertical:Le,scrollButtons:Q,textColor:we,variant:oe,visibleScrollbar:ve,fixed:!He,hideScrollbar:He&&!ve,scrollableX:He&&!Le,scrollableY:He&&Le,centered:j&&!He,scrollButtonsHideMobile:!se},ft=bG(Ge),Gt=jn({elementType:ce.StartScrollButtonIcon,externalSlotProps:fe.startScrollButtonIcon,ownerState:Ge}),Ft=jn({elementType:ce.EndScrollButtonIcon,externalSlotProps:fe.endScrollButtonIcon,ownerState:Ge}),[wt,Rt]=Y.useState(!1),[It,zt]=Y.useState(GA),[At,kt]=Y.useState(!1),[Ot,be]=Y.useState(!1),[Ht,xt]=Y.useState(!1),[Bt,rt]=Y.useState({overflow:"hidden",scrollbarWidth:0}),qt=new Map,Lt=Y.useRef(null),Yt=Y.useRef(null),Wt=()=>{const dr=Lt.current;let gr;if(dr){const hn=dr.getBoundingClientRect();gr={clientWidth:dr.clientWidth,scrollLeft:dr.scrollLeft,scrollTop:dr.scrollTop,scrollWidth:dr.scrollWidth,top:hn.top,bottom:hn.bottom,left:hn.left,right:hn.right}}let Zr;if(dr&&ot!==!1){const hn=Yt.current.children;if(hn.length>0){const hr=hn[qt.get(ot)];Zr=hr?hr.getBoundingClientRect():null}}return{tabsMeta:gr,tabMeta:Zr}},wr=Ar(()=>{const{tabsMeta:dr,tabMeta:gr}=Wt();let Zr=0,hn;Le?(hn="top",gr&&dr&&(Zr=gr.top-dr.top+dr.scrollTop)):(hn=_?"right":"left",gr&&dr&&(Zr=(_?-1:1)*(gr[hn]-dr[hn]+dr.scrollLeft)));const hr={[hn]:Zr,[Ke]:gr?gr[Ke]:0};if(typeof It[hn]!="number"||typeof It[Ke]!="number")zt(hr);else{const Mn=Math.abs(It[hn]-hr[hn]),bi=Math.abs(It[Ke]-hr[Ke]);(Mn>=1||bi>=1)&&zt(hr)}}),Sr=(dr,{animation:gr=!0}={})=>{gr?hG(ze,Lt.current,dr,{duration:g.transitions.duration.standard}):Lt.current[ze]=dr},dn=dr=>{let gr=Lt.current[ze];Le?gr+=dr:gr+=dr*(_?-1:1),Sr(gr)},Tt=()=>{const dr=Lt.current[De];let gr=0;const Zr=Array.from(Yt.current.children);for(let hn=0;hn<Zr.length;hn+=1){const hr=Zr[hn];if(gr+hr[De]>dr){hn===0&&(gr=dr);break}gr+=hr[De]}return gr},ar=()=>{dn(-1*Tt())},Xt=()=>{dn(Tt())},Hr=Y.useCallback(dr=>{rt({overflow:null,scrollbarWidth:dr})},[]),zr=()=>{const dr={};dr.scrollbarSizeListener=He?L.jsx(MG,{onChange:Hr,className:rr(ft.scrollableX,ft.hideScrollbar)}):null;const Zr=He&&(Q==="auto"&&(At||Ot)||Q===!0);return dr.scrollButtonStart=Zr?L.jsx(te,{slots:{StartScrollButtonIcon:ce.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:Gt},orientation:de,direction:_?"right":"left",onClick:ar,disabled:!At,...Ce,className:rr(ft.scrollButtons,Ce.className)}):null,dr.scrollButtonEnd=Zr?L.jsx(te,{slots:{EndScrollButtonIcon:ce.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:Ft},orientation:de,direction:_?"left":"right",onClick:Xt,disabled:!Ot,...Ce,className:rr(ft.scrollButtons,Ce.className)}):null,dr},br=Ar(dr=>{const{tabsMeta:gr,tabMeta:Zr}=Wt();if(!(!Zr||!gr)){if(Zr[Pe]<gr[Pe]){const hn=gr[ze]+(Zr[Pe]-gr[Pe]);Sr(hn,{animation:dr})}else if(Zr[tt]>gr[tt]){const hn=gr[ze]+(Zr[tt]-gr[tt]);Sr(hn,{animation:dr})}}}),Qr=Ar(()=>{He&&Q!==!1&&xt(!Ht)});Y.useEffect(()=>{const dr=zy(()=>{Lt.current&&wr()});let gr;const Zr=Mn=>{Mn.forEach(bi=>{bi.removedNodes.forEach(sn=>{gr==null||gr.unobserve(sn)}),bi.addedNodes.forEach(sn=>{gr==null||gr.observe(sn)})}),dr(),Qr()},hn=Hs(Lt.current);hn.addEventListener("resize",dr);let hr;return typeof ResizeObserver<"u"&&(gr=new ResizeObserver(dr),Array.from(Yt.current.children).forEach(Mn=>{gr.observe(Mn)})),typeof MutationObserver<"u"&&(hr=new MutationObserver(Zr),hr.observe(Yt.current,{childList:!0})),()=>{dr.clear(),hn.removeEventListener("resize",dr),hr==null||hr.disconnect(),gr==null||gr.disconnect()}},[wr,Qr]),Y.useEffect(()=>{const dr=Array.from(Yt.current.children),gr=dr.length;if(typeof IntersectionObserver<"u"&&gr>0&&He&&Q!==!1){const Zr=dr[0],hn=dr[gr-1],hr={root:Lt.current,threshold:.99},Mn=uo=>{kt(!uo[0].isIntersecting)},bi=new IntersectionObserver(Mn,hr);bi.observe(Zr);const sn=uo=>{be(!uo[0].isIntersecting)},qn=new IntersectionObserver(sn,hr);return qn.observe(hn),()=>{bi.disconnect(),qn.disconnect()}}},[He,Q,Ht,H==null?void 0:H.length]),Y.useEffect(()=>{Rt(!0)},[]),Y.useEffect(()=>{wr()}),Y.useEffect(()=>{br(GA!==It)},[br,It]),Y.useImperativeHandle(i,()=>({updateIndicator:wr,updateScrollButtons:Qr}),[wr,Qr]);const pn=L.jsx(CG,{...Ie,className:rr(ft.indicator,Ie.className),ownerState:Ge,style:{...It,...Ie.style}});let Wr=0;const Jn=Y.Children.map(H,dr=>{if(!Y.isValidElement(dr))return null;const gr=dr.props.value===void 0?Wr:dr.props.value;qt.set(gr,Wr);const Zr=gr===ot;return Wr+=1,Y.cloneElement(dr,{fullWidth:oe==="fullWidth",indicator:Zr&&!wt&&pn,selected:Zr,selectionFollowsFocus:K,onChange:le,textColor:we,value:gr,...Wr===1&&ot===!1&&!dr.props.tabIndex?{tabIndex:0}:{}})}),li=dr=>{const gr=Yt.current,Zr=Ko(gr).activeElement;if(Zr.getAttribute("role")!=="tab")return;let hr=de==="horizontal"?"ArrowLeft":"ArrowUp",Mn=de==="horizontal"?"ArrowRight":"ArrowDown";switch(de==="horizontal"&&_&&(hr="ArrowRight",Mn="ArrowLeft"),dr.key){case hr:dr.preventDefault(),cx(gr,Zr,WA);break;case Mn:dr.preventDefault(),cx(gr,Zr,UA);break;case"Home":dr.preventDefault(),cx(gr,null,UA);break;case"End":dr.preventDefault(),cx(gr,null,WA);break}},Dr=zr();return L.jsxs(wG,{className:rr(ft.root,q),ownerState:Ge,ref:a,as:X,...je,children:[Dr.scrollButtonStart,Dr.scrollbarSizeListener,L.jsxs(SG,{className:ft.scroller,ownerState:Ge,style:{overflow:Bt.overflow,[Le?`margin${_?"Left":"Right"}`:"marginBottom"]:ve?void 0:-Bt.scrollbarWidth},ref:Lt,children:[L.jsx(TG,{"aria-label":M,"aria-labelledby":D,"aria-orientation":de==="vertical"?"vertical":null,className:ft.flexContainer,ownerState:Ge,onKeyDown:li,ref:Yt,role:"tablist",children:Jn}),wt&&pn]}),Dr.scrollButtonEnd]})});function IG(e){return Ir("MuiTextField",e)}const Sg=Mr("MuiTextField",["root"]),kG={standard:pv,filled:dv,outlined:fv},PG=e=>{const{classes:r}=e;return Er({root:["root"]},IG,r)},AG=bt(jy,{name:"MuiTextField",slot:"Root",overridesResolver:(e,r)=>r.root})({}),ws=Y.forwardRef(function(r,a){const u=_n({props:r,name:"MuiTextField"}),{autoComplete:g,autoFocus:_=!1,children:M,className:D,color:i="primary",defaultValue:j,disabled:H=!1,error:q=!1,FormHelperTextProps:X,fullWidth:se=!1,helperText:ne,id:le,InputLabelProps:de,inputProps:te,InputProps:Q,inputRef:K,label:ce,maxRows:fe,minRows:Ie,multiline:Ce=!1,name:we,onBlur:ot,onChange:oe,onFocus:ve,placeholder:je,required:He=!1,rows:Le,select:ze=!1,SelectProps:Pe,slots:tt={},slotProps:De={},type:Ke,value:Ge,variant:ft="outlined",...Gt}=u,Ft={...u,autoFocus:_,color:i,disabled:H,error:q,fullWidth:se,multiline:Ce,required:He,select:ze,variant:ft},wt=PG(Ft),Rt=Bu(le),It=ne&&Rt?`${Rt}-helper-text`:void 0,zt=ce&&Rt?`${Rt}-label`:void 0,At=kG[ft],kt={slots:tt,slotProps:{input:Q,inputLabel:de,htmlInput:te,formHelperText:X,select:Pe,...De}},Ot={},be=kt.slotProps.inputLabel;ft==="outlined"&&(be&&typeof be.shrink<"u"&&(Ot.notched=be.shrink),Ot.label=ce),ze&&((!Pe||!Pe.native)&&(Ot.id=void 0),Ot["aria-describedby"]=void 0);const[Ht,xt]=_a("input",{elementType:At,externalForwardedProps:kt,additionalProps:Ot,ownerState:Ft}),[Bt,rt]=_a("inputLabel",{elementType:T1,externalForwardedProps:kt,ownerState:Ft}),[qt,Lt]=_a("htmlInput",{elementType:"input",externalForwardedProps:kt,ownerState:Ft}),[Yt,Wt]=_a("formHelperText",{elementType:Oz,externalForwardedProps:kt,ownerState:Ft}),[wr,Sr]=_a("select",{elementType:Ny,externalForwardedProps:kt,ownerState:Ft}),dn=L.jsx(Ht,{"aria-describedby":It,autoComplete:g,autoFocus:_,defaultValue:j,fullWidth:se,multiline:Ce,name:we,rows:Le,maxRows:fe,minRows:Ie,type:Ke,value:Ge,id:Rt,inputRef:K,onBlur:ot,onChange:oe,onFocus:ve,placeholder:je,inputProps:Lt,slots:{input:tt.htmlInput?qt:void 0},...xt});return L.jsxs(AG,{className:rr(wt.root,D),disabled:H,error:q,fullWidth:se,ref:a,required:He,color:i,variant:ft,ownerState:Ft,...Gt,children:[ce!=null&&ce!==""&&L.jsx(Bt,{htmlFor:Rt,id:zt,...rt,children:ce}),ze?L.jsx(wr,{"aria-describedby":It,id:Rt,labelId:zt,value:Ge,input:dn,...Sr,children:M}):dn,ne&&L.jsx(Yt,{id:It,...Wt,children:ne})]})});var Gz={exports:{}};(function(e,r){var a={};(function(u,g){e.exports=g()})(Jd,function(){var u,g,_;function M(i,j){if(!u)u=j;else if(!g)g=j;else{var H="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+u+")(sharedChunk); ("+g+")(sharedChunk); self.onerror = null;",q={};u(q),_=j(q),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(_.workerUrl=window.URL.createObjectURL(new Blob([H],{type:"text/javascript"})))}}M(["exports"],function(i){function j(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var H,q={},X={};function se(){if(H)return X;H=1,Object.defineProperty(X,"__esModule",{value:!0}),X.setMatrixArrayType=function(f){X.ARRAY_TYPE=t=f},X.toRadian=function(f){return f*c},X.equals=function(f,d){return Math.abs(f-d)<=l*Math.max(1,Math.abs(f),Math.abs(d))},X.RANDOM=X.ARRAY_TYPE=X.EPSILON=void 0;var l=1e-6;X.EPSILON=l;var t=typeof Float32Array<"u"?Float32Array:Array;X.ARRAY_TYPE=t;var o=Math.random;X.RANDOM=o;var c=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var f=0,d=arguments.length;d--;)f+=arguments[d]*arguments[d];return Math.sqrt(f)}),X}var ne,le={};function de(){if(ne)return le;function l(d){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},l(d)}ne=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var d=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},le.clone=function(d){var m=new t.ARRAY_TYPE(4);return m[0]=d[0],m[1]=d[1],m[2]=d[2],m[3]=d[3],m},le.copy=function(d,m){return d[0]=m[0],d[1]=m[1],d[2]=m[2],d[3]=m[3],d},le.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},le.fromValues=function(d,m,b,C){var k=new t.ARRAY_TYPE(4);return k[0]=d,k[1]=m,k[2]=b,k[3]=C,k},le.set=function(d,m,b,C,k){return d[0]=m,d[1]=b,d[2]=C,d[3]=k,d},le.transpose=function(d,m){if(d===m){var b=m[1];d[1]=m[2],d[2]=b}else d[0]=m[0],d[1]=m[2],d[2]=m[1],d[3]=m[3];return d},le.invert=function(d,m){var b=m[0],C=m[1],k=m[2],x=m[3],S=b*x-k*C;return S?(d[0]=x*(S=1/S),d[1]=-C*S,d[2]=-k*S,d[3]=b*S,d):null},le.adjoint=function(d,m){var b=m[0];return d[0]=m[3],d[1]=-m[1],d[2]=-m[2],d[3]=b,d},le.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},le.multiply=c,le.rotate=function(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=Math.sin(b),T=Math.cos(b);return d[0]=C*T+x*I,d[1]=k*T+S*I,d[2]=C*-I+x*T,d[3]=k*-I+S*T,d},le.scale=function(d,m,b){var C=m[1],k=m[2],x=m[3],S=b[0],I=b[1];return d[0]=m[0]*S,d[1]=C*S,d[2]=k*I,d[3]=x*I,d},le.fromRotation=function(d,m){var b=Math.sin(m),C=Math.cos(m);return d[0]=C,d[1]=b,d[2]=-b,d[3]=C,d},le.fromScaling=function(d,m){return d[0]=m[0],d[1]=0,d[2]=0,d[3]=m[1],d},le.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},le.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3])},le.LDU=function(d,m,b,C){return d[2]=C[2]/C[0],b[0]=C[0],b[1]=C[1],b[3]=C[3]-d[2]*b[1],[d,m,b]},le.add=function(d,m,b){return d[0]=m[0]+b[0],d[1]=m[1]+b[1],d[2]=m[2]+b[2],d[3]=m[3]+b[3],d},le.subtract=f,le.exactEquals=function(d,m){return d[0]===m[0]&&d[1]===m[1]&&d[2]===m[2]&&d[3]===m[3]},le.equals=function(d,m){var b=d[0],C=d[1],k=d[2],x=d[3],S=m[0],I=m[1],T=m[2],E=m[3];return Math.abs(b-S)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(S))&&Math.abs(C-I)<=t.EPSILON*Math.max(1,Math.abs(C),Math.abs(I))&&Math.abs(k-T)<=t.EPSILON*Math.max(1,Math.abs(k),Math.abs(T))&&Math.abs(x-E)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(E))},le.multiplyScalar=function(d,m,b){return d[0]=m[0]*b,d[1]=m[1]*b,d[2]=m[2]*b,d[3]=m[3]*b,d},le.multiplyScalarAndAdd=function(d,m,b,C){return d[0]=m[0]+b[0]*C,d[1]=m[1]+b[1]*C,d[2]=m[2]+b[2]*C,d[3]=m[3]+b[3]*C,d},le.sub=le.mul=void 0;var t=function(d,m){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var b=o(void 0);if(b&&b.has(d))return b.get(d);var C={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in d)if(x!=="default"&&Object.prototype.hasOwnProperty.call(d,x)){var S=k?Object.getOwnPropertyDescriptor(d,x):null;S&&(S.get||S.set)?Object.defineProperty(C,x,S):C[x]=d[x]}return C.default=d,b&&b.set(d,C),C}(se());function o(d){if(typeof WeakMap!="function")return null;var m=new WeakMap,b=new WeakMap;return(o=function(C){return C?b:m})(d)}function c(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=b[0],T=b[1],E=b[2],A=b[3];return d[0]=C*I+x*T,d[1]=k*I+S*T,d[2]=C*E+x*A,d[3]=k*E+S*A,d}function f(d,m,b){return d[0]=m[0]-b[0],d[1]=m[1]-b[1],d[2]=m[2]-b[2],d[3]=m[3]-b[3],d}return le.mul=c,le.sub=f,le}var te,Q={};function K(){if(te)return Q;function l(d){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},l(d)}te=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.create=function(){var d=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},Q.clone=function(d){var m=new t.ARRAY_TYPE(6);return m[0]=d[0],m[1]=d[1],m[2]=d[2],m[3]=d[3],m[4]=d[4],m[5]=d[5],m},Q.copy=function(d,m){return d[0]=m[0],d[1]=m[1],d[2]=m[2],d[3]=m[3],d[4]=m[4],d[5]=m[5],d},Q.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},Q.fromValues=function(d,m,b,C,k,x){var S=new t.ARRAY_TYPE(6);return S[0]=d,S[1]=m,S[2]=b,S[3]=C,S[4]=k,S[5]=x,S},Q.set=function(d,m,b,C,k,x,S){return d[0]=m,d[1]=b,d[2]=C,d[3]=k,d[4]=x,d[5]=S,d},Q.invert=function(d,m){var b=m[0],C=m[1],k=m[2],x=m[3],S=m[4],I=m[5],T=b*x-C*k;return T?(d[0]=x*(T=1/T),d[1]=-C*T,d[2]=-k*T,d[3]=b*T,d[4]=(k*I-x*S)*T,d[5]=(C*S-b*I)*T,d):null},Q.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},Q.multiply=c,Q.rotate=function(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=m[4],T=m[5],E=Math.sin(b),A=Math.cos(b);return d[0]=C*A+x*E,d[1]=k*A+S*E,d[2]=C*-E+x*A,d[3]=k*-E+S*A,d[4]=I,d[5]=T,d},Q.scale=function(d,m,b){var C=m[1],k=m[2],x=m[3],S=m[4],I=m[5],T=b[0],E=b[1];return d[0]=m[0]*T,d[1]=C*T,d[2]=k*E,d[3]=x*E,d[4]=S,d[5]=I,d},Q.translate=function(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=m[4],T=m[5],E=b[0],A=b[1];return d[0]=C,d[1]=k,d[2]=x,d[3]=S,d[4]=C*E+x*A+I,d[5]=k*E+S*A+T,d},Q.fromRotation=function(d,m){var b=Math.sin(m),C=Math.cos(m);return d[0]=C,d[1]=b,d[2]=-b,d[3]=C,d[4]=0,d[5]=0,d},Q.fromScaling=function(d,m){return d[0]=m[0],d[1]=0,d[2]=0,d[3]=m[1],d[4]=0,d[5]=0,d},Q.fromTranslation=function(d,m){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=m[0],d[5]=m[1],d},Q.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},Q.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],1)},Q.add=function(d,m,b){return d[0]=m[0]+b[0],d[1]=m[1]+b[1],d[2]=m[2]+b[2],d[3]=m[3]+b[3],d[4]=m[4]+b[4],d[5]=m[5]+b[5],d},Q.subtract=f,Q.multiplyScalar=function(d,m,b){return d[0]=m[0]*b,d[1]=m[1]*b,d[2]=m[2]*b,d[3]=m[3]*b,d[4]=m[4]*b,d[5]=m[5]*b,d},Q.multiplyScalarAndAdd=function(d,m,b,C){return d[0]=m[0]+b[0]*C,d[1]=m[1]+b[1]*C,d[2]=m[2]+b[2]*C,d[3]=m[3]+b[3]*C,d[4]=m[4]+b[4]*C,d[5]=m[5]+b[5]*C,d},Q.exactEquals=function(d,m){return d[0]===m[0]&&d[1]===m[1]&&d[2]===m[2]&&d[3]===m[3]&&d[4]===m[4]&&d[5]===m[5]},Q.equals=function(d,m){var b=d[0],C=d[1],k=d[2],x=d[3],S=d[4],I=d[5],T=m[0],E=m[1],A=m[2],z=m[3],B=m[4],U=m[5];return Math.abs(b-T)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(T))&&Math.abs(C-E)<=t.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))&&Math.abs(k-A)<=t.EPSILON*Math.max(1,Math.abs(k),Math.abs(A))&&Math.abs(x-z)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(z))&&Math.abs(S-B)<=t.EPSILON*Math.max(1,Math.abs(S),Math.abs(B))&&Math.abs(I-U)<=t.EPSILON*Math.max(1,Math.abs(I),Math.abs(U))},Q.sub=Q.mul=void 0;var t=function(d,m){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var b=o(void 0);if(b&&b.has(d))return b.get(d);var C={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in d)if(x!=="default"&&Object.prototype.hasOwnProperty.call(d,x)){var S=k?Object.getOwnPropertyDescriptor(d,x):null;S&&(S.get||S.set)?Object.defineProperty(C,x,S):C[x]=d[x]}return C.default=d,b&&b.set(d,C),C}(se());function o(d){if(typeof WeakMap!="function")return null;var m=new WeakMap,b=new WeakMap;return(o=function(C){return C?b:m})(d)}function c(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=m[4],T=m[5],E=b[0],A=b[1],z=b[2],B=b[3],U=b[4],G=b[5];return d[0]=C*E+x*A,d[1]=k*E+S*A,d[2]=C*z+x*B,d[3]=k*z+S*B,d[4]=C*U+x*G+I,d[5]=k*U+S*G+T,d}function f(d,m,b){return d[0]=m[0]-b[0],d[1]=m[1]-b[1],d[2]=m[2]-b[2],d[3]=m[3]-b[3],d[4]=m[4]-b[4],d[5]=m[5]-b[5],d}return Q.mul=c,Q.sub=f,Q}var ce,fe={};function Ie(){if(ce)return fe;function l(d){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},l(d)}ce=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.create=function(){var d=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},fe.fromMat4=function(d,m){return d[0]=m[0],d[1]=m[1],d[2]=m[2],d[3]=m[4],d[4]=m[5],d[5]=m[6],d[6]=m[8],d[7]=m[9],d[8]=m[10],d},fe.clone=function(d){var m=new t.ARRAY_TYPE(9);return m[0]=d[0],m[1]=d[1],m[2]=d[2],m[3]=d[3],m[4]=d[4],m[5]=d[5],m[6]=d[6],m[7]=d[7],m[8]=d[8],m},fe.copy=function(d,m){return d[0]=m[0],d[1]=m[1],d[2]=m[2],d[3]=m[3],d[4]=m[4],d[5]=m[5],d[6]=m[6],d[7]=m[7],d[8]=m[8],d},fe.fromValues=function(d,m,b,C,k,x,S,I,T){var E=new t.ARRAY_TYPE(9);return E[0]=d,E[1]=m,E[2]=b,E[3]=C,E[4]=k,E[5]=x,E[6]=S,E[7]=I,E[8]=T,E},fe.set=function(d,m,b,C,k,x,S,I,T,E){return d[0]=m,d[1]=b,d[2]=C,d[3]=k,d[4]=x,d[5]=S,d[6]=I,d[7]=T,d[8]=E,d},fe.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},fe.transpose=function(d,m){if(d===m){var b=m[1],C=m[2],k=m[5];d[1]=m[3],d[2]=m[6],d[3]=b,d[5]=m[7],d[6]=C,d[7]=k}else d[0]=m[0],d[1]=m[3],d[2]=m[6],d[3]=m[1],d[4]=m[4],d[5]=m[7],d[6]=m[2],d[7]=m[5],d[8]=m[8];return d},fe.invert=function(d,m){var b=m[0],C=m[1],k=m[2],x=m[3],S=m[4],I=m[5],T=m[6],E=m[7],A=m[8],z=A*S-I*E,B=-A*x+I*T,U=E*x-S*T,G=b*z+C*B+k*U;return G?(d[0]=z*(G=1/G),d[1]=(-A*C+k*E)*G,d[2]=(I*C-k*S)*G,d[3]=B*G,d[4]=(A*b-k*T)*G,d[5]=(-I*b+k*x)*G,d[6]=U*G,d[7]=(-E*b+C*T)*G,d[8]=(S*b-C*x)*G,d):null},fe.adjoint=function(d,m){var b=m[0],C=m[1],k=m[2],x=m[3],S=m[4],I=m[5],T=m[6],E=m[7],A=m[8];return d[0]=S*A-I*E,d[1]=k*E-C*A,d[2]=C*I-k*S,d[3]=I*T-x*A,d[4]=b*A-k*T,d[5]=k*x-b*I,d[6]=x*E-S*T,d[7]=C*T-b*E,d[8]=b*S-C*x,d},fe.determinant=function(d){var m=d[3],b=d[4],C=d[5],k=d[6],x=d[7],S=d[8];return d[0]*(S*b-C*x)+d[1]*(-S*m+C*k)+d[2]*(x*m-b*k)},fe.multiply=c,fe.translate=function(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=m[4],T=m[5],E=m[6],A=m[7],z=m[8],B=b[0],U=b[1];return d[0]=C,d[1]=k,d[2]=x,d[3]=S,d[4]=I,d[5]=T,d[6]=B*C+U*S+E,d[7]=B*k+U*I+A,d[8]=B*x+U*T+z,d},fe.rotate=function(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=m[4],T=m[5],E=m[6],A=m[7],z=m[8],B=Math.sin(b),U=Math.cos(b);return d[0]=U*C+B*S,d[1]=U*k+B*I,d[2]=U*x+B*T,d[3]=U*S-B*C,d[4]=U*I-B*k,d[5]=U*T-B*x,d[6]=E,d[7]=A,d[8]=z,d},fe.scale=function(d,m,b){var C=b[0],k=b[1];return d[0]=C*m[0],d[1]=C*m[1],d[2]=C*m[2],d[3]=k*m[3],d[4]=k*m[4],d[5]=k*m[5],d[6]=m[6],d[7]=m[7],d[8]=m[8],d},fe.fromTranslation=function(d,m){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=m[0],d[7]=m[1],d[8]=1,d},fe.fromRotation=function(d,m){var b=Math.sin(m),C=Math.cos(m);return d[0]=C,d[1]=b,d[2]=0,d[3]=-b,d[4]=C,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},fe.fromScaling=function(d,m){return d[0]=m[0],d[1]=0,d[2]=0,d[3]=0,d[4]=m[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},fe.fromMat2d=function(d,m){return d[0]=m[0],d[1]=m[1],d[2]=0,d[3]=m[2],d[4]=m[3],d[5]=0,d[6]=m[4],d[7]=m[5],d[8]=1,d},fe.fromQuat=function(d,m){var b=m[0],C=m[1],k=m[2],x=m[3],S=b+b,I=C+C,T=k+k,E=b*S,A=C*S,z=C*I,B=k*S,U=k*I,G=k*T,N=x*S,Z=x*I,J=x*T;return d[0]=1-z-G,d[3]=A-J,d[6]=B+Z,d[1]=A+J,d[4]=1-E-G,d[7]=U-N,d[2]=B-Z,d[5]=U+N,d[8]=1-E-z,d},fe.normalFromMat4=function(d,m){var b=m[0],C=m[1],k=m[2],x=m[3],S=m[4],I=m[5],T=m[6],E=m[7],A=m[8],z=m[9],B=m[10],U=m[11],G=m[12],N=m[13],Z=m[14],J=m[15],he=b*I-C*S,ye=b*T-k*S,xe=b*E-x*S,me=C*T-k*I,Ae=C*E-x*I,Te=k*E-x*T,Oe=A*N-z*G,We=A*Z-B*G,Ze=A*J-U*G,Ye=z*Z-B*N,Je=z*J-U*N,at=B*J-U*Z,Qe=he*at-ye*Je+xe*Ye+me*Ze-Ae*We+Te*Oe;return Qe?(d[0]=(I*at-T*Je+E*Ye)*(Qe=1/Qe),d[1]=(T*Ze-S*at-E*We)*Qe,d[2]=(S*Je-I*Ze+E*Oe)*Qe,d[3]=(k*Je-C*at-x*Ye)*Qe,d[4]=(b*at-k*Ze+x*We)*Qe,d[5]=(C*Ze-b*Je-x*Oe)*Qe,d[6]=(N*Te-Z*Ae+J*me)*Qe,d[7]=(Z*xe-G*Te-J*ye)*Qe,d[8]=(G*Ae-N*xe+J*he)*Qe,d):null},fe.projection=function(d,m,b){return d[0]=2/m,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/b,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},fe.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},fe.frob=function(d){return Math.hypot(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])},fe.add=function(d,m,b){return d[0]=m[0]+b[0],d[1]=m[1]+b[1],d[2]=m[2]+b[2],d[3]=m[3]+b[3],d[4]=m[4]+b[4],d[5]=m[5]+b[5],d[6]=m[6]+b[6],d[7]=m[7]+b[7],d[8]=m[8]+b[8],d},fe.subtract=f,fe.multiplyScalar=function(d,m,b){return d[0]=m[0]*b,d[1]=m[1]*b,d[2]=m[2]*b,d[3]=m[3]*b,d[4]=m[4]*b,d[5]=m[5]*b,d[6]=m[6]*b,d[7]=m[7]*b,d[8]=m[8]*b,d},fe.multiplyScalarAndAdd=function(d,m,b,C){return d[0]=m[0]+b[0]*C,d[1]=m[1]+b[1]*C,d[2]=m[2]+b[2]*C,d[3]=m[3]+b[3]*C,d[4]=m[4]+b[4]*C,d[5]=m[5]+b[5]*C,d[6]=m[6]+b[6]*C,d[7]=m[7]+b[7]*C,d[8]=m[8]+b[8]*C,d},fe.exactEquals=function(d,m){return d[0]===m[0]&&d[1]===m[1]&&d[2]===m[2]&&d[3]===m[3]&&d[4]===m[4]&&d[5]===m[5]&&d[6]===m[6]&&d[7]===m[7]&&d[8]===m[8]},fe.equals=function(d,m){var b=d[0],C=d[1],k=d[2],x=d[3],S=d[4],I=d[5],T=d[6],E=d[7],A=d[8],z=m[0],B=m[1],U=m[2],G=m[3],N=m[4],Z=m[5],J=m[6],he=m[7],ye=m[8];return Math.abs(b-z)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(z))&&Math.abs(C-B)<=t.EPSILON*Math.max(1,Math.abs(C),Math.abs(B))&&Math.abs(k-U)<=t.EPSILON*Math.max(1,Math.abs(k),Math.abs(U))&&Math.abs(x-G)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(G))&&Math.abs(S-N)<=t.EPSILON*Math.max(1,Math.abs(S),Math.abs(N))&&Math.abs(I-Z)<=t.EPSILON*Math.max(1,Math.abs(I),Math.abs(Z))&&Math.abs(T-J)<=t.EPSILON*Math.max(1,Math.abs(T),Math.abs(J))&&Math.abs(E-he)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(he))&&Math.abs(A-ye)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(ye))},fe.sub=fe.mul=void 0;var t=function(d,m){if(d&&d.__esModule)return d;if(d===null||l(d)!=="object"&&typeof d!="function")return{default:d};var b=o(void 0);if(b&&b.has(d))return b.get(d);var C={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in d)if(x!=="default"&&Object.prototype.hasOwnProperty.call(d,x)){var S=k?Object.getOwnPropertyDescriptor(d,x):null;S&&(S.get||S.set)?Object.defineProperty(C,x,S):C[x]=d[x]}return C.default=d,b&&b.set(d,C),C}(se());function o(d){if(typeof WeakMap!="function")return null;var m=new WeakMap,b=new WeakMap;return(o=function(C){return C?b:m})(d)}function c(d,m,b){var C=m[0],k=m[1],x=m[2],S=m[3],I=m[4],T=m[5],E=m[6],A=m[7],z=m[8],B=b[0],U=b[1],G=b[2],N=b[3],Z=b[4],J=b[5],he=b[6],ye=b[7],xe=b[8];return d[0]=B*C+U*S+G*E,d[1]=B*k+U*I+G*A,d[2]=B*x+U*T+G*z,d[3]=N*C+Z*S+J*E,d[4]=N*k+Z*I+J*A,d[5]=N*x+Z*T+J*z,d[6]=he*C+ye*S+xe*E,d[7]=he*k+ye*I+xe*A,d[8]=he*x+ye*T+xe*z,d}function f(d,m,b){return d[0]=m[0]-b[0],d[1]=m[1]-b[1],d[2]=m[2]-b[2],d[3]=m[3]-b[3],d[4]=m[4]-b[4],d[5]=m[5]-b[5],d[6]=m[6]-b[6],d[7]=m[7]-b[7],d[8]=m[8]-b[8],d}return fe.mul=c,fe.sub=f,fe}var Ce,we={};function ot(){if(Ce)return we;function l(x){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},l(x)}Ce=1,Object.defineProperty(we,"__esModule",{value:!0}),we.create=function(){var x=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},we.clone=function(x){var S=new t.ARRAY_TYPE(16);return S[0]=x[0],S[1]=x[1],S[2]=x[2],S[3]=x[3],S[4]=x[4],S[5]=x[5],S[6]=x[6],S[7]=x[7],S[8]=x[8],S[9]=x[9],S[10]=x[10],S[11]=x[11],S[12]=x[12],S[13]=x[13],S[14]=x[14],S[15]=x[15],S},we.copy=function(x,S){return x[0]=S[0],x[1]=S[1],x[2]=S[2],x[3]=S[3],x[4]=S[4],x[5]=S[5],x[6]=S[6],x[7]=S[7],x[8]=S[8],x[9]=S[9],x[10]=S[10],x[11]=S[11],x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15],x},we.fromValues=function(x,S,I,T,E,A,z,B,U,G,N,Z,J,he,ye,xe){var me=new t.ARRAY_TYPE(16);return me[0]=x,me[1]=S,me[2]=I,me[3]=T,me[4]=E,me[5]=A,me[6]=z,me[7]=B,me[8]=U,me[9]=G,me[10]=N,me[11]=Z,me[12]=J,me[13]=he,me[14]=ye,me[15]=xe,me},we.set=function(x,S,I,T,E,A,z,B,U,G,N,Z,J,he,ye,xe,me){return x[0]=S,x[1]=I,x[2]=T,x[3]=E,x[4]=A,x[5]=z,x[6]=B,x[7]=U,x[8]=G,x[9]=N,x[10]=Z,x[11]=J,x[12]=he,x[13]=ye,x[14]=xe,x[15]=me,x},we.identity=c,we.transpose=function(x,S){if(x===S){var I=S[1],T=S[2],E=S[3],A=S[6],z=S[7],B=S[11];x[1]=S[4],x[2]=S[8],x[3]=S[12],x[4]=I,x[6]=S[9],x[7]=S[13],x[8]=T,x[9]=A,x[11]=S[14],x[12]=E,x[13]=z,x[14]=B}else x[0]=S[0],x[1]=S[4],x[2]=S[8],x[3]=S[12],x[4]=S[1],x[5]=S[5],x[6]=S[9],x[7]=S[13],x[8]=S[2],x[9]=S[6],x[10]=S[10],x[11]=S[14],x[12]=S[3],x[13]=S[7],x[14]=S[11],x[15]=S[15];return x},we.invert=function(x,S){var I=S[0],T=S[1],E=S[2],A=S[3],z=S[4],B=S[5],U=S[6],G=S[7],N=S[8],Z=S[9],J=S[10],he=S[11],ye=S[12],xe=S[13],me=S[14],Ae=S[15],Te=I*B-T*z,Oe=I*U-E*z,We=I*G-A*z,Ze=T*U-E*B,Ye=T*G-A*B,Je=E*G-A*U,at=N*xe-Z*ye,Qe=N*me-J*ye,gt=N*Ae-he*ye,Et=Z*me-J*xe,dt=Z*Ae-he*xe,sr=J*Ae-he*me,Jt=Te*sr-Oe*dt+We*Et+Ze*gt-Ye*Qe+Je*at;return Jt?(x[0]=(B*sr-U*dt+G*Et)*(Jt=1/Jt),x[1]=(E*dt-T*sr-A*Et)*Jt,x[2]=(xe*Je-me*Ye+Ae*Ze)*Jt,x[3]=(J*Ye-Z*Je-he*Ze)*Jt,x[4]=(U*gt-z*sr-G*Qe)*Jt,x[5]=(I*sr-E*gt+A*Qe)*Jt,x[6]=(me*We-ye*Je-Ae*Oe)*Jt,x[7]=(N*Je-J*We+he*Oe)*Jt,x[8]=(z*dt-B*gt+G*at)*Jt,x[9]=(T*gt-I*dt-A*at)*Jt,x[10]=(ye*Ye-xe*We+Ae*Te)*Jt,x[11]=(Z*We-N*Ye-he*Te)*Jt,x[12]=(B*Qe-z*Et-U*at)*Jt,x[13]=(I*Et-T*Qe+E*at)*Jt,x[14]=(xe*Oe-ye*Ze-me*Te)*Jt,x[15]=(N*Ze-Z*Oe+J*Te)*Jt,x):null},we.adjoint=function(x,S){var I=S[0],T=S[1],E=S[2],A=S[3],z=S[4],B=S[5],U=S[6],G=S[7],N=S[8],Z=S[9],J=S[10],he=S[11],ye=S[12],xe=S[13],me=S[14],Ae=S[15];return x[0]=B*(J*Ae-he*me)-Z*(U*Ae-G*me)+xe*(U*he-G*J),x[1]=-(T*(J*Ae-he*me)-Z*(E*Ae-A*me)+xe*(E*he-A*J)),x[2]=T*(U*Ae-G*me)-B*(E*Ae-A*me)+xe*(E*G-A*U),x[3]=-(T*(U*he-G*J)-B*(E*he-A*J)+Z*(E*G-A*U)),x[4]=-(z*(J*Ae-he*me)-N*(U*Ae-G*me)+ye*(U*he-G*J)),x[5]=I*(J*Ae-he*me)-N*(E*Ae-A*me)+ye*(E*he-A*J),x[6]=-(I*(U*Ae-G*me)-z*(E*Ae-A*me)+ye*(E*G-A*U)),x[7]=I*(U*he-G*J)-z*(E*he-A*J)+N*(E*G-A*U),x[8]=z*(Z*Ae-he*xe)-N*(B*Ae-G*xe)+ye*(B*he-G*Z),x[9]=-(I*(Z*Ae-he*xe)-N*(T*Ae-A*xe)+ye*(T*he-A*Z)),x[10]=I*(B*Ae-G*xe)-z*(T*Ae-A*xe)+ye*(T*G-A*B),x[11]=-(I*(B*he-G*Z)-z*(T*he-A*Z)+N*(T*G-A*B)),x[12]=-(z*(Z*me-J*xe)-N*(B*me-U*xe)+ye*(B*J-U*Z)),x[13]=I*(Z*me-J*xe)-N*(T*me-E*xe)+ye*(T*J-E*Z),x[14]=-(I*(B*me-U*xe)-z*(T*me-E*xe)+ye*(T*U-E*B)),x[15]=I*(B*J-U*Z)-z*(T*J-E*Z)+N*(T*U-E*B),x},we.determinant=function(x){var S=x[0],I=x[1],T=x[2],E=x[3],A=x[4],z=x[5],B=x[6],U=x[7],G=x[8],N=x[9],Z=x[10],J=x[11],he=x[12],ye=x[13],xe=x[14],me=x[15];return(S*z-I*A)*(Z*me-J*xe)-(S*B-T*A)*(N*me-J*ye)+(S*U-E*A)*(N*xe-Z*ye)+(I*B-T*z)*(G*me-J*he)-(I*U-E*z)*(G*xe-Z*he)+(T*U-E*B)*(G*ye-N*he)},we.multiply=f,we.translate=function(x,S,I){var T,E,A,z,B,U,G,N,Z,J,he,ye,xe=I[0],me=I[1],Ae=I[2];return S===x?(x[12]=S[0]*xe+S[4]*me+S[8]*Ae+S[12],x[13]=S[1]*xe+S[5]*me+S[9]*Ae+S[13],x[14]=S[2]*xe+S[6]*me+S[10]*Ae+S[14],x[15]=S[3]*xe+S[7]*me+S[11]*Ae+S[15]):(E=S[1],A=S[2],z=S[3],B=S[4],U=S[5],G=S[6],N=S[7],Z=S[8],J=S[9],he=S[10],ye=S[11],x[0]=T=S[0],x[1]=E,x[2]=A,x[3]=z,x[4]=B,x[5]=U,x[6]=G,x[7]=N,x[8]=Z,x[9]=J,x[10]=he,x[11]=ye,x[12]=T*xe+B*me+Z*Ae+S[12],x[13]=E*xe+U*me+J*Ae+S[13],x[14]=A*xe+G*me+he*Ae+S[14],x[15]=z*xe+N*me+ye*Ae+S[15]),x},we.scale=function(x,S,I){var T=I[0],E=I[1],A=I[2];return x[0]=S[0]*T,x[1]=S[1]*T,x[2]=S[2]*T,x[3]=S[3]*T,x[4]=S[4]*E,x[5]=S[5]*E,x[6]=S[6]*E,x[7]=S[7]*E,x[8]=S[8]*A,x[9]=S[9]*A,x[10]=S[10]*A,x[11]=S[11]*A,x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15],x},we.rotate=function(x,S,I,T){var E,A,z,B,U,G,N,Z,J,he,ye,xe,me,Ae,Te,Oe,We,Ze,Ye,Je,at,Qe,gt,Et,dt=T[0],sr=T[1],Jt=T[2],$t=Math.hypot(dt,sr,Jt);return $t<t.EPSILON?null:(dt*=$t=1/$t,sr*=$t,Jt*=$t,E=Math.sin(I),A=Math.cos(I),U=S[1],G=S[2],N=S[3],J=S[5],he=S[6],ye=S[7],me=S[9],Ae=S[10],Te=S[11],Oe=dt*dt*(z=1-A)+A,Ye=dt*sr*z-Jt*E,Je=sr*sr*z+A,at=Jt*sr*z+dt*E,Qe=dt*Jt*z+sr*E,gt=sr*Jt*z-dt*E,Et=Jt*Jt*z+A,x[0]=(B=S[0])*Oe+(Z=S[4])*(We=sr*dt*z+Jt*E)+(xe=S[8])*(Ze=Jt*dt*z-sr*E),x[1]=U*Oe+J*We+me*Ze,x[2]=G*Oe+he*We+Ae*Ze,x[3]=N*Oe+ye*We+Te*Ze,x[4]=B*Ye+Z*Je+xe*at,x[5]=U*Ye+J*Je+me*at,x[6]=G*Ye+he*Je+Ae*at,x[7]=N*Ye+ye*Je+Te*at,x[8]=B*Qe+Z*gt+xe*Et,x[9]=U*Qe+J*gt+me*Et,x[10]=G*Qe+he*gt+Ae*Et,x[11]=N*Qe+ye*gt+Te*Et,S!==x&&(x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15]),x)},we.rotateX=function(x,S,I){var T=Math.sin(I),E=Math.cos(I),A=S[4],z=S[5],B=S[6],U=S[7],G=S[8],N=S[9],Z=S[10],J=S[11];return S!==x&&(x[0]=S[0],x[1]=S[1],x[2]=S[2],x[3]=S[3],x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15]),x[4]=A*E+G*T,x[5]=z*E+N*T,x[6]=B*E+Z*T,x[7]=U*E+J*T,x[8]=G*E-A*T,x[9]=N*E-z*T,x[10]=Z*E-B*T,x[11]=J*E-U*T,x},we.rotateY=function(x,S,I){var T=Math.sin(I),E=Math.cos(I),A=S[0],z=S[1],B=S[2],U=S[3],G=S[8],N=S[9],Z=S[10],J=S[11];return S!==x&&(x[4]=S[4],x[5]=S[5],x[6]=S[6],x[7]=S[7],x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15]),x[0]=A*E-G*T,x[1]=z*E-N*T,x[2]=B*E-Z*T,x[3]=U*E-J*T,x[8]=A*T+G*E,x[9]=z*T+N*E,x[10]=B*T+Z*E,x[11]=U*T+J*E,x},we.rotateZ=function(x,S,I){var T=Math.sin(I),E=Math.cos(I),A=S[0],z=S[1],B=S[2],U=S[3],G=S[4],N=S[5],Z=S[6],J=S[7];return S!==x&&(x[8]=S[8],x[9]=S[9],x[10]=S[10],x[11]=S[11],x[12]=S[12],x[13]=S[13],x[14]=S[14],x[15]=S[15]),x[0]=A*E+G*T,x[1]=z*E+N*T,x[2]=B*E+Z*T,x[3]=U*E+J*T,x[4]=G*E-A*T,x[5]=N*E-z*T,x[6]=Z*E-B*T,x[7]=J*E-U*T,x},we.fromTranslation=function(x,S){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=S[0],x[13]=S[1],x[14]=S[2],x[15]=1,x},we.fromScaling=function(x,S){return x[0]=S[0],x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=S[1],x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=S[2],x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},we.fromRotation=function(x,S,I){var T,E,A,z=I[0],B=I[1],U=I[2],G=Math.hypot(z,B,U);return G<t.EPSILON?null:(z*=G=1/G,B*=G,U*=G,T=Math.sin(S),E=Math.cos(S),x[0]=z*z*(A=1-E)+E,x[1]=B*z*A+U*T,x[2]=U*z*A-B*T,x[3]=0,x[4]=z*B*A-U*T,x[5]=B*B*A+E,x[6]=U*B*A+z*T,x[7]=0,x[8]=z*U*A+B*T,x[9]=B*U*A-z*T,x[10]=U*U*A+E,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x)},we.fromXRotation=function(x,S){var I=Math.sin(S),T=Math.cos(S);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=T,x[6]=I,x[7]=0,x[8]=0,x[9]=-I,x[10]=T,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},we.fromYRotation=function(x,S){var I=Math.sin(S),T=Math.cos(S);return x[0]=T,x[1]=0,x[2]=-I,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=I,x[9]=0,x[10]=T,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},we.fromZRotation=function(x,S){var I=Math.sin(S),T=Math.cos(S);return x[0]=T,x[1]=I,x[2]=0,x[3]=0,x[4]=-I,x[5]=T,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},we.fromRotationTranslation=d,we.fromQuat2=function(x,S){var I=new t.ARRAY_TYPE(3),T=-S[0],E=-S[1],A=-S[2],z=S[3],B=S[4],U=S[5],G=S[6],N=S[7],Z=T*T+E*E+A*A+z*z;return Z>0?(I[0]=2*(B*z+N*T+U*A-G*E)/Z,I[1]=2*(U*z+N*E+G*T-B*A)/Z,I[2]=2*(G*z+N*A+B*E-U*T)/Z):(I[0]=2*(B*z+N*T+U*A-G*E),I[1]=2*(U*z+N*E+G*T-B*A),I[2]=2*(G*z+N*A+B*E-U*T)),d(x,S,I),x},we.getTranslation=function(x,S){return x[0]=S[12],x[1]=S[13],x[2]=S[14],x},we.getScaling=m,we.getRotation=function(x,S){var I=new t.ARRAY_TYPE(3);m(I,S);var T=1/I[0],E=1/I[1],A=1/I[2],z=S[0]*T,B=S[1]*E,U=S[2]*A,G=S[4]*T,N=S[5]*E,Z=S[6]*A,J=S[8]*T,he=S[9]*E,ye=S[10]*A,xe=z+N+ye,me=0;return xe>0?(me=2*Math.sqrt(xe+1),x[3]=.25*me,x[0]=(Z-he)/me,x[1]=(J-U)/me,x[2]=(B-G)/me):z>N&&z>ye?(me=2*Math.sqrt(1+z-N-ye),x[3]=(Z-he)/me,x[0]=.25*me,x[1]=(B+G)/me,x[2]=(J+U)/me):N>ye?(me=2*Math.sqrt(1+N-z-ye),x[3]=(J-U)/me,x[0]=(B+G)/me,x[1]=.25*me,x[2]=(Z+he)/me):(me=2*Math.sqrt(1+ye-z-N),x[3]=(B-G)/me,x[0]=(J+U)/me,x[1]=(Z+he)/me,x[2]=.25*me),x},we.fromRotationTranslationScale=function(x,S,I,T){var E=S[0],A=S[1],z=S[2],B=S[3],U=E+E,G=A+A,N=z+z,Z=E*U,J=E*G,he=E*N,ye=A*G,xe=A*N,me=z*N,Ae=B*U,Te=B*G,Oe=B*N,We=T[0],Ze=T[1],Ye=T[2];return x[0]=(1-(ye+me))*We,x[1]=(J+Oe)*We,x[2]=(he-Te)*We,x[3]=0,x[4]=(J-Oe)*Ze,x[5]=(1-(Z+me))*Ze,x[6]=(xe+Ae)*Ze,x[7]=0,x[8]=(he+Te)*Ye,x[9]=(xe-Ae)*Ye,x[10]=(1-(Z+ye))*Ye,x[11]=0,x[12]=I[0],x[13]=I[1],x[14]=I[2],x[15]=1,x},we.fromRotationTranslationScaleOrigin=function(x,S,I,T,E){var A=S[0],z=S[1],B=S[2],U=S[3],G=A+A,N=z+z,Z=B+B,J=A*G,he=A*N,ye=A*Z,xe=z*N,me=z*Z,Ae=B*Z,Te=U*G,Oe=U*N,We=U*Z,Ze=T[0],Ye=T[1],Je=T[2],at=E[0],Qe=E[1],gt=E[2],Et=(1-(xe+Ae))*Ze,dt=(he+We)*Ze,sr=(ye-Oe)*Ze,Jt=(he-We)*Ye,$t=(1-(J+Ae))*Ye,Dt=(me+Te)*Ye,vr=(ye+Oe)*Je,ir=(me-Te)*Je,cr=(1-(J+xe))*Je;return x[0]=Et,x[1]=dt,x[2]=sr,x[3]=0,x[4]=Jt,x[5]=$t,x[6]=Dt,x[7]=0,x[8]=vr,x[9]=ir,x[10]=cr,x[11]=0,x[12]=I[0]+at-(Et*at+Jt*Qe+vr*gt),x[13]=I[1]+Qe-(dt*at+$t*Qe+ir*gt),x[14]=I[2]+gt-(sr*at+Dt*Qe+cr*gt),x[15]=1,x},we.fromQuat=function(x,S){var I=S[0],T=S[1],E=S[2],A=S[3],z=I+I,B=T+T,U=E+E,G=I*z,N=T*z,Z=T*B,J=E*z,he=E*B,ye=E*U,xe=A*z,me=A*B,Ae=A*U;return x[0]=1-Z-ye,x[1]=N+Ae,x[2]=J-me,x[3]=0,x[4]=N-Ae,x[5]=1-G-ye,x[6]=he+xe,x[7]=0,x[8]=J+me,x[9]=he-xe,x[10]=1-G-Z,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},we.frustum=function(x,S,I,T,E,A,z){var B=1/(I-S),U=1/(E-T),G=1/(A-z);return x[0]=2*A*B,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=2*A*U,x[6]=0,x[7]=0,x[8]=(I+S)*B,x[9]=(E+T)*U,x[10]=(z+A)*G,x[11]=-1,x[12]=0,x[13]=0,x[14]=z*A*2*G,x[15]=0,x},we.perspectiveNO=b,we.perspectiveZO=function(x,S,I,T,E){var A,z=1/Math.tan(S/2);return x[0]=z/I,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=z,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,E!=null&&E!==1/0?(x[10]=E*(A=1/(T-E)),x[14]=E*T*A):(x[10]=-1,x[14]=-T),x},we.perspectiveFromFieldOfView=function(x,S,I,T){var E=Math.tan(S.upDegrees*Math.PI/180),A=Math.tan(S.downDegrees*Math.PI/180),z=Math.tan(S.leftDegrees*Math.PI/180),B=Math.tan(S.rightDegrees*Math.PI/180),U=2/(z+B),G=2/(E+A);return x[0]=U,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=G,x[6]=0,x[7]=0,x[8]=-(z-B)*U*.5,x[9]=(E-A)*G*.5,x[10]=T/(I-T),x[11]=-1,x[12]=0,x[13]=0,x[14]=T*I/(I-T),x[15]=0,x},we.orthoNO=C,we.orthoZO=function(x,S,I,T,E,A,z){var B=1/(S-I),U=1/(T-E),G=1/(A-z);return x[0]=-2*B,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*U,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=G,x[11]=0,x[12]=(S+I)*B,x[13]=(E+T)*U,x[14]=A*G,x[15]=1,x},we.lookAt=function(x,S,I,T){var E,A,z,B,U,G,N,Z,J,he,ye=S[0],xe=S[1],me=S[2],Ae=T[0],Te=T[1],Oe=T[2],We=I[0],Ze=I[1],Ye=I[2];return Math.abs(ye-We)<t.EPSILON&&Math.abs(xe-Ze)<t.EPSILON&&Math.abs(me-Ye)<t.EPSILON?c(x):(N=ye-We,Z=xe-Ze,J=me-Ye,E=Te*(J*=he=1/Math.hypot(N,Z,J))-Oe*(Z*=he),A=Oe*(N*=he)-Ae*J,z=Ae*Z-Te*N,(he=Math.hypot(E,A,z))?(E*=he=1/he,A*=he,z*=he):(E=0,A=0,z=0),B=Z*z-J*A,U=J*E-N*z,G=N*A-Z*E,(he=Math.hypot(B,U,G))?(B*=he=1/he,U*=he,G*=he):(B=0,U=0,G=0),x[0]=E,x[1]=B,x[2]=N,x[3]=0,x[4]=A,x[5]=U,x[6]=Z,x[7]=0,x[8]=z,x[9]=G,x[10]=J,x[11]=0,x[12]=-(E*ye+A*xe+z*me),x[13]=-(B*ye+U*xe+G*me),x[14]=-(N*ye+Z*xe+J*me),x[15]=1,x)},we.targetTo=function(x,S,I,T){var E=S[0],A=S[1],z=S[2],B=T[0],U=T[1],G=T[2],N=E-I[0],Z=A-I[1],J=z-I[2],he=N*N+Z*Z+J*J;he>0&&(N*=he=1/Math.sqrt(he),Z*=he,J*=he);var ye=U*J-G*Z,xe=G*N-B*J,me=B*Z-U*N;return(he=ye*ye+xe*xe+me*me)>0&&(ye*=he=1/Math.sqrt(he),xe*=he,me*=he),x[0]=ye,x[1]=xe,x[2]=me,x[3]=0,x[4]=Z*me-J*xe,x[5]=J*ye-N*me,x[6]=N*xe-Z*ye,x[7]=0,x[8]=N,x[9]=Z,x[10]=J,x[11]=0,x[12]=E,x[13]=A,x[14]=z,x[15]=1,x},we.str=function(x){return"mat4("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+", "+x[9]+", "+x[10]+", "+x[11]+", "+x[12]+", "+x[13]+", "+x[14]+", "+x[15]+")"},we.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15])},we.add=function(x,S,I){return x[0]=S[0]+I[0],x[1]=S[1]+I[1],x[2]=S[2]+I[2],x[3]=S[3]+I[3],x[4]=S[4]+I[4],x[5]=S[5]+I[5],x[6]=S[6]+I[6],x[7]=S[7]+I[7],x[8]=S[8]+I[8],x[9]=S[9]+I[9],x[10]=S[10]+I[10],x[11]=S[11]+I[11],x[12]=S[12]+I[12],x[13]=S[13]+I[13],x[14]=S[14]+I[14],x[15]=S[15]+I[15],x},we.subtract=k,we.multiplyScalar=function(x,S,I){return x[0]=S[0]*I,x[1]=S[1]*I,x[2]=S[2]*I,x[3]=S[3]*I,x[4]=S[4]*I,x[5]=S[5]*I,x[6]=S[6]*I,x[7]=S[7]*I,x[8]=S[8]*I,x[9]=S[9]*I,x[10]=S[10]*I,x[11]=S[11]*I,x[12]=S[12]*I,x[13]=S[13]*I,x[14]=S[14]*I,x[15]=S[15]*I,x},we.multiplyScalarAndAdd=function(x,S,I,T){return x[0]=S[0]+I[0]*T,x[1]=S[1]+I[1]*T,x[2]=S[2]+I[2]*T,x[3]=S[3]+I[3]*T,x[4]=S[4]+I[4]*T,x[5]=S[5]+I[5]*T,x[6]=S[6]+I[6]*T,x[7]=S[7]+I[7]*T,x[8]=S[8]+I[8]*T,x[9]=S[9]+I[9]*T,x[10]=S[10]+I[10]*T,x[11]=S[11]+I[11]*T,x[12]=S[12]+I[12]*T,x[13]=S[13]+I[13]*T,x[14]=S[14]+I[14]*T,x[15]=S[15]+I[15]*T,x},we.exactEquals=function(x,S){return x[0]===S[0]&&x[1]===S[1]&&x[2]===S[2]&&x[3]===S[3]&&x[4]===S[4]&&x[5]===S[5]&&x[6]===S[6]&&x[7]===S[7]&&x[8]===S[8]&&x[9]===S[9]&&x[10]===S[10]&&x[11]===S[11]&&x[12]===S[12]&&x[13]===S[13]&&x[14]===S[14]&&x[15]===S[15]},we.equals=function(x,S){var I=x[0],T=x[1],E=x[2],A=x[3],z=x[4],B=x[5],U=x[6],G=x[7],N=x[8],Z=x[9],J=x[10],he=x[11],ye=x[12],xe=x[13],me=x[14],Ae=x[15],Te=S[0],Oe=S[1],We=S[2],Ze=S[3],Ye=S[4],Je=S[5],at=S[6],Qe=S[7],gt=S[8],Et=S[9],dt=S[10],sr=S[11],Jt=S[12],$t=S[13],Dt=S[14],vr=S[15];return Math.abs(I-Te)<=t.EPSILON*Math.max(1,Math.abs(I),Math.abs(Te))&&Math.abs(T-Oe)<=t.EPSILON*Math.max(1,Math.abs(T),Math.abs(Oe))&&Math.abs(E-We)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(We))&&Math.abs(A-Ze)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(Ze))&&Math.abs(z-Ye)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ye))&&Math.abs(B-Je)<=t.EPSILON*Math.max(1,Math.abs(B),Math.abs(Je))&&Math.abs(U-at)<=t.EPSILON*Math.max(1,Math.abs(U),Math.abs(at))&&Math.abs(G-Qe)<=t.EPSILON*Math.max(1,Math.abs(G),Math.abs(Qe))&&Math.abs(N-gt)<=t.EPSILON*Math.max(1,Math.abs(N),Math.abs(gt))&&Math.abs(Z-Et)<=t.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Et))&&Math.abs(J-dt)<=t.EPSILON*Math.max(1,Math.abs(J),Math.abs(dt))&&Math.abs(he-sr)<=t.EPSILON*Math.max(1,Math.abs(he),Math.abs(sr))&&Math.abs(ye-Jt)<=t.EPSILON*Math.max(1,Math.abs(ye),Math.abs(Jt))&&Math.abs(xe-$t)<=t.EPSILON*Math.max(1,Math.abs(xe),Math.abs($t))&&Math.abs(me-Dt)<=t.EPSILON*Math.max(1,Math.abs(me),Math.abs(Dt))&&Math.abs(Ae-vr)<=t.EPSILON*Math.max(1,Math.abs(Ae),Math.abs(vr))},we.sub=we.mul=we.ortho=we.perspective=void 0;var t=function(x,S){if(x&&x.__esModule)return x;if(x===null||l(x)!=="object"&&typeof x!="function")return{default:x};var I=o(void 0);if(I&&I.has(x))return I.get(x);var T={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in x)if(A!=="default"&&Object.prototype.hasOwnProperty.call(x,A)){var z=E?Object.getOwnPropertyDescriptor(x,A):null;z&&(z.get||z.set)?Object.defineProperty(T,A,z):T[A]=x[A]}return T.default=x,I&&I.set(x,T),T}(se());function o(x){if(typeof WeakMap!="function")return null;var S=new WeakMap,I=new WeakMap;return(o=function(T){return T?I:S})(x)}function c(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function f(x,S,I){var T=S[0],E=S[1],A=S[2],z=S[3],B=S[4],U=S[5],G=S[6],N=S[7],Z=S[8],J=S[9],he=S[10],ye=S[11],xe=S[12],me=S[13],Ae=S[14],Te=S[15],Oe=I[0],We=I[1],Ze=I[2],Ye=I[3];return x[0]=Oe*T+We*B+Ze*Z+Ye*xe,x[1]=Oe*E+We*U+Ze*J+Ye*me,x[2]=Oe*A+We*G+Ze*he+Ye*Ae,x[3]=Oe*z+We*N+Ze*ye+Ye*Te,x[4]=(Oe=I[4])*T+(We=I[5])*B+(Ze=I[6])*Z+(Ye=I[7])*xe,x[5]=Oe*E+We*U+Ze*J+Ye*me,x[6]=Oe*A+We*G+Ze*he+Ye*Ae,x[7]=Oe*z+We*N+Ze*ye+Ye*Te,x[8]=(Oe=I[8])*T+(We=I[9])*B+(Ze=I[10])*Z+(Ye=I[11])*xe,x[9]=Oe*E+We*U+Ze*J+Ye*me,x[10]=Oe*A+We*G+Ze*he+Ye*Ae,x[11]=Oe*z+We*N+Ze*ye+Ye*Te,x[12]=(Oe=I[12])*T+(We=I[13])*B+(Ze=I[14])*Z+(Ye=I[15])*xe,x[13]=Oe*E+We*U+Ze*J+Ye*me,x[14]=Oe*A+We*G+Ze*he+Ye*Ae,x[15]=Oe*z+We*N+Ze*ye+Ye*Te,x}function d(x,S,I){var T=S[0],E=S[1],A=S[2],z=S[3],B=T+T,U=E+E,G=A+A,N=T*B,Z=T*U,J=T*G,he=E*U,ye=E*G,xe=A*G,me=z*B,Ae=z*U,Te=z*G;return x[0]=1-(he+xe),x[1]=Z+Te,x[2]=J-Ae,x[3]=0,x[4]=Z-Te,x[5]=1-(N+xe),x[6]=ye+me,x[7]=0,x[8]=J+Ae,x[9]=ye-me,x[10]=1-(N+he),x[11]=0,x[12]=I[0],x[13]=I[1],x[14]=I[2],x[15]=1,x}function m(x,S){var I=S[4],T=S[5],E=S[6],A=S[8],z=S[9],B=S[10];return x[0]=Math.hypot(S[0],S[1],S[2]),x[1]=Math.hypot(I,T,E),x[2]=Math.hypot(A,z,B),x}function b(x,S,I,T,E){var A,z=1/Math.tan(S/2);return x[0]=z/I,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=z,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,E!=null&&E!==1/0?(x[10]=(E+T)*(A=1/(T-E)),x[14]=2*E*T*A):(x[10]=-1,x[14]=-2*T),x}function C(x,S,I,T,E,A,z){var B=1/(S-I),U=1/(T-E),G=1/(A-z);return x[0]=-2*B,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*U,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*G,x[11]=0,x[12]=(S+I)*B,x[13]=(E+T)*U,x[14]=(z+A)*G,x[15]=1,x}function k(x,S,I){return x[0]=S[0]-I[0],x[1]=S[1]-I[1],x[2]=S[2]-I[2],x[3]=S[3]-I[3],x[4]=S[4]-I[4],x[5]=S[5]-I[5],x[6]=S[6]-I[6],x[7]=S[7]-I[7],x[8]=S[8]-I[8],x[9]=S[9]-I[9],x[10]=S[10]-I[10],x[11]=S[11]-I[11],x[12]=S[12]-I[12],x[13]=S[13]-I[13],x[14]=S[14]-I[14],x[15]=S[15]-I[15],x}return we.perspective=b,we.ortho=C,we.mul=f,we.sub=k,we}var oe,ve={},je={};function He(){if(oe)return je;function l(E){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},l(E)}oe=1,Object.defineProperty(je,"__esModule",{value:!0}),je.create=c,je.clone=function(E){var A=new t.ARRAY_TYPE(3);return A[0]=E[0],A[1]=E[1],A[2]=E[2],A},je.length=f,je.fromValues=function(E,A,z){var B=new t.ARRAY_TYPE(3);return B[0]=E,B[1]=A,B[2]=z,B},je.copy=function(E,A){return E[0]=A[0],E[1]=A[1],E[2]=A[2],E},je.set=function(E,A,z,B){return E[0]=A,E[1]=z,E[2]=B,E},je.add=function(E,A,z){return E[0]=A[0]+z[0],E[1]=A[1]+z[1],E[2]=A[2]+z[2],E},je.subtract=d,je.multiply=m,je.divide=b,je.ceil=function(E,A){return E[0]=Math.ceil(A[0]),E[1]=Math.ceil(A[1]),E[2]=Math.ceil(A[2]),E},je.floor=function(E,A){return E[0]=Math.floor(A[0]),E[1]=Math.floor(A[1]),E[2]=Math.floor(A[2]),E},je.min=function(E,A,z){return E[0]=Math.min(A[0],z[0]),E[1]=Math.min(A[1],z[1]),E[2]=Math.min(A[2],z[2]),E},je.max=function(E,A,z){return E[0]=Math.max(A[0],z[0]),E[1]=Math.max(A[1],z[1]),E[2]=Math.max(A[2],z[2]),E},je.round=function(E,A){return E[0]=Math.round(A[0]),E[1]=Math.round(A[1]),E[2]=Math.round(A[2]),E},je.scale=function(E,A,z){return E[0]=A[0]*z,E[1]=A[1]*z,E[2]=A[2]*z,E},je.scaleAndAdd=function(E,A,z,B){return E[0]=A[0]+z[0]*B,E[1]=A[1]+z[1]*B,E[2]=A[2]+z[2]*B,E},je.distance=C,je.squaredDistance=k,je.squaredLength=x,je.negate=function(E,A){return E[0]=-A[0],E[1]=-A[1],E[2]=-A[2],E},je.inverse=function(E,A){return E[0]=1/A[0],E[1]=1/A[1],E[2]=1/A[2],E},je.normalize=function(E,A){var z=A[0],B=A[1],U=A[2],G=z*z+B*B+U*U;return G>0&&(G=1/Math.sqrt(G)),E[0]=A[0]*G,E[1]=A[1]*G,E[2]=A[2]*G,E},je.dot=S,je.cross=function(E,A,z){var B=A[0],U=A[1],G=A[2],N=z[0],Z=z[1],J=z[2];return E[0]=U*J-G*Z,E[1]=G*N-B*J,E[2]=B*Z-U*N,E},je.lerp=function(E,A,z,B){var U=A[0],G=A[1],N=A[2];return E[0]=U+B*(z[0]-U),E[1]=G+B*(z[1]-G),E[2]=N+B*(z[2]-N),E},je.hermite=function(E,A,z,B,U,G){var N=G*G,Z=N*(2*G-3)+1,J=N*(G-2)+G,he=N*(G-1),ye=N*(3-2*G);return E[0]=A[0]*Z+z[0]*J+B[0]*he+U[0]*ye,E[1]=A[1]*Z+z[1]*J+B[1]*he+U[1]*ye,E[2]=A[2]*Z+z[2]*J+B[2]*he+U[2]*ye,E},je.bezier=function(E,A,z,B,U,G){var N=1-G,Z=N*N,J=G*G,he=Z*N,ye=3*G*Z,xe=3*J*N,me=J*G;return E[0]=A[0]*he+z[0]*ye+B[0]*xe+U[0]*me,E[1]=A[1]*he+z[1]*ye+B[1]*xe+U[1]*me,E[2]=A[2]*he+z[2]*ye+B[2]*xe+U[2]*me,E},je.random=function(E,A){A=A||1;var z=2*t.RANDOM()*Math.PI,B=2*t.RANDOM()-1,U=Math.sqrt(1-B*B)*A;return E[0]=Math.cos(z)*U,E[1]=Math.sin(z)*U,E[2]=B*A,E},je.transformMat4=function(E,A,z){var B=A[0],U=A[1],G=A[2],N=z[3]*B+z[7]*U+z[11]*G+z[15];return E[0]=(z[0]*B+z[4]*U+z[8]*G+z[12])/(N=N||1),E[1]=(z[1]*B+z[5]*U+z[9]*G+z[13])/N,E[2]=(z[2]*B+z[6]*U+z[10]*G+z[14])/N,E},je.transformMat3=function(E,A,z){var B=A[0],U=A[1],G=A[2];return E[0]=B*z[0]+U*z[3]+G*z[6],E[1]=B*z[1]+U*z[4]+G*z[7],E[2]=B*z[2]+U*z[5]+G*z[8],E},je.transformQuat=function(E,A,z){var B=z[0],U=z[1],G=z[2],N=A[0],Z=A[1],J=A[2],he=U*J-G*Z,ye=G*N-B*J,xe=B*Z-U*N,me=U*xe-G*ye,Ae=G*he-B*xe,Te=B*ye-U*he,Oe=2*z[3];return ye*=Oe,xe*=Oe,Ae*=2,Te*=2,E[0]=N+(he*=Oe)+(me*=2),E[1]=Z+ye+Ae,E[2]=J+xe+Te,E},je.rotateX=function(E,A,z,B){var U=[],G=[];return U[0]=A[0]-z[0],U[1]=A[1]-z[1],U[2]=A[2]-z[2],G[0]=U[0],G[1]=U[1]*Math.cos(B)-U[2]*Math.sin(B),G[2]=U[1]*Math.sin(B)+U[2]*Math.cos(B),E[0]=G[0]+z[0],E[1]=G[1]+z[1],E[2]=G[2]+z[2],E},je.rotateY=function(E,A,z,B){var U=[],G=[];return U[0]=A[0]-z[0],U[1]=A[1]-z[1],U[2]=A[2]-z[2],G[0]=U[2]*Math.sin(B)+U[0]*Math.cos(B),G[1]=U[1],G[2]=U[2]*Math.cos(B)-U[0]*Math.sin(B),E[0]=G[0]+z[0],E[1]=G[1]+z[1],E[2]=G[2]+z[2],E},je.rotateZ=function(E,A,z,B){var U=[],G=[];return U[0]=A[0]-z[0],U[1]=A[1]-z[1],U[2]=A[2]-z[2],G[0]=U[0]*Math.cos(B)-U[1]*Math.sin(B),G[1]=U[0]*Math.sin(B)+U[1]*Math.cos(B),G[2]=U[2],E[0]=G[0]+z[0],E[1]=G[1]+z[1],E[2]=G[2]+z[2],E},je.angle=function(E,A){var z=E[0],B=E[1],U=E[2],G=A[0],N=A[1],Z=A[2],J=Math.sqrt(z*z+B*B+U*U)*Math.sqrt(G*G+N*N+Z*Z),he=J&&S(E,A)/J;return Math.acos(Math.min(Math.max(he,-1),1))},je.zero=function(E){return E[0]=0,E[1]=0,E[2]=0,E},je.str=function(E){return"vec3("+E[0]+", "+E[1]+", "+E[2]+")"},je.exactEquals=function(E,A){return E[0]===A[0]&&E[1]===A[1]&&E[2]===A[2]},je.equals=function(E,A){var z=E[0],B=E[1],U=E[2],G=A[0],N=A[1],Z=A[2];return Math.abs(z-G)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(G))&&Math.abs(B-N)<=t.EPSILON*Math.max(1,Math.abs(B),Math.abs(N))&&Math.abs(U-Z)<=t.EPSILON*Math.max(1,Math.abs(U),Math.abs(Z))},je.forEach=je.sqrLen=je.len=je.sqrDist=je.dist=je.div=je.mul=je.sub=void 0;var t=function(E,A){if(E&&E.__esModule)return E;if(E===null||l(E)!=="object"&&typeof E!="function")return{default:E};var z=o(void 0);if(z&&z.has(E))return z.get(E);var B={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in E)if(G!=="default"&&Object.prototype.hasOwnProperty.call(E,G)){var N=U?Object.getOwnPropertyDescriptor(E,G):null;N&&(N.get||N.set)?Object.defineProperty(B,G,N):B[G]=E[G]}return B.default=E,z&&z.set(E,B),B}(se());function o(E){if(typeof WeakMap!="function")return null;var A=new WeakMap,z=new WeakMap;return(o=function(B){return B?z:A})(E)}function c(){var E=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0),E}function f(E){return Math.hypot(E[0],E[1],E[2])}function d(E,A,z){return E[0]=A[0]-z[0],E[1]=A[1]-z[1],E[2]=A[2]-z[2],E}function m(E,A,z){return E[0]=A[0]*z[0],E[1]=A[1]*z[1],E[2]=A[2]*z[2],E}function b(E,A,z){return E[0]=A[0]/z[0],E[1]=A[1]/z[1],E[2]=A[2]/z[2],E}function C(E,A){return Math.hypot(A[0]-E[0],A[1]-E[1],A[2]-E[2])}function k(E,A){var z=A[0]-E[0],B=A[1]-E[1],U=A[2]-E[2];return z*z+B*B+U*U}function x(E){var A=E[0],z=E[1],B=E[2];return A*A+z*z+B*B}function S(E,A){return E[0]*A[0]+E[1]*A[1]+E[2]*A[2]}je.sub=d,je.mul=m,je.div=b,je.dist=C,je.sqrDist=k,je.len=f,je.sqrLen=x;var I,T=(I=c(),function(E,A,z,B,U,G){var N,Z;for(A||(A=3),z||(z=0),Z=B?Math.min(B*A+z,E.length):E.length,N=z;N<Z;N+=A)I[0]=E[N],I[1]=E[N+1],I[2]=E[N+2],U(I,I,G),E[N]=I[0],E[N+1]=I[1],E[N+2]=I[2];return E});return je.forEach=T,je}var Le,ze,Pe={};function tt(){if(Le)return Pe;function l(T){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},l(T)}Le=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.create=c,Pe.clone=function(T){var E=new t.ARRAY_TYPE(4);return E[0]=T[0],E[1]=T[1],E[2]=T[2],E[3]=T[3],E},Pe.fromValues=function(T,E,A,z){var B=new t.ARRAY_TYPE(4);return B[0]=T,B[1]=E,B[2]=A,B[3]=z,B},Pe.copy=function(T,E){return T[0]=E[0],T[1]=E[1],T[2]=E[2],T[3]=E[3],T},Pe.set=function(T,E,A,z,B){return T[0]=E,T[1]=A,T[2]=z,T[3]=B,T},Pe.add=function(T,E,A){return T[0]=E[0]+A[0],T[1]=E[1]+A[1],T[2]=E[2]+A[2],T[3]=E[3]+A[3],T},Pe.subtract=f,Pe.multiply=d,Pe.divide=m,Pe.ceil=function(T,E){return T[0]=Math.ceil(E[0]),T[1]=Math.ceil(E[1]),T[2]=Math.ceil(E[2]),T[3]=Math.ceil(E[3]),T},Pe.floor=function(T,E){return T[0]=Math.floor(E[0]),T[1]=Math.floor(E[1]),T[2]=Math.floor(E[2]),T[3]=Math.floor(E[3]),T},Pe.min=function(T,E,A){return T[0]=Math.min(E[0],A[0]),T[1]=Math.min(E[1],A[1]),T[2]=Math.min(E[2],A[2]),T[3]=Math.min(E[3],A[3]),T},Pe.max=function(T,E,A){return T[0]=Math.max(E[0],A[0]),T[1]=Math.max(E[1],A[1]),T[2]=Math.max(E[2],A[2]),T[3]=Math.max(E[3],A[3]),T},Pe.round=function(T,E){return T[0]=Math.round(E[0]),T[1]=Math.round(E[1]),T[2]=Math.round(E[2]),T[3]=Math.round(E[3]),T},Pe.scale=function(T,E,A){return T[0]=E[0]*A,T[1]=E[1]*A,T[2]=E[2]*A,T[3]=E[3]*A,T},Pe.scaleAndAdd=function(T,E,A,z){return T[0]=E[0]+A[0]*z,T[1]=E[1]+A[1]*z,T[2]=E[2]+A[2]*z,T[3]=E[3]+A[3]*z,T},Pe.distance=b,Pe.squaredDistance=C,Pe.length=k,Pe.squaredLength=x,Pe.negate=function(T,E){return T[0]=-E[0],T[1]=-E[1],T[2]=-E[2],T[3]=-E[3],T},Pe.inverse=function(T,E){return T[0]=1/E[0],T[1]=1/E[1],T[2]=1/E[2],T[3]=1/E[3],T},Pe.normalize=function(T,E){var A=E[0],z=E[1],B=E[2],U=E[3],G=A*A+z*z+B*B+U*U;return G>0&&(G=1/Math.sqrt(G)),T[0]=A*G,T[1]=z*G,T[2]=B*G,T[3]=U*G,T},Pe.dot=function(T,E){return T[0]*E[0]+T[1]*E[1]+T[2]*E[2]+T[3]*E[3]},Pe.cross=function(T,E,A,z){var B=A[0]*z[1]-A[1]*z[0],U=A[0]*z[2]-A[2]*z[0],G=A[0]*z[3]-A[3]*z[0],N=A[1]*z[2]-A[2]*z[1],Z=A[1]*z[3]-A[3]*z[1],J=A[2]*z[3]-A[3]*z[2],he=E[0],ye=E[1],xe=E[2],me=E[3];return T[0]=ye*J-xe*Z+me*N,T[1]=-he*J+xe*G-me*U,T[2]=he*Z-ye*G+me*B,T[3]=-he*N+ye*U-xe*B,T},Pe.lerp=function(T,E,A,z){var B=E[0],U=E[1],G=E[2],N=E[3];return T[0]=B+z*(A[0]-B),T[1]=U+z*(A[1]-U),T[2]=G+z*(A[2]-G),T[3]=N+z*(A[3]-N),T},Pe.random=function(T,E){var A,z,B,U,G,N;E=E||1;do G=(A=2*t.RANDOM()-1)*A+(z=2*t.RANDOM()-1)*z;while(G>=1);do N=(B=2*t.RANDOM()-1)*B+(U=2*t.RANDOM()-1)*U;while(N>=1);var Z=Math.sqrt((1-G)/N);return T[0]=E*A,T[1]=E*z,T[2]=E*B*Z,T[3]=E*U*Z,T},Pe.transformMat4=function(T,E,A){var z=E[0],B=E[1],U=E[2],G=E[3];return T[0]=A[0]*z+A[4]*B+A[8]*U+A[12]*G,T[1]=A[1]*z+A[5]*B+A[9]*U+A[13]*G,T[2]=A[2]*z+A[6]*B+A[10]*U+A[14]*G,T[3]=A[3]*z+A[7]*B+A[11]*U+A[15]*G,T},Pe.transformQuat=function(T,E,A){var z=E[0],B=E[1],U=E[2],G=A[0],N=A[1],Z=A[2],J=A[3],he=J*z+N*U-Z*B,ye=J*B+Z*z-G*U,xe=J*U+G*B-N*z,me=-G*z-N*B-Z*U;return T[0]=he*J+me*-G+ye*-Z-xe*-N,T[1]=ye*J+me*-N+xe*-G-he*-Z,T[2]=xe*J+me*-Z+he*-N-ye*-G,T[3]=E[3],T},Pe.zero=function(T){return T[0]=0,T[1]=0,T[2]=0,T[3]=0,T},Pe.str=function(T){return"vec4("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+")"},Pe.exactEquals=function(T,E){return T[0]===E[0]&&T[1]===E[1]&&T[2]===E[2]&&T[3]===E[3]},Pe.equals=function(T,E){var A=T[0],z=T[1],B=T[2],U=T[3],G=E[0],N=E[1],Z=E[2],J=E[3];return Math.abs(A-G)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(G))&&Math.abs(z-N)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(N))&&Math.abs(B-Z)<=t.EPSILON*Math.max(1,Math.abs(B),Math.abs(Z))&&Math.abs(U-J)<=t.EPSILON*Math.max(1,Math.abs(U),Math.abs(J))},Pe.forEach=Pe.sqrLen=Pe.len=Pe.sqrDist=Pe.dist=Pe.div=Pe.mul=Pe.sub=void 0;var t=function(T,E){if(T&&T.__esModule)return T;if(T===null||l(T)!=="object"&&typeof T!="function")return{default:T};var A=o(void 0);if(A&&A.has(T))return A.get(T);var z={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in T)if(U!=="default"&&Object.prototype.hasOwnProperty.call(T,U)){var G=B?Object.getOwnPropertyDescriptor(T,U):null;G&&(G.get||G.set)?Object.defineProperty(z,U,G):z[U]=T[U]}return z.default=T,A&&A.set(T,z),z}(se());function o(T){if(typeof WeakMap!="function")return null;var E=new WeakMap,A=new WeakMap;return(o=function(z){return z?A:E})(T)}function c(){var T=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0,T[2]=0,T[3]=0),T}function f(T,E,A){return T[0]=E[0]-A[0],T[1]=E[1]-A[1],T[2]=E[2]-A[2],T[3]=E[3]-A[3],T}function d(T,E,A){return T[0]=E[0]*A[0],T[1]=E[1]*A[1],T[2]=E[2]*A[2],T[3]=E[3]*A[3],T}function m(T,E,A){return T[0]=E[0]/A[0],T[1]=E[1]/A[1],T[2]=E[2]/A[2],T[3]=E[3]/A[3],T}function b(T,E){return Math.hypot(E[0]-T[0],E[1]-T[1],E[2]-T[2],E[3]-T[3])}function C(T,E){var A=E[0]-T[0],z=E[1]-T[1],B=E[2]-T[2],U=E[3]-T[3];return A*A+z*z+B*B+U*U}function k(T){return Math.hypot(T[0],T[1],T[2],T[3])}function x(T){var E=T[0],A=T[1],z=T[2],B=T[3];return E*E+A*A+z*z+B*B}Pe.sub=f,Pe.mul=d,Pe.div=m,Pe.dist=b,Pe.sqrDist=C,Pe.len=k,Pe.sqrLen=x;var S,I=(S=c(),function(T,E,A,z,B,U){var G,N;for(E||(E=4),A||(A=0),N=z?Math.min(z*E+A,T.length):T.length,G=A;G<N;G+=E)S[0]=T[G],S[1]=T[G+1],S[2]=T[G+2],S[3]=T[G+3],B(S,S,U),T[G]=S[0],T[G+1]=S[1],T[G+2]=S[2],T[G+3]=S[3];return T});return Pe.forEach=I,Pe}function De(){if(ze)return ve;function l(Te){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Oe){return typeof Oe}:function(Oe){return Oe&&typeof Symbol=="function"&&Oe.constructor===Symbol&&Oe!==Symbol.prototype?"symbol":typeof Oe},l(Te)}ze=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.create=b,ve.identity=function(Te){return Te[0]=0,Te[1]=0,Te[2]=0,Te[3]=1,Te},ve.setAxisAngle=C,ve.getAxisAngle=function(Te,Oe){var We=2*Math.acos(Oe[3]),Ze=Math.sin(We/2);return Ze>t.EPSILON?(Te[0]=Oe[0]/Ze,Te[1]=Oe[1]/Ze,Te[2]=Oe[2]/Ze):(Te[0]=1,Te[1]=0,Te[2]=0),We},ve.getAngle=function(Te,Oe){var We=A(Te,Oe);return Math.acos(2*We*We-1)},ve.multiply=k,ve.rotateX=function(Te,Oe,We){We*=.5;var Ze=Oe[0],Ye=Oe[1],Je=Oe[2],at=Oe[3],Qe=Math.sin(We),gt=Math.cos(We);return Te[0]=Ze*gt+at*Qe,Te[1]=Ye*gt+Je*Qe,Te[2]=Je*gt-Ye*Qe,Te[3]=at*gt-Ze*Qe,Te},ve.rotateY=function(Te,Oe,We){We*=.5;var Ze=Oe[0],Ye=Oe[1],Je=Oe[2],at=Oe[3],Qe=Math.sin(We),gt=Math.cos(We);return Te[0]=Ze*gt-Je*Qe,Te[1]=Ye*gt+at*Qe,Te[2]=Je*gt+Ze*Qe,Te[3]=at*gt-Ye*Qe,Te},ve.rotateZ=function(Te,Oe,We){We*=.5;var Ze=Oe[0],Ye=Oe[1],Je=Oe[2],at=Oe[3],Qe=Math.sin(We),gt=Math.cos(We);return Te[0]=Ze*gt+Ye*Qe,Te[1]=Ye*gt-Ze*Qe,Te[2]=Je*gt+at*Qe,Te[3]=at*gt-Je*Qe,Te},ve.calculateW=function(Te,Oe){var We=Oe[0],Ze=Oe[1],Ye=Oe[2];return Te[0]=We,Te[1]=Ze,Te[2]=Ye,Te[3]=Math.sqrt(Math.abs(1-We*We-Ze*Ze-Ye*Ye)),Te},ve.exp=x,ve.ln=S,ve.pow=function(Te,Oe,We){return S(Te,Oe),E(Te,Te,We),x(Te,Te),Te},ve.slerp=I,ve.random=function(Te){var Oe=t.RANDOM(),We=t.RANDOM(),Ze=t.RANDOM(),Ye=Math.sqrt(1-Oe),Je=Math.sqrt(Oe);return Te[0]=Ye*Math.sin(2*Math.PI*We),Te[1]=Ye*Math.cos(2*Math.PI*We),Te[2]=Je*Math.sin(2*Math.PI*Ze),Te[3]=Je*Math.cos(2*Math.PI*Ze),Te},ve.invert=function(Te,Oe){var We=Oe[0],Ze=Oe[1],Ye=Oe[2],Je=Oe[3],at=We*We+Ze*Ze+Ye*Ye+Je*Je,Qe=at?1/at:0;return Te[0]=-We*Qe,Te[1]=-Ze*Qe,Te[2]=-Ye*Qe,Te[3]=Je*Qe,Te},ve.conjugate=function(Te,Oe){return Te[0]=-Oe[0],Te[1]=-Oe[1],Te[2]=-Oe[2],Te[3]=Oe[3],Te},ve.fromMat3=T,ve.fromEuler=function(Te,Oe,We,Ze){var Ye=.5*Math.PI/180;Oe*=Ye,We*=Ye,Ze*=Ye;var Je=Math.sin(Oe),at=Math.cos(Oe),Qe=Math.sin(We),gt=Math.cos(We),Et=Math.sin(Ze),dt=Math.cos(Ze);return Te[0]=Je*gt*dt-at*Qe*Et,Te[1]=at*Qe*dt+Je*gt*Et,Te[2]=at*gt*Et-Je*Qe*dt,Te[3]=at*gt*dt+Je*Qe*Et,Te},ve.str=function(Te){return"quat("+Te[0]+", "+Te[1]+", "+Te[2]+", "+Te[3]+")"},ve.setAxes=ve.sqlerp=ve.rotationTo=ve.equals=ve.exactEquals=ve.normalize=ve.sqrLen=ve.squaredLength=ve.len=ve.length=ve.lerp=ve.dot=ve.scale=ve.mul=ve.add=ve.set=ve.copy=ve.fromValues=ve.clone=void 0;var t=m(se()),o=m(Ie()),c=m(He()),f=m(tt());function d(Te){if(typeof WeakMap!="function")return null;var Oe=new WeakMap,We=new WeakMap;return(d=function(Ze){return Ze?We:Oe})(Te)}function m(Te,Oe){if(Te&&Te.__esModule)return Te;if(Te===null||l(Te)!=="object"&&typeof Te!="function")return{default:Te};var We=d(Oe);if(We&&We.has(Te))return We.get(Te);var Ze={},Ye=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Je in Te)if(Je!=="default"&&Object.prototype.hasOwnProperty.call(Te,Je)){var at=Ye?Object.getOwnPropertyDescriptor(Te,Je):null;at&&(at.get||at.set)?Object.defineProperty(Ze,Je,at):Ze[Je]=Te[Je]}return Ze.default=Te,We&&We.set(Te,Ze),Ze}function b(){var Te=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(Te[0]=0,Te[1]=0,Te[2]=0),Te[3]=1,Te}function C(Te,Oe,We){We*=.5;var Ze=Math.sin(We);return Te[0]=Ze*Oe[0],Te[1]=Ze*Oe[1],Te[2]=Ze*Oe[2],Te[3]=Math.cos(We),Te}function k(Te,Oe,We){var Ze=Oe[0],Ye=Oe[1],Je=Oe[2],at=Oe[3],Qe=We[0],gt=We[1],Et=We[2],dt=We[3];return Te[0]=Ze*dt+at*Qe+Ye*Et-Je*gt,Te[1]=Ye*dt+at*gt+Je*Qe-Ze*Et,Te[2]=Je*dt+at*Et+Ze*gt-Ye*Qe,Te[3]=at*dt-Ze*Qe-Ye*gt-Je*Et,Te}function x(Te,Oe){var We=Oe[0],Ze=Oe[1],Ye=Oe[2],Je=Oe[3],at=Math.sqrt(We*We+Ze*Ze+Ye*Ye),Qe=Math.exp(Je),gt=at>0?Qe*Math.sin(at)/at:0;return Te[0]=We*gt,Te[1]=Ze*gt,Te[2]=Ye*gt,Te[3]=Qe*Math.cos(at),Te}function S(Te,Oe){var We=Oe[0],Ze=Oe[1],Ye=Oe[2],Je=Oe[3],at=Math.sqrt(We*We+Ze*Ze+Ye*Ye),Qe=at>0?Math.atan2(at,Je)/at:0;return Te[0]=We*Qe,Te[1]=Ze*Qe,Te[2]=Ye*Qe,Te[3]=.5*Math.log(We*We+Ze*Ze+Ye*Ye+Je*Je),Te}function I(Te,Oe,We,Ze){var Ye,Je,at,Qe,gt,Et=Oe[0],dt=Oe[1],sr=Oe[2],Jt=Oe[3],$t=We[0],Dt=We[1],vr=We[2],ir=We[3];return(Je=Et*$t+dt*Dt+sr*vr+Jt*ir)<0&&(Je=-Je,$t=-$t,Dt=-Dt,vr=-vr,ir=-ir),1-Je>t.EPSILON?(Ye=Math.acos(Je),at=Math.sin(Ye),Qe=Math.sin((1-Ze)*Ye)/at,gt=Math.sin(Ze*Ye)/at):(Qe=1-Ze,gt=Ze),Te[0]=Qe*Et+gt*$t,Te[1]=Qe*dt+gt*Dt,Te[2]=Qe*sr+gt*vr,Te[3]=Qe*Jt+gt*ir,Te}function T(Te,Oe){var We,Ze=Oe[0]+Oe[4]+Oe[8];if(Ze>0)We=Math.sqrt(Ze+1),Te[3]=.5*We,Te[0]=(Oe[5]-Oe[7])*(We=.5/We),Te[1]=(Oe[6]-Oe[2])*We,Te[2]=(Oe[1]-Oe[3])*We;else{var Ye=0;Oe[4]>Oe[0]&&(Ye=1),Oe[8]>Oe[3*Ye+Ye]&&(Ye=2);var Je=(Ye+1)%3,at=(Ye+2)%3;We=Math.sqrt(Oe[3*Ye+Ye]-Oe[3*Je+Je]-Oe[3*at+at]+1),Te[Ye]=.5*We,Te[3]=(Oe[3*Je+at]-Oe[3*at+Je])*(We=.5/We),Te[Je]=(Oe[3*Je+Ye]+Oe[3*Ye+Je])*We,Te[at]=(Oe[3*at+Ye]+Oe[3*Ye+at])*We}return Te}ve.clone=f.clone,ve.fromValues=f.fromValues,ve.copy=f.copy,ve.set=f.set,ve.add=f.add,ve.mul=k;var E=f.scale;ve.scale=E;var A=f.dot;ve.dot=A,ve.lerp=f.lerp;var z=f.length;ve.length=z,ve.len=z;var B=f.squaredLength;ve.squaredLength=B,ve.sqrLen=B;var U=f.normalize;ve.normalize=U,ve.exactEquals=f.exactEquals,ve.equals=f.equals;var G,N,Z,J=(G=c.create(),N=c.fromValues(1,0,0),Z=c.fromValues(0,1,0),function(Te,Oe,We){var Ze=c.dot(Oe,We);return Ze<-.999999?(c.cross(G,N,Oe),c.len(G)<1e-6&&c.cross(G,Z,Oe),c.normalize(G,G),C(Te,G,Math.PI),Te):Ze>.999999?(Te[0]=0,Te[1]=0,Te[2]=0,Te[3]=1,Te):(c.cross(G,Oe,We),Te[0]=G[0],Te[1]=G[1],Te[2]=G[2],Te[3]=1+Ze,U(Te,Te))});ve.rotationTo=J;var he,ye,xe=(he=b(),ye=b(),function(Te,Oe,We,Ze,Ye,Je){return I(he,Oe,Ye,Je),I(ye,We,Ze,Je),I(Te,he,ye,2*Je*(1-Je)),Te});ve.sqlerp=xe;var me,Ae=(me=o.create(),function(Te,Oe,We,Ze){return me[0]=We[0],me[3]=We[1],me[6]=We[2],me[1]=Ze[0],me[4]=Ze[1],me[7]=Ze[2],me[2]=-Oe[0],me[5]=-Oe[1],me[8]=-Oe[2],U(Te,T(Te,me))});return ve.setAxes=Ae,ve}var Ke,Ge={};function ft(){if(Ke)return Ge;function l(I){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},l(I)}Ke=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.create=function(){var I=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[4]=0,I[5]=0,I[6]=0,I[7]=0),I[3]=1,I},Ge.clone=function(I){var T=new t.ARRAY_TYPE(8);return T[0]=I[0],T[1]=I[1],T[2]=I[2],T[3]=I[3],T[4]=I[4],T[5]=I[5],T[6]=I[6],T[7]=I[7],T},Ge.fromValues=function(I,T,E,A,z,B,U,G){var N=new t.ARRAY_TYPE(8);return N[0]=I,N[1]=T,N[2]=E,N[3]=A,N[4]=z,N[5]=B,N[6]=U,N[7]=G,N},Ge.fromRotationTranslationValues=function(I,T,E,A,z,B,U){var G=new t.ARRAY_TYPE(8);G[0]=I,G[1]=T,G[2]=E,G[3]=A;var N=.5*z,Z=.5*B,J=.5*U;return G[4]=N*A+Z*E-J*T,G[5]=Z*A+J*I-N*E,G[6]=J*A+N*T-Z*I,G[7]=-N*I-Z*T-J*E,G},Ge.fromRotationTranslation=m,Ge.fromTranslation=function(I,T){return I[0]=0,I[1]=0,I[2]=0,I[3]=1,I[4]=.5*T[0],I[5]=.5*T[1],I[6]=.5*T[2],I[7]=0,I},Ge.fromRotation=function(I,T){return I[0]=T[0],I[1]=T[1],I[2]=T[2],I[3]=T[3],I[4]=0,I[5]=0,I[6]=0,I[7]=0,I},Ge.fromMat4=function(I,T){var E=o.create();c.getRotation(E,T);var A=new t.ARRAY_TYPE(3);return c.getTranslation(A,T),m(I,E,A),I},Ge.copy=b,Ge.identity=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=1,I[4]=0,I[5]=0,I[6]=0,I[7]=0,I},Ge.set=function(I,T,E,A,z,B,U,G,N){return I[0]=T,I[1]=E,I[2]=A,I[3]=z,I[4]=B,I[5]=U,I[6]=G,I[7]=N,I},Ge.getDual=function(I,T){return I[0]=T[4],I[1]=T[5],I[2]=T[6],I[3]=T[7],I},Ge.setDual=function(I,T){return I[4]=T[0],I[5]=T[1],I[6]=T[2],I[7]=T[3],I},Ge.getTranslation=function(I,T){var E=T[4],A=T[5],z=T[6],B=T[7],U=-T[0],G=-T[1],N=-T[2],Z=T[3];return I[0]=2*(E*Z+B*U+A*N-z*G),I[1]=2*(A*Z+B*G+z*U-E*N),I[2]=2*(z*Z+B*N+E*G-A*U),I},Ge.translate=function(I,T,E){var A=T[0],z=T[1],B=T[2],U=T[3],G=.5*E[0],N=.5*E[1],Z=.5*E[2],J=T[4],he=T[5],ye=T[6],xe=T[7];return I[0]=A,I[1]=z,I[2]=B,I[3]=U,I[4]=U*G+z*Z-B*N+J,I[5]=U*N+B*G-A*Z+he,I[6]=U*Z+A*N-z*G+ye,I[7]=-A*G-z*N-B*Z+xe,I},Ge.rotateX=function(I,T,E){var A=-T[0],z=-T[1],B=-T[2],U=T[3],G=T[4],N=T[5],Z=T[6],J=T[7],he=G*U+J*A+N*B-Z*z,ye=N*U+J*z+Z*A-G*B,xe=Z*U+J*B+G*z-N*A,me=J*U-G*A-N*z-Z*B;return o.rotateX(I,T,E),I[4]=he*(U=I[3])+me*(A=I[0])+ye*(B=I[2])-xe*(z=I[1]),I[5]=ye*U+me*z+xe*A-he*B,I[6]=xe*U+me*B+he*z-ye*A,I[7]=me*U-he*A-ye*z-xe*B,I},Ge.rotateY=function(I,T,E){var A=-T[0],z=-T[1],B=-T[2],U=T[3],G=T[4],N=T[5],Z=T[6],J=T[7],he=G*U+J*A+N*B-Z*z,ye=N*U+J*z+Z*A-G*B,xe=Z*U+J*B+G*z-N*A,me=J*U-G*A-N*z-Z*B;return o.rotateY(I,T,E),I[4]=he*(U=I[3])+me*(A=I[0])+ye*(B=I[2])-xe*(z=I[1]),I[5]=ye*U+me*z+xe*A-he*B,I[6]=xe*U+me*B+he*z-ye*A,I[7]=me*U-he*A-ye*z-xe*B,I},Ge.rotateZ=function(I,T,E){var A=-T[0],z=-T[1],B=-T[2],U=T[3],G=T[4],N=T[5],Z=T[6],J=T[7],he=G*U+J*A+N*B-Z*z,ye=N*U+J*z+Z*A-G*B,xe=Z*U+J*B+G*z-N*A,me=J*U-G*A-N*z-Z*B;return o.rotateZ(I,T,E),I[4]=he*(U=I[3])+me*(A=I[0])+ye*(B=I[2])-xe*(z=I[1]),I[5]=ye*U+me*z+xe*A-he*B,I[6]=xe*U+me*B+he*z-ye*A,I[7]=me*U-he*A-ye*z-xe*B,I},Ge.rotateByQuatAppend=function(I,T,E){var A=E[0],z=E[1],B=E[2],U=E[3],G=T[0],N=T[1],Z=T[2],J=T[3];return I[0]=G*U+J*A+N*B-Z*z,I[1]=N*U+J*z+Z*A-G*B,I[2]=Z*U+J*B+G*z-N*A,I[3]=J*U-G*A-N*z-Z*B,I[4]=(G=T[4])*U+(J=T[7])*A+(N=T[5])*B-(Z=T[6])*z,I[5]=N*U+J*z+Z*A-G*B,I[6]=Z*U+J*B+G*z-N*A,I[7]=J*U-G*A-N*z-Z*B,I},Ge.rotateByQuatPrepend=function(I,T,E){var A=T[0],z=T[1],B=T[2],U=T[3],G=E[0],N=E[1],Z=E[2],J=E[3];return I[0]=A*J+U*G+z*Z-B*N,I[1]=z*J+U*N+B*G-A*Z,I[2]=B*J+U*Z+A*N-z*G,I[3]=U*J-A*G-z*N-B*Z,I[4]=A*(J=E[7])+U*(G=E[4])+z*(Z=E[6])-B*(N=E[5]),I[5]=z*J+U*N+B*G-A*Z,I[6]=B*J+U*Z+A*N-z*G,I[7]=U*J-A*G-z*N-B*Z,I},Ge.rotateAroundAxis=function(I,T,E,A){if(Math.abs(A)<t.EPSILON)return b(I,T);var z=Math.hypot(E[0],E[1],E[2]);A*=.5;var B=Math.sin(A),U=B*E[0]/z,G=B*E[1]/z,N=B*E[2]/z,Z=Math.cos(A),J=T[0],he=T[1],ye=T[2],xe=T[3];I[0]=J*Z+xe*U+he*N-ye*G,I[1]=he*Z+xe*G+ye*U-J*N,I[2]=ye*Z+xe*N+J*G-he*U,I[3]=xe*Z-J*U-he*G-ye*N;var me=T[4],Ae=T[5],Te=T[6],Oe=T[7];return I[4]=me*Z+Oe*U+Ae*N-Te*G,I[5]=Ae*Z+Oe*G+Te*U-me*N,I[6]=Te*Z+Oe*N+me*G-Ae*U,I[7]=Oe*Z-me*U-Ae*G-Te*N,I},Ge.add=function(I,T,E){return I[0]=T[0]+E[0],I[1]=T[1]+E[1],I[2]=T[2]+E[2],I[3]=T[3]+E[3],I[4]=T[4]+E[4],I[5]=T[5]+E[5],I[6]=T[6]+E[6],I[7]=T[7]+E[7],I},Ge.multiply=C,Ge.scale=function(I,T,E){return I[0]=T[0]*E,I[1]=T[1]*E,I[2]=T[2]*E,I[3]=T[3]*E,I[4]=T[4]*E,I[5]=T[5]*E,I[6]=T[6]*E,I[7]=T[7]*E,I},Ge.lerp=function(I,T,E,A){var z=1-A;return k(T,E)<0&&(A=-A),I[0]=T[0]*z+E[0]*A,I[1]=T[1]*z+E[1]*A,I[2]=T[2]*z+E[2]*A,I[3]=T[3]*z+E[3]*A,I[4]=T[4]*z+E[4]*A,I[5]=T[5]*z+E[5]*A,I[6]=T[6]*z+E[6]*A,I[7]=T[7]*z+E[7]*A,I},Ge.invert=function(I,T){var E=S(T);return I[0]=-T[0]/E,I[1]=-T[1]/E,I[2]=-T[2]/E,I[3]=T[3]/E,I[4]=-T[4]/E,I[5]=-T[5]/E,I[6]=-T[6]/E,I[7]=T[7]/E,I},Ge.conjugate=function(I,T){return I[0]=-T[0],I[1]=-T[1],I[2]=-T[2],I[3]=T[3],I[4]=-T[4],I[5]=-T[5],I[6]=-T[6],I[7]=T[7],I},Ge.normalize=function(I,T){var E=S(T);if(E>0){E=Math.sqrt(E);var A=T[0]/E,z=T[1]/E,B=T[2]/E,U=T[3]/E,G=T[4],N=T[5],Z=T[6],J=T[7],he=A*G+z*N+B*Z+U*J;I[0]=A,I[1]=z,I[2]=B,I[3]=U,I[4]=(G-A*he)/E,I[5]=(N-z*he)/E,I[6]=(Z-B*he)/E,I[7]=(J-U*he)/E}return I},Ge.str=function(I){return"quat2("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+", "+I[4]+", "+I[5]+", "+I[6]+", "+I[7]+")"},Ge.exactEquals=function(I,T){return I[0]===T[0]&&I[1]===T[1]&&I[2]===T[2]&&I[3]===T[3]&&I[4]===T[4]&&I[5]===T[5]&&I[6]===T[6]&&I[7]===T[7]},Ge.equals=function(I,T){var E=I[0],A=I[1],z=I[2],B=I[3],U=I[4],G=I[5],N=I[6],Z=I[7],J=T[0],he=T[1],ye=T[2],xe=T[3],me=T[4],Ae=T[5],Te=T[6],Oe=T[7];return Math.abs(E-J)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(J))&&Math.abs(A-he)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(he))&&Math.abs(z-ye)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(ye))&&Math.abs(B-xe)<=t.EPSILON*Math.max(1,Math.abs(B),Math.abs(xe))&&Math.abs(U-me)<=t.EPSILON*Math.max(1,Math.abs(U),Math.abs(me))&&Math.abs(G-Ae)<=t.EPSILON*Math.max(1,Math.abs(G),Math.abs(Ae))&&Math.abs(N-Te)<=t.EPSILON*Math.max(1,Math.abs(N),Math.abs(Te))&&Math.abs(Z-Oe)<=t.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Oe))},Ge.sqrLen=Ge.squaredLength=Ge.len=Ge.length=Ge.dot=Ge.mul=Ge.setReal=Ge.getReal=void 0;var t=d(se()),o=d(De()),c=d(ot());function f(I){if(typeof WeakMap!="function")return null;var T=new WeakMap,E=new WeakMap;return(f=function(A){return A?E:T})(I)}function d(I,T){if(I&&I.__esModule)return I;if(I===null||l(I)!=="object"&&typeof I!="function")return{default:I};var E=f(T);if(E&&E.has(I))return E.get(I);var A={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in I)if(B!=="default"&&Object.prototype.hasOwnProperty.call(I,B)){var U=z?Object.getOwnPropertyDescriptor(I,B):null;U&&(U.get||U.set)?Object.defineProperty(A,B,U):A[B]=I[B]}return A.default=I,E&&E.set(I,A),A}function m(I,T,E){var A=.5*E[0],z=.5*E[1],B=.5*E[2],U=T[0],G=T[1],N=T[2],Z=T[3];return I[0]=U,I[1]=G,I[2]=N,I[3]=Z,I[4]=A*Z+z*N-B*G,I[5]=z*Z+B*U-A*N,I[6]=B*Z+A*G-z*U,I[7]=-A*U-z*G-B*N,I}function b(I,T){return I[0]=T[0],I[1]=T[1],I[2]=T[2],I[3]=T[3],I[4]=T[4],I[5]=T[5],I[6]=T[6],I[7]=T[7],I}function C(I,T,E){var A=T[0],z=T[1],B=T[2],U=T[3],G=E[4],N=E[5],Z=E[6],J=E[7],he=T[4],ye=T[5],xe=T[6],me=T[7],Ae=E[0],Te=E[1],Oe=E[2],We=E[3];return I[0]=A*We+U*Ae+z*Oe-B*Te,I[1]=z*We+U*Te+B*Ae-A*Oe,I[2]=B*We+U*Oe+A*Te-z*Ae,I[3]=U*We-A*Ae-z*Te-B*Oe,I[4]=A*J+U*G+z*Z-B*N+he*We+me*Ae+ye*Oe-xe*Te,I[5]=z*J+U*N+B*G-A*Z+ye*We+me*Te+xe*Ae-he*Oe,I[6]=B*J+U*Z+A*N-z*G+xe*We+me*Oe+he*Te-ye*Ae,I[7]=U*J-A*G-z*N-B*Z+me*We-he*Ae-ye*Te-xe*Oe,I}Ge.getReal=o.copy,Ge.setReal=o.copy,Ge.mul=C;var k=o.dot;Ge.dot=k;var x=o.length;Ge.length=x,Ge.len=x;var S=o.squaredLength;return Ge.squaredLength=S,Ge.sqrLen=S,Ge}var Gt,Ft,wt={};function Rt(){if(Gt)return wt;function l(T){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},l(T)}Gt=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.create=c,wt.clone=function(T){var E=new t.ARRAY_TYPE(2);return E[0]=T[0],E[1]=T[1],E},wt.fromValues=function(T,E){var A=new t.ARRAY_TYPE(2);return A[0]=T,A[1]=E,A},wt.copy=function(T,E){return T[0]=E[0],T[1]=E[1],T},wt.set=function(T,E,A){return T[0]=E,T[1]=A,T},wt.add=function(T,E,A){return T[0]=E[0]+A[0],T[1]=E[1]+A[1],T},wt.subtract=f,wt.multiply=d,wt.divide=m,wt.ceil=function(T,E){return T[0]=Math.ceil(E[0]),T[1]=Math.ceil(E[1]),T},wt.floor=function(T,E){return T[0]=Math.floor(E[0]),T[1]=Math.floor(E[1]),T},wt.min=function(T,E,A){return T[0]=Math.min(E[0],A[0]),T[1]=Math.min(E[1],A[1]),T},wt.max=function(T,E,A){return T[0]=Math.max(E[0],A[0]),T[1]=Math.max(E[1],A[1]),T},wt.round=function(T,E){return T[0]=Math.round(E[0]),T[1]=Math.round(E[1]),T},wt.scale=function(T,E,A){return T[0]=E[0]*A,T[1]=E[1]*A,T},wt.scaleAndAdd=function(T,E,A,z){return T[0]=E[0]+A[0]*z,T[1]=E[1]+A[1]*z,T},wt.distance=b,wt.squaredDistance=C,wt.length=k,wt.squaredLength=x,wt.negate=function(T,E){return T[0]=-E[0],T[1]=-E[1],T},wt.inverse=function(T,E){return T[0]=1/E[0],T[1]=1/E[1],T},wt.normalize=function(T,E){var A=E[0],z=E[1],B=A*A+z*z;return B>0&&(B=1/Math.sqrt(B)),T[0]=E[0]*B,T[1]=E[1]*B,T},wt.dot=function(T,E){return T[0]*E[0]+T[1]*E[1]},wt.cross=function(T,E,A){var z=E[0]*A[1]-E[1]*A[0];return T[0]=T[1]=0,T[2]=z,T},wt.lerp=function(T,E,A,z){var B=E[0],U=E[1];return T[0]=B+z*(A[0]-B),T[1]=U+z*(A[1]-U),T},wt.random=function(T,E){E=E||1;var A=2*t.RANDOM()*Math.PI;return T[0]=Math.cos(A)*E,T[1]=Math.sin(A)*E,T},wt.transformMat2=function(T,E,A){var z=E[0],B=E[1];return T[0]=A[0]*z+A[2]*B,T[1]=A[1]*z+A[3]*B,T},wt.transformMat2d=function(T,E,A){var z=E[0],B=E[1];return T[0]=A[0]*z+A[2]*B+A[4],T[1]=A[1]*z+A[3]*B+A[5],T},wt.transformMat3=function(T,E,A){var z=E[0],B=E[1];return T[0]=A[0]*z+A[3]*B+A[6],T[1]=A[1]*z+A[4]*B+A[7],T},wt.transformMat4=function(T,E,A){var z=E[0],B=E[1];return T[0]=A[0]*z+A[4]*B+A[12],T[1]=A[1]*z+A[5]*B+A[13],T},wt.rotate=function(T,E,A,z){var B=E[0]-A[0],U=E[1]-A[1],G=Math.sin(z),N=Math.cos(z);return T[0]=B*N-U*G+A[0],T[1]=B*G+U*N+A[1],T},wt.angle=function(T,E){var A=T[0],z=T[1],B=E[0],U=E[1],G=Math.sqrt(A*A+z*z)*Math.sqrt(B*B+U*U);return Math.acos(Math.min(Math.max(G&&(A*B+z*U)/G,-1),1))},wt.zero=function(T){return T[0]=0,T[1]=0,T},wt.str=function(T){return"vec2("+T[0]+", "+T[1]+")"},wt.exactEquals=function(T,E){return T[0]===E[0]&&T[1]===E[1]},wt.equals=function(T,E){var A=T[0],z=T[1],B=E[0],U=E[1];return Math.abs(A-B)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(B))&&Math.abs(z-U)<=t.EPSILON*Math.max(1,Math.abs(z),Math.abs(U))},wt.forEach=wt.sqrLen=wt.sqrDist=wt.dist=wt.div=wt.mul=wt.sub=wt.len=void 0;var t=function(T,E){if(T&&T.__esModule)return T;if(T===null||l(T)!=="object"&&typeof T!="function")return{default:T};var A=o(void 0);if(A&&A.has(T))return A.get(T);var z={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in T)if(U!=="default"&&Object.prototype.hasOwnProperty.call(T,U)){var G=B?Object.getOwnPropertyDescriptor(T,U):null;G&&(G.get||G.set)?Object.defineProperty(z,U,G):z[U]=T[U]}return z.default=T,A&&A.set(T,z),z}(se());function o(T){if(typeof WeakMap!="function")return null;var E=new WeakMap,A=new WeakMap;return(o=function(z){return z?A:E})(T)}function c(){var T=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0),T}function f(T,E,A){return T[0]=E[0]-A[0],T[1]=E[1]-A[1],T}function d(T,E,A){return T[0]=E[0]*A[0],T[1]=E[1]*A[1],T}function m(T,E,A){return T[0]=E[0]/A[0],T[1]=E[1]/A[1],T}function b(T,E){return Math.hypot(E[0]-T[0],E[1]-T[1])}function C(T,E){var A=E[0]-T[0],z=E[1]-T[1];return A*A+z*z}function k(T){return Math.hypot(T[0],T[1])}function x(T){var E=T[0],A=T[1];return E*E+A*A}wt.len=k,wt.sub=f,wt.mul=d,wt.div=m,wt.dist=b,wt.sqrDist=C,wt.sqrLen=x;var S,I=(S=c(),function(T,E,A,z,B,U){var G,N;for(E||(E=2),A||(A=0),N=z?Math.min(z*E+A,T.length):T.length,G=A;G<N;G+=E)S[0]=T[G],S[1]=T[G+1],B(S,S,U),T[G]=S[0],T[G+1]=S[1];return T});return wt.forEach=I,wt}function It(){if(Ft)return q;function l(T){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},l(T)}Ft=1,Object.defineProperty(q,"__esModule",{value:!0}),q.vec4=q.vec3=q.vec2=q.quat2=q.quat=q.mat4=q.mat3=q.mat2d=q.mat2=q.glMatrix=void 0;var t=I(se());q.glMatrix=t;var o=I(de());q.mat2=o;var c=I(K());q.mat2d=c;var f=I(Ie());q.mat3=f;var d=I(ot());q.mat4=d;var m=I(De());q.quat=m;var b=I(ft());q.quat2=b;var C=I(Rt());q.vec2=C;var k=I(He());q.vec3=k;var x=I(tt());function S(T){if(typeof WeakMap!="function")return null;var E=new WeakMap,A=new WeakMap;return(S=function(z){return z?A:E})(T)}function I(T,E){if(T&&T.__esModule)return T;if(T===null||l(T)!=="object"&&typeof T!="function")return{default:T};var A=S(E);if(A&&A.has(T))return A.get(T);var z={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in T)if(U!=="default"&&Object.prototype.hasOwnProperty.call(T,U)){var G=B?Object.getOwnPropertyDescriptor(T,U):null;G&&(G.get||G.set)?Object.defineProperty(z,U,G):z[U]=T[U]}return z.default=T,A&&A.set(T,z),z}return q.vec4=x,q}var zt,At,kt,Ot,be=It(),Ht=function(){if(At)return zt;function l(t,o,c,f){this.cx=3*t,this.bx=3*(c-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=c,this.p2y=f}return At=1,zt=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,o){if(o===void 0&&(o=1e-6),t<0)return 0;if(t>1)return 1;for(var c=t,f=0;f<8;f++){var d=this.sampleCurveX(c)-t;if(Math.abs(d)<o)return c;var m=this.sampleCurveDerivativeX(c);if(Math.abs(m)<1e-6)break;c-=d/m}var b=0,C=1;for(c=t,f=0;f<20&&(d=this.sampleCurveX(c),!(Math.abs(d-t)<o));f++)t>d?b=c:C=c,c=.5*(C-b)+b;return c},solve:function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))}},zt}(),xt=j(Ht);function Bt(){if(Ot)return kt;function l(t,o){this.x=t,this.y=o}return Ot=1,kt=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,o){return this.clone()._rotateAround(t,o)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var o=t.x-this.x,c=t.y-this.y;return o*o+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,o){return Math.atan2(this.x*o-this.y*t,this.x*t+this.y*o)},_matMult:function(t){var o=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=o,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var o=Math.cos(t),c=Math.sin(t),f=c*this.x+o*this.y;return this.x=o*this.x-c*this.y,this.y=f,this},_rotateAround:function(t,o){var c=Math.cos(t),f=Math.sin(t),d=o.y+f*(this.x-o.x)+c*(this.y-o.y);return this.x=o.x+c*(this.x-o.x)-f*(this.y-o.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(t){return t instanceof l?t:Array.isArray(t)?new l(t[0],t[1]):t},kt}var rt=j(Bt());function qt(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(!qt(l[o],t[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const o in l)if(!qt(l[o],t[o]))return!1;return!0}return l===t}const Lt=Math.PI/180,Yt=180/Math.PI;function Wt(l){return l*Lt}function wr(l){return l*Yt}const Sr=[[0,0],[1,0],[1,1],[0,1]];function dn(l){if(l<=0)return 0;if(l>=1)return 1;const t=l*l,o=t*l;return 4*(l<.5?o:3*(l-t)+o-.75)}function Tt(l,t,o,c){const f=new xt(l,t,o,c);return function(d){return f.solve(d)}}const ar=Tt(.25,.1,.25,1);function Xt(l,t,o){return Math.min(o,Math.max(t,l))}function Hr(l,t,o){return(o=Xt((o-l)/(t-l),0,1))*o*(3-2*o)}function zr(l,t,o){const c=o-t,f=((l-t)%c+c)%c+t;return f===t?o:f}function br(l,t,o){if(!l.length)return o(null,[]);let c=l.length;const f=new Array(l.length);let d=null;l.forEach((m,b)=>{t(m,(C,k)=>{C&&(d=C),f[b]=k,--c==0&&o(d,f)})})}function Qr(l,...t){for(const o of t)for(const c in o)l[c]=o[c];return l}let pn=1;function Wr(){return pn++}function Jn(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function li(l,t){l.forEach(o=>{t[o]&&(t[o]=t[o].bind(t))})}function Dr(l,t){return l.indexOf(t,l.length-t.length)!==-1}function dr(l,t,o){const c={};for(const f in l)c[f]=t.call(this,l[f],f,l);return c}function gr(l,t,o){const c={};for(const f in l)t.call(this,l[f],f,l)&&(c[f]=l[f]);return c}function Zr(l){return Array.isArray(l)?l.map(Zr):typeof l=="object"&&l?dr(l,Zr):l}const hn={};function hr(l){hn[l]||(typeof console<"u"&&console.warn(l),hn[l]=!0)}function Mn(l,t,o){return(o.y-l.y)*(t.x-l.x)>(t.y-l.y)*(o.x-l.x)}function bi(l){let t=0;for(let o,c,f=0,d=l.length,m=d-1;f<d;m=f++)o=l[f],c=l[m],t+=(c.x-o.x)*(o.y+c.y);return t}function sn([l,t,o]){const c=Wt(t+90),f=Wt(o);return{x:l*Math.cos(c)*Math.sin(f),y:l*Math.sin(c)*Math.sin(f),z:l*Math.cos(f),azimuthal:t,polar:o}}function qn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function uo(l){const t={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,f,d)=>{const m=f||d;return t[c]=!m||m.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let _o,eo=null;function ms(l,t){return[l[4*t],l[4*t+1],l[4*t+2],l[4*t+3]]}function ut(l,t,o,c){for(;t<o;){const f=t+o>>1;l[f]<c?t=f+1:o=f}return t}function ue(l,t,o,c){for(;t<o;){const f=t+o>>1;l[f]<=c?t=f+1:o=f}return t}function pe(l){return l>0?1/(1.001-l):1+l}function ke(l){return l>0?1-1/(1.001-l):-l}const Ve={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_o==null){const l=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_o=a.API_URL_REGEX!=null?new RegExp(a.API_URL_REGEX):l}catch{_o=l}}return _o},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ve.API_URL)return null;try{const l=new URL(Ve.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Be(l){return Ve.API_URL_REGEX.test(l)}function Xe(l){return Ve.API_SPRITE_REGEX.test(l)}let lt,et,ct,yt,mt,jt;function nr(){return lt==null&&(lt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),lt}const or={now:()=>yt!==void 0?yt:performance.now(),setNow(l){yt=l},restoreNow(){yt=void 0},frame(l){const t=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(l,t=0){const{width:o,height:c}=l;mt||(mt=document.createElement("canvas"));const f=mt.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>mt.width||c>mt.height)&&(mt.width=o,mt.height=c),f.clearRect(-t,-t,o+2*t,c+2*t),f.drawImage(l,0,0,o,c),f.getImageData(-t,-t,o+2*t,c+2*t)},resolveURL:l=>(et||(et=document.createElement("a")),et.href=l,et.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(ct==null&&(ct=window.matchMedia("(prefers-reduced-motion: reduce)")),ct.matches)},hasCanvasFingerprintNoise(){if(jt!==void 0)return jt;if(!nr())return jt=!1,!1;const l=new OffscreenCanvas(85,1),t=l.getContext("2d",{willReadFrequently:!0});let o=0;for(let f=0;f<l.width;++f)t.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,t.fillRect(f,0,1,1);const c=t.getImageData(0,0,l.width,l.height);o=0;for(let f=0;f<c.data.length;++f)if(f%4!=3&&o++!==c.data[f])return jt=!0,!0;return jt=!1,!1}};function Or(l,t){const o=l.indexOf("?");if(o<0)return`${l}?${new URLSearchParams(t).toString()}`;const c=new URLSearchParams(l.slice(o));for(const f in t)c.set(f,t[f]);return`${l.slice(0,o)}?${c.toString()}`}function Fr(l,t={persistentParams:[]}){const o=l.indexOf("?");if(o<0)return l;const c=new URLSearchParams,f=new URLSearchParams(l.slice(o));for(const m of t.persistentParams){const b=f.get(m);b&&c.set(m,b)}const d=c.toString();return`${l.slice(0,o)}${d.length>0?`?${d}`:""}`}const Br="mapbox-tiles";let jr=500,Tn=50;const Pn=["language","worldview","jobid"];let Yr,En;function ti(){try{return caches}catch{}}function Ii(){const l=ti();l&&Yr==null&&(Yr=l.open(Br))}let ki=1/0;const Zi={supported:!1,testSupport:function(l){!Nl&&Is&&(Vl?xc(l):Bo=l)}};let Bo,Is,Nl=!1,Vl=!1;const il=typeof self<"u"?self:{};function xc(l){const t=l.createTexture();l.bindTexture(l.TEXTURE_2D,t);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Is),l.isContextLost())return;Zi.supported=!0}catch{}l.deleteTexture(t),Nl=!0}il.document&&(Is=il.document.createElement("img"),Is.onload=function(){Bo&&xc(Bo),Bo=null,Vl=!0},Is.onerror=function(){Nl=!0,Bo=null},Is.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ol={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(ol);class ju extends Error{constructor(t,o,c){o===401&&Be(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Nu=qn()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,sl=function(l,t){if(!(/^file:/.test(o=l.url)||/^file:/.test(Nu())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,f){const d=new AbortController,m=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Nu(),referrerPolicy:c.referrerPolicy,signal:d.signal});let b=!1,C=!1;const k=(x=m.url).indexOf("sku=")>0&&Be(x);var x;c.type==="json"&&m.headers.set("Accept","application/json");const S=(T,E,A)=>{if(C)return;if(T&&T.message!=="SecurityError"&&hr(T.toString()),E&&A)return I(E);const z=Date.now();fetch(m).then(B=>{if(B.ok){const U=k?B.clone():null;return I(B,U,z)}return f(new ju(B.statusText,B.status,c.url))}).catch(B=>{B.name!=="AbortError"&&f(new Error(`${B.message} ${c.url}`))})},I=(T,E,A)=>{(c.type==="arrayBuffer"?T.arrayBuffer():c.type==="json"?T.json():T.text()).then(z=>{C||(E&&A&&function(B,U,G){if(Ii(),Yr==null)return;const N=uo(U.headers.get("Cache-Control")||"");if(N["no-store"])return;const Z={status:U.status,statusText:U.statusText,headers:new Headers};U.headers.forEach((ye,xe)=>Z.headers.set(xe,ye)),N["max-age"]&&Z.headers.set("Expires",new Date(G+1e3*N["max-age"]).toUTCString());const J=Z.headers.get("Expires");if(!J||new Date(J).getTime()-G<42e4)return;let he=Fr(B.url,{persistentParams:Pn});if(U.status===206){const ye=B.headers.get("Range");if(!ye)return;Z.status=200,he=Or(he,{range:ye})}(function(ye,xe){if(En===void 0)try{new Response(new ReadableStream),En=!0}catch{En=!1}En?xe(ye.body):ye.blob().then(xe)})(U,ye=>{const xe=new Response((me=U.status)!==200&&me!==404&&[101,103,204,205,304].includes(me)?null:ye,Z);var me;Ii(),Yr!=null&&Yr.then(Ae=>Ae.put(he,xe)).catch(Ae=>hr(Ae.message))})}(m,E,A),b=!0,f(null,z,T.headers.get("Cache-Control"),T.headers.get("Expires")))}).catch(z=>{C||f(new Error(z.message))})};return k?function(T,E){if(Ii(),Yr==null)return E(null);Yr.then(A=>{let z=Fr(T.url,{persistentParams:Pn});const B=T.headers.get("Range");B&&(z=Or(z,{range:B})),A.match(z).then(U=>{const G=function(N){if(!N)return!1;const Z=new Date(N.headers.get("Expires")||0),J=uo(N.headers.get("Cache-Control")||"");return Z>Date.now()&&!J["no-cache"]}(U);A.delete(z),G&&A.put(z,U.clone()),E(null,U,G)}).catch(E)}).catch(E)}(m,S):S(null,null),{cancel:()=>{C=!0,b||d.abort()}}}(l,t);if(qn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,t,void 0,!0)}var o;return function(c,f){const d=new XMLHttpRequest;d.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(d.responseType="arraybuffer");for(const m in c.headers)d.setRequestHeader(m,c.headers[m]);return c.type==="json"&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials=c.credentials==="include",d.onerror=()=>{f(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||d.status===0)&&d.response!==null){let m=d.response;if(c.type==="json")try{m=JSON.parse(d.response)}catch(b){return f(b)}f(null,m,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else f(new ju(d.statusText,d.status,c.url))},d.send(c.body),{cancel:()=>d.abort()}}(l,t)},al=function(l,t){return sl(Qr(l,{type:"arrayBuffer"}),t)};function jo(l){const t=document.createElement("a");return t.href=l,t.protocol===location.protocol&&t.host===location.host}const Ri="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ks,No;ks=[],No=0;const Qs=function(l,t){if(Zi.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),No>=Ve.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:l,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return ks.push(d),d}No++;let o=!1;const c=()=>{if(!o)for(o=!0,No--;ks.length&&No<Ve.MAX_PARALLEL_IMAGE_REQUESTS;){const d=ks.shift(),{requestParameters:m,callback:b,cancelled:C}=d;C||(d.cancel=Qs(m,b).cancel)}},f=al(l,(d,m,b,C)=>{c(),d?t(d):m&&(self.createImageBitmap?function(k,x){const S=new Blob([new Uint8Array(k)],{type:"image/png"});createImageBitmap(S).then(I=>{x(null,I)}).catch(I=>{x(new Error(`Could not load image because of ${I.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(k,x)=>t(k,x,b,C)):function(k,x){const S=new Image;S.onload=()=>{x(null,S),URL.revokeObjectURL(S.src),S.onload=null,requestAnimationFrame(()=>{S.src=Ri})},S.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new Blob([new Uint8Array(k)],{type:"image/png"});S.src=k.byteLength?URL.createObjectURL(I):Ri}(m,(k,x)=>t(k,x,b,C)))});return{cancel:()=>{f.cancel(),c()}}};var Vu,Tf,Cf,ea={exports:{}},nh={exports:{}},Wy={exports:{}},A1=function(){if(Cf)return ea.exports;Cf=1;var l=(Vu||(Vu=1,nh.exports=function(o,c){var f,d,m,b,C,k,x,S;for(d=o.length-(f=3&o.length),m=c,C=3432918353,k=461845907,S=0;S<d;)x=255&o.charCodeAt(S)|(255&o.charCodeAt(++S))<<8|(255&o.charCodeAt(++S))<<16|(255&o.charCodeAt(++S))<<24,++S,m=27492+(65535&(b=5*(65535&(m=(m^=x=(65535&(x=(x=(65535&x)*C+(((x>>>16)*C&65535)<<16)&4294967295)<<15|x>>>17))*k+(((x>>>16)*k&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(x=0,f){case 3:x^=(255&o.charCodeAt(S+2))<<16;case 2:x^=(255&o.charCodeAt(S+1))<<8;case 1:m^=x=(65535&(x=(x=(65535&(x^=255&o.charCodeAt(S)))*C+(((x>>>16)*C&65535)<<16)&4294967295)<<15|x>>>17))*k+(((x>>>16)*k&65535)<<16)&4294967295}return m^=o.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}),nh.exports),t=(Tf||(Tf=1,Wy.exports=function(o,c){for(var f,d=o.length,m=c^d,b=0;d>=4;)f=1540483477*(65535&(f=255&o.charCodeAt(b)|(255&o.charCodeAt(++b))<<8|(255&o.charCodeAt(++b))<<16|(255&o.charCodeAt(++b))<<24))+((1540483477*(f>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),d-=4,++b;switch(d){case 3:m^=(255&o.charCodeAt(b+2))<<16;case 2:m^=(255&o.charCodeAt(b+1))<<8;case 1:m=1540483477*(65535&(m^=255&o.charCodeAt(b)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}),Wy.exports);return ea.exports=l,ea.exports.murmur3=l,ea.exports.murmur2=t,ea.exports}(),Vo=j(A1);class ll{constructor(t,...o){Qr(this,o[0]||{}),this.type=t}}class $u extends ll{constructor(t,o={}){super("error",Qr({error:t},o))}}function vc(l,t,o){o[l]&&o[l].indexOf(t)!==-1||(o[l]=o[l]||[],o[l].push(t))}function Mf(l,t,o){if(o&&o[l]){const c=o[l].indexOf(t);c!==-1&&o[l].splice(c,1)}}class bc{on(t,o){return this._listeners=this._listeners||{},vc(t,o,this._listeners),this}off(t,o){return Mf(t,o,this._listeners),Mf(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},vc(t,o,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,o){const c=typeof t=="string"?new ll(t,o):t,f=c.type;if(this.listens(f)){c.target=this;const d=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const C of d)C.call(this,c);const m=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const C of m)Mf(f,C,this._oneTimeListeners),C.call(this,c);const b=this._eventedParent;b&&(Qr(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(c))}else c instanceof $u&&console.error(c.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var Ef,vn={},If=function(){if(Ef)return vn;Ef=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(d){return(d=Math.round(d))<0?0:d>255?255:d}function o(d){return t(d[d.length-1]==="%"?parseFloat(d)/100*255:parseInt(d))}function c(d){return(m=d[d.length-1]==="%"?parseFloat(d)/100:parseFloat(d))<0?0:m>1?1:m;var m}function f(d,m,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?d+(m-d)*b*6:2*b<1?m:3*b<2?d+(m-d)*(2/3-b)*6:d}try{vn.parseCSSColor=function(d){var m,b=d.replace(/ /g,"").toLowerCase();if(b in l)return l[b].slice();if(b[0]==="#")return b.length===4?(m=parseInt(b.substr(1),16))>=0&&m<=4095?[(3840&m)>>4|(3840&m)>>8,240&m|(240&m)>>4,15&m|(15&m)<<4,1]:null:b.length===7&&(m=parseInt(b.substr(1),16))>=0&&m<=16777215?[(16711680&m)>>16,(65280&m)>>8,255&m,1]:null;var C=b.indexOf("("),k=b.indexOf(")");if(C!==-1&&k+1===b.length){var x=b.substr(0,C),S=b.substr(C+1,k-(C+1)).split(","),I=1;switch(x){case"rgba":if(S.length!==4)return null;I=c(S.pop());case"rgb":return S.length!==3?null:[o(S[0]),o(S[1]),o(S[2]),I];case"hsla":if(S.length!==4)return null;I=c(S.pop());case"hsl":if(S.length!==3)return null;var T=(parseFloat(S[0])%360+360)%360/360,E=c(S[1]),A=c(S[2]),z=A<=.5?A*(E+1):A+E-A*E,B=2*A-z;return[t(255*f(B,z,T+1/3)),t(255*f(B,z,T)),t(255*f(B,z,T-1/3)),I];default:return null}}return null}}catch{}return vn}();class An{constructor(t,o,c,f=1){this.r=t,this.g=o,this.b=c,this.a=f}static parse(t){if(!t)return;if(t instanceof An)return t;if(typeof t!="string")return;const o=If.parseCSSColor(t);return o?new An(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[t,o,c,f]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(t)},${Math.round(o)},${Math.round(c)},${f})`}toRenderColor(t){const{r:o,g:c,b:f,a:d}=this;return new D1(t,o,c,f,d)}}class D1{constructor(t,o,c,f,d){if(t){const m=t.image.height,b=m*m;o=d===0?0:o/d*(m-1),c=d===0?0:c/d*(m-1),f=d===0?0:f/d*(m-1);const C=Math.floor(o),k=Math.floor(c),x=Math.floor(f),S=Math.ceil(o),I=Math.ceil(c),T=Math.ceil(f),E=o-C,A=c-k,z=f-x,B=t.image.data,U=4*(C+k*b+x*m),G=4*(C+k*b+T*m),N=4*(C+I*b+x*m),Z=4*(C+I*b+T*m),J=4*(S+k*b+x*m),he=4*(S+k*b+T*m),ye=4*(S+I*b+x*m),xe=4*(S+I*b+T*m);if(U<0||xe>=B.length)throw new Error("out of range");this.r=Pr(Pr(Pr(B[U],B[G],z),Pr(B[N],B[Z],z),A),Pr(Pr(B[J],B[he],z),Pr(B[ye],B[xe],z),A),E)/255*d,this.g=Pr(Pr(Pr(B[U+1],B[G+1],z),Pr(B[N+1],B[Z+1],z),A),Pr(Pr(B[J+1],B[he+1],z),Pr(B[ye+1],B[xe+1],z),A),E)/255*d,this.b=Pr(Pr(Pr(B[U+2],B[G+2],z),Pr(B[N+2],B[Z+2],z),A),Pr(Pr(B[J+2],B[he+2],z),Pr(B[ye+2],B[xe+2],z),A),E)/255*d,this.a=d}else this.r=o,this.g=c,this.b=f,this.a=d}toArray(){const{r:t,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*t/f,255*o/f,255*c/f,f]}toArray01(){const{r:t,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[t/f,o/f,c/f,f]}toArray01Scaled(t){const{r:o,g:c,b:f,a:d}=this;return d===0?[0,0,0]:[o/d*t,c/d*t,f/d*t]}toArray01PremultipliedAlpha(){const{r:t,g:o,b:c,a:f}=this;return[t,o,c,f]}toArray01Linear(){const{r:t,g:o,b:c,a:f}=this;return f===0?[0,0,0,0]:[Math.pow(t/f,2.2),Math.pow(o/f,2.2),Math.pow(c/f,2.2),f]}}function Pr(l,t,o){return l*(1-o)+t*o}function Uu(l,t,o){return l.map((c,f)=>Pr(c,t[f],o))}An.black=new An(0,0,0,1),An.white=new An(1,1,1,1),An.transparent=new An(0,0,0,0),An.red=new An(1,0,0,1),An.blue=new An(0,0,1,1);var $l=Object.freeze({__proto__:null,array:Uu,color:function(l,t,o){return new An(Pr(l.r,t.r,o),Pr(l.g,t.g,o),Pr(l.b,t.b,o),Pr(l.a,t.a,o))},number:Pr});function wc(l,...t){for(const o of t)for(const c in o)l[c]=o[c];return l}class ta extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class ih{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[c,f]of o)this.bindings[c]=f}concat(t){return new ih(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Ps={kind:"null"},pr={kind:"number"},fn={kind:"string"},mn={kind:"boolean"},$o={kind:"color"},xo={kind:"object"},xn={kind:"value"},oh={kind:"collator"},Sc={kind:"formatted"},Tc={kind:"resolvedImage"};function Eo(l,t){return{kind:"array",itemType:l,N:t}}function wi(l){if(l.kind==="array"){const t=wi(l.itemType);return typeof l.N=="number"?`array<${t}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${t}>`}return l.kind}const Gy=[Ps,pr,fn,mn,$o,Sc,xo,Eo(xn),Tc];function Cc(l,t){if(t.kind==="error")return null;if(l.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Cc(l.itemType,t.itemType))&&(typeof l.N!="number"||l.N===t.N))return null}else{if(l.kind===t.kind)return null;if(l.kind==="value"){for(const o of Gy)if(!Cc(o,t))return null}}return`Expected ${wi(l)} but found ${wi(t)} instead.`}function Mc(l,t){return t.some(o=>o.kind===l.kind)}function ra(l,t){return t.some(o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l)}class sh{constructor(t,o,c){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class es{constructor(t,o,c,f,d){this.text=t.normalize?t.normalize():t,this.image=o,this.scale=c,this.fontStack=f,this.textColor=d}}class vo{constructor(t){this.sections=t}static fromString(t){return new vo([new es(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof vo?t:vo.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){t.push(["image",o.image.namePrimary]);continue}t.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toRenderColor(null).toArray())),t.push(c)}return t}}class Io{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,o){return t?new Io({namePrimary:t,nameSecondary:o,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Hy(l,t,o,c){return typeof l=="number"&&l>=0&&l<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[l,t,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[l,t,o,c]:[l,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function cl(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof An||l instanceof sh||l instanceof vo||l instanceof Io)return!0;if(Array.isArray(l)){for(const t of l)if(!cl(t))return!1;return!0}if(typeof l=="object"){for(const t in l)if(!cl(l[t]))return!1;return!0}return!1}function Li(l){if(l===null)return Ps;if(typeof l=="string")return fn;if(typeof l=="boolean")return mn;if(typeof l=="number")return pr;if(l instanceof An)return $o;if(l instanceof sh)return oh;if(l instanceof vo)return Sc;if(l instanceof Io)return Tc;if(Array.isArray(l)){const t=l.length;let o;for(const c of l){const f=Li(c);if(o){if(o===f)continue;o=xn;break}o=f}return Eo(o||xn,t)}return xo}function ko(l){const t=typeof l;return l===null?"":t==="string"||t==="number"||t==="boolean"?String(l):l instanceof An||l instanceof vo||l instanceof Io?l.toString():JSON.stringify(l)}class As{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!cl(t[1]))return o.error("invalid value");const c=t[1];let f=Li(c);const d=o.expectedType;return f.kind!=="array"||f.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(f=d),new As(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof An?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof vo?this.value.serialize():this.value}}class Yi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const kf={string:fn,number:pr,boolean:mn,object:xo};class Ds{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let c,f=1;const d=t[0];if(d==="array"){let b,C;if(t.length>2){const k=t[1];if(typeof k!="string"||!(k in kf)||k==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=kf[k],f++}else b=xn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);C=t[2],f++}c=Eo(b,C)}else c=kf[d];const m=[];for(;f<t.length;f++){const b=o.parse(t[f],f,xn);if(!b)return null;m.push(b)}return new Ds(c,m)}evaluate(t){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(t);if(!Cc(this.type,Li(c)))return c;if(o===this.args.length-1)throw new Yi(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${wi(Li(c))} but was expected to be of type ${wi(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){o.push(c.kind);const f=t.N;(typeof f=="number"||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map(c=>c.serialize()))}}class Ec{constructor(t){this.type=Sc,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const f=[];let d=!1;for(let m=1;m<=t.length-1;++m){const b=t[m];if(d&&typeof b=="object"&&!Array.isArray(b)){d=!1;let C=null;if(b["font-scale"]&&(C=o.parseObjectValue(b["font-scale"],m,"font-scale",pr),!C))return null;let k=null;if(b["text-font"]&&(k=o.parseObjectValue(b["text-font"],m,"text-font",Eo(fn)),!k))return null;let x=null;if(b["text-color"]&&(x=o.parseObjectValue(b["text-color"],m,"text-color",$o),!x))return null;const S=f[f.length-1];S.scale=C,S.font=k,S.textColor=x}else{const C=o.parse(t[m],m,xn);if(!C)return null;const k=C.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,f.push({content:C,scale:null,font:null,textColor:null})}}return new Ec(f)}evaluate(t){return new vo(this.sections.map(o=>{const c=o.content.evaluate(t);return Li(c)===Tc?new es("",c,null,null,null):new es(ko(c),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),t.push(c)}return t}}class Ul{constructor(t,o){this.type=Tc,this.inputPrimary=t,this.inputSecondary=o}static parse(t,o){if(t.length<2)return o.error("Expected two or more arguments.");const c=o.parse(t[1],1,fn);if(!c)return o.error("No image name provided.");if(t.length===2)return new Ul(c);const f=o.parse(t[2],1,fn);return f?new Ul(c,f):o.error("Secondary image variant is not a string.")}evaluate(t){const o=Io.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(o.namePrimary)>-1,o.nameSecondary&&o.available&&t.availableImages&&(o.available=t.availableImages.indexOf(o.nameSecondary)>-1)),o}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Wl(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const ah={"to-boolean":mn,"to-color":$o,"to-number":pr,"to-string":fn};class ka{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const c=t[0],f=[];let d=Ps;if(c==="to-array"){if(!Array.isArray(t[1]))return null;const m=t[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);d=Eo(o.expectedType.itemType,m)}else{if(!(m>0&&cl(t[1][0])))return null;d=Eo(Li(t[1][0]),m)}for(let b=0;b<m;b++){const C=t[1][b];let k;if(Wl(C)==="array")k=o.parse(C,void 0,d.itemType);else{const x=Wl(C);if(x!==d.itemType.kind)return o.error(`Expected ${d.itemType.kind} but found ${x}.`);k=o.registry.literal.parse(["literal",C===void 0?null:C],o)}if(!k)return null;f.push(k)}}else{if((c==="to-boolean"||c==="to-string")&&t.length!==2)return o.error("Expected one argument.");d=ah[c];for(let m=1;m<t.length;m++){const b=o.parse(t[m],m,xn);if(!b)return null;f.push(b)}}return new ka(d,f)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let o,c;for(const f of this.args){if(o=f.evaluate(t),c=null,o instanceof An)return o;if(typeof o=="string"){const d=t.parseColor(o);if(d)return d}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Hy(o[0],o[1],o[2],o[3]),!c))return new An(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Yi(c||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const c of this.args){if(o=c.evaluate(t),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Yi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?vo.fromString(ko(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Io.fromString(ko(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(o=>o.evaluate(t)):ko(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ec([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ul(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{t.push(o.serialize())}),t}}const R1=["Unknown","Point","LineString","Polygon"];class qy{constructor(t,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?R1[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*o-t[0])+this.featureDistanceData.bearing[1]*(f*o-t[1])}return 0}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=An.parse(t)),o}getConfig(t){return this.options?this.options.get(t):null}}class Uo{constructor(t,o,c,f,d){this.name=t,this.type=o,this._evaluate=c,this.args=f,this._overloadIndex=d}evaluate(t){if(!this._evaluate){const o=Uo.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,o){const c=t[0],f=Uo.definitions[c];if(!f)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(f)?f[0]:f.type,m=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,b=[];let C=null,k=-1;for(const[x,S]of m){if(Array.isArray(x)&&x.length!==t.length-1)continue;b.push(x),k++,C=new o_(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const I=[];let T=!1;for(let E=1;E<t.length;E++){const A=t[E],z=Array.isArray(x)?x[E-1]:x.type,B=C.parse(A,1+I.length,z);if(!B){T=!0;break}I.push(B)}if(!T)if(Array.isArray(x)&&x.length!==I.length)C.error(`Expected ${x.length} arguments, but found ${I.length} instead.`);else{for(let E=0;E<I.length;E++){const A=Array.isArray(x)?x[E]:x.type,z=I[E];C.concat(E+1).checkSubtype(A,z.type)}if(C.errors.length===0)return new Uo(c,d,S,I,k)}}if(b.length===1)o.errors.push(...C.errors);else{const x=(b.length?b:m.map(([I])=>I)).map(L1).join(" | "),S=[];for(let I=1;I<t.length;I++){const T=o.parse(t[I],1+S.length);if(!T)return null;S.push(wi(T.type))}o.error(`Expected arguments of type ${x}, but found (${S.join(", ")}) instead.`)}return null}static register(t,o){Uo.definitions=o;for(const c in o)t[c]=Uo}}function L1(l){return Array.isArray(l)?`(${l.map(wi).join(", ")})`:`(${wi(l.type)}...)`}class lh{constructor(t,o,c){this.type=oh,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const f=c["case-sensitive"]===void 0?o.parse(!1,1,mn):o.parseObjectValue(c["case-sensitive"],1,"case-sensitive",mn);if(!f)return null;const d=c["diacritic-sensitive"]===void 0?o.parse(!1,1,mn):o.parseObjectValue(c["diacritic-sensitive"],1,"diacritic-sensitive",mn);if(!d)return null;let m=null;return c.locale&&(m=o.parseObjectValue(c.locale,1,"locale",fn),!m)?null:new lh(f,d,m)}evaluate(t){return new sh(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function Zy(l,t,o=0,c=l.length-1,f=kc){for(;c>o;){if(c-o>600){const C=c-o+1,k=t-o+1,x=Math.log(C),S=.5*Math.exp(2*x/3),I=.5*Math.sqrt(x*S*(C-S)/C)*(k-C/2<0?-1:1);Zy(l,t,Math.max(o,Math.floor(t-k*S/C+I)),Math.min(c,Math.floor(t+(C-k)*S/C+I)),f)}const d=l[t];let m=o,b=c;for(Ic(l,o,t),f(l[c],d)>0&&Ic(l,o,c);m<b;){for(Ic(l,m,b),m++,b--;f(l[m],d)<0;)m++;for(;f(l[b],d)>0;)b--}f(l[o],d)===0?Ic(l,o,b):(b++,Ic(l,b,c)),b<=t&&(o=b+1),t<=b&&(c=b-1)}}function Ic(l,t,o){const c=l[t];l[t]=l[o],l[o]=c}function kc(l,t){return l<t?-1:l>t?1:0}function z1(l){let t=0;for(let o,c,f=0,d=l.length,m=d-1;f<d;m=f++)o=l[f],c=l[m],t+=(c.x-o.x)*(o.y+c.y);return t}function Wu(l,t){l[0]=Math.min(l[0],t[0]),l[1]=Math.min(l[1],t[1]),l[2]=Math.max(l[2],t[0]),l[3]=Math.max(l[3],t[1])}function Gl(l,t){return!(l[0]<=t[0]||l[2]>=t[2]||l[1]<=t[1]||l[3]>=t[3])}function O1(l,t,o){const c=l[0]-t[0],f=l[1]-t[1],d=l[0]-o[0],m=l[1]-o[1];return c*m-d*f==0&&c*d<=0&&f*m<=0}function Pc(l,t,o=!1){let c=!1;for(let b=0,C=t.length;b<C;b++){const k=t[b];for(let x=0,S=k.length,I=S-1;x<S;I=x++){const T=k[I],E=k[x];if(O1(l,T,E))return o;(d=T)[1]>(f=l)[1]!=(m=E)[1]>f[1]&&f[0]<(m[0]-d[0])*(f[1]-d[1])/(m[1]-d[1])+d[0]&&(c=!c)}}var f,d,m;return c}function Yy(l,t,o,c){const f=c[0]-o[0],d=c[1]-o[1],m=(l[0]-o[0])*d-f*(l[1]-o[1]),b=(t[0]-o[0])*d-f*(t[1]-o[1]);return m>0&&b<0||m<0&&b>0}function ch(l,t,o,c){return(f=[c[0]-o[0],c[1]-o[1]])[0]*(d=[t[0]-l[0],t[1]-l[1]])[1]-f[1]*d[0]!=0&&!(!Yy(l,t,o,c)||!Yy(o,c,l,t));var f,d}const ts=8192;function cn(l,t){const o=(180+l[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(o*f*ts),Math.round(c*f*ts)]}function Tr(l,t){for(let o=0;o<t.length;o++)if(Pc(l,t[o]))return!0;return!1}function Pf(l,t,o){for(const c of o)for(let f=0,d=c.length,m=d-1;f<d;m=f++)if(ch(l,t,c[m],c[f]))return!0;return!1}function qr(l,t){for(let o=0;o<l.length;++o)if(!Pc(l[o],t))return!1;for(let o=0;o<l.length-1;++o)if(Pf(l[o],l[o+1],t))return!1;return!0}function Af(l,t){for(let o=0;o<t.length;o++)if(qr(l,t[o]))return!0;return!1}function Gu(l,t,o){const c=[];for(let f=0;f<l.length;f++){const d=[];for(let m=0;m<l[f].length;m++){const b=cn(l[f][m],o);Wu(t,b),d.push(b)}c.push(d)}return c}function Nr(l,t,o){const c=[];for(let f=0;f<l.length;f++){const d=Gu(l[f],t,o);c.push(d)}return c}function Df(l,t,o,c){if(l[0]<o[0]||l[0]>o[2]){const f=.5*c;let d=l[0]-o[0]>f?-c:o[0]-l[0]>f?c:0;d===0&&(d=l[0]-o[2]>f?-c:o[2]-l[0]>f?c:0),l[0]+=d}Wu(t,l)}function uh(l,t,o,c){const f=Math.pow(2,c.z)*ts,d=[c.x*ts,c.y*ts],m=[];if(!l)return m;for(const b of l)for(const C of b){const k=[C.x+d[0],C.y+d[1]];Df(k,t,o,f),m.push(k)}return m}function Rf(l,t,o,c){const f=Math.pow(2,c.z)*ts,d=[c.x*ts,c.y*ts],m=[];if(!l)return m;for(const C of l){const k=[];for(const x of C){const S=[x.x+d[0],x.y+d[1]];Wu(t,S),k.push(S)}m.push(k)}if(t[2]-t[0]<=f/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const C of m)for(const k of C)Df(k,t,o,f)}var b;return m}class ul{constructor(t,o){this.type=mn,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(cl(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const d=c.features[f].geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new ul(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new ul(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new ul(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,c){const f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const b=Gu(c.coordinates,d,m),C=uh(o.geometry(),f,d,m);if(!Gl(f,d))return!1;for(const k of C)if(!Pc(k,b))return!1}if(c.type==="MultiPolygon"){const b=Nr(c.coordinates,d,m),C=uh(o.geometry(),f,d,m);if(!Gl(f,d))return!1;for(const k of C)if(!Tr(k,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,c){const f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const b=Gu(c.coordinates,d,m),C=Rf(o.geometry(),f,d,m);if(!Gl(f,d))return!1;for(const k of C)if(!qr(k,b))return!1}if(c.type==="MultiPolygon"){const b=Nr(c.coordinates,d,m),C=Rf(o.geometry(),f,d,m);if(!Gl(f,d))return!1;for(const k of C)if(!Af(k,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Hl={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},ho=1/298.257223563,dh=ho*(2-ho),Ac=Math.PI/180;class Dc{static fromTile(t,o,c){const f=Math.PI*(1-2*(t+.5)/Math.pow(2,o)),d=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/Ac;return new Dc(d,c)}static get units(){return Hl}constructor(t,o){if(t===void 0)throw new Error("No latitude given.");if(o&&!Hl[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(Hl).join(", ")}`);const c=6378.137*Ac*(o?Hl[o]:1),f=Math.cos(t*Ac),d=1/(1-dh*(1-f*f)),m=Math.sqrt(d);this.kx=c*m*f,this.ky=c*m*d*(1-dh)}distance(t,o){const c=pi(t[0]-o[0])*this.kx,f=(t[1]-o[1])*this.ky;return Math.sqrt(c*c+f*f)}bearing(t,o){const c=pi(o[0]-t[0])*this.kx;return Math.atan2(c,(o[1]-t[1])*this.ky)/Ac}destination(t,o,c){const f=c*Ac;return this.offset(t,Math.sin(f)*o,Math.cos(f)*o)}offset(t,o,c){return[t[0]+o/this.kx,t[1]+c/this.ky]}lineDistance(t){let o=0;for(let c=0;c<t.length-1;c++)o+=this.distance(t[c],t[c+1]);return o}area(t){let o=0;for(let c=0;c<t.length;c++){const f=t[c];for(let d=0,m=f.length,b=m-1;d<m;b=d++)o+=pi(f[d][0]-f[b][0])*(f[d][1]+f[b][1])*(c?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(t,o){let c=0;if(o<=0)return t[0];for(let f=0;f<t.length-1;f++){const d=t[f],m=t[f+1],b=this.distance(d,m);if(c+=b,c>o)return Pa(d,m,(o-(c-b))/b)}return t[t.length-1]}pointToSegmentDistance(t,o,c){let[f,d]=o,m=pi(c[0]-f)*this.kx,b=(c[1]-d)*this.ky;if(m!==0||b!==0){const C=(pi(t[0]-f)*this.kx*m+(t[1]-d)*this.ky*b)/(m*m+b*b);C>1?(f=c[0],d=c[1]):C>0&&(f+=m/this.kx*C,d+=b/this.ky*C)}return m=pi(t[0]-f)*this.kx,b=(t[1]-d)*this.ky,Math.sqrt(m*m+b*b)}pointOnLine(t,o){let c=1/0,f=t[0][0],d=t[0][1],m=0,b=0;for(let C=0;C<t.length-1;C++){let k=t[C][0],x=t[C][1],S=pi(t[C+1][0]-k)*this.kx,I=(t[C+1][1]-x)*this.ky,T=0;S===0&&I===0||(T=(pi(o[0]-k)*this.kx*S+(o[1]-x)*this.ky*I)/(S*S+I*I),T>1?(k=t[C+1][0],x=t[C+1][1]):T>0&&(k+=S/this.kx*T,x+=I/this.ky*T)),S=pi(o[0]-k)*this.kx,I=(o[1]-x)*this.ky;const E=S*S+I*I;E<c&&(c=E,f=k,d=x,m=C,b=T)}return{point:[f,d],index:m,t:Math.max(0,Math.min(1,b))}}lineSlice(t,o,c){let f=this.pointOnLine(c,t),d=this.pointOnLine(c,o);if(f.index>d.index||f.index===d.index&&f.t>d.t){const k=f;f=d,d=k}const m=[f.point],b=f.index+1,C=d.index;!hh(c[b],m[0])&&b<=C&&m.push(c[b]);for(let k=b+1;k<=C;k++)m.push(c[k]);return hh(c[C],d.point)||m.push(d.point),m}lineSliceAlong(t,o,c){let f=0;const d=[];for(let m=0;m<c.length-1;m++){const b=c[m],C=c[m+1],k=this.distance(b,C);if(f+=k,f>t&&d.length===0&&d.push(Pa(b,C,(t-(f-k))/k)),f>=o)return d.push(Pa(b,C,(o-(f-k))/k)),d;f>t&&d.push(C)}return d}bufferPoint(t,o){const c=o/this.ky,f=o/this.kx;return[t[0]-f,t[1]-c,t[0]+f,t[1]+c]}bufferBBox(t,o){const c=o/this.ky,f=o/this.kx;return[t[0]-f,t[1]-c,t[2]+f,t[3]+c]}insideBBox(t,o){return pi(t[0]-o[0])>=0&&pi(t[0]-o[2])<=0&&t[1]>=o[1]&&t[1]<=o[3]}}function hh(l,t){return l[0]===t[0]&&l[1]===t[1]}function Pa(l,t,o){const c=pi(t[0]-l[0]);return[l[0]+c*o,l[1]+(t[1]-l[1])*o]}function pi(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class Lf{constructor(t=[],o=(c,f)=>c<f?-1:c>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:c}=this,f=o[t];for(;t>0;){const d=t-1>>1,m=o[d];if(c(f,m)>=0)break;o[t]=m,t=d}o[t]=f}_down(t){const{data:o,compare:c}=this,f=this.length>>1,d=o[t];for(;t<f;){let m=1+(t<<1);const b=m+1;if(b<this.length&&c(o[b],o[m])<0&&(m=b),c(o[m],d)>=0)break;o[t]=o[m],t=m}o[t]=d}}var er=8192;function Xy(l,t){return t.dist-l.dist}const Rc=100,ph=50;function fh(l){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==l.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==l[o])return!1;return!0}function mh(l){return l[1]-l[0]+1}function Aa(l,t){const o=l[1]>=l[0]&&l[1]<t;return o||console.warn("Distance Expression: Index is out of range"),o}function zf(l,t){if(l[0]>l[1])return[null,null];const o=mh(l);if(t){if(o===2)return[l,null];const c=Math.floor(o/2);return[[l[0],l[0]+c],[l[0]+c,l[1]]]}{if(o===1)return[l,null];const c=Math.floor(o/2)-1;return[[l[0],l[0]+c],[l[0]+c+1,l[1]]]}}function rs(l,t){const o=[1/0,1/0,-1/0,-1/0];if(!Aa(t,l.length))return o;for(let c=t[0];c<=t[1];++c)Wu(o,l[c]);return o}function gh(l){const t=[1/0,1/0,-1/0,-1/0];for(let o=0;o<l.length;++o)for(let c=0;c<l[o].length;++c)Wu(t,l[o][c]);return t}function Lc(l,t,o){if(fh(l)||fh(t))return NaN;let c=0,f=0;return l[2]<t[0]&&(c=t[0]-l[2]),l[0]>t[2]&&(c=l[0]-t[2]),l[1]>t[3]&&(f=l[1]-t[3]),l[3]<t[1]&&(f=t[1]-l[3]),o.distance([0,0],[c,f])}function Ky(l){return 360*l-180}function Jy(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function ns(l,t){const o=Math.pow(2,t.z),c=(l.y/er+t.y)/o;return[Ky((l.x/er+t.x)/o),Jy(c)]}function Qy(l,t){const o=[];for(let c=0;c<l.length;++c)o.push(ns(l[c],t));return o}function Of(l,t,o){const c=o.pointOnLine(t,l).point;return o.distance(l,c)}function Ff(l,t,o,c,f){const d=o.slice(c[0],c[1]+1);let m=1/0;for(let b=t[0];b<=t[1];++b)if((m=Math.min(m,Of(l[b],d,f)))===0)return 0;return m}function yh(l,t,o,c,f){const d=Math.min(f.pointToSegmentDistance(l,o,c),f.pointToSegmentDistance(t,o,c)),m=Math.min(f.pointToSegmentDistance(o,l,t),f.pointToSegmentDistance(c,l,t));return Math.min(d,m)}function e_(l,t,o,c,f){if(!Aa(t,l.length)||!Aa(c,o.length))return NaN;let d=1/0;for(let m=t[0];m<t[1];++m)for(let b=c[0];b<c[1];++b){if(ch(l[m],l[m+1],o[b],o[b+1]))return 0;d=Math.min(d,yh(l[m],l[m+1],o[b],o[b+1],f))}return d}function t_(l,t,o,c,f){if(!Aa(t,l.length)||!Aa(c,o.length))return NaN;let d=1/0;for(let m=t[0];m<=t[1];++m)for(let b=c[0];b<=c[1];++b)if((d=Math.min(d,f.distance(l[m],o[b])))===0)return d;return d}function r_(l,t,o){if(Pc(l,t,!0))return 0;let c=1/0;for(const f of t){const d=f.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[d-1]&&(c=Math.min(c,o.pointToSegmentDistance(l,f[d-1],f[0])))===0||(c=Math.min(c,Of(l,f,o)))===0)return c}return c}function n_(l,t,o,c){if(!Aa(t,l.length))return NaN;for(let d=t[0];d<=t[1];++d)if(Pc(l[d],o,!0))return 0;let f=1/0;for(let d=t[0];d<t[1];++d)for(const m of o)for(let b=0,C=m.length,k=C-1;b<C;k=b++){if(ch(l[d],l[d+1],m[k],m[b]))return 0;f=Math.min(f,yh(l[d],l[d+1],m[k],m[b],c))}return f}function Bf(l,t){for(const o of l)for(let c=0;c<=o.length-1;++c)if(Pc(o[c],t,!0))return!0;return!1}function i_(l,t,o,c=1/0){const f=gh(l),d=gh(t);if(c!==1/0&&Lc(f,d,o)>=c)return c;if(Gl(f,d)){if(Bf(l,t))return 0}else if(Bf(t,l))return 0;let m=c;for(const b of l)for(let C=0,k=b.length,x=k-1;C<k;x=C++)for(const S of t)for(let I=0,T=S.length,E=T-1;I<T;E=I++){if(ch(b[x],b[C],S[E],S[I]))return 0;m=Math.min(m,yh(b[x],b[C],S[E],S[I],o))}return m}function Hu(l,t,o,c,f,d,m){if(d===null||m===null)return;const b=Lc(rs(c,d),rs(f,m),o);b<t&&l.push({dist:b,range1:d,range2:m})}function _h(l,t,o,c,f=1/0){let d=Math.min(c.distance(l[0],o[0][0]),f);if(d===0)return d;const m=new Lf([{dist:0,range1:[0,l.length-1],range2:[0,0]}],Xy),b=t?ph:Rc,C=gh(o);for(;m.length;){const k=m.pop();if(k.dist>=d)continue;const x=k.range1;if(mh(x)<=b){if(!Aa(x,l.length))return NaN;if(t){const S=n_(l,x,o,c);if((d=Math.min(d,S))===0)return d}else for(let S=x[0];S<=x[1];++S){const I=r_(l[S],o,c);if((d=Math.min(d,I))===0)return d}}else{const S=zf(x,t);if(S[0]!==null){const I=Lc(rs(l,S[0]),C,c);I<d&&m.push({dist:I,range1:S[0],range2:[0,0]})}if(S[1]!==null){const I=Lc(rs(l,S[1]),C,c);I<d&&m.push({dist:I,range1:S[1],range2:[0,0]})}}}return d}function qu(l,t,o,c,f,d=1/0){let m=Math.min(d,f.distance(l[0],o[0]));if(m===0)return m;const b=new Lf([{dist:0,range1:[0,l.length-1],range2:[0,o.length-1]}],Xy),C=t?ph:Rc,k=c?ph:Rc;for(;b.length;){const x=b.pop();if(x.dist>=m)continue;const S=x.range1,I=x.range2;if(mh(S)<=C&&mh(I)<=k){if(!Aa(S,l.length)||!Aa(I,o.length))return NaN;if(t&&c?m=Math.min(m,e_(l,S,o,I,f)):t||c?t&&!c?m=Math.min(m,Ff(o,I,l,S,f)):!t&&c&&(m=Math.min(m,Ff(l,S,o,I,f))):m=Math.min(m,t_(l,S,o,I,f)),m===0)return m}else{const T=zf(S,t),E=zf(I,c);Hu(b,m,f,l,o,T[0],E[0]),Hu(b,m,f,l,o,T[0],E[1]),Hu(b,m,f,l,o,T[1],E[0]),Hu(b,m,f,l,o,T[1],E[1])}}return m}function zc(l,t,o,c,f=1/0){let d=f;const m=rs(l,[0,l.length-1]);for(const b of o)if(!(d!==1/0&&Lc(m,rs(b,[0,b.length-1]),c)>=d)&&(d=Math.min(d,qu(l,t,b,!0,c,d)),d===0))return d;return d}function Zu(l,t,o,c,f=1/0){let d=f;const m=rs(l,[0,l.length-1]);for(const b of o){if(d!==1/0&&Lc(m,gh(b),c)>=d)continue;const C=_h(l,t,b,c,d);if(isNaN(C))return C;if((d=Math.min(d,C))===0)return d}return d}function xh(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class dl{constructor(t,o){this.type=pr,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(cl(t[1])){const c=t[1];if(c.type==="FeatureCollection"){for(let f=0;f<c.features.length;++f)if(xh(c.features[f].geometry.type))return new dl(c,c.features[f].geometry)}else if(c.type==="Feature"){if(xh(c.geometry.type))return new dl(c,c.geometry)}else if(xh(c.type))return new dl(c,c)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const o=t.geometry(),c=t.canonicalID();if(o!=null&&c!=null){if(t.geometryType()==="Point")return function(f,d,m){const b=[];for(const k of f)for(const x of k)b.push(ns(x,d));const C=new Dc(b[0][1],"meters");return m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString"?qu(b,!1,m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",C):m.type==="MultiLineString"?zc(b,!1,m.coordinates,C):m.type==="Polygon"||m.type==="MultiPolygon"?Zu(b,!1,m.type==="Polygon"?[m.coordinates]:m.coordinates,C):null}(o,c,this.geometries);if(t.geometryType()==="LineString")return function(f,d,m){const b=[];for(const k of f){const x=[];for(const S of k)x.push(ns(S,d));b.push(x)}const C=new Dc(b[0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return zc(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",b,C);if(m.type==="MultiLineString"){let k=1/0;for(let x=0;x<m.coordinates.length;x++){const S=zc(m.coordinates[x],!0,b,C,k);if(isNaN(S))return S;if((k=Math.min(k,S))===0)return k}return k}if(m.type==="Polygon"||m.type==="MultiPolygon"){let k=1/0;for(let x=0;x<b.length;x++){const S=Zu(b[x],!0,m.type==="Polygon"?[m.coordinates]:m.coordinates,C,k);if(isNaN(S))return S;if((k=Math.min(k,S))===0)return k}return k}return null}(o,c,this.geometries);if(t.geometryType()==="Polygon")return function(f,d,m){const b=[];for(const k of function(x,S){const I=x.length;if(I<=1)return[x];const T=[];let E,A;for(let z=0;z<I;z++){const B=z1(x[z]);B!==0&&(x[z].area=Math.abs(B),A===void 0&&(A=B<0),A===B<0?(E&&T.push(E),E=[x[z]]):E.push(x[z]))}return E&&T.push(E),T}(f)){const x=[];for(let S=0;S<k.length;++S)x.push(Qy(k[S],d));b.push(x)}const C=new Dc(b[0][0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return Zu(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",b,C);if(m.type==="MultiLineString"){let k=1/0;for(let x=0;x<m.coordinates.length;x++){const S=Zu(m.coordinates[x],!0,b,C,k);if(isNaN(S))return S;if((k=Math.min(k,S))===0)return k}return k}return m.type==="Polygon"||m.type==="MultiPolygon"?function(k,x,S){let I=1/0;for(const T of k)for(const E of x){const A=i_(T,E,S,I);if(isNaN(A))return A;if((I=Math.min(I,A))===0)return I}return I}(m.type==="Polygon"?[m.coordinates]:m.coordinates,b,C):null}(o,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function hl(l,t){switch(l){case"string":return ko(t);case"number":return+t;case"boolean":return!!t;case"color":return An.parse(t);case"formatted":return vo.fromString(ko(t));case"resolvedImage":return Io.fromString(ko(t))}return t}function gn(l,t,o,c){return c!==void 0&&(l=c*Math.round(l/c)),t!==void 0&&l<t&&(l=t),o!==void 0&&l>o&&(l=o),l}class Oc{constructor(t,o,c){this.type=t,this.key=o,this.scope=c}static parse(t,o){let c=o.expectedType;if(c==null&&(c=xn),t.length<2||t.length>3)return o.error("Invalid number of arguments for 'config' expression.");const f=o.parse(t[1],1);if(!(f instanceof As))return o.error("Key name of 'config' expression must be a string literal.");if(t.length>=3){const d=o.parse(t[2],2);return d instanceof As?new Oc(c,ko(f.value),ko(d.value)):o.error("Scope of 'config' expression must be a string literal.")}return new Oc(c,ko(f.value))}evaluate(t){const o=[this.key,this.scope,t.scope].filter(Boolean).join(""),c=t.getConfig(o);if(!c)return null;const{type:f,value:d,values:m,minValue:b,maxValue:C,stepValue:k}=c,x=c.default.evaluate(t);let S=x;if(d){const I=t.scope;t.scope=(I||"").split("").slice(1).join(""),S=d.evaluate(t),t.scope=I}return f&&(S=hl(f,S)),S===void 0||b===void 0&&C===void 0&&k===void 0||(typeof S=="number"?S=gn(S,b,C,k):Array.isArray(S)&&(S=S.map(I=>typeof I=="number"?gn(I,b,C,k):I))),d!==void 0&&S!==void 0&&m&&!m.includes(S)&&(S=x,f&&(S=hl(f,S))),(f&&f!==this.type||S!==void 0&&Li(S)!==this.type)&&(S=hl(this.type.kind,S)),S}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.key),t}}function Yu(l){if(l instanceof Uo&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof ul||l instanceof dl)return!1;let t=!0;return l.eachChild(o=>{t&&!Yu(o)&&(t=!1)}),t}function vh(l){if(l instanceof Uo&&l.name==="feature-state")return!1;let t=!0;return l.eachChild(o=>{t&&!vh(o)&&(t=!1)}),t}function bh(l){if(l instanceof Oc)return new Set([l.key]);let t=new Set;return l.eachChild(o=>{t=new Set([...t,...bh(o)])}),t}function Xu(l,t){if(l instanceof Uo&&t.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild(c=>{o&&!Xu(c,t)&&(o=!1)}),o}class $n{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=t[1];return o.scope.has(c)?new $n(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class jf{constructor(t,o=[],c,f=new ih,d=[],m,b){this.registry=t,this.path=o,this.key=o.map(C=>typeof C=="string"?`['${C}']`:`[${C}]`).join(""),this.scope=f,this.errors=d,this.expectedType=c,this._scope=m,this.options=b}parse(t,o,c,f,d={}){return o||c?this.concat(o,null,c,f)._parse(t,d):this._parse(t,d)}parseObjectValue(t,o,c,f,d,m={}){return this.concat(o,c,f,d)._parse(t,m)}_parse(t,o){function c(f,d,m){return m==="assert"?new Ds(d,[f]):m==="coerce"?new ka(d,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(f){let d=f.parse(t,this);if(!d)return null;if(this.expectedType){const m=this.expectedType,b=d.type;if(m.kind!=="string"&&m.kind!=="number"&&m.kind!=="boolean"&&m.kind!=="object"&&m.kind!=="array"||b.kind!=="value")if(m.kind!=="color"&&m.kind!=="formatted"&&m.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(m,b))return null}else d=c(d,m,o.typeAnnotation||"coerce");else d=c(d,m,o.typeAnnotation||"assert")}if(!(d instanceof As)&&d.type.kind!=="resolvedImage"&&Nf(d)){const m=new qy(this._scope,this.options);try{d=new As(d.type,d.evaluate(m))}catch(b){return this.error(b.message),null}}return d}return ka.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,c,f){let d=typeof t=="number"?this.path.concat(t):this.path;d=typeof o=="string"?d.concat(o):d;const m=f?this.scope.concat(f):this.scope;return new jf(this.registry,d,c||null,m,this.errors,this._scope,this.options)}error(t,...o){const c=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new ta(c,t))}checkSubtype(t,o){const c=Cc(t,o);return c&&this.error(c),c}}var o_=jf;function Nf(l){if(l instanceof $n)return Nf(l.boundExpression);if(l instanceof Uo&&l.name==="error"||l instanceof lh||l instanceof ul||l instanceof dl||l instanceof Oc)return!1;const t=l instanceof ka||l instanceof Ds;let o=!0;return l.eachChild(c=>{o=t?o&&Nf(c):o&&c instanceof As}),!!o&&Yu(l)&&Xu(l,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function wh(l,t){const o=l.length-1;let c,f,d=0,m=o,b=0;for(;d<=m;)if(b=Math.floor((d+m)/2),c=l[b],f=l[b+1],c<=t){if(b===o||t<f)return b;d=b+1}else{if(!(c>t))throw new Yi("Input is not a number.");m=b-1}return 0}class Ku{constructor(t,o,c){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[f,d]of c)this.labels.push(f),this.outputs.push(d)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(t[1],1,pr);if(!c)return null;const f=[];let d=null;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);for(let m=1;m<t.length;m+=2){const b=m===1?-1/0:t[m],C=t[m+1],k=m,x=m+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(f.length&&f[f.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const S=o.parse(C,x,d);if(!S)return null;d=d||S.type,f.push([b,S])}return new Ku(d,c,f)}evaluate(t){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return c[0].evaluate(t);const d=o.length;return f>=o[d-1]?c[d-1].evaluate(t):c[wh(o,f)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}const s_=.95047,a_=1.08883,l_=4/29,Fc=6/29,c_=3*Fc*Fc,F1=Fc*Fc*Fc,B1=Math.PI/180,j1=180/Math.PI;function Vf(l){return l>F1?Math.pow(l,1/3):l/c_+l_}function $f(l){return l>Fc?l*l*l:c_*(l-l_)}function Uf(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Wf(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function u_(l){const t=Wf(l.r),o=Wf(l.g),c=Wf(l.b),f=Vf((.4124564*t+.3575761*o+.1804375*c)/s_),d=Vf((.2126729*t+.7151522*o+.072175*c)/1);return{l:116*d-16,a:500*(f-d),b:200*(d-Vf((.0193339*t+.119192*o+.9503041*c)/a_)),alpha:l.a}}function d_(l){let t=(l.l+16)/116,o=isNaN(l.a)?t:t+l.a/500,c=isNaN(l.b)?t:t-l.b/200;return t=1*$f(t),o=s_*$f(o),c=a_*$f(c),new An(Uf(3.2404542*o-1.5371385*t-.4985314*c),Uf(-.969266*o+1.8760108*t+.041556*c),Uf(.0556434*o-.2040259*t+1.0572252*c),l.alpha)}function N1(l,t,o){const c=t-l;return l+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const Ju={forward:u_,reverse:d_,interpolate:function(l,t,o){return{l:Pr(l.l,t.l,o),a:Pr(l.a,t.a,o),b:Pr(l.b,t.b,o),alpha:Pr(l.alpha,t.alpha,o)}}},Qu={forward:function(l){const{l:t,a:o,b:c}=u_(l),f=Math.atan2(c,o)*j1;return{h:f<0?f+360:f,c:Math.sqrt(o*o+c*c),l:t,alpha:l.a}},reverse:function(l){const t=l.h*B1,o=l.c;return d_({l:l.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:l.alpha})},interpolate:function(l,t,o){return{h:N1(l.h,t.h,o),c:Pr(l.c,t.c,o),l:Pr(l.l,t.l,o),alpha:Pr(l.alpha,t.alpha,o)}}};var h_=Object.freeze({__proto__:null,hcl:Qu,lab:Ju});class is{constructor(t,o,c,f,d){this.type=t,this.operator=o,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[m,b]of d)this.labels.push(m),this.outputs.push(b)}static interpolationFactor(t,o,c,f){let d=0;if(t.name==="exponential")d=Gf(o,t.base,c,f);else if(t.name==="linear")d=Gf(o,1,c,f);else if(t.name==="cubic-bezier"){const m=t.controlPoints;d=new xt(m[0],m[1],m[2],m[3]).solve(Gf(o,1,c,f))}return d}static parse(t,o){let[c,f,d,...m]=t;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const k=f[1];if(typeof k!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:k}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const k=f.slice(1);if(k.length!==4||k.some(x=>typeof x!="number"||x<0||x>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:k}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(d=o.parse(d,2,pr),!d)return null;const b=[];let C=null;c==="interpolate-hcl"||c==="interpolate-lab"?C=$o:o.expectedType&&o.expectedType.kind!=="value"&&(C=o.expectedType);for(let k=0;k<m.length;k+=2){const x=m[k],S=m[k+1],I=k+3,T=k+4;if(typeof x!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(b.length&&b[b.length-1][0]>=x)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',I);const E=o.parse(S,T,C);if(!E)return null;C=C||E.type,b.push([x,E])}return C.kind==="number"||C.kind==="color"||C.kind==="array"&&C.itemType.kind==="number"&&typeof C.N=="number"?new is(C,c,f,d,b):o.error(`Type ${wi(C)} is not interpolatable.`)}evaluate(t){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return c[0].evaluate(t);const d=o.length;if(f>=o[d-1])return c[d-1].evaluate(t);const m=wh(o,f),b=is.interpolationFactor(this.interpolation,f,o[m],o[m+1]),C=c[m].evaluate(t),k=c[m+1].evaluate(t);return this.operator==="interpolate"?$l[this.type.kind.toLowerCase()](C,k,b):this.operator==="interpolate-hcl"?Qu.reverse(Qu.interpolate(Qu.forward(C),Qu.forward(k),b)):Ju.reverse(Ju.interpolate(Ju.forward(C),Ju.forward(k),b))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function Gf(l,t,o,c){const f=c-o,d=l-o;return f===0?0:t===1?d/f:(Math.pow(t,d)-1)/(Math.pow(t,f)-1)}class Sh{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let c=null;const f=o.expectedType;f&&f.kind!=="value"&&(c=f);const d=[];for(const b of t.slice(1)){const C=o.parse(b,1+d.length,c,void 0,{typeAnnotation:"omit"});if(!C)return null;c=c||C.type,d.push(C)}const m=f&&d.some(b=>Cc(f,b.type));return new Sh(m?xn:c,d)}evaluate(t){let o,c=null,f=0;for(const d of this.args){if(f++,c=d.evaluate(t),c&&c instanceof Io&&!c.available&&(o||(o=c),c=null,f===this.args.length))return o;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class Th{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let d=1;d<t.length-1;d+=2){const m=t[d];if(typeof m!="string")return o.error(`Expected string, but found ${typeof m} instead.`,d);if(/[^a-zA-Z0-9_]/.test(m))return o.error("Variable names must contain only alphanumeric characters or '_'.",d);const b=o.parse(t[d+1],d+1);if(!b)return null;c.push([m,b])}const f=o.parse(t[t.length-1],t.length-1,o.expectedType,c);return f?new Th(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,c]of this.bindings)t.push(o,c.serialize());return t.push(this.result.serialize()),t}}class Hf{constructor(t,o,c){this.type=t,this.index=o,this.input=c}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,pr),f=o.parse(t[2],2,Eo(o.expectedType||xn));return c&&f?new Hf(f.type.itemType,c,f):null}evaluate(t){const o=this.index.evaluate(t),c=this.input.evaluate(t);if(o<0)throw new Yi(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new Yi(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new Yi(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class qf{constructor(t,o){this.type=mn,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,xn),f=o.parse(t[2],2,xn);return c&&f?Mc(c.type,[mn,fn,pr,Ps,xn])?new qf(c,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(c.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!ra(o,["boolean","string","number","null"]))throw new Yi(`Expected first argument to be of type boolean, string, number or null, but found ${wi(Li(o))} instead.`);if(!ra(c,["string","array"]))throw new Yi(`Expected second argument to be of type array or string, but found ${wi(Li(c))} instead.`);return c.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ch{constructor(t,o,c){this.type=pr,this.needle=t,this.haystack=o,this.fromIndex=c}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,xn),f=o.parse(t[2],2,xn);if(!c||!f)return null;if(!Mc(c.type,[mn,fn,pr,Ps,xn]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(c.type)} instead`);if(t.length===4){const d=o.parse(t[3],3,pr);return d?new Ch(c,f,d):null}return new Ch(c,f)}evaluate(t){const o=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!ra(o,["boolean","string","number","null"]))throw new Yi(`Expected first argument to be of type boolean, string, number or null, but found ${wi(Li(o))} instead.`);if(!ra(c,["string","array"]))throw new Yi(`Expected second argument to be of type array or string, but found ${wi(Li(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return c.indexOf(o,f)}return c.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Zf{constructor(t,o,c,f,d,m){this.inputType=t,this.type=o,this.input=c,this.cases=f,this.outputs=d,this.otherwise=m}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let c,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const d={},m=[];for(let k=2;k<t.length-1;k+=2){let x=t[k];const S=t[k+1];Array.isArray(x)||(x=[x]);const I=o.concat(k);if(x.length===0)return I.error("Expected at least one branch label.");for(const E of x){if(typeof E!="number"&&typeof E!="string")return I.error("Branch labels must be numbers or strings.");if(typeof E=="number"&&Math.abs(E)>Number.MAX_SAFE_INTEGER)return I.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof E=="number"&&Math.floor(E)!==E)return I.error("Numeric branch labels must be integer values.");if(c){if(I.checkSubtype(c,Li(E)))return null}else c=Li(E);if(d[String(E)]!==void 0)return I.error("Branch labels must be unique.");d[String(E)]=m.length}const T=o.parse(S,k,f);if(!T)return null;f=f||T.type,m.push(T)}const b=o.parse(t[1],1,xn);if(!b)return null;const C=o.parse(t[t.length-1],t.length-1,f);return C?b.type.kind!=="value"&&o.concat(1).checkSubtype(c,b.type)?null:new Zf(c,f,b,d,m,C):null}evaluate(t){const o=this.input.evaluate(t);return(Li(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],f={};for(const m of o){const b=f[this.cases[m]];b===void 0?(f[this.cases[m]]=c.length,c.push([this.cases[m],[m]])):c[b][1].push(m)}const d=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,b]of c)t.push(b.length===1?d(b[0]):b.map(d)),t.push(this.outputs[m].serialize());return t.push(this.otherwise.serialize()),t}}class ed{constructor(t,o,c){this.type=t,this.branches=o,this.otherwise=c}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const f=[];for(let m=1;m<t.length-1;m+=2){const b=o.parse(t[m],m,mn);if(!b)return null;const C=o.parse(t[m+1],m+1,c);if(!C)return null;f.push([b,C]),c=c||C.type}const d=o.parse(t[t.length-1],t.length-1,c);return d?new ed(c,f,d):null}evaluate(t){for(const[o,c]of this.branches)if(o.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,c]of this.branches)t(o),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class Mh{constructor(t,o,c,f){this.type=t,this.input=o,this.beginIndex=c,this.endIndex=f}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,xn),f=o.parse(t[2],2,pr);if(!c||!f)return null;if(!Mc(c.type,[Eo(xn),fn,xn]))return o.error(`Expected first argument to be of type array or string, but found ${wi(c.type)} instead`);if(t.length===4){const d=o.parse(t[3],3,pr);return d?new Mh(c.type,c,f,d):null}return new Mh(c.type,c,f)}evaluate(t){const o=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!ra(o,["string","array"]))throw new Yi(`Expected first argument to be of type array or string, but found ${wi(Li(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return o.slice(c,f)}return o.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Yf(l,t){return l==="=="||l==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function p_(l,t,o,c){return c.compare(t,o)===0}function Bc(l,t,o){const c=l!=="=="&&l!=="!=";return class Hz{constructor(d,m,b){this.type=mn,this.lhs=d,this.rhs=m,this.collator=b,this.hasUntypedArgument=d.type.kind==="value"||m.type.kind==="value"}static parse(d,m){if(d.length!==3&&d.length!==4)return m.error("Expected two or three arguments.");const b=d[0];let C=m.parse(d[1],1,xn);if(!C)return null;if(!Yf(b,C.type))return m.concat(1).error(`"${b}" comparisons are not supported for type '${wi(C.type)}'.`);let k=m.parse(d[2],2,xn);if(!k)return null;if(!Yf(b,k.type))return m.concat(2).error(`"${b}" comparisons are not supported for type '${wi(k.type)}'.`);if(C.type.kind!==k.type.kind&&C.type.kind!=="value"&&k.type.kind!=="value")return m.error(`Cannot compare types '${wi(C.type)}' and '${wi(k.type)}'.`);c&&(C.type.kind==="value"&&k.type.kind!=="value"?C=new Ds(k.type,[C]):C.type.kind!=="value"&&k.type.kind==="value"&&(k=new Ds(C.type,[k])));let x=null;if(d.length===4){if(C.type.kind!=="string"&&k.type.kind!=="string"&&C.type.kind!=="value"&&k.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(x=m.parse(d[3],3,oh),!x)return null}return new Hz(C,k,x)}evaluate(d){const m=this.lhs.evaluate(d),b=this.rhs.evaluate(d);if(c&&this.hasUntypedArgument){const C=Li(m),k=Li(b);if(C.kind!==k.kind||C.kind!=="string"&&C.kind!=="number")throw new Yi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${C.kind}, ${k.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const C=Li(m),k=Li(b);if(C.kind!=="string"||k.kind!=="string")return t(d,m,b)}return this.collator?o(d,m,b,this.collator.evaluate(d)):t(d,m,b)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[l];return this.eachChild(m=>{d.push(m.serialize())}),d}}}const V1=Bc("==",function(l,t,o){return t===o},p_),f_=Bc("!=",function(l,t,o){return t!==o},function(l,t,o,c){return!p_(0,t,o,c)}),m_=Bc("<",function(l,t,o){return t<o},function(l,t,o,c){return c.compare(t,o)<0}),jc=Bc(">",function(l,t,o){return t>o},function(l,t,o,c){return c.compare(t,o)>0}),g_=Bc("<=",function(l,t,o){return t<=o},function(l,t,o,c){return c.compare(t,o)<=0}),y_=Bc(">=",function(l,t,o){return t>=o},function(l,t,o,c){return c.compare(t,o)>=0});class Xf{constructor(t,o,c,f,d,m){this.type=fn,this.number=t,this.locale=o,this.currency=c,this.unit=f,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const c=o.parse(t[1],1,pr);if(!c)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let d=null;if(f.locale&&(d=o.parseObjectValue(f.locale,2,"locale",fn),!d))return null;let m=null;if(f.currency&&(m=o.parseObjectValue(f.currency,2,"currency",fn),!m))return null;let b=null;if(f.unit&&(b=o.parseObjectValue(f.unit,2,"unit",fn),!b))return null;let C=null;if(f["min-fraction-digits"]&&(C=o.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",pr),!C))return null;let k=null;return f["max-fraction-digits"]&&(k=o.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",pr),!k)?null:new Xf(c,d,m,b,C,k)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class td{constructor(t){this.type=pr,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=o.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${wi(c.type)} instead.`):new td(c):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Yi(`Expected value to be of type string or array, but found ${wi(Li(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(o=>{t.push(o.serialize())}),t}}function Eh(l){return function(){l=1831565813+(l|=0)|0;let t=Math.imul(l^l>>>15,1|l);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Nc={"==":V1,"!=":f_,">":jc,"<":m_,">=":y_,"<=":g_,array:Ds,at:Hf,boolean:Ds,case:ed,coalesce:Sh,collator:lh,format:Ec,image:Ul,in:qf,"index-of":Ch,interpolate:is,"interpolate-hcl":is,"interpolate-lab":is,length:td,let:Th,literal:As,match:Zf,number:Ds,"number-format":Xf,object:Ds,slice:Mh,step:Ku,string:Ds,"to-boolean":ka,"to-color":ka,"to-number":ka,"to-string":ka,var:$n,within:ul,distance:dl,config:Oc};function __(l,[t,o,c,f]){t=t.evaluate(l),o=o.evaluate(l),c=c.evaluate(l);const d=f?f.evaluate(l):1,m=Hy(t,o,c,d);if(m)throw new Yi(m);return new An(t/255*d,o/255*d,c/255*d,d)}function Kf(l,[t,o,c,f]){t=t.evaluate(l),o=o.evaluate(l),c=c.evaluate(l);const d=f?f.evaluate(l):1,m=function(k,x,S,I){return typeof k=="number"&&k>=0&&k<=360?typeof x=="number"&&x>=0&&x<=100&&typeof S=="number"&&S>=0&&S<=100?I===void 0||typeof I=="number"&&I>=0&&I<=1?null:`Invalid hsla value [${[k,x,S,I].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof I=="number"?[k,x,S,I]:[k,x,S]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof I=="number"?[k,x,S,I]:[k,x,S]).join(", ")}]: 'h' must be between 0 and 360.`}(t,o,c,d);if(m)throw new Yi(m);const b=`hsla(${t}, ${o}%, ${c}%, ${d})`,C=An.parse(b);if(!C)throw new Yi(`Failed to parse HSLA color: ${b}`);return C}function Jf(l,t){return l in t}function Qf(l,t){const o=t[l];return o===void 0?null:o}function ql(l){return{type:l}}function x_(l){return{result:"success",value:l}}function pl(l){return{result:"error",value:l}}function em(l,t){return!!l&&!!l.parameters&&l.parameters.indexOf(t)>-1}function Ih(l){return l["property-type"]==="data-driven"}function tm(l){return em(l.expression,"measure-light")}function v_(l){return em(l.expression,"zoom")}function rm(l){return!!l.expression&&l.expression.interpolated}function kh(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function b_(l){return l}function w_(l,t){const o=t.type==="color",c=l.stops&&typeof l.stops[0][0]=="object",f=c||!(c||l.property!==void 0),d=l.type||(rm(t)?"exponential":"interval");if(o&&((l=wc({},l)).stops&&(l.stops=l.stops.map(k=>[k[0],An.parse(k[1])])),l.default=An.parse(l.default?l.default:t.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!h_[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let m,b,C;if(d==="exponential")m=T_;else if(d==="interval")m=S_;else if(d==="categorical"){m=$1,b=Object.create(null);for(const k of l.stops)b[k[0]]=k[1];C=typeof l.stops[0][0]}else{if(d!=="identity")throw new Error(`Unknown function type "${d}"`);m=U1}if(c){const k={},x=[];for(let T=0;T<l.stops.length;T++){const E=l.stops[T],A=E[0].zoom;k[A]===void 0&&(k[A]={zoom:A,type:l.type,property:l.property,default:l.default,stops:[]},x.push(A)),k[A].stops.push([E[0].value,E[1]])}const S=[];for(const T of x)S.push([k[T].zoom,w_(k[T],t)]);const I={name:"linear"};return{kind:"composite",interpolationType:I,interpolationFactor:is.interpolationFactor.bind(void 0,I),zoomStops:S.map(T=>T[0]),evaluate:({zoom:T},E)=>T_({stops:S,base:l.base},t,T).evaluate(T,E)}}if(f){const k=d==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:is.interpolationFactor.bind(void 0,k),zoomStops:l.stops.map(x=>x[0]),evaluate:({zoom:x})=>m(l,t,x,b,C)}}return{kind:"source",evaluate(k,x){const S=x&&x.properties?x.properties[l.property]:void 0;return S===void 0?rd(l.default,t.default):m(l,t,S,b,C)}}}function rd(l,t,o){return l!==void 0?l:t!==void 0?t:o!==void 0?o:void 0}function $1(l,t,o,c,f){return rd(typeof o===f?c[o]:void 0,l.default,t.default)}function S_(l,t,o){if(Wl(o)!=="number")return rd(l.default,t.default);const c=l.stops.length;if(c===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[c-1][0])return l.stops[c-1][1];const f=wh(l.stops.map(d=>d[0]),o);return l.stops[f][1]}function T_(l,t,o){const c=l.base!==void 0?l.base:1;if(Wl(o)!=="number")return rd(l.default,t.default);const f=l.stops.length;if(f===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[f-1][0])return l.stops[f-1][1];const d=wh(l.stops.map(x=>x[0]),o),m=function(x,S,I,T){const E=T-I,A=x-I;return E===0?0:S===1?A/E:(Math.pow(S,A)-1)/(Math.pow(S,E)-1)}(o,c,l.stops[d][0],l.stops[d+1][0]),b=l.stops[d][1],C=l.stops[d+1][1];let k=$l[t.type]||b_;if(l.colorSpace&&l.colorSpace!=="rgb"){const x=h_[l.colorSpace];k=(S,I)=>x.reverse(x.interpolate(x.forward(S),x.forward(I),m))}return typeof b.evaluate=="function"?{evaluate(...x){const S=b.evaluate.apply(void 0,x),I=C.evaluate.apply(void 0,x);if(S!==void 0&&I!==void 0)return k(S,I,m)}}:k(b,C,m)}function U1(l,t,o){return t.type==="color"?o=An.parse(o):t.type==="formatted"?o=vo.fromString(o.toString()):t.type==="resolvedImage"?o=Io.fromString(o.toString()):Wl(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),rd(o,l.default,t.default)}Uo.register(Nc,{error:[{kind:"error"},[fn],(l,[t])=>{throw new Yi(t.evaluate(l))}],typeof:[fn,[xn],(l,[t])=>wi(Li(t.evaluate(l)))],"to-rgba":[Eo(pr,4),[$o],(l,[t])=>t.evaluate(l).toRenderColor(null).toArray()],rgb:[$o,[pr,pr,pr],__],rgba:[$o,[pr,pr,pr,pr],__],hsl:[$o,[pr,pr,pr],Kf],hsla:[$o,[pr,pr,pr,pr],Kf],has:{type:mn,overloads:[[[fn],(l,[t])=>Jf(t.evaluate(l),l.properties())],[[fn,xo],(l,[t,o])=>Jf(t.evaluate(l),o.evaluate(l))]]},get:{type:xn,overloads:[[[fn],(l,[t])=>Qf(t.evaluate(l),l.properties())],[[fn,xo],(l,[t,o])=>Qf(t.evaluate(l),o.evaluate(l))]]},"feature-state":[xn,[fn],(l,[t])=>Qf(t.evaluate(l),l.featureState||{})],properties:[xo,[],l=>l.properties()],"geometry-type":[fn,[],l=>l.geometryType()],id:[xn,[],l=>l.id()],zoom:[pr,[],l=>l.globals.zoom],pitch:[pr,[],l=>l.globals.pitch||0],"distance-from-center":[pr,[],l=>l.distanceFromCenter()],"measure-light":[pr,[fn],(l,[t])=>l.measureLight(t.evaluate(l))],"heatmap-density":[pr,[],l=>l.globals.heatmapDensity||0],"line-progress":[pr,[],l=>l.globals.lineProgress||0],"raster-value":[pr,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[pr,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[pr,[],l=>l.globals.skyRadialProgress||0],accumulated:[xn,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[pr,ql(pr),(l,t)=>{let o=0;for(const c of t)o+=c.evaluate(l);return o}],"*":[pr,ql(pr),(l,t)=>{let o=1;for(const c of t)o*=c.evaluate(l);return o}],"-":{type:pr,overloads:[[[pr,pr],(l,[t,o])=>t.evaluate(l)-o.evaluate(l)],[[pr],(l,[t])=>-t.evaluate(l)]]},"/":[pr,[pr,pr],(l,[t,o])=>t.evaluate(l)/o.evaluate(l)],"%":[pr,[pr,pr],(l,[t,o])=>t.evaluate(l)%o.evaluate(l)],ln2:[pr,[],()=>Math.LN2],pi:[pr,[],()=>Math.PI],e:[pr,[],()=>Math.E],"^":[pr,[pr,pr],(l,[t,o])=>Math.pow(t.evaluate(l),o.evaluate(l))],sqrt:[pr,[pr],(l,[t])=>Math.sqrt(t.evaluate(l))],log10:[pr,[pr],(l,[t])=>Math.log(t.evaluate(l))/Math.LN10],ln:[pr,[pr],(l,[t])=>Math.log(t.evaluate(l))],log2:[pr,[pr],(l,[t])=>Math.log(t.evaluate(l))/Math.LN2],sin:[pr,[pr],(l,[t])=>Math.sin(t.evaluate(l))],cos:[pr,[pr],(l,[t])=>Math.cos(t.evaluate(l))],tan:[pr,[pr],(l,[t])=>Math.tan(t.evaluate(l))],asin:[pr,[pr],(l,[t])=>Math.asin(t.evaluate(l))],acos:[pr,[pr],(l,[t])=>Math.acos(t.evaluate(l))],atan:[pr,[pr],(l,[t])=>Math.atan(t.evaluate(l))],min:[pr,ql(pr),(l,t)=>Math.min(...t.map(o=>o.evaluate(l)))],max:[pr,ql(pr),(l,t)=>Math.max(...t.map(o=>o.evaluate(l)))],abs:[pr,[pr],(l,[t])=>Math.abs(t.evaluate(l))],round:[pr,[pr],(l,[t])=>{const o=t.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[pr,[pr],(l,[t])=>Math.floor(t.evaluate(l))],ceil:[pr,[pr],(l,[t])=>Math.ceil(t.evaluate(l))],"filter-==":[mn,[fn,xn],(l,[t,o])=>l.properties()[t.value]===o.value],"filter-id-==":[mn,[xn],(l,[t])=>l.id()===t.value],"filter-type-==":[mn,[fn],(l,[t])=>l.geometryType()===t.value],"filter-<":[mn,[fn,xn],(l,[t,o])=>{const c=l.properties()[t.value],f=o.value;return typeof c==typeof f&&c<f}],"filter-id-<":[mn,[xn],(l,[t])=>{const o=l.id(),c=t.value;return typeof o==typeof c&&o<c}],"filter->":[mn,[fn,xn],(l,[t,o])=>{const c=l.properties()[t.value],f=o.value;return typeof c==typeof f&&c>f}],"filter-id->":[mn,[xn],(l,[t])=>{const o=l.id(),c=t.value;return typeof o==typeof c&&o>c}],"filter-<=":[mn,[fn,xn],(l,[t,o])=>{const c=l.properties()[t.value],f=o.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[mn,[xn],(l,[t])=>{const o=l.id(),c=t.value;return typeof o==typeof c&&o<=c}],"filter->=":[mn,[fn,xn],(l,[t,o])=>{const c=l.properties()[t.value],f=o.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[mn,[xn],(l,[t])=>{const o=l.id(),c=t.value;return typeof o==typeof c&&o>=c}],"filter-has":[mn,[xn],(l,[t])=>t.value in l.properties()],"filter-has-id":[mn,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[mn,[Eo(fn)],(l,[t])=>t.value.indexOf(l.geometryType())>=0],"filter-id-in":[mn,[Eo(xn)],(l,[t])=>t.value.indexOf(l.id())>=0],"filter-in-small":[mn,[fn,Eo(xn)],(l,[t,o])=>o.value.indexOf(l.properties()[t.value])>=0],"filter-in-large":[mn,[fn,Eo(xn)],(l,[t,o])=>function(c,f,d,m){for(;d<=m;){const b=d+m>>1;if(f[b]===c)return!0;f[b]>c?m=b-1:d=b+1}return!1}(l.properties()[t.value],o.value,0,o.value.length-1)],all:{type:mn,overloads:[[[mn,mn],(l,[t,o])=>t.evaluate(l)&&o.evaluate(l)],[ql(mn),(l,t)=>{for(const o of t)if(!o.evaluate(l))return!1;return!0}]]},any:{type:mn,overloads:[[[mn,mn],(l,[t,o])=>t.evaluate(l)||o.evaluate(l)],[ql(mn),(l,t)=>{for(const o of t)if(o.evaluate(l))return!0;return!1}]]},"!":[mn,[mn],(l,[t])=>!t.evaluate(l)],"is-supported-script":[mn,[fn],(l,[t])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(t.evaluate(l))}],upcase:[fn,[fn],(l,[t])=>t.evaluate(l).toUpperCase()],downcase:[fn,[fn],(l,[t])=>t.evaluate(l).toLowerCase()],concat:[fn,ql(xn),(l,t)=>t.map(o=>ko(o.evaluate(l))).join("")],"resolved-locale":[fn,[oh],(l,[t])=>t.evaluate(l).resolvedLocale()],random:[pr,[pr,pr,xn],(l,t)=>{const[o,c,f]=t.map(m=>m.evaluate(l));if(o>c||o===c)return o;let d;if(typeof f=="string")d=function(m){let b=0;if(m.length===0)return b;for(let C=0;C<m.length;C++)b=(b<<5)-b+m.charCodeAt(C),b|=0;return b}(f);else{if(typeof f!="number")throw new Yi(`Invalid seed input: ${f}`);d=f}return o+Eh(d)()*(c-o)}]});class Ph{constructor(t,o,c,f){this.expression=t,this._warningHistory={},this._evaluator=new qy(c,f),this._defaultValue=o?function(d){return d.type==="color"&&(kh(d.default)||Array.isArray(d.default))?new An(0,0,0,0):d.type==="color"?An.parse(d.default)||null:d.default===void 0?null:d.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,c,f,d,m,b,C){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(t,o,c,f,d,m,b,C){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=C||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Yi(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${k.message}`)),this._defaultValue}}}function Ah(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Nc}function nd(l,t,o,c){const f=new o_(Nc,[],t?function(m){const b={color:$o,string:fn,number:pr,enum:fn,boolean:mn,formatted:Sc,resolvedImage:Tc};return m.type==="array"?Eo(b[m.value]||xn,m.length):b[m.type]}(t):void 0,void 0,void 0,o,c),d=f.parse(l,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?x_(new Ph(d,t,o,c)):pl(f.errors)}class nm{constructor(t,o,c){this.kind=t,this._styleExpression=o,this.isLightConstant=c,this.isStateDependent=t!=="constant"&&!vh(o.expression),this.configDependencies=bh(o.expression)}evaluateWithoutErrorHandling(t,o,c,f,d,m){return this._styleExpression.evaluateWithoutErrorHandling(t,o,c,f,d,m)}evaluate(t,o,c,f,d,m){return this._styleExpression.evaluate(t,o,c,f,d,m)}}class na{constructor(t,o,c,f,d){this.kind=t,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!vh(o.expression),this.isLightConstant=d,this.configDependencies=bh(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,o,c,f,d,m){return this._styleExpression.evaluateWithoutErrorHandling(t,o,c,f,d,m)}evaluate(t,o,c,f,d,m){return this._styleExpression.evaluate(t,o,c,f,d,m)}interpolationFactor(t,o,c){return this.interpolationType?is.interpolationFactor(this.interpolationType,t,o,c):0}}function C_(l,t,o,c){if((l=nd(l,t,o,c)).result==="error")return l;const f=l.value.expression,d=Yu(f);if(!d&&!Ih(t))return pl([new ta("","data expressions not supported")]);const m=Xu(f,["zoom","pitch","distance-from-center"]);if(!m&&!v_(t))return pl([new ta("","zoom expressions not supported")]);const b=Xu(f,["measure-light"]);if(!b&&!tm(t))return pl([new ta("","measure-light expression not supported")]);const C=t.expression&&t.expression.relaxZoomRestriction,k=Rh(f);return k||m||C?k instanceof ta?pl([k]):k instanceof is&&!rm(t)?pl([new ta("",'"interpolate" expressions cannot be used with this property')]):x_(k?new na(d?"camera":"composite",l.value,k.labels,k instanceof is?k.interpolation:void 0,b):new nm(d?"constant":"source",l.value,b)):pl([new ta("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Dh{constructor(t,o){this._parameters=t,this._specification=o,wc(this,w_(this._parameters,this._specification))}static deserialize(t){return new Dh(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Rh(l){let t=null;if(l instanceof Th)t=Rh(l.result);else if(l instanceof Sh){for(const o of l.args)if(t=Rh(o),t)break}else(l instanceof Ku||l instanceof is)&&l.input instanceof Uo&&l.input.name==="zoom"&&(t=l);return t instanceof ta||l.eachChild(o=>{const c=Rh(o);c instanceof ta?t=c:t&&c&&t!==c&&(t=new ta("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}var Lh,im,M_=function(){if(im)return Lh;im=1,Lh=t;var l=3;function t(o,c,f){var d=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var m=new Int32Array(this.arrayBuffer);o=m[0],this.d=(c=m[1])+2*(f=m[2]);for(var b=0;b<this.d*this.d;b++){var C=m[l+b],k=m[l+b+1];d.push(C===k?null:m.subarray(C,k))}var x=m[l+d.length+1];this.keys=m.subarray(m[l+d.length],x),this.bboxes=m.subarray(x),this.insert=this._insertReadonly}else{this.d=c+2*f;for(var S=0;S<this.d*this.d;S++)d.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=o,this.padding=f,this.scale=c/o,this.uid=0;var I=f/c*o;this.min=-I,this.max=o+I}return t.prototype.insert=function(o,c,f,d,m){this._forEachCell(c,f,d,m,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(d),this.bboxes.push(m)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(o,c,f,d,m,b){this.cells[m].push(b)},t.prototype.query=function(o,c,f,d,m){var b=this.min,C=this.max;if(o<=b&&c<=b&&C<=f&&C<=d&&!m)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(o,c,f,d,this._queryCell,k,{},m),k},t.prototype._queryCell=function(o,c,f,d,m,b,C,k){var x=this.cells[m];if(x!==null)for(var S=this.keys,I=this.bboxes,T=0;T<x.length;T++){var E=x[T];if(C[E]===void 0){var A=4*E;(k?k(I[A+0],I[A+1],I[A+2],I[A+3]):o<=I[A+2]&&c<=I[A+3]&&f>=I[A+0]&&d>=I[A+1])?(C[E]=!0,b.push(S[E])):C[E]=!1}}},t.prototype._forEachCell=function(o,c,f,d,m,b,C,k){for(var x=this._convertToCellCoord(o),S=this._convertToCellCoord(c),I=this._convertToCellCoord(f),T=this._convertToCellCoord(d),E=x;E<=I;E++)for(var A=S;A<=T;A++){var z=this.d*A+E;if((!k||k(this._convertFromCellCoord(E),this._convertFromCellCoord(A),this._convertFromCellCoord(E+1),this._convertFromCellCoord(A+1)))&&m.call(this,o,c,f,d,z,b,C,k))return}},t.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},t.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,c=l+this.cells.length+1+1,f=0,d=0;d<this.cells.length;d++)f+=this.cells[d].length;var m=new Int32Array(c+f+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var b=c,C=0;C<o.length;C++){var k=o[C];m[l+C]=b,m.set(k,b),b+=k.length}return m[l+o.length]=b,m.set(this.keys,b),m[l+o.length+1]=b+=this.keys.length,m.set(this.bboxes,b),b+=this.bboxes.length,m.buffer},Lh}(),Zl=j(M_);const Vc={};function ur(l,t,o={}){Object.defineProperty(l,"_classRegistryKey",{value:t,writable:!1}),Vc[t]={klass:l,omit:o.omit||[]}}ur(Object,"Object"),Zl.serialize=function(l,t){const o=l.toArrayBuffer();return t&&t.add(o),{buffer:o}},Zl.deserialize=function(l){return new Zl(l.buffer)},Object.defineProperty(Zl,"name",{value:"Grid"}),ur(Zl,"Grid"),ur(An,"Color"),ur(Error,"Error"),ur(vo,"Formatted"),ur(es,"FormattedSection"),ur(ju,"AJAXError"),ur(Io,"ResolvedImage"),ur(Dh,"StylePropertyFunction"),ur(Ph,"StyleExpression",{omit:["_evaluator"]}),ur(na,"ZoomDependentExpression"),ur(nm,"ZoomConstantExpression"),ur(Uo,"CompoundExpression",{omit:["_evaluate"]});for(const l in Nc)Vc[Nc[l]._classRegistryKey]||ur(Nc[l],`Expression${l}`);function om(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function E_(l){return self.ImageBitmap&&l instanceof ImageBitmap}function Wo(l,t){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(om(l)||E_(l))return t&&t.add(l),l;if(ArrayBuffer.isView(l)){const o=l;return t&&t.add(o.buffer),o}if(l instanceof ImageData)return t&&t.add(l.data.buffer),l;if(Array.isArray(l)){const o=[];for(const c of l)o.push(Wo(c,t));return o}if(l instanceof Map){const o={$name:"Map"};for(const[c,f]of l.entries())o[c]=Wo(f);return o}if(l instanceof Set){const o={$name:"Set"};let c=0;for(const f of l.values())o[++c]=Wo(f);return o}if(typeof l=="object"){const o=l.constructor,c=o._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=o.serialize?o.serialize(l,t):{};if(!o.serialize){for(const d in l)l.hasOwnProperty(d)&&(Vc[c].omit.indexOf(d)>=0||(f[d]=Wo(l[d],t)));l instanceof Error&&(f.message=l.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof l)}function Yl(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||om(l)||E_(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(Yl);if(typeof l=="object"){const t=l.$name||"Object";if(t==="Map"){const f=new Map;for(const d of Object.keys(l))d!=="$name"&&f.set(d,Yl(l[d]));return f}if(t==="Set"){const f=new Set;for(const d of Object.keys(l))d!=="$name"&&f.add(Yl(l[d]));return f}const{klass:o}=Vc[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(l);const c=Object.create(o.prototype);for(const f of Object.keys(l))f!=="$name"&&(c[f]=Yl(l[f]));return c}throw new Error("can't deserialize object of type "+typeof l)}const yr={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function zh(l){for(const t of l)if(Fh(t.charCodeAt(0)))return!0;return!1}function W1(l){for(const t of l)if(!Oh(t.charCodeAt(0)))return!1;return!0}function Oh(l){return!(yr.Arabic(l)||yr["Arabic Supplement"](l)||yr["Arabic Extended-A"](l)||yr["Arabic Presentation Forms-A"](l)||yr["Arabic Presentation Forms-B"](l))}function Fh(l){return!(l!==746&&l!==747&&(l<4352||!(yr["Bopomofo Extended"](l)||yr.Bopomofo(l)||yr["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||yr["CJK Compatibility Ideographs"](l)||yr["CJK Compatibility"](l)||yr["CJK Radicals Supplement"](l)||yr["CJK Strokes"](l)||!(!yr["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||yr["CJK Unified Ideographs Extension A"](l)||yr["CJK Unified Ideographs"](l)||yr["Enclosed CJK Letters and Months"](l)||yr["Hangul Compatibility Jamo"](l)||yr["Hangul Jamo Extended-A"](l)||yr["Hangul Jamo Extended-B"](l)||yr["Hangul Jamo"](l)||yr["Hangul Syllables"](l)||yr.Hiragana(l)||yr["Ideographic Description Characters"](l)||yr.Kanbun(l)||yr["Kangxi Radicals"](l)||yr["Katakana Phonetic Extensions"](l)||yr.Katakana(l)&&l!==12540||!(!yr["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!yr["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||yr["Unified Canadian Aboriginal Syllabics"](l)||yr["Unified Canadian Aboriginal Syllabics Extended"](l)||yr["Vertical Forms"](l)||yr["Yijing Hexagram Symbols"](l)||yr["Yi Syllables"](l)||yr["Yi Radicals"](l))))}function id(l){return!(Fh(l)||function(t){return!!(yr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||yr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||yr["Letterlike Symbols"](t)||yr["Number Forms"](t)||yr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||yr["Control Pictures"](t)&&t!==9251||yr["Optical Character Recognition"](t)||yr["Enclosed Alphanumerics"](t)||yr["Geometric Shapes"](t)||yr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||yr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||yr["CJK Symbols and Punctuation"](t)||yr.Katakana(t)||yr["Private Use Area"](t)||yr["CJK Compatibility Forms"](t)||yr["Small Form Variants"](t)||yr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(l))}function sm(l){return l>=1424&&l<=2303||yr["Arabic Presentation Forms-A"](l)||yr["Arabic Presentation Forms-B"](l)}function G1(l,t){return!(!t&&sm(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||yr.Khmer(l))}function H1(l){for(const t of l)if(sm(t.charCodeAt(0)))return!0;return!1}const od="deferred",sd="loading",Bh="loaded";let $c=null,to="unavailable",fl=null;const I_=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(to="error"),$c&&$c(l)};function am(){lm.fire(new ll("pluginStateChange",{pluginStatus:to,pluginURL:fl}))}const lm=new bc,cm=function(){return to},um=function(){if(to!==od||!fl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");to=sd,am(),fl&&al({url:fl},l=>{l?I_(l):(to=Bh,am())})},Go={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>to===Bh||Go.applyArabicShaping!=null,isLoading:()=>to===sd,setState(l){to=l.pluginStatus,fl=l.pluginURL},isParsed:()=>Go.applyArabicShaping!=null&&Go.processBidirectionalText!=null&&Go.processStyledBidirectionalText!=null,getPluginURL:()=>fl};class yi{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(o,c){for(const f of o)if(!G1(f.charCodeAt(0),c))return!1;return!0}(t,Go.isLoaded())}}class jh{constructor(t,o,c,f){this.property=t,this.value=o,this.expression=function(d,m,b,C){if(kh(d))return new Dh(d,m);if(Ah(d)||Array.isArray(d)&&d.length>0){const k=C_(d,m,b,C);if(k.result==="error")throw new Error(k.value.map(x=>`${x.key}: ${x.message}`).join(", "));return k.value}{let k=d;return typeof d=="string"&&m.type==="color"&&(k=An.parse(d)),{kind:"constant",configDependencies:new Set,evaluate:()=>k}}}(o===void 0?t.specification.default:o,t.specification,c,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,c){return this.property.possiblyEvaluate(this,t,o,c)}}class dm{constructor(t,o,c){this.property=t,this.value=new jh(t,void 0,o,c)}transitioned(t,o){return new P_(this.property,this.value,o,Qr({},t.transition,this.transition),t.now)}untransitioned(){return new P_(this.property,this.value,null,{},0)}}class k_{constructor(t,o,c){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=o,this._options=c,this.configDependencies=new Set}getValue(t){return Zr(this._values[t].value.value)}setValue(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new dm(this._values[t].property,this._scope,this._options)),this._values[t].value=new jh(this._values[t].property,o===null?void 0:Zr(o),this._scope,this._options),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]))}setTransitionOrValue(t,o){o&&(this._options=o);const c=this._properties.properties;if(t)for(const f in t){const d=t[f];if(Dr(f,"-transition")){const m=f.slice(0,-11);c[m]&&this.setTransition(m,d)}else c.hasOwnProperty(f)&&this.setValue(f,d)}}getTransition(t){return Zr(this._values[t].transition)}setTransition(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new dm(this._values[t].property)),this._values[t].transition=Zr(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(t[o]=c);const f=this.getTransition(o);f!==void 0&&(t[`${o}-transition`]=f)}return t}transitioned(t,o){const c=new A_(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(t,o._values[f]);return c}untransitioned(){const t=new A_(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class P_{constructor(t,o,c,f,d){const m=f.delay||0,b=f.duration||0;d=d||0,this.property=t,this.value=o,this.begin=d+m,this.end=this.begin+b,t.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(t,o,c){const f=t.now||0,d=this.value.possiblyEvaluate(t,o,c),m=this.prior;if(m){if(f>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(f<this.begin)return m.possiblyEvaluate(t,o,c);{const b=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(t,o,c),d,dn(b))}}return d}}class A_{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,c){const f=new Wc(this._properties);for(const d of Object.keys(this._values))f._values[d]=this._values[d].possiblyEvaluate(t,o,c);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class q1{constructor(t,o,c){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=o,this._options=c,this.configDependencies=new Set}getValue(t){return Zr(this._values[t].value)}setValue(t,o){this._values[t]=new jh(this._values[t].property,o===null?void 0:Zr(o),this._scope,this._options),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]))}serialize(){const t={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(t[o]=c)}return t}possiblyEvaluate(t,o,c){const f=new Wc(this._properties);for(const d of Object.keys(this._values))f._values[d]=this._values[d].possiblyEvaluate(t,o,c);return f}}class Uc{constructor(t,o,c){this.property=t,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,c,f){return this.property.evaluate(this.value,this.parameters,t,o,c,f)}}class Wc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Zt{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,c){const f=$l[this.specification.type];return f?f(t,o,c):t}}class _r{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,c,f){return new Uc(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},c,f)}:t.expression,o)}interpolate(t,o,c){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new Uc(this,{kind:"constant",value:void 0},t.parameters);const f=$l[this.specification.type];return f?new Uc(this,{kind:"constant",value:f(t.value.value,o.value.value,c)},t.parameters):t}evaluate(t,o,c,f,d,m){return t.kind==="constant"?t.value:t.evaluate(o,c,f,d,m)}}class Rs{constructor(t){this.specification=t}possiblyEvaluate(t,o,c,f){return!!t.expression.evaluate(o,null,{},c,f)}interpolate(){return!1}}class ci{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new yi(0,{});for(const c in t){const f=t[c];f.specification.overridable&&this.overridableProperties.push(c);const d=this.defaultPropertyValues[c]=new jh(f,void 0),m=this.defaultTransitionablePropertyValues[c]=new dm(f);this.defaultTransitioningPropertyValues[c]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=d.possiblyEvaluate(o)}}}ur(_r,"DataDrivenProperty"),ur(Zt,"DataConstantProperty"),ur(Rs,"ColorRampProperty");var st=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ad(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Nh(l){if(Array.isArray(l))return l.map(Nh);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const t={};for(const o in l)t[o]=Nh(l[o]);return t}return ad(l)}function hm(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const t of l.slice(1))if(!hm(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Ls(l,t="",o=null,c="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};hm(l)||(l=Vh(l));const f=l;let d=!0;try{d=function(S){if(!Gc(S))return S;let I=Nh(S);return Xl(I),I=pm(I),I}(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}const m=st[`filter_${c}`],b=nd(d,m,t,o);let C=null;if(b.result==="error")throw new Error(b.value.map(S=>`${S.key}: ${S.message}`).join(", "));C=(S,I,T)=>b.value.evaluate(S,I,{},T);let k=null,x=null;if(d!==f){const S=nd(f,m,t,o);if(S.result==="error")throw new Error(S.value.map(I=>`${I.key}: ${I.message}`).join(", "));k=(I,T,E,A,z)=>S.value.evaluate(I,T,{},E,void 0,void 0,A,z),x=!Yu(S.value.expression)}return{filter:C,dynamicFilter:k||void 0,needGeometry:D_(d),needFeature:!!x}}function pm(l){if(!Array.isArray(l))return l;const t=function(o){if(Z1.has(o[0])){for(let c=1;c<o.length;c++)if(Gc(o[c]))return!0}return o}(l);return t===!0?t:t.map(o=>pm(o))}function Xl(l){let t=!1;const o=[];if(l[0]==="case"){for(let c=1;c<l.length-1;c+=2)t=t||Gc(l[c]),o.push(l[c+1]);o.push(l[l.length-1])}else if(l[0]==="match"){t=t||Gc(l[1]);for(let c=2;c<l.length-1;c+=2)o.push(l[c+1]);o.push(l[l.length-1])}else if(l[0]==="step"){t=t||Gc(l[1]);for(let c=1;c<l.length-1;c+=2)o.push(l[c+1])}t&&(l.length=0,l.push("any",...o));for(let c=1;c<l.length;c++)Xl(l[c])}function Gc(l){if(!Array.isArray(l))return!1;if((t=l[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let o=1;o<l.length;o++)if(Gc(l[o]))return!0;return!1}const Z1=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Y1(l,t){return l<t?-1:l>t?1:0}function D_(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let t=1;t<l.length;t++)if(D_(l[t]))return!0;return!1}function Vh(l){if(!l)return!0;const t=l[0];return l.length<=1?t!=="any":t==="=="?$h(l[1],l[2],"=="):t==="!="?cd($h(l[1],l[2],"==")):t==="<"||t===">"||t==="<="||t===">="?$h(l[1],l[2],t):t==="any"?(o=l.slice(1),["any"].concat(o.map(Vh))):t==="all"?["all"].concat(l.slice(1).map(Vh)):t==="none"?["all"].concat(l.slice(1).map(Vh).map(cd)):t==="in"?Uh(l[1],l.slice(2)):t==="!in"?cd(Uh(l[1],l.slice(2))):t==="has"?ld(l[1]):t!=="!has"||cd(ld(l[1]));var o}function $h(l,t,o){switch(l){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,l,t]}}function Uh(l,t){if(t.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",l,["literal",t.sort(Y1)]]:["filter-in-small",l,["literal",t]]}}function ld(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function cd(l){return["!",l]}const Hc="";function R_(l,t){return t?`${l}${Hc}${t}`:l}const zs="-transition",X1=new Set(["fill","line","background","hillshade","raster"]);class bo extends bc{constructor(t,o,c,f,d){if(super(),this.id=t.id,this.fqid=R_(this.id,c),this.type=t.type,this.scope=c,this.lut=f,this.options=d,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),t.slot&&(this.slot=t.slot),o.layout&&(this._unevaluatedLayout=new q1(o.layout,this.scope,d),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint)){this._transitionablePaint=new k_(o.paint,this.scope,d);for(const m in t.paint)this.setPaintProperty(m,t.paint[m]);for(const m in t.layout)this.setLayoutProperty(m,t.layout[m]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wc(o.paint)}}onAdd(t){}onRemove(t){}isDraped(t){return!this.is3D()&&X1.has(this.type)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o){if(this.type==="custom"&&t==="visibility")return void(this.visibility=o);const c=this._unevaluatedLayout;c._properties.properties[t]&&(c.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return Dr(t,zs)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o){const c=this._transitionablePaint,f=c._properties.properties;if(Dr(t,zs)){const S=t.slice(0,-11);return f[S]&&c.setTransition(S,o||void 0),!1}if(!f[t])return!1;const d=c._values[t],m=d.value.isDataDriven(),b=d.value;c.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),this._handleSpecialPaintPropertyUpdate(t);const C=c._values[t].value,k=C.isDataDriven(),x=Dr(t,"pattern")||t==="line-dasharray";return k||m||x||this._handleOverridablePaintPropertyUpdate(t,b,C)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,o,c){return null}_handleOverridablePaintPropertyUpdate(t,o,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){return gr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,o)=>!(t===void 0||o==="layout"&&!Object.keys(t).length||o==="paint"&&!Object.keys(t).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof Uc&&Ih(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(t){this._filterCompiled||(this._featureFilter=Ls(this.filter,this.scope,t),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(t){}queryIntersectsFeature(t,o,c,f,d,m,b,C,k){}queryIntersectsMatchingFeature(t,o,c,f){}}const K1={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ud{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ri{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function bn(l,t=1){let o=0,c=0;return{members:l.map(f=>{const d=K1[f.type].BYTES_PER_ELEMENT,m=o=L_(o,Math.max(t,d)),b=f.components||1;return c=Math.max(c,d),o+=d*b,{name:f.name,type:f.type,components:b,offset:m}}),size:L_(o,Math.max(c,t)),alignment:t}}function L_(l,t){return Math.ceil(l/t)*t}class ml extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const f=2*t;return this.int16[f+0]=o,this.int16[f+1]=c,t}}ml.prototype.bytesPerElement=4,ur(ml,"StructArrayLayout2i4");class Wh extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,c)}emplace(t,o,c,f){const d=3*t;return this.int16[d+0]=o,this.int16[d+1]=c,this.int16[d+2]=f,t}}Wh.prototype.bytesPerElement=6,ur(Wh,"StructArrayLayout3i6");class gl extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c,f)}emplace(t,o,c,f,d){const m=4*t;return this.int16[m+0]=o,this.int16[m+1]=c,this.int16[m+2]=f,this.int16[m+3]=d,t}}gl.prototype.bytesPerElement=8,ur(gl,"StructArrayLayout4i8");class Gh extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,f,d)}emplace(t,o,c,f,d,m){const b=5*t;return this.int16[b+0]=o,this.int16[b+1]=c,this.int16[b+2]=f,this.int16[b+3]=d,this.int16[b+4]=m,t}}Gh.prototype.bytesPerElement=10,ur(Gh,"StructArrayLayout5i10");class fm extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,c,f,d,m,b)}emplace(t,o,c,f,d,m,b,C){const k=6*t,x=12*t,S=3*t;return this.int16[k+0]=o,this.int16[k+1]=c,this.uint8[x+4]=f,this.uint8[x+5]=d,this.uint8[x+6]=m,this.uint8[x+7]=b,this.float32[S+2]=C,t}}fm.prototype.bytesPerElement=12,ur(fm,"StructArrayLayout2i4ub1f12");class Da extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c,f)}emplace(t,o,c,f,d){const m=4*t;return this.float32[m+0]=o,this.float32[m+1]=c,this.float32[m+2]=f,this.float32[m+3]=d,t}}Da.prototype.bytesPerElement=16,ur(Da,"StructArrayLayout4f16");class yl extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,c)}emplace(t,o,c,f){const d=3*t;return this.float32[d+0]=o,this.float32[d+1]=c,this.float32[d+2]=f,t}}yl.prototype.bytesPerElement=12,ur(yl,"StructArrayLayout3f12");class Ra extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,f,d)}emplace(t,o,c,f,d,m){const b=6*t,C=3*t;return this.uint16[b+0]=o,this.uint16[b+1]=c,this.uint16[b+2]=f,this.uint16[b+3]=d,this.float32[C+2]=m,t}}Ra.prototype.bytesPerElement=12,ur(Ra,"StructArrayLayout4ui1f12");class Kl extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c,f)}emplace(t,o,c,f,d){const m=4*t;return this.uint16[m+0]=o,this.uint16[m+1]=c,this.uint16[m+2]=f,this.uint16[m+3]=d,t}}Kl.prototype.bytesPerElement=8,ur(Kl,"StructArrayLayout4ui8");class Hh extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,f,d,m)}emplace(t,o,c,f,d,m,b){const C=6*t;return this.int16[C+0]=o,this.int16[C+1]=c,this.int16[C+2]=f,this.int16[C+3]=d,this.int16[C+4]=m,this.int16[C+5]=b,t}}Hh.prototype.bytesPerElement=12,ur(Hh,"StructArrayLayout6i12");class mm extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b,C,k,x,S,I){const T=this.length;return this.resize(T+1),this.emplace(T,t,o,c,f,d,m,b,C,k,x,S,I)}emplace(t,o,c,f,d,m,b,C,k,x,S,I,T){const E=12*t;return this.int16[E+0]=o,this.int16[E+1]=c,this.int16[E+2]=f,this.int16[E+3]=d,this.uint16[E+4]=m,this.uint16[E+5]=b,this.uint16[E+6]=C,this.uint16[E+7]=k,this.int16[E+8]=x,this.int16[E+9]=S,this.int16[E+10]=I,this.int16[E+11]=T,t}}mm.prototype.bytesPerElement=24,ur(mm,"StructArrayLayout4i4ui4i24");class gm extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,f,d,m)}emplace(t,o,c,f,d,m,b){const C=10*t,k=5*t;return this.int16[C+0]=o,this.int16[C+1]=c,this.int16[C+2]=f,this.float32[k+2]=d,this.float32[k+3]=m,this.float32[k+4]=b,t}}gm.prototype.bytesPerElement=20,ur(gm,"StructArrayLayout3i3f20");class ym extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}ym.prototype.bytesPerElement=4,ur(ym,"StructArrayLayout1ul4");class _l extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const f=2*t;return this.uint16[f+0]=o,this.uint16[f+1]=c,t}}_l.prototype.bytesPerElement=4,ur(_l,"StructArrayLayout2ui4");class qc extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b,C,k,x,S,I,T){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,c,f,d,m,b,C,k,x,S,I,T)}emplace(t,o,c,f,d,m,b,C,k,x,S,I,T,E){const A=20*t,z=10*t;return this.int16[A+0]=o,this.int16[A+1]=c,this.int16[A+2]=f,this.int16[A+3]=d,this.int16[A+4]=m,this.float32[z+3]=b,this.float32[z+4]=C,this.float32[z+5]=k,this.float32[z+6]=x,this.int16[A+14]=S,this.uint32[z+8]=I,this.uint16[A+18]=T,this.uint16[A+19]=E,t}}qc.prototype.bytesPerElement=40,ur(qc,"StructArrayLayout5i4f1i1ul2ui40");class Jl extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,c,f,d,m,b)}emplace(t,o,c,f,d,m,b,C){const k=8*t;return this.int16[k+0]=o,this.int16[k+1]=c,this.int16[k+2]=f,this.int16[k+4]=d,this.int16[k+5]=m,this.int16[k+6]=b,this.int16[k+7]=C,t}}Jl.prototype.bytesPerElement=16,ur(Jl,"StructArrayLayout3i2i2i16");class Po extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,f,d)}emplace(t,o,c,f,d,m){const b=4*t,C=8*t;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=f,this.int16[C+6]=d,this.int16[C+7]=m,t}}Po.prototype.bytesPerElement=16,ur(Po,"StructArrayLayout2f1f2i16");class Zc extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,c,f,d,m)}emplace(t,o,c,f,d,m,b){const C=20*t,k=5*t;return this.uint8[C+0]=o,this.uint8[C+1]=c,this.float32[k+1]=f,this.float32[k+2]=d,this.float32[k+3]=m,this.float32[k+4]=b,t}}Zc.prototype.bytesPerElement=20,ur(Zc,"StructArrayLayout2ub4f20");class so extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,c)}emplace(t,o,c,f){const d=3*t;return this.uint16[d+0]=o,this.uint16[d+1]=c,this.uint16[d+2]=f,t}}so.prototype.bytesPerElement=6,ur(so,"StructArrayLayout3ui6");class _m extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B,U,G,N,Z){const J=this.length;return this.resize(J+1),this.emplace(J,t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B,U,G,N,Z)}emplace(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B,U,G,N,Z,J){const he=30*t,ye=15*t,xe=60*t;return this.int16[he+0]=o,this.int16[he+1]=c,this.int16[he+2]=f,this.float32[ye+2]=d,this.float32[ye+3]=m,this.uint16[he+8]=b,this.uint16[he+9]=C,this.uint32[ye+5]=k,this.uint32[ye+6]=x,this.uint32[ye+7]=S,this.uint16[he+16]=I,this.uint16[he+17]=T,this.uint16[he+18]=E,this.float32[ye+10]=A,this.float32[ye+11]=z,this.uint8[xe+48]=B,this.uint8[xe+49]=U,this.uint8[xe+50]=G,this.uint32[ye+13]=N,this.int16[he+28]=Z,this.uint8[xe+58]=J,t}}_m.prototype.bytesPerElement=60,ur(_m,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class xm extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B,U,G,N,Z,J,he,ye,xe,me,Ae,Te,Oe,We,Ze,Ye){const Je=this.length;return this.resize(Je+1),this.emplace(Je,t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B,U,G,N,Z,J,he,ye,xe,me,Ae,Te,Oe,We,Ze,Ye)}emplace(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B,U,G,N,Z,J,he,ye,xe,me,Ae,Te,Oe,We,Ze,Ye,Je){const at=20*t,Qe=40*t,gt=80*t;return this.float32[at+0]=o,this.float32[at+1]=c,this.int16[Qe+4]=f,this.int16[Qe+5]=d,this.int16[Qe+6]=m,this.int16[Qe+7]=b,this.int16[Qe+8]=C,this.int16[Qe+9]=k,this.int16[Qe+10]=x,this.int16[Qe+11]=S,this.int16[Qe+12]=I,this.uint16[Qe+13]=T,this.uint16[Qe+14]=E,this.uint16[Qe+15]=A,this.uint16[Qe+16]=z,this.uint16[Qe+17]=B,this.uint16[Qe+18]=U,this.uint16[Qe+19]=G,this.uint16[Qe+20]=N,this.uint16[Qe+21]=Z,this.uint16[Qe+22]=J,this.uint16[Qe+23]=he,this.uint16[Qe+24]=ye,this.uint16[Qe+25]=xe,this.uint16[Qe+26]=me,this.uint16[Qe+27]=Ae,this.uint32[at+14]=Te,this.float32[at+15]=Oe,this.float32[at+16]=We,this.float32[at+17]=Ze,this.float32[at+18]=Ye,this.uint8[gt+76]=Je,t}}xm.prototype.bytesPerElement=80,ur(xm,"StructArrayLayout2f9i15ui1ul4f1ub80");class Yc extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}Yc.prototype.bytesPerElement=4,ur(Yc,"StructArrayLayout1f4");class La extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,f,d)}emplace(t,o,c,f,d,m){const b=5*t;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=f,this.float32[b+3]=d,this.float32[b+4]=m,t}}La.prototype.bytesPerElement=20,ur(La,"StructArrayLayout5f20");class vm extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,c,f,d,m,b)}emplace(t,o,c,f,d,m,b,C){const k=7*t;return this.float32[k+0]=o,this.float32[k+1]=c,this.float32[k+2]=f,this.float32[k+3]=d,this.float32[k+4]=m,this.float32[k+5]=b,this.float32[k+6]=C,t}}vm.prototype.bytesPerElement=28,ur(vm,"StructArrayLayout7f28");class dd extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,f){const d=this.length;return this.resize(d+1),this.emplace(d,t,o,c,f)}emplace(t,o,c,f,d){const m=6*t;return this.uint32[3*t+0]=o,this.uint16[m+2]=c,this.uint16[m+3]=f,this.uint16[m+4]=d,t}}dd.prototype.bytesPerElement=12,ur(dd,"StructArrayLayout1ul3ui12");class bm extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}bm.prototype.bytesPerElement=2,ur(bm,"StructArrayLayout1ui2");class hd extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const f=2*t;return this.float32[f+0]=o,this.float32[f+1]=c,t}}hd.prototype.bytesPerElement=8,ur(hd,"StructArrayLayout2f8");class pd extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z){const B=this.length;return this.resize(B+1),this.emplace(B,t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z)}emplace(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B){const U=16*t;return this.float32[U+0]=o,this.float32[U+1]=c,this.float32[U+2]=f,this.float32[U+3]=d,this.float32[U+4]=m,this.float32[U+5]=b,this.float32[U+6]=C,this.float32[U+7]=k,this.float32[U+8]=x,this.float32[U+9]=S,this.float32[U+10]=I,this.float32[U+11]=T,this.float32[U+12]=E,this.float32[U+13]=A,this.float32[U+14]=z,this.float32[U+15]=B,t}}pd.prototype.bytesPerElement=64,ur(pd,"StructArrayLayout16f64");class qh extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,f,d,m,b){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,c,f,d,m,b)}emplace(t,o,c,f,d,m,b,C){const k=10*t,x=5*t;return this.uint16[k+0]=o,this.uint16[k+1]=c,this.uint16[k+2]=f,this.uint16[k+3]=d,this.float32[x+2]=m,this.float32[x+3]=b,this.float32[x+4]=C,t}}qh.prototype.bytesPerElement=20,ur(qh,"StructArrayLayout4ui3f20");class Zh extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.int16[1*t+0]=o,t}}Zh.prototype.bytesPerElement=2,ur(Zh,"StructArrayLayout1i2");class Yh extends ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint8[1*t+0]=o,t}}Yh.prototype.bytesPerElement=1,ur(Yh,"StructArrayLayout1ub1");class z_ extends ud{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}z_.prototype.size=40;class Xh extends qc{get(t){return new z_(this,t)}}ur(Xh,"CollisionBoxArray");class fd extends ud{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}fd.prototype.size=60;class wm extends _m{get(t){return new fd(this,t)}}ur(wm,"PlacedSymbolArray");class O_ extends ud{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}O_.prototype.size=80;class Sm extends xm{get(t){return new O_(this,t)}}ur(Sm,"SymbolInstanceArray");class F_ extends Yc{getoffsetX(t){return this.float32[1*t+0]}}ur(F_,"GlyphOffsetArray");class Kh extends ml{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}ur(Kh,"SymbolLineVertexArray");class B_ extends ud{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}B_.prototype.size=12;class j_ extends dd{get(t){return new B_(this,t)}}ur(j_,"FeatureIndexArray");class N_ extends _l{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}ur(N_,"FillExtrusionCentroidArray");class V_ extends ud{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}V_.prototype.size=6;class Tm extends Wh{get(t){return new V_(this,t)}}ur(Tm,"FillExtrusionWallArray");const J1=bn([{name:"a_pos",components:2,type:"Int16"}],4),Q1=bn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class _i{constructor(t=[]){this.segments=t}_prepareSegment(t,o,c,f){let d=this.segments[this.segments.length-1];return t>_i.MAX_VERTEX_ARRAY_LENGTH&&hr(`Max vertices per segment is ${_i.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!d||d.vertexLength+t>_i.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==f)&&(d={vertexOffset:o,primitiveOffset:c,vertexLength:0,primitiveLength:0},f!==void 0&&(d.sortKey=f),this.segments.push(d)),d}prepareSegment(t,o,c,f){return this._prepareSegment(t,o.length,c.length,f)}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,c,f){return new _i([{vertexOffset:t,primitiveOffset:o,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function $_(l,t){return 256*(l=Xt(Math.floor(l),0,255))+Xt(Math.floor(t),0,255)}_i.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ur(_i,"SegmentVector");const eb=bn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),tb=bn([{name:"a_dash",components:4,type:"Uint16"}]);class md{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,o,c,f){this.ids.push(U_(t)),this.positions.push(o,c,f)}eachPosition(t,o){const c=U_(t);let f=0,d=this.ids.length-1;for(;f<d;){const m=f+d>>1;this.ids[m]>=c?d=m:f=m+1}for(;this.ids[f]===c;)o(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(t,o){const c=new Float64Array(t.ids),f=new Uint32Array(t.positions);return Xc(c,f,0,c.length-1),o&&(o.add(c.buffer),o.add(f.buffer)),{ids:c,positions:f}}static deserialize(t){const o=new md;let c;o.ids=t.ids,o.positions=t.positions;for(const f of o.ids)f!==c&&o.uniqueIds.push(f),c=f;return o.indexed=!0,o}}function U_(l){const t=+l;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Vo(String(l))}function Xc(l,t,o,c){for(;o<c;){const f=l[o+c>>1];let d=o-1,m=c+1;for(;;){do d++;while(l[d]<f);do m--;while(l[m]>f);if(d>=m)break;Jh(l,d,m),Jh(t,3*d,3*m),Jh(t,3*d+1,3*m+1),Jh(t,3*d+2,3*m+2)}m-o<c-m?(Xc(l,t,o,m),o=m+1):(Xc(l,t,m+1,c),c=m)}}function Jh(l,t,o){const c=l[t];l[t]=l[o],l[o]=c}ur(md,"FeaturePositionMap");class za{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,o),this.initialized=!0),!!this.location}set(t,o,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Ql extends za{constructor(t){super(t),this.current=0}set(t,o,c){this.fetchUniformLocation(t,o)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class wo extends za{constructor(t){super(t),this.current=0}set(t,o,c){this.fetchUniformLocation(t,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class ia extends za{constructor(t){super(t),this.current=[0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class Cm extends za{constructor(t){super(t),this.current=[0,0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class Qh extends za{constructor(t){super(t),this.current=[0,0,0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class Mm extends za{constructor(t){super(t),this.current=An.transparent.toRenderColor(null)}set(t,o,c){this.fetchUniformLocation(t,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const W_=new Float32Array(16);class gd extends za{constructor(t){super(t),this.current=W_}set(t,o,c){if(this.fetchUniformLocation(t,o)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const rb=new Float32Array(9),nb=new Float32Array(4);class Em extends za{constructor(t){super(t),this.current=nb}set(t,o,c){if(this.fetchUniformLocation(t,o)){for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function Im(l){return[$_(255*l.r,255*l.g),$_(255*l.b,255*l.a)]}class yd{constructor(t,o,c,f){this.value=t,this.uniformNames=o.map(d=>`u_${d}`),this.type=c,this.context=f}setUniform(t,o,c,f,d){const m=f.constantOr(this.value);o.set(t,d,m instanceof An?m.toRenderColor(this.context.lut):m)}getBinding(t,o){return this.type==="color"?new Mm(t):new wo(t)}}class Kc{constructor(t,o){this.uniformNames=o.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,o,c,f,d){const m=d==="u_pattern"||d==="u_dash"?this.pattern:d==="u_pixel_ratio"?this.pixelRatio:null;m&&o.set(t,d,m)}getBinding(t,o){return o==="u_pattern"||o==="u_dash"?new Qh(t):new wo(t)}}class oa{constructor(t,o,c,f){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(d=>({name:`a_${d}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,o,c,f,d,m,b){const C=this.paintVertexArray.length,k=this.expression.evaluate(new yi(0,{brightness:m}),o,{},d,f,b);this.paintVertexArray.resize(t),this._setPaintValue(C,t,k,this.context)}updatePaintArray(t,o,c,f,d,m,b){const C=this.expression.evaluate({zoom:0,brightness:b},c,f,void 0,d);this._setPaintValue(t,o,C,this.context)}_setPaintValue(t,o,c,f){if(this.type==="color"){const d=Im(c.toRenderColor(f.lut));for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=t;d<o;d++)this.paintVertexArray.emplace(d,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class os{constructor(t,o,c,f,d,m){this.expression=t,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=f,this.context=d,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,o,c,f,d,m,b){const C=this.expression.evaluate(new yi(this.context.zoom,{brightness:m}),o,{},d,f,b),k=this.expression.evaluate(new yi(this.context.zoom+1,{brightness:m}),o,{},d,f,b),x=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(x,t,C,k,this.context)}updatePaintArray(t,o,c,f,d,m,b){const C=this.expression.evaluate({zoom:this.context.zoom,brightness:b},c,f,void 0,d),k=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b},c,f,void 0,d);this._setPaintValue(t,o,C,k,this.context)}_setPaintValue(t,o,c,f,d){if(this.type==="color"){const m=Im(c.toRenderColor(d.lut)),b=Im(c.toRenderColor(d.lut));for(let C=t;C<o;C++)this.paintVertexArray.emplace(C,m[0],m[1],b[0],b[1])}else{for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o,c,f,d){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,b=Xt(this.expression.interpolationFactor(m,this.context.zoom,this.context.zoom+1),0,1);o.set(t,d,b)}getBinding(t,o){return new wo(t)}}class sa{constructor(t,o,c,f,d){this.expression=t,this.layerId=d,this.paintVertexAttributes=(c==="array"?tb:eb).members;for(let m=0;m<o.length;++m);this.paintVertexArray=new f}populatePaintArray(t,o,c,f){const d=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(d,t,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(t,o,c,f,d,m,b){this._setPaintValues(t,o,c.patterns&&c.patterns[this.layerId],m)}_setPaintValues(t,o,c,f){if(!f||!c)return;const d=f[c];if(!d)return;const{tl:m,br:b,pixelRatio:C}=d;for(let k=t;k<o;k++)this.paintVertexArray.emplace(k,m[0],m[1],b[0],b[1],C)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ec{constructor(t,o,c=()=>!0){this.binders={},this._buffers=[],this.context=o;const f=[];for(const d in t.paint._values){const m=t.paint.get(d);if(!c(d)||!(m instanceof Uc&&Ih(m.property.specification)))continue;const b=ob(d,t.type),C=m.value,k=m.property.specification.type,x=!!m.property.useIntegerZoom,S=d==="line-dasharray"||d.endsWith("pattern"),I=d==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(C.kind!=="constant"||I)if(C.kind==="source"||I||S){const T=h(d,k,"source");this.binders[d]=S?new sa(C,b,k,T,t.id):new oa(C,b,k,T),f.push(`/a_${d}`)}else{const T=h(d,k,"composite");this.binders[d]=new os(C,b,k,x,o,T),f.push(`/z_${d}`)}else this.binders[d]=S?new Kc(C.value,b):new yd(C.value,b,k,o),f.push(`/u_${d}`)}this.cacheKey=f.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof oa||o instanceof os?o.maxValue:0}populatePaintArrays(t,o,c,f,d,m,b){for(const C in this.binders){const k=this.binders[C];k.context=this.context,(k instanceof oa||k instanceof os||k instanceof sa)&&k.populatePaintArray(t,o,c,f,d,m,b)}}setConstantPatternPositions(t){for(const o in this.binders){const c=this.binders[o];c instanceof Kc&&c.setConstantPatternPositions(t)}}updatePaintArrays(t,o,c,f,d,m,b,C){let k=!1;const x=Object.keys(t),S=x.length!==0,I=S?x:o.uniqueIds;this.context.lut=d.lut;for(const T in this.binders){const E=this.binders[T];if(E.context=this.context,(E instanceof oa||E instanceof os||E instanceof sa)&&(E.expression.isStateDependent===!0||E.expression.isLightConstant===!1)){const A=d.paint.get(T);E.expression=A.value;for(const z of I){const B=t[z.toString()];o.eachPosition(z,(U,G,N)=>{const Z=f.feature(U);E.updatePaintArray(G,N,Z,B,m,b,C)})}if(!S)for(const z of c.uniqueIds){const B=t[z.toString()];c.eachPosition(z,(U,G,N)=>{const Z=f.feature(U);E.updatePaintArray(G,N,Z,B,m,b,C)})}k=!0}}return k}defines(){const t=[];for(const o in this.binders){const c=this.binders[o];(c instanceof yd||c instanceof Kc)&&t.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof oa||c instanceof os||c instanceof sa)for(let f=0;f<c.paintVertexAttributes.length;f++)t.push(c.paintVertexAttributes[f].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof yd||c instanceof Kc||c instanceof os)for(const f of c.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof yd||f instanceof Kc||f instanceof os)for(const d of f.uniformNames)o.push({name:d,property:c,binding:f.getBinding(t,d)})}return o}setUniforms(t,o,c,f,d){for(const{name:m,property:b,binding:C}of c)this.binders[b].setUniform(t,C,d,f.get(b),m)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const o=this.binders[t];(o instanceof oa||o instanceof os||o instanceof sa)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const o in this.binders){const c=this.binders[o];(c instanceof oa||c instanceof os||c instanceof sa)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof oa||o instanceof os||o instanceof sa)&&o.destroy()}}}class xl{constructor(t,o,c=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new ec(f,o,c);this.needsUpload=!1,this._featureMap=new md,this._featureMapWithoutIds=new md,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,o,c,f,d,m,b,C){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(t,o,f,d,m,b,C);o.id!==void 0?this._featureMap.add(o.id,c,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,c,f,d,m){for(const b of c)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,o,b,f,d,m||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const ib={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function ob(l,t){return ib[l]||[l.replace(`${t}-`,"").replace(/-/g,"_")]}const sb={"line-pattern":{source:Ra,composite:Ra},"fill-pattern":{source:Ra,composite:Ra},"fill-extrusion-pattern":{source:Ra,composite:Ra},"line-dasharray":{source:Kl,composite:Kl}},G_={color:{source:hd,composite:Da},number:{source:Yc,composite:hd}};function h(l,t,o){const c=sb[l];return c&&c[o]||G_[t][o]}ur(yd,"ConstantBinder"),ur(Kc,"PatternConstantBinder"),ur(oa,"SourceExpressionBinder"),ur(sa,"PatternCompositeBinder"),ur(os,"CompositeExpressionBinder"),ur(ec,"ProgramConfiguration",{omit:["_buffers"]}),ur(xl,"ProgramConfigurationSet");const n=er/Math.PI/2,s=5,p=6,y=16383,v=64,w=[v,32,16],P=-n,R=n;function O(l,t,o,c=n){return o=Wt(o),[l*Math.sin(o)*c,-t*c,l*Math.cos(o)*c]}function F(l,t,o){return O(Math.cos(Wt(l)),Math.sin(Wt(l)),t,o)}const V=63710088e-1,$=2*Math.PI*V;class W{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new W(zr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,c=this.lat*o,f=t.lat*o,d=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((t.lng-this.lng)*o);return V*Math.acos(Math.min(d,1))}toBounds(t=0){const o=360*t/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new ee({lng:this.lng-c,lat:this.lat-o},{lng:this.lng+c,lat:this.lat+o})}toEcef(t){return F(this.lat,this.lng,n+t*n/V)}static convert(t){if(t instanceof W)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new W(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new W(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ee{constructor(t,o){if(t)if(o)this.setSouthWest(t).setNorthEast(o);else if(t.length===4){const c=t;this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]])}else{const c=t;this.setSouthWest(c[0]).setNorthEast(c[1])}}setNorthEast(t){return this._ne=t instanceof W?new W(t.lng,t.lat):W.convert(t),this}setSouthWest(t){return this._sw=t instanceof W?new W(t.lng,t.lat):W.convert(t),this}extend(t){const o=this._sw,c=this._ne;let f,d;if(t instanceof W)f=t,d=t;else{if(!(t instanceof ee))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(ee.convert(t)):this.extend(W.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(W.convert(t)):this;if(f=t._sw,d=t._ne,!f||!d)return this}return o||c?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),c.lng=Math.max(d.lng,c.lng),c.lat=Math.max(d.lat,c.lat)):(this._sw=new W(f.lng,f.lat),this._ne=new W(d.lng,d.lat)),this}getCenter(){return new W((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new W(this.getWest(),this.getNorth())}getSouthEast(){return new W(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:c}=W.convert(t);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(t){if(t)return t instanceof ee?t:new ee(t)}}const re=0,ie=25.5;function ae(l){return $*Math.cos(l*Math.PI/180)}function _e(l){return(180+l)/360}function Se(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function ge(l,t){return l/ae(t)}function Ee(l){return 360*l-180}function Me(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function Fe(l,t){return l*ae(Me(t))}const Re=85.051129;function Ne(l){return Math.cos(Wt(Xt(l,-Re,Re)))}function qe(l,t){const o=Xt(t,re,ie),c=Math.pow(2,o);return Ne(l)*$/(512*c)}function Ue(l){return 1/Math.cos(l*Math.PI/180)}function $e(l,t=0){const o=Math.exp(Math.PI*(1-(l.y+t/er)/(1<<l.z)*2));return 80150034*o/(o*o+1)/er/(1<<l.z)}class nt{constructor(t,o,c=0){this.x=+t,this.y=+o,this.z=+c}static fromLngLat(t,o=0){const c=W.convert(t);return new nt(_e(c.lng),Se(c.lat),ge(o,c.lat))}toLngLat(){return new W(Ee(this.x),Me(this.y))}toAltitude(){return Fe(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/$*Ue(Me(this.y))}}function pt(l,t,o,c,f,d,m,b,C){const k=(t+c)/2,x=(o+f)/2,S=new rt(k,x);b(S),function(I,T,E,A,z,B){const U=E-z,G=A-B;return Math.abs((A-T)*U-(E-I)*G)/Math.hypot(U,G)}(S.x,S.y,d.x,d.y,m.x,m.y)>=C?(pt(l,t,o,k,x,d,S,b,C),pt(l,k,x,c,f,S,m,b,C)):l.push(m)}function Mt(l,t,o){let c=l[0],f=c.x,d=c.y;t(c);const m=[c];for(let b=1;b<l.length;b++){const C=l[b],{x:k,y:x}=C;t(C),pt(m,f,d,k,x,c,C,t,o),f=k,d=x,c=C}return m}function ht(l,t,o,c){if(c(t,o)){const f=t.add(o)._mult(.5);ht(l,t,f,c),ht(l,f,o,c)}else l.push(o)}function Nt(l,t){let o=l[0];const c=[o];for(let f=1;f<l.length;f++){const d=l[f];ht(c,o,d,t),o=d}return c}const it=Math.pow(2,14)-1,St=-it-1;function _t(l,t){const o=Math.round(l.x*t),c=Math.round(l.y*t);return l.x=Xt(o,St,it),l.y=Xt(c,St,it),(o<l.x||o>l.x+1||c<l.y||c>l.y+1)&&hr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function Vt(l,t,o){const c=l.loadGeometry(),f=l.extent,d=er/f;if(t&&o&&o.projection.isReprojectedInTileSpace){const m=1<<t.z,{scale:b,x:C,y:k,projection:x}=o,S=I=>{const T=Ee((t.x+I.x/f)/m),E=Me((t.y+I.y/f)/m),A=x.project(T,E);I.x=(A.x*b-C)*f,I.y=(A.y*b-k)*f};for(let I=0;I<c.length;I++)if(l.type!==1)c[I]=Mt(c[I],S,1);else{const T=[];for(const E of c[I])E.x<0||E.x>=f||E.y<0||E.y>=f||(S(E),T.push(E));c[I]=T}}for(const m of c)for(const b of m)_t(b,d);return c}function Ut(l,t){return{type:l.type,id:l.id,properties:l.properties,geometry:t?Vt(l):[]}}function Ct(l,t,o,c,f){l.emplaceBack(2*t+(c+1)/2,2*o+(f+1)/2)}function Pt(l,t,o){l.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class xr{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new ml,this.indexArray=new so,this.segments=new _i,this.programConfigurations=new xl(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}updateFootprints(t,o){}populate(t,o,c,f){const d=this.layers[0],m=[];let b=null;d.type==="circle"&&(b=d.layout.get("circle-sort-key"));for(const{feature:k,id:x,index:S,sourceLayerIndex:I}of t){const T=this.layers[0]._featureFilter.needGeometry,E=Ut(k,T);if(!this.layers[0]._featureFilter.filter(new yi(this.zoom),E,c))continue;const A=b?b.evaluate(E,{},c):void 0,z={id:x,properties:k.properties,type:k.type,sourceLayerIndex:I,index:S,geometry:T?E.geometry:Vt(k,c,f),patterns:{},sortKey:A};m.push(z)}b&&m.sort((k,x)=>k.sortKey-x.sortKey);let C=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new Hh,C=f.projection);for(const k of m){const{geometry:x,index:S,sourceLayerIndex:I}=k,T=t[S].feature;this.addFeature(k,x,S,o.availableImages,c,C,o.brightness),o.featureIndex.insert(T,x,S,I,this.index)}}update(t,o,c,f,d){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,o,m?this.stateDependentLayers:this.layers,c,f,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,J1.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Q1.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,o,c,f,d,m,b){for(const C of o)for(const k of C){const x=k.x,S=k.y;if(x<0||x>=er||S<0||S>=er)continue;if(m){const E=m.projectTilePoint(x,S,d),A=m.upVector(d,x,S),z=this.globeExtVertexArray;Pt(z,E,A),Pt(z,E,A),Pt(z,E,A),Pt(z,E,A)}const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),T=I.vertexLength;Ct(this.layoutVertexArray,x,S,-1,-1),Ct(this.layoutVertexArray,x,S,1,-1),Ct(this.layoutVertexArray,x,S,1,1),Ct(this.layoutVertexArray,x,S,-1,1),this.indexArray.emplaceBack(T,T+1,T+2),this.indexArray.emplaceBack(T,T+2,T+3),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},f,d,b)}}function Kt(l,t){for(let o=0;o<l.length;o++)if(Qn(t,l[o]))return!0;for(let o=0;o<t.length;o++)if(Qn(l,t[o]))return!0;return!!kr(l,t)}function lr(l,t,o){return!!Qn(l,t)||!!Jr(t,l,o)}function Lr(l,t){if(l.length===1)return Un(t,l[0]);for(let o=0;o<t.length;o++){const c=t[o];for(let f=0;f<c.length;f++)if(Qn(l,c[f]))return!0}for(let o=0;o<l.length;o++)if(Un(t,l[o]))return!0;for(let o=0;o<t.length;o++)if(kr(l,t[o]))return!0;return!1}function fr(l,t,o){if(l.length>1){if(kr(l,t))return!0;for(let c=0;c<t.length;c++)if(Jr(t[c],l,o))return!0}for(let c=0;c<l.length;c++)if(Jr(l[c],t,o))return!0;return!1}function kr(l,t){if(l.length===0||t.length===0)return!1;for(let o=0;o<l.length-1;o++){const c=l[o],f=l[o+1];for(let d=0;d<t.length-1;d++)if(rn(c,f,t[d],t[d+1]))return!0}return!1}function rn(l,t,o,c){return Mn(l,o,c)!==Mn(t,o,c)&&Mn(l,t,o)!==Mn(l,t,c)}function Jr(l,t,o){const c=o*o;if(t.length===1)return l.distSqr(t[0])<c;for(let f=1;f<t.length;f++)if(Ln(l,t[f-1],t[f])<c)return!0;return!1}function Ln(l,t,o){const c=t.distSqr(o);if(c===0)return l.distSqr(t);const f=((l.x-t.x)*(o.x-t.x)+(l.y-t.y)*(o.y-t.y))/c;return l.distSqr(f<0?t:f>1?o:o.sub(t)._mult(f)._add(t))}function Un(l,t){let o,c,f,d=!1;for(let m=0;m<l.length;m++){o=l[m];for(let b=0,C=o.length-1;b<o.length;C=b++)c=o[b],f=o[C],c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(d=!d)}return d}function Qn(l,t){let o=!1;for(let c=0,f=l.length-1;c<l.length;f=c++){const d=l[c],m=l[f];d.y>t.y!=m.y>t.y&&t.x<(m.x-d.x)*(t.y-d.y)/(m.y-d.y)+d.x&&(o=!o)}return o}function gs(l,t,o,c,f){for(const m of l)if(t<=m.x&&o<=m.y&&c>=m.x&&f>=m.y)return!0;const d=[new rt(t,o),new rt(t,f),new rt(c,f),new rt(c,o)];if(l.length>2){for(const m of d)if(Qn(l,m))return!0}for(let m=0;m<l.length-1;m++)if(Pi(l[m],l[m+1],d))return!0;return!1}function Pi(l,t,o){const c=o[0],f=o[2];if(l.x<c.x&&t.x<c.x||l.x>f.x&&t.x>f.x||l.y<c.y&&t.y<c.y||l.y>f.y&&t.y>f.y)return!1;const d=Mn(l,t,o[0]);return d!==Mn(l,t,o[1])||d!==Mn(l,t,o[2])||d!==Mn(l,t,o[3])}function un(l,t,o,c,f,d){let m=t.y-l.y,b=l.x-t.x;if(d=d||0){const C=m*m+b*b;if(C===0)return!0;const k=Math.sqrt(C);m/=k,b/=k}return!((o.x-l.x)*m+(o.y-l.y)*b-d<0||(c.x-l.x)*m+(c.y-l.y)*b-d<0||(f.x-l.x)*m+(f.y-l.y)*b-d<0)}function Nn(l,t,o,c,f,d,m){return!(un(l,t,c,f,d,m)||un(t,o,c,f,d,m)||un(o,l,c,f,d,m)||un(c,f,l,t,o,m)||un(f,d,l,t,o,m)||un(d,c,l,t,o,m))}function ui(l,t,o){const c=t.paint.get(l).value;return c.kind==="constant"?c.value:o.programConfigurations.get(t.id).getMaxValue(l)}function On(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function en(l,t,o,c,f){if(!t[0]&&!t[1])return l;const d=rt.convert(t)._mult(f);o==="viewport"&&d._rotate(-c);const m=[];for(let b=0;b<l.length;b++)m.push(l[b].sub(d));return m}function wn(l,t,o,c){const f=rt.convert(l)._mult(c);return t==="viewport"&&f._rotate(-o),f}let Dn,xi;ur(xr,"CircleBucket",{omit:["layers"]});var Ai,yn={exports:{}},$i=(Ai||(Ai=1,function(l,t){(function(o){function c(d,m,b){var C=f(256*d,256*(m=Math.pow(2,b)-m-1),b),k=f(256*(d+1),256*(m+1),b);return C[0]+","+C[1]+","+k[0]+","+k[1]}function f(d,m,b){var C=2*Math.PI*6378137/256/Math.pow(2,b);return[d*C-2*Math.PI*6378137/2,m*C-2*Math.PI*6378137/2]}o.getURL=function(d,m,b,C,k,x){return x=x||{},d+"?"+["bbox="+c(b,C,k),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+m].join("&")},o.getTileBBox=c,o.getMercCoords=f,Object.defineProperty(o,"__esModule",{value:!0})})(t)}(0,yn.exports)),yn.exports);class Xi{constructor(t,o,c){this.z=t,this.x=o,this.y=c,this.key=Ao(0,t,t,o,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o){const c=$i.getTileBBox(this.x,this.y,this.z),f=function(d,m,b){let C,k="";for(let x=d;x>0;x--)C=1<<x-1,k+=(m&C?1:0)+(b&C?2:0);return k}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ui{constructor(t,o){this.wrap=t,this.canonical=o,this.key=Ao(t,o.z,o.z,o.x,o.y)}}class Zn{constructor(t,o,c,f,d){this.overscaledZ=t,this.wrap=o,this.canonical=new Xi(c,+f,+d),this.key=o===0&&t===c?this.canonical.key:Ao(o,t,c,f,d)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new Zn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Zn(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o=!0){if(this.overscaledZ===t&&o)return this.key;if(t>this.canonical.z)return Ao(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return Ao(this.wrap*+o,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new Zn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Zn(o,this.wrap,o,c,f),new Zn(o,this.wrap,o,c+1,f),new Zn(o,this.wrap,o,c,f+1),new Zn(o,this.wrap,o,c+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Zn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Zn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ui(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Ao(l,t,o,c,f){const d=1<<Math.min(o,22);let m=d*(f%d)+c%d;return l&&o<22&&(m+=d*d*((l<0?-2*l-1:2*l)%(1<<2*(22-o)))),16*(32*m+o)+(t-o)}const Do=[l=>{let t=l.canonical.x-1,o=l.wrap;return t<0&&(t=(1<<l.canonical.z)-1,o--),new Zn(l.overscaledZ,o,l.canonical.z,t,l.canonical.y)},l=>{let t=l.canonical.x+1,o=l.wrap;return t===1<<l.canonical.z&&(t=0,o++),new Zn(l.overscaledZ,o,l.canonical.z,t,l.canonical.y)},l=>new Zn(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new Zn(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];ur(Xi,"CanonicalTileID"),ur(Zn,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ys=bn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ss}=ys,Ho=bn([{name:"a_pos_3",components:3,type:"Int16"}]);var _s=bn([{name:"a_pos",type:"Int16",components:2}]);class Oa{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,c){const f=be.vec3.dot(o,this.dir);if(Math.abs(f)<1e-6)return!1;const d=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1]+(t[2]-this.pos[2])*o[2])/f;return c[0]=this.pos[0]+this.dir[0]*d,c[1]=this.pos[1]+this.dir[1]*d,c[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(t,o,c){if(be.vec3.equals(this.pos,t)||o===0)return c[0]=c[1]=c[2]=0,!1;const[f,d,m]=this.dir,b=this.pos[0]-t[0],C=this.pos[1]-t[1],k=this.pos[2]-t[2],x=f*f+d*d+m*m,S=2*(b*f+C*d+k*m),I=S*S-4*x*(b*b+C*C+k*k-o*o);if(I<0){const T=Math.max(-S/2,0),E=b+f*T,A=C+d*T,z=k+m*T,B=Math.hypot(E,A,z);return c[0]=E*o/B,c[1]=A*o/B,c[2]=z*o/B,!1}{const T=(-S-Math.sqrt(I))/(2*x);if(T<0){const E=Math.hypot(b,C,k);return c[0]=b*o/E,c[1]=C*o/E,c[2]=k*o/E,!1}return c[0]=b+f*T,c[1]=C+d*T,c[2]=k+m*T,!0}}}class vl{constructor(t,o,c,f,d){this.TL=t,this.TR=o,this.BR=c,this.BL=f,this.horizon=d}static fromInvProjectionMatrix(t,o,c){const f=[-1,1,1],d=[1,1,1],m=[1,-1,1],b=[-1,-1,1],C=be.vec3.transformMat4(f,f,t),k=be.vec3.transformMat4(d,d,t),x=be.vec3.transformMat4(m,m,t),S=be.vec3.transformMat4(b,b,t);return new vl(C,k,x,S,o/c)}}function aa(l,t,o){let c=1/0,f=-1/0;const d=[];for(const m of l){be.vec3.sub(d,m,t);const b=be.vec3.dot(d,o);c=Math.min(c,b),f=Math.max(f,b)}return[c,f]}function Jc(l,t){let o=!0;for(let c=0;c<l.planes.length;c++){const f=l.planes[c];let d=0;for(let m=0;m<t.length;m++)d+=be.vec3.dot(f,t[m])+f[3]>=0;if(d===0)return 0;d!==t.length&&(o=!1)}return o?2:1}function Qc(l,t){for(const o of l.projections){const c=aa(t,l.points[0],o.axis);if(o.projection[1]<c[0]||o.projection[0]>c[1])return 0}return 1}function ep(l,t){let o=0;const c=[0,0,0,0];for(let f=0;f<l.length;f++)c[0]=l[f][0],c[1]=l[f][1],c[2]=l[f][2],c[3]=1,be.vec4.dot(c,t)>=0&&o++;return o}class eu{constructor(t,o){this.points=t||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=Yn.fromPoints(this.points),this.projections=[],this.frustumEdges=[be.vec3.sub([],this.points[2],this.points[3]),be.vec3.sub([],this.points[0],this.points[3]),be.vec3.sub([],this.points[4],this.points[0]),be.vec3.sub([],this.points[5],this.points[1]),be.vec3.sub([],this.points[6],this.points[2]),be.vec3.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const f=[0,-c[2],c[1]],d=[c[2],0,-c[0]];this.projections.push({axis:f,projection:aa(this.points,this.points[0],f)}),this.projections.push({axis:d,projection:aa(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(t,o,c,f){const d=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const x=be.vec4.transformMat4([],k,t),S=1/x[3]/o*d;return be.vec4.mul(x,x,[S,S,f?1/x[3]:S,S])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const x=be.vec3.sub([],m[k[0]],m[k[1]]),S=be.vec3.sub([],m[k[2]],m[k[1]]),I=be.vec3.normalize([],be.vec3.cross([],x,S)),T=-be.vec3.dot(I,m[k[1]]);return I.concat(T)}),C=[];for(let k=0;k<m.length;k++)C.push([m[k][0],m[k][1],m[k][2]]);return new eu(C,b)}intersectsPrecise(t,o,c){for(let f=0;f<o.length;f++)if(!ep(t,o[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!ep(t,this.planes[f]))return 0;for(const f of c)for(const d of this.frustumEdges){const m=be.vec3.cross([],f,d),b=be.vec3.length(m);if(b===0)continue;be.vec3.scale(m,m,1/b);const C=aa(this.points,this.points[0],m),k=aa(t,this.points[0],m);if(C[0]>k[1]||k[0]>C[1])return 0}return 1}containsPoint(t){for(const o of this.planes){const c=o[3];if(be.vec3.dot([o[0],o[1],o[2]],t)+c<0)return!1}return!0}}class Yn{static fromPoints(t){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of t)be.vec3.min(o,o,f),be.vec3.max(c,c,f);return new Yn(o,c)}static fromTileIdAndHeight(t,o,c){const f=1<<t.canonical.z,d=t.canonical.x,m=t.canonical.y;return new Yn([d/f,m/f,o],[(d+1)/f,(m+1)/f,c])}static applyTransform(t,o){const c=t.getCorners();for(let f=0;f<c.length;++f)be.vec3.transformMat4(c[f],c[f],o);return Yn.fromPoints(c)}static applyTransformFast(t,o){const c=[o[12],o[13],o[14]],f=[...c];for(let d=0;d<3;d++)for(let m=0;m<3;m++){const b=o[4*m+d],C=b*t.min[m],k=b*t.max[m];c[d]+=Math.min(C,k),f[d]+=Math.max(C,k)}return new Yn(c,f)}static projectAabbCorners(t,o){const c=t.getCorners();for(let f=0;f<c.length;++f)be.vec3.transformMat4(c[f],c[f],o);return c}constructor(t,o){this.min=t,this.max=o,this.center=be.vec3.scale([],be.vec3.add([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],c=be.vec3.clone(this.min),f=be.vec3.clone(this.max);for(let d=0;d<o.length;d++)c[d]=o[d]?this.min[d]:this.center[d],f[d]=o[d]?this.center[d]:this.max[d];return f[2]=this.max[2],new Yn(c,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,o=this.max;return[[t[0],t[1],t[2]],[o[0],t[1],t[2]],[o[0],o[1],t[2]],[t[0],o[1],t[2]],[t[0],t[1],o[2]],[o[0],t[1],o[2]],[o[0],o[1],o[2]],[t[0],o[1],o[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?Jc(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?Jc(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,o){return o||this.intersects(t)?Qc(t,this.getCorners()):0}intersectsPreciseFlat(t,o){return o||this.intersectsFlat(t)?Qc(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let o=0;o<3;++o)if(this.min[o]>t.max[o]||t.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t.min[o]),this.max[o]=Math.max(this.max[o],t.max[o])}encapsulatePoint(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t[o]),this.max[o]=Math.max(this.max[o],t[o])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}function tc(l){return l*n/V}ur(Yn,"Aabb");const ab=[new Yn([P,P,P],[R,R,R]),new Yn([P,P,P],[0,0,R]),new Yn([0,P,P],[R,0,R]),new Yn([P,0,P],[0,R,R]),new Yn([0,0,P],[R,R,R])];function H_(l,t,o,c=!0){const f=be.vec3.scale([],l._camera.position,l.worldSize),d=[t,o,1,1];be.vec4.transformMat4(d,d,l.pixelMatrixInverse),be.vec4.scale(d,d,1/d[3]);const m=be.vec3.sub([],d,f),b=be.vec3.normalize([],m),C=l.globeMatrix,k=[C[12],C[13],C[14]],x=be.vec3.sub([],k,f),S=be.vec3.length(x),I=be.vec3.normalize([],x),T=l.worldSize/(2*Math.PI),E=be.vec3.dot(I,b),A=Math.asin(T/S);if(A<Math.acos(E)){if(!c)return null;const Ae=[],Te=[];be.vec3.scale(Ae,b,S/E),be.vec3.normalize(Te,be.vec3.sub(Te,Ae,x)),be.vec3.normalize(b,be.vec3.add(b,x,be.vec3.scale(b,Te,Math.tan(A)*S)))}const z=[];new Oa(f,b).closestPointOnSphere(k,T,z);const B=be.vec3.normalize([],ms(C,0)),U=be.vec3.normalize([],ms(C,1)),G=be.vec3.normalize([],ms(C,2)),N=be.vec3.dot(B,z),Z=be.vec3.dot(U,z),J=be.vec3.dot(G,z),he=wr(Math.asin(-Z/T));let ye=wr(Math.atan2(N,J));ye=l.center.lng+function(Ae,Te){const Oe=(Te-Ae+180)%360-180;return Oe<-180?Oe+360:Oe}(l.center.lng,ye);const xe=_e(ye),me=Xt(Se(he),0,1);return new nt(xe,me)}class B4{constructor(t,o,c){this.a=be.vec3.sub([],t,c),this.b=be.vec3.sub([],o,c),this.center=c;const f=be.vec3.normalize([],this.a),d=be.vec3.normalize([],this.b);this.angle=Math.acos(be.vec3.dot(f,d))}}function lb(l,t){if(l.angle===0)return null;let o;return o=l.a[t]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[t]/l.a[t]/Math.sin(l.angle)-1/Math.tan(l.angle)),o<0||o>1?null:function(c,f,d,m){const b=Math.sin(d);return c*(Math.sin((1-m)*d)/b)+f*(Math.sin(m*d)/b)}(l.a[t],l.b[t],l.angle,Xt(o,0,1))+l.center[t]}function bl(l){if(l.z<=1)return ab[l.z+2*l.y+l.x];const t=cb(q_(l));return Yn.fromPoints(t)}function rc(l,t,o){return be.vec3.scale(l,l,1-o),be.vec3.scaleAndAdd(l,l,t,o)}function iM(l,t,o){for(const c of l)be.vec3.transformMat4(c,c,t),be.vec3.scale(c,c,o)}function oM(l,t,o,c){const f=t/l.worldSize,d=l.globeMatrix;if(o.z<=1){const xe=bl(o).getCorners();return iM(xe,d,f),Yn.fromPoints(xe)}const m=q_(o,c),b=cb(m,n+tc(l._tileCoverLift));iM(b,d,f);const C=Number.MAX_VALUE,k=[-C,-C,-C],x=[C,C,C];if(m.contains(l.center)){for(const Ae of b)be.vec3.min(x,x,Ae),be.vec3.max(k,k,Ae);k[2]=0;const xe=l.point,me=[xe.x*f,xe.y*f,0];return be.vec3.min(x,x,me),be.vec3.max(k,k,me),new Yn(x,k)}if(l._tileCoverLift>0){for(const xe of b)be.vec3.min(x,x,xe),be.vec3.max(k,k,xe);return new Yn(x,k)}const S=[d[12]*f,d[13]*f,d[14]*f],I=m.getCenter(),T=Xt(l.center.lat,-Re,Re),E=Xt(I.lat,-Re,Re),A=_e(l.center.lng),z=Se(T);let B=A-_e(I.lng);const U=z-Se(E);B>.5?B-=1:B<-.5&&(B+=1);let G=0;if(Math.abs(B)>Math.abs(U))G=B>=0?1:3;else{G=U>=0?0:2;const xe=[d[4]*f,d[5]*f,d[6]*f],me=-Math.sin(Wt(U>=0?m.getSouth():m.getNorth()))*n;be.vec3.scaleAndAdd(S,S,xe,me)}const N=b[G],Z=b[(G+1)%4],J=new B4(N,Z,S),he=[lb(J,0)||N[0],lb(J,1)||N[1],lb(J,2)||N[2]],ye=tu(l.zoom);if(ye>0){const xe=function({x:Ae,y:Te,z:Oe},We,Ze,Ye,Je){const at=1/(1<<Oe);let Qe=Ae*at,gt=Qe+at,Et=Te*at,dt=Et+at,sr=0;const Jt=(Qe+gt)/2-Ye;return Jt>.5?sr=-1:Jt<-.5&&(sr=1),Qe=((Qe+sr)*We-(Ye*=We))*Ze+Ye,gt=((gt+sr)*We-Ye)*Ze+Ye,Et=(Et*We-(Je*=We))*Ze+Je,dt=(dt*We-Je)*Ze+Je,[[Qe,dt,0],[gt,dt,0],[gt,Et,0],[Qe,Et,0]]}(o,t,l._pixelsPerMercatorPixel,A,z);for(let Ae=0;Ae<b.length;Ae++)rc(b[Ae],xe[Ae],ye);const me=be.vec3.add([],xe[G],xe[(G+1)%4]);be.vec3.scale(me,me,.5),rc(he,me,ye)}for(const xe of b)be.vec3.min(x,x,xe),be.vec3.max(k,k,xe);return x[2]=Math.min(N[2],Z[2]),be.vec3.min(x,x,he),be.vec3.max(k,k,he),new Yn(x,k)}function q_({x:l,y:t,z:o},c=!1){const f=1/(1<<o),d=new W(Ee(l*f),t===(1<<o)-1&&c?-90:Me((t+1)*f)),m=new W(Ee((l+1)*f),t===0&&c?90:Me(t*f));return new ee(d,m)}function cb(l,t=n){const o=Wt(l.getNorth()),c=Wt(l.getSouth()),f=Math.cos(o),d=Math.cos(c),m=Math.sin(o),b=Math.sin(c),C=l.getWest(),k=l.getEast();return[O(d,b,C,t),O(d,b,k,t),O(f,m,k,t),O(f,m,C,t)]}function km(l,t,o,c){const f=1<<o.z,d=(l/er+o.x)/f;return F(Me((t/er+o.y)/f),Ee(d),c)}function Z_({min:l,max:t}){return y/Math.max(t[0]-l[0],t[1]-l[1],t[2]-l[2])}const sM=new Float64Array(16);function Y_(l){const t=Z_(l),o=be.mat4.fromScaling(sM,[t,t,t]);return be.mat4.translate(o,o,be.vec3.negate([],l.min))}function ub(l){const t=be.mat4.fromTranslation(sM,l.min),o=1/Z_(l);return be.mat4.scale(t,t,[o,o,o])}function db(l){const t=er/(2*Math.PI);return l/(2*Math.PI)/t}function aM(l,t){return er/(512*Math.pow(2,l))*Z_(bl(t))}function lM(l,t,o,c,f){const d=db(o),m=[l,t,-o/(2*Math.PI)],b=be.mat4.identity(new Float64Array(16));return be.mat4.translate(b,b,m),be.mat4.scale(b,b,[d,d,d]),be.mat4.rotateX(b,b,Wt(-f)),be.mat4.rotateY(b,b,Wt(-c)),b}function tu(l){return Hr(s,p,l)}function cM(l,t){const o=F(t.lat,t.lng),c=function(d){const m=F(d._center.lat,d._center.lng),b=be.vec3.fromValues(0,1,0);let C=be.vec3.cross([],b,m);const k=be.mat4.fromRotation([],-d.angle,m);C=be.vec3.transformMat4(C,C,k),be.mat4.fromRotation(k,-d._pitch,C);const x=be.vec3.normalize([],m);return be.vec3.scale(x,x,tc(d.cameraToCenterDistance/d.pixelsPerMeter)),be.vec3.transformMat4(x,x,k),be.vec3.add([],m,x)}(l),f=be.vec3.subtract([],c,o);return be.vec3.angle(f,o)}function hb(l,t){return cM(l,t)>Math.PI/2*1.01}const uM=Wt(85),j4=Math.cos(uM),N4=Math.sin(uM),V4=be.mat4.create(),dM=l=>{const t=[];return l.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function hM(l,t,o,c,f,d,m,b,C){if(d&&l.queryGeometry.isAboveHorizon)return!1;d&&(C*=l.pixelToTileUnitsFactor);const k=l.tileID.canonical,x=o.projection.upVectorScale(k,o.center.lat,o.worldSize).metersToTile;for(const S of t)for(const I of S){const T=I.add(b),E=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt(T.x,T.y,!0):0,A=o.projection.projectTilePoint(T.x,T.y,k);if(E>0){const G=o.projection.upVector(k,T.x,T.y);A.x+=G[0]*x*E,A.y+=G[1]*x*E,A.z+=G[2]*x*E}const z=d?T:$4(A.x,A.y,A.z,c),B=d?l.tilespaceRays.map(G=>W4(G,E)):l.queryGeometry.screenGeometry,U=be.vec4.transformMat4([],[A.x,A.y,A.z,1],c);if(!m&&d?C*=U[3]/o.cameraToCenterDistance:m&&!d&&(C*=o.cameraToCenterDistance/U[3]),d){const G=Me((I.y/er+k.y)/(1<<k.z));C/=o.projection.pixelsPerMeter(G,1)/ge(1,G)}if(lr(B,z,C))return!0}return!1}function $4(l,t,o,c){const f=be.vec4.transformMat4([],[l,t,o,1],c);return new rt(f[0]/f[3],f[1]/f[3])}const pM=be.vec3.fromValues(0,0,0),U4=be.vec3.fromValues(0,0,1);function W4(l,t){const o=be.vec3.create();return pM[2]=t,l.intersectsPlane(pM,U4,o),new rt(o[0],o[1])}class fM extends xr{}let mM,gM,yM,_M;function xM(l,{width:t,height:o},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*o*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(t*o*c);return l.width=t,l.height=o,l.data=f,l}function vM(l,t,o){const{width:c,height:f}=t;c===l.width&&f===l.height||(pb(l,t,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,c),height:Math.min(l.height,f)},o,null),l.width=c,l.height=f,l.data=t.data)}function pb(l,t,o,c,f,d,m,b){if(f.width===0||f.height===0)return t;if(f.width>l.width||f.height>l.height||o.x>l.width-f.width||o.y>l.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||c.x>t.width-f.width||c.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const C=l.data,k=t.data,x=d===4&&b;for(let S=0;S<f.height;S++){const I=((o.y+S)*l.width+o.x)*d,T=((c.y+S)*t.width+c.x)*d;if(x)for(let E=0;E<f.width;E++){const A=I+E*d+3,z=T+E*d;k[z+0]=255,k[z+1]=255,k[z+2]=255,k[z+3]=C[A]}else if(m)for(let E=0;E<f.width;E++){const A=I+E*d,z=T+E*d,B=C[A+3],U=new An(C[A+0]/255*B,C[A+1]/255*B,C[A+2]/255*B,B).toRenderColor(m).toArray();k[z+0]=U[0],k[z+1]=U[1],k[z+2]=U[2],k[z+3]=U[3]}else for(let E=0;E<f.width*d;E++)k[T+E]=C[I+E]}return t}ur(fM,"HeatmapBucket",{omit:["layers"]});class ru{constructor(t,o){xM(this,t,1,o)}resize(t){vM(this,new ru(t),1)}clone(){return new ru({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,c,f,d){pb(t,o,c,f,d,1,null)}}class Ro{constructor(t,o){xM(this,t,4,o)}resize(t){vM(this,new Ro(t),4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ro({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,c,f,d,m,b){pb(t,o,c,f,d,4,m,b)}}class bM{constructor(t,o){this.width=t.width,this.height=t.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function Pm(l){const t={},o=l.resolution||256,c=l.clips?l.clips.length:1,f=l.image||new Ro({width:o,height:c}),d=(m,b,C)=>{t[l.evaluationKey]=C;const k=l.expression.evaluate(t);k&&(f.data[m+b+0]=Math.floor(255*k.r/k.a),f.data[m+b+1]=Math.floor(255*k.g/k.a),f.data[m+b+2]=Math.floor(255*k.b/k.a),f.data[m+b+3]=Math.floor(255*k.a))};if(l.clips)for(let m=0,b=0;m<c;++m,b+=4*o)for(let C=0,k=0;C<o;C++,k+=4){const x=C/(o-1),{start:S,end:I}=l.clips[m];d(b,k,S*(1-x)+I*x)}else for(let m=0,b=0;m<o;m++,b+=4)d(0,b,m/(o-1));return f}ur(ru,"AlphaImage"),ur(Ro,"RGBAImage");const G4=bn([{name:"a_pos",components:2,type:"Int16"}],4),{members:H4}=G4;function Am(l,t,o=2){const c=t&&t.length,f=c?t[0]*o:l.length;let d=wM(l,0,f,o,!0);const m=[];if(!d||d.next===d.prev)return m;let b,C,k;if(c&&(d=function(x,S,I,T){const E=[];for(let A=0,z=S.length;A<z;A++){const B=wM(x,S[A]*T,A<z-1?S[A+1]*T:x.length,T,!1);B===B.next&&(B.steiner=!0),E.push(eO(B))}E.sort(K4);for(let A=0;A<E.length;A++)I=J4(E[A],I);return I}(l,t,d,o)),l.length>80*o){b=1/0,C=1/0;let x=-1/0,S=-1/0;for(let I=o;I<f;I+=o){const T=l[I],E=l[I+1];T<b&&(b=T),E<C&&(C=E),T>x&&(x=T),E>S&&(S=E)}k=Math.max(x-b,S-C),k=k!==0?32767/k:0}return Dm(d,m,o,b,C,k,0),m}function wM(l,t,o,c,f){let d;if(f===function(m,b,C,k){let x=0;for(let S=b,I=C-k;S<C;S+=k)x+=(m[I]-m[S])*(m[S+1]+m[I+1]),I=S;return x}(l,t,o,c)>0)for(let m=t;m<o;m+=c)d=CM(m/c|0,l[m],l[m+1],d);else for(let m=o-c;m>=t;m-=c)d=CM(m/c|0,l[m],l[m+1],d);return d&&X_(d,d.next)&&(Lm(d),d=d.next),d}function _d(l,t){if(!l)return l;t||(t=l);let o,c=l;do if(o=!1,c.steiner||!X_(c,c.next)&&Wi(c.prev,c,c.next)!==0)c=c.next;else{if(Lm(c),c=t=c.prev,c===c.next)break;o=!0}while(o||c!==t);return t}function Dm(l,t,o,c,f,d,m){if(!l)return;!m&&d&&function(C,k,x,S){let I=C;do I.z===0&&(I.z=fb(I.x,I.y,k,x,S)),I.prevZ=I.prev,I.nextZ=I.next,I=I.next;while(I!==C);I.prevZ.nextZ=null,I.prevZ=null,function(T){let E,A=1;do{let z,B=T;T=null;let U=null;for(E=0;B;){E++;let G=B,N=0;for(let J=0;J<A&&(N++,G=G.nextZ,G);J++);let Z=A;for(;N>0||Z>0&&G;)N!==0&&(Z===0||!G||B.z<=G.z)?(z=B,B=B.nextZ,N--):(z=G,G=G.nextZ,Z--),U?U.nextZ=z:T=z,z.prevZ=U,U=z;B=G}U.nextZ=null,A*=2}while(E>1)}(I)}(l,c,f,d);let b=l;for(;l.prev!==l.next;){const C=l.prev,k=l.next;if(d?Z4(l,c,f,d):q4(l))t.push(C.i,l.i,k.i),Lm(l),l=k.next,b=k.next;else if((l=k)===b){m?m===1?Dm(l=Y4(_d(l),t),t,o,c,f,d,2):m===2&&X4(l,t,o,c,f,d):Dm(_d(l),t,o,c,f,d,1);break}}}function q4(l){const t=l.prev,o=l,c=l.next;if(Wi(t,o,c)>=0)return!1;const f=t.x,d=o.x,m=c.x,b=t.y,C=o.y,k=c.y,x=f<d?f<m?f:m:d<m?d:m,S=b<C?b<k?b:k:C<k?C:k,I=f>d?f>m?f:m:d>m?d:m,T=b>C?b>k?b:k:C>k?C:k;let E=c.next;for(;E!==t;){if(E.x>=x&&E.x<=I&&E.y>=S&&E.y<=T&&tp(f,b,d,C,m,k,E.x,E.y)&&Wi(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function Z4(l,t,o,c){const f=l.prev,d=l,m=l.next;if(Wi(f,d,m)>=0)return!1;const b=f.x,C=d.x,k=m.x,x=f.y,S=d.y,I=m.y,T=b<C?b<k?b:k:C<k?C:k,E=x<S?x<I?x:I:S<I?S:I,A=b>C?b>k?b:k:C>k?C:k,z=x>S?x>I?x:I:S>I?S:I,B=fb(T,E,t,o,c),U=fb(A,z,t,o,c);let G=l.prevZ,N=l.nextZ;for(;G&&G.z>=B&&N&&N.z<=U;){if(G.x>=T&&G.x<=A&&G.y>=E&&G.y<=z&&G!==f&&G!==m&&tp(b,x,C,S,k,I,G.x,G.y)&&Wi(G.prev,G,G.next)>=0||(G=G.prevZ,N.x>=T&&N.x<=A&&N.y>=E&&N.y<=z&&N!==f&&N!==m&&tp(b,x,C,S,k,I,N.x,N.y)&&Wi(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;G&&G.z>=B;){if(G.x>=T&&G.x<=A&&G.y>=E&&G.y<=z&&G!==f&&G!==m&&tp(b,x,C,S,k,I,G.x,G.y)&&Wi(G.prev,G,G.next)>=0)return!1;G=G.prevZ}for(;N&&N.z<=U;){if(N.x>=T&&N.x<=A&&N.y>=E&&N.y<=z&&N!==f&&N!==m&&tp(b,x,C,S,k,I,N.x,N.y)&&Wi(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function Y4(l,t){let o=l;do{const c=o.prev,f=o.next.next;!X_(c,f)&&SM(c,o,o.next,f)&&Rm(c,f)&&Rm(f,c)&&(t.push(c.i,o.i,f.i),Lm(o),Lm(o.next),o=l=f),o=o.next}while(o!==l);return _d(o)}function X4(l,t,o,c,f,d){let m=l;do{let b=m.next.next;for(;b!==m.prev;){if(m.i!==b.i&&tO(m,b)){let C=TM(m,b);return m=_d(m,m.next),C=_d(C,C.next),Dm(m,t,o,c,f,d,0),void Dm(C,t,o,c,f,d,0)}b=b.next}m=m.next}while(m!==l)}function K4(l,t){return l.x-t.x}function J4(l,t){const o=function(f,d){let m=d;const b=f.x,C=f.y;let k,x=-1/0;do{if(C<=m.y&&C>=m.next.y&&m.next.y!==m.y){const A=m.x+(C-m.y)*(m.next.x-m.x)/(m.next.y-m.y);if(A<=b&&A>x&&(x=A,k=m.x<m.next.x?m:m.next,A===b))return k}m=m.next}while(m!==d);if(!k)return null;const S=k,I=k.x,T=k.y;let E=1/0;m=k;do{if(b>=m.x&&m.x>=I&&b!==m.x&&tp(C<T?b:x,C,I,T,C<T?x:b,C,m.x,m.y)){const A=Math.abs(C-m.y)/(b-m.x);Rm(m,f)&&(A<E||A===E&&(m.x>k.x||m.x===k.x&&Q4(k,m)))&&(k=m,E=A)}m=m.next}while(m!==S);return k}(l,t);if(!o)return t;const c=TM(o,l);return _d(c,c.next),_d(o,o.next)}function Q4(l,t){return Wi(l.prev,l,t.prev)<0&&Wi(t.next,l,l.next)<0}function fb(l,t,o,c,f){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*f|0)|l<<8))|l<<4))|l<<2))|l<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function eO(l){let t=l,o=l;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==l);return o}function tp(l,t,o,c,f,d,m,b){return(f-m)*(t-b)>=(l-m)*(d-b)&&(l-m)*(c-b)>=(o-m)*(t-b)&&(o-m)*(d-b)>=(f-m)*(c-b)}function tO(l,t){return l.next.i!==t.i&&l.prev.i!==t.i&&!function(o,c){let f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==c.i&&f.next.i!==c.i&&SM(f,f.next,o,c))return!0;f=f.next}while(f!==o);return!1}(l,t)&&(Rm(l,t)&&Rm(t,l)&&function(o,c){let f=o,d=!1;const m=(o.x+c.x)/2,b=(o.y+c.y)/2;do f.y>b!=f.next.y>b&&f.next.y!==f.y&&m<(f.next.x-f.x)*(b-f.y)/(f.next.y-f.y)+f.x&&(d=!d),f=f.next;while(f!==o);return d}(l,t)&&(Wi(l.prev,l,t.prev)||Wi(l,t.prev,t))||X_(l,t)&&Wi(l.prev,l,l.next)>0&&Wi(t.prev,t,t.next)>0)}function Wi(l,t,o){return(t.y-l.y)*(o.x-t.x)-(t.x-l.x)*(o.y-t.y)}function X_(l,t){return l.x===t.x&&l.y===t.y}function SM(l,t,o,c){const f=J_(Wi(l,t,o)),d=J_(Wi(l,t,c)),m=J_(Wi(o,c,l)),b=J_(Wi(o,c,t));return f!==d&&m!==b||!(f!==0||!K_(l,o,t))||!(d!==0||!K_(l,c,t))||!(m!==0||!K_(o,l,c))||!(b!==0||!K_(o,t,c))}function K_(l,t,o){return t.x<=Math.max(l.x,o.x)&&t.x>=Math.min(l.x,o.x)&&t.y<=Math.max(l.y,o.y)&&t.y>=Math.min(l.y,o.y)}function J_(l){return l>0?1:l<0?-1:0}function Rm(l,t){return Wi(l.prev,l,l.next)<0?Wi(l,t,l.next)>=0&&Wi(l,l.prev,t)>=0:Wi(l,t,l.prev)<0||Wi(l,l.next,t)<0}function TM(l,t){const o=mb(l.i,l.x,l.y),c=mb(t.i,t.x,t.y),f=l.next,d=t.prev;return l.next=t,t.prev=l,o.next=f,f.prev=o,c.next=o,o.prev=c,d.next=c,c.prev=d,c}function CM(l,t,o,c){const f=mb(l,t,o);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Lm(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function mb(l,t,o){return{i:l,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Q_(l,t){const o=l.length;if(o<=1)return[l];const c=[];let f,d;for(let m=0;m<o;m++){const b=bi(l[m]);b!==0&&(l[m].area=Math.abs(b),d===void 0&&(d=b<0),d===b<0?(f&&c.push(f),f=[l[m]]):f.push(l[m]))}if(f&&c.push(f),t>1)for(let m=0;m<c.length;m++)c[m].length<=t||(Zy(c[m],t,1,c[m].length-1,rO),c[m]=c[m].slice(0,t));return c}function rO(l,t){return t.area-l.area}function gb(l,t,o){const c=o.patternDependencies;let f=!1;for(const d of t){const m=d.paint.get(`${l}-pattern`);m.isConstant()||(f=!0);const b=m.constantOr(null);b&&(f=!0,c[b]=!0)}return f}function yb(l,t,o,c,f){const d=f.patternDependencies;for(const m of t){const b=m.paint.get(`${l}-pattern`).value;if(b.kind!=="constant"){let C=b.evaluate({zoom:c},o,{},f.availableImages);C=C&&C.name?C.name:C,d[C]=!0,o.patterns[m.id]=C}}return o}class _b{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ml,this.indexArray=new so,this.indexArray2=new _l,this.programConfigurations=new xl(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new _i,this.segments2=new _i,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=t.projection}updateFootprints(t,o){}populate(t,o,c,f){this.hasPattern=gb("fill",this.layers,o);const d=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:b,id:C,index:k,sourceLayerIndex:x}of t){const S=this.layers[0]._featureFilter.needGeometry,I=Ut(b,S);if(!this.layers[0]._featureFilter.filter(new yi(this.zoom),I,c))continue;const T=d?d.evaluate(I,{},c,o.availableImages):void 0,E={id:C,properties:b.properties,type:b.type,sourceLayerIndex:x,index:k,geometry:S?I.geometry:Vt(b,c,f),patterns:{},sortKey:T};m.push(E)}d&&m.sort((b,C)=>b.sortKey-C.sortKey);for(const b of m){const{geometry:C,index:k,sourceLayerIndex:x}=b;if(this.hasPattern){const S=yb("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(S)}else this.addFeature(b,C,k,c,{},o.availableImages,o.brightness);o.featureIndex.insert(t[k].feature,C,k,x,this.index)}}update(t,o,c,f,d){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,o,m?this.stateDependentLayers:this.layers,c,f,d)}addFeatures(t,o,c,f,d,m){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,c,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,H4),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,c,f,d,m=[],b){for(const C of Q_(o,500)){let k=0;for(const A of C)k+=A.length;const x=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),S=x.vertexLength,I=[],T=[];for(const A of C){if(A.length===0)continue;A!==C[0]&&T.push(I.length/2);const z=this.segments2.prepareSegment(A.length,this.layoutVertexArray,this.indexArray2),B=z.vertexLength;this.layoutVertexArray.emplaceBack(A[0].x,A[0].y),this.indexArray2.emplaceBack(B+A.length-1,B),I.push(A[0].x),I.push(A[0].y);for(let U=1;U<A.length;U++)this.layoutVertexArray.emplaceBack(A[U].x,A[U].y),this.indexArray2.emplaceBack(B+U-1,B+U),I.push(A[U].x),I.push(A[U].y);z.vertexLength+=A.length,z.primitiveLength+=A.length}const E=Am(I,T);for(let A=0;A<E.length;A+=3)this.indexArray.emplaceBack(S+E[A],S+E[A+1],S+E[A+2]);x.vertexLength+=k,x.primitiveLength+=E.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,d,m,f,b)}}let MM,EM,IM,kM;ur(_b,"FillBucket",{omit:["layers","patternFeatures"]});class xb{constructor(t,o,c,f){if(this.triangleCount=o.length/3,this.min=new rt(0,0),this.max=new rt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0)return;const[d,m]=[t[0].clone(),t[0].clone()];for(let S=1;S<t.length;++S){const I=t[S];d.x=Math.min(d.x,I.x),d.y=Math.min(d.y,I.y),m.x=Math.max(m.x,I.x),m.y=Math.max(m.y,I.y)}if(f){const S=Math.ceil(Math.max(m.x-d.x,m.y-d.y)/f);c=Math.max(c,S)}if(c===0)return;this.min=d,this.max=m;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const C=Math.max(b.x,b.y)/c;this.cellsX=Math.max(1,Math.ceil(b.x/C)),this.cellsY=Math.max(1,Math.ceil(b.y/C)),this.xScale=1/C,this.yScale=1/C;const k=[];for(let S=0;S<this.triangleCount;S++){const I=t[o[3*S+0]].sub(this.min),T=t[o[3*S+1]].sub(this.min),E=t[o[3*S+2]].sub(this.min),A=wl(Math.floor(Math.min(I.x,T.x,E.x)),this.xScale,this.cellsX),z=wl(Math.floor(Math.max(I.x,T.x,E.x)),this.xScale,this.cellsX),B=wl(Math.floor(Math.min(I.y,T.y,E.y)),this.yScale,this.cellsY),U=wl(Math.floor(Math.max(I.y,T.y,E.y)),this.yScale,this.cellsY),G=new rt(0,0),N=new rt(0,0),Z=new rt(0,0),J=new rt(0,0);for(let he=B;he<=U;++he){G.y=N.y=he*C,Z.y=J.y=(he+1)*C;for(let ye=A;ye<=z;++ye)G.x=Z.x=ye*C,N.x=J.x=(ye+1)*C,(Nn(I,T,E,G,N,J)||Nn(I,T,E,G,J,Z))&&k.push({cellIdx:he*this.cellsX+ye,triIdx:S})}}if(k.length===0)return;k.sort((S,I)=>S.cellIdx-I.cellIdx||S.triIdx-I.triIdx);let x=0;for(;x<k.length;){const S=k[x].cellIdx,I={start:this.payload.length,len:0};for(;x<k.length&&k[x].cellIdx===S;)++I.len,this.payload.push(k[x++].triIdx);this.cells[S]=I}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,o){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const c=wl(t.x-this.min.x,this.xScale,this.cellsX),f=wl(t.y-this.min.y,this.yScale,this.cellsY),d=this.cells[f*this.cellsX+c];if(d){this._lazyInitLookup();for(let m=0;m<d.len;m++){const b=this.payload[d.start+m],C=Math.floor(b/8),k=1<<b%8;if(!(this.lookup[C]&k)&&(this.lookup[C]|=k,o.push(b),o.length===this.triangleCount))return}}}query(t,o,c){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>o.x||t.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const f=wl(t.x-this.min.x,this.xScale,this.cellsX),d=wl(o.x-this.min.x,this.xScale,this.cellsX),m=wl(t.y-this.min.y,this.yScale,this.cellsY),b=wl(o.y-this.min.y,this.yScale,this.cellsY);for(let C=m;C<=b;C++)for(let k=f;k<=d;k++){const x=this.cells[C*this.cellsX+k];if(x)for(let S=0;S<x.len;S++){const I=this.payload[x.start+S],T=Math.floor(I/8),E=1<<I%8;if(!(this.lookup[T]&E)&&(this.lookup[T]|=E,c.push(I),c.length===this.triangleCount))return}}}}function wl(l,t,o){return Math.max(0,Math.min(o-1,Math.floor(l*t)))}ur(xb,"TriangleGridIndex");class PM{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[]}updateFootprints(t,o){for(const c of this.footprints)o.push({footprint:c,id:t})}populate(t,o,c,f){const d=[];for(const{feature:m,id:b,index:C,sourceLayerIndex:k}of t){const x=this.layers[0]._featureFilter.needGeometry,S=Ut(m,x);if(!this.layers[0]._featureFilter.filter(new yi(this.zoom),S,c))continue;const I={id:b,properties:m.properties,type:m.type,sourceLayerIndex:k,index:C,geometry:x?S.geometry:Vt(m,c,f),patterns:{}};d.push(I)}for(const m of d){const{geometry:b,index:C,sourceLayerIndex:k}=m;this.addFeature(m,b,C,c,{},o.availableImages,o.brightness),o.featureIndex.insert(t[C].feature,b,C,k,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(t){}update(t,o,c,f,d){}destroy(){}addFeature(t,o,c,f,d,m=[],b){for(const C of Q_(o,2)){const k=[],x=[],S=[],I=new rt(1/0,1/0),T=new rt(-1/0,-1/0);for(const z of C)if(z.length!==0){z!==C[0]&&S.push(x.length/2);for(let B=0;B<z.length;B++)x.push(z[B].x),x.push(z[B].y),k.push(z[B]),I.x=Math.min(I.x,z[B].x),I.y=Math.min(I.y,z[B].y),T.x=Math.max(T.x,z[B].x),T.y=Math.max(T.y,z[B].y)}const E=Am(x,S),A=new xb(k,E,8,256);this.footprints.push({vertices:k,indices:E,grid:A,min:I,max:T})}}}ur(PM,"ClipBucket",{omit:["layers"]});const nO=bn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),iO=bn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),oO=bn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),sO=bn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),aO=bn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),lO=bn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:cO}=nO;var vb,AM,bb,DM,wb,RM,LM,e0={};function zM(){if(AM)return vb;AM=1;var l=Bt();function t(f,d,m,b,C){this.properties={},this.extent=m,this.type=0,this._pbf=f,this._geometry=-1,this._keys=b,this._values=C,f.readFields(o,this,d)}function o(f,d,m){f==1?d.id=m.readVarint():f==2?function(b,C){for(var k=b.readVarint()+b.pos;b.pos<k;){var x=C._keys[b.readVarint()],S=C._values[b.readVarint()];C.properties[x]=S}}(m,d):f==3?d.type=m.readVarint():f==4&&(d._geometry=m.pos)}function c(f){for(var d,m,b=0,C=0,k=f.length,x=k-1;C<k;x=C++)b+=((m=f[x]).x-(d=f[C]).x)*(d.y+m.y);return b}return vb=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var d,m=f.readVarint()+f.pos,b=1,C=0,k=0,x=0,S=[];f.pos<m;){if(C<=0){var I=f.readVarint();b=7&I,C=I>>3}if(C--,b===1||b===2)k+=f.readSVarint(),x+=f.readSVarint(),b===1&&(d&&S.push(d),d=[]),d.push(new l(k,x));else{if(b!==7)throw new Error("unknown command "+b);d&&d.push(d[0].clone())}}return d&&S.push(d),S},t.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var d=f.readVarint()+f.pos,m=1,b=0,C=0,k=0,x=1/0,S=-1/0,I=1/0,T=-1/0;f.pos<d;){if(b<=0){var E=f.readVarint();m=7&E,b=E>>3}if(b--,m===1||m===2)(C+=f.readSVarint())<x&&(x=C),C>S&&(S=C),(k+=f.readSVarint())<I&&(I=k),k>T&&(T=k);else if(m!==7)throw new Error("unknown command "+m)}return[x,I,S,T]},t.prototype.toGeoJSON=function(f,d,m){var b,C,k=this.extent*Math.pow(2,m),x=this.extent*f,S=this.extent*d,I=this.loadGeometry(),T=t.types[this.type];function E(B){for(var U=0;U<B.length;U++){var G=B[U];B[U]=[360*(G.x+x)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+S)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(b=0;b<I.length;b++)A[b]=I[b][0];E(I=A);break;case 2:for(b=0;b<I.length;b++)E(I[b]);break;case 3:for(I=function(B){var U=B.length;if(U<=1)return[B];for(var G,N,Z=[],J=0;J<U;J++){var he=c(B[J]);he!==0&&(N===void 0&&(N=he<0),N===he<0?(G&&Z.push(G),G=[B[J]]):G.push(B[J]))}return G&&Z.push(G),Z}(I),b=0;b<I.length;b++)for(C=0;C<I[b].length;C++)E(I[b][C])}I.length===1?I=I[0]:T="Multi"+T;var z={type:"Feature",geometry:{type:T,coordinates:I},properties:this.properties};return"id"in this&&(z.id=this.id),z},vb}function OM(){if(DM)return bb;DM=1;var l=zM();function t(c,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(o,this,f),this.length=this._features.length}function o(c,f,d){c===15?f.version=d.readVarint():c===1?f.name=d.readString():c===5?f.extent=d.readVarint():c===2?f._features.push(d.pos):c===3?f._keys.push(d.readString()):c===4&&f._values.push(function(m){for(var b=null,C=m.readVarint()+m.pos;m.pos<C;){var k=m.readVarint()>>3;b=k===1?m.readString():k===2?m.readFloat():k===3?m.readDouble():k===4?m.readVarint64():k===5?m.readVarint():k===6?m.readSVarint():k===7?m.readBoolean():null}return b}(d))}return bb=t,t.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var f=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,f,this.extent,this._keys,this._values)},bb}function FM(){return LM||(LM=1,e0.VectorTile=function(){if(RM)return wb;RM=1;var l=OM();function t(o,c,f){if(o===3){var d=new l(f,f.readVarint()+f.pos);d.length&&(c[d.name]=d)}}return wb=function(o,c){this.layers=o.readFields(t,{},c)},wb}(),e0.VectorTileFeature=zM(),e0.VectorTileLayer=OM()),e0}var rp=FM();class xd extends rt{constructor(t,o,c){super(t,o),this.z=c}}class BM extends xd{constructor(t,o,c,f){super(t,o,c),this.w=f}}function t0(l,t,o,c){const f=[],d=c===0?(m,b,C,k,x,S)=>{m.push(new rt(S,C+(S-b)/(k-b)*(x-C)))}:(m,b,C,k,x,S)=>{m.push(new rt(b+(S-C)/(x-C)*(k-b),S))};for(const m of l){const b=[];for(const C of m){if(C.length<=2)continue;const k=[];for(let I=0;I<C.length-1;I++){const T=C[I].x,E=C[I].y,A=C[I+1].x,z=C[I+1].y,B=c===0?T:E,U=c===0?A:z;B<t?U>t&&d(k,T,E,A,z,t):B>o?U<o&&d(k,T,E,A,z,o):k.push(C[I]),U<t&&B>=t&&d(k,T,E,A,z,t),U>o&&B<=o&&d(k,T,E,A,z,o)}let x=C[C.length-1];const S=c===0?x.x:x.y;S>=t&&S<=o&&k.push(x),k.length&&(x=k[k.length-1],k[0].x===x.x&&k[0].y===x.y||k.push(k[0]),b.push(k))}b.length&&f.push(b)}return f}function jM(l,t,o,c){const f=o==="x"?"y":"x",d=(c-l[o])/(t[o]-l[o]);l[f]=l[f]+(t[f]-l[f])*d,l[o]=c,l.hasOwnProperty("z")&&(l.z=Pr(l.z,t.z,d)),l.hasOwnProperty("w")&&(l.w=Pr(l.w,t.w,d))}function NM(l,t,o,c){const f=o,d=c;for(const m of["x","y"]){let b=l,C=t;b[m]>=C[m]&&(b=t,C=l),b[m]<f&&C[m]>f&&jM(b,C,m,f),b[m]<d&&C[m]>d&&jM(C,b,m,d)}}const r0=Number.MAX_SAFE_INTEGER;function VM(l,t,o,c){return l.order<t||l.order===r0||!(l.clipMask&o)||function(f,d){return d.length!==0&&d.find(m=>m===f)===void 0}(c,l.clipScope)}function n0(l,t){return l.x-t.x||l.y-t.y}function $M(l,t){return n0(l.min,t.min)===0&&n0(l.max,t.max)===0}function Sb(l,t){return!(l.min.x>t.max.x||l.max.x<t.min.x||l.min.y>t.max.y||l.max.y<t.min.y)}function Tb(l,t){if(l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(l[o].sourceId!==t[o].sourceId||!$M(l[o],t[o])||l[o].order!==t[o].order||l[o].clipMask!==t[o].clipMask||!qt(l[o].clipScope,t[o].clipScope))return!1;return!0}function UM(l,t,o){const c=1/er,f=1/(1<<o.canonical.z),d=(t.x*c+o.canonical.x)*f+o.wrap,m=(t.y*c+o.canonical.y)*f;return{min:new rt((l.x*c+o.canonical.x)*f+o.wrap,(l.y*c+o.canonical.y)*f),max:new rt(d,m)}}function uO(l,t,o){const c=1<<o.canonical.z,f=((t.x-o.wrap)*c-o.canonical.x)*er,d=(t.y*c-o.canonical.y)*er;return{min:new rt(((l.x-o.wrap)*c-o.canonical.x)*er,(l.y*c-o.canonical.y)*er),max:new rt(f,d)}}function WM(l,t,o,c,f,d,m){const b=l.indices,C=l.vertices,k=[];for(let x=c;x<c+f;x+=3){const S=t[o[x+0]+d],I=t[o[x+1]+d],T=t[o[x+2]+d],E=Math.min(S.x,I.x,T.x),A=Math.max(S.x,I.x,T.x),z=Math.min(S.y,I.y,T.y),B=Math.max(S.y,I.y,T.y);k.length=0,l.grid.query(new rt(E,z),new rt(A,B),k);for(let U=0;U<k.length;U++){const G=k[U];if(Nn(C[b[3*G+0]],C[b[3*G+1]],C[b[3*G+2]],S,I,T,m))return!0}}return!1}function GM(l,t,o,c){if(!l||!o)return!1;let f=l.vertices;if(!t.canonical.equals(c.canonical)||t.wrap!==c.wrap){if(o.vertices.length<l.vertices.length)return GM(o,c,l,t);const d=t.canonical,m=c.canonical,b=Math.pow(2,m.z-d.z);f=l.vertices.map(C=>new rt((C.x+d.x*er)*b-m.x*er,(C.y+d.y*er)*b-m.y*er))}return WM(o,f,l.indices,0,l.indices.length,0,0)}function HM(l,t,o,c){const f=Math.pow(2,c.z-o.z);return new rt((l+o.x*er)*f-c.x*er,(t+o.y*er)*f-c.y*er)}function qM(l,t){const o=[];t.grid.queryPoint(l,o);const c=t.indices,f=t.vertices;for(let d=0;d<o.length;d++){const m=o[d];if(Qn([f[c[3*m+0]],f[c[3*m+1]],f[c[3*m+2]]],l))return!0}return!1}const Cb=[new rt(0,0),new rt(er,0),new rt(er,er),new rt(0,er)];function ZM(l,t){const o=[];let c=[];if(!t||l.length<2)return[l];if(l.length===2)return Pi(l[0],l[1],Cb)?[l]:[];for(let f=0;f<l.length+2;f++){const d=l[f%l.length],m=l[(f+1)%l.length],b=Pi(f===0?l[l.length-1]:l[(f-1)%l.length],d,Cb),C=Pi(d,m,Cb),k=b||C;k&&c.push(d),k&&C||c.length>0&&(c.length>1&&o.push(c),c=[])}return c.length>1&&o.push(c),o}const Mb=rp.VectorTileFeature.types,dO=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],hO=["fill-extrusion-flood-light-ground-radius"],pO=Math.pow(2,13),fO=Math.pow(2,15)-1,YM=new rt(0,1),nu=2147483648;function zm(l,t,o,c,f,d,m,b){l.emplaceBack((t<<1)+m,(o<<1)+d,(Math.floor(c*pO)<<1)+f,Math.round(b))}function Om(l,t,o){l.emplaceBack(t.x*er,t.y*er,o?1:0)}function i0(l,t,o,c,f,d){l.emplaceBack(t.x,t.y,(o.x<<1)+c,(o.y<<1)+f,d)}function Fm(l,t,o){l.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class XM{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class KM{constructor(){this.centroidXY=new rt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new rt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new rt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new rt(this.max.x-this.min.x,this.max.y-this.min.y)}}class JM{constructor(){this.acc=new rt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,o){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=o.x,t.min.y=t.max.y=o.y)}appendEdge(t,o,c){this.accCount++,this.acc._add(o);let f=!!this.borders;o.x<t.min.x?(t.min.x=o.x,f=!0):o.x>t.max.x&&(t.max.x=o.x,f=!0),o.y<t.min.y?(t.min.y=o.y,f=!0):o.y>t.max.y&&(t.max.y=o.y,f=!0),((o.x===0||o.x===er)&&o.x===c.x)!=((o.y===0||o.y===er)&&o.y===c.y)&&this.processBorderOverlap(o,c),f&&this.checkBorderIntersection(o,c)}checkBorderIntersection(t,o){o.x<0!=t.x<0&&this.addBorderIntersection(0,Pr(o.y,t.y,(0-o.x)/(t.x-o.x))),o.x>er!=t.x>er&&this.addBorderIntersection(1,Pr(o.y,t.y,(er-o.x)/(t.x-o.x))),o.y<0!=t.y<0&&this.addBorderIntersection(2,Pr(o.x,t.x,(0-o.y)/(t.y-o.y))),o.y>er!=t.y>er&&this.addBorderIntersection(3,Pr(o.x,t.x,(er-o.y)/(t.y-o.y)))}addBorderIntersection(t,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(t,o){if(t.x===o.x){if(t.y===o.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,t.x)}}centroid(){return this.accCount===0?new rt(0,0):new rt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,o)=>t+ +(o[0]!==Number.MAX_VALUE),0):0}}function QM(l,t){const o=l.add(t)._unit(),c=Xt(l.x*o.x+l.y*o.y,-1,1);var f,d,m;return m=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(m)))/4*fO*((f=l).x*(d=t).y-f.y*d.x<0?-1:1)}const mO=[l=>l.x<0,l=>l.x>er,l=>l.y<0,l=>l.y>er];function gO(l,t,o,c){const f=[4];if(c===0)return f;o._mult(c);const d=l.sub(o),m=t.sub(o),b=[l,t,d,m];for(let C=0;C<4;C++)for(const k of b)if(mO[C](k)){f.push(C);break}return f}class eE{constructor(t){this.vertexArray=new Gh,this.indexArray=new so,this.programConfigurations=new xl(t.layers,{zoom:t.zoom,lut:t.lut},o=>hO.includes(o)),this._segments=new _i,this.hiddenByLandmarkVertexArray=new Yh,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new _i}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,o,c,f=!1){const d=t.length;if(d>2){let m=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[m].length);let C;m!==this._segments.get().length-1&&(m++,this._segmentToGroundQuads[m]=[],this._segmentToRegionTriCounts[m]=[0,0,0,0,0]);{const k=t[0],x=t[1];C=QM(k.sub(t[d-1])._perp()._unit(),x.sub(k)._perp()._unit())}for(let k=0;k<d;k++){const x=k===d-1?0:k+1,S=t[k],I=t[x],T=t[x===d-1?0:x+1],E=I.sub(S)._perp()._unit(),A=QM(E,T.sub(I)._perp()._unit()),z=C,B=A;if(Eb(S,I,o)||f&&nE(S,o)&&nE(I,o)){C=A;continue}const U=b.vertexLength;i0(this.vertexArray,S,I,1,1,z),i0(this.vertexArray,S,I,1,0,z),i0(this.vertexArray,S,I,0,1,B),i0(this.vertexArray,S,I,0,0,B),b.vertexLength+=4;const G=gO(S,I,E,c);for(const N of G)this._segmentToGroundQuads[m].push({id:U,region:N}),this._segmentToRegionTriCounts[m][N]+=2,b.primitiveLength+=2;C=A}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),o=t.length;for(let c=0;c<o;c++)this._segmentToGroundQuads[c].sort((f,d)=>f.region-d.region);for(let c=0;c<o;c++){const f=this._segmentToGroundQuads[c],d=t[c],m=this._segmentToRegionTriCounts[c];m.reduce((C,k)=>C+k,0);let b=0;for(let C=0;C<=4;C++){const k=m[C];if(k!==0){let x=this.regionSegments[C];x||(x=this.regionSegments[C]=new _i);const S={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+b,vertexLength:d.vertexLength,primitiveLength:k};x.get().push(S)}b+=k}for(let C=0;C<f.length;C++){const k=f[C].id;this.indexArray.emplaceBack(k,k+1,k+3),this.indexArray.emplaceBack(k,k+3,k+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,o,c,f,d,m){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,o,c,f,d,m)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,iO.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,o,c,f,d,m){this.hasData()&&this.programConfigurations.updatePaintArrays(t,o,c,f,d,m)}updateHiddenByLandmark(t){if(!this.hasData())return;const o=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const c=t.flags&nu?1:0;for(let f=t.groundVertexArrayOffset;f<o;++f)this.hiddenByLandmarkVertexArray.emplace(f,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,aO.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const o=this.regionSegments[t];o&&o.destroy()}}}}class o0{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new so,this.footprintVertices=new ml,this.footprintSegments=[],this.layoutVertexArray=new gl,this.centroidVertexArray=new N_,this.wallVertexArray=new Tm,this.indexArray=new so,this.programConfigurations=new xl(t.layers,{zoom:t.zoom,lut:t.lut},o=>dO.includes(o)),this.segments=new _i,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new eE(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(t,o){}populate(t,o,c,f){this.features=[],this.hasPattern=gb("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=$e(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:d,id:m,index:b,sourceLayerIndex:C}of t){const k=this.layers[0]._featureFilter.needGeometry,x=Ut(d,k);if(!this.layers[0]._featureFilter.filter(new yi(this.zoom),x,c))continue;const S={id:m,sourceLayerIndex:C,index:b,geometry:k?x.geometry:Vt(d,c,f),properties:d.properties,type:d.type,patterns:{}},I=this.layoutVertexArray.length,T=Mb[S.type]==="Polygon";if(this.hasPattern)this.features.push(yb("fill-extrusion",this.layers,S,this.zoom,o));else if(this.wallMode)for(const E of S.geometry)for(const A of ZM(E,T))this.addFeature(S,[A],b,c,{},o.availableImages,f,o.brightness);else this.addFeature(S,S.geometry,b,c,{},o.availableImages,f,o.brightness);o.featureIndex.insert(d,S.geometry,b,C,this.index,I)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,o,c,f,d,m){for(const b of this.features){const C=Mb[b.type]==="Polygon",{geometry:k}=b;if(this.wallMode)for(const x of k)for(const S of ZM(x,C))this.addFeature(b,[S],b.index,o,c,f,d,m);else this.addFeature(b,k,b.index,o,c,f,d,m)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,o,c,f,d){const m=Object.keys(t).length!==0;if(m&&!this.stateDependentLayers.length)return;const b=m?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,o,b,c,f,d),this.groundEffect.update(t,o,b,c,f,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cO),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,sO.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,lO.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,oO.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,c,f,d,m,b,C){const k=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,x=[new rt(0,0),new rt(er,er)],S=b.projection,I=S.name==="globe",T=this.wallMode||Mb[t.type]==="Polygon",E=new JM;E.centroidDataIndex=this.centroidData.length;const A=new KM,z=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},f)<=0,B=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},f);let U;if(A.height=B,A.vertexArrayOffset=this.layoutVertexArray.length,A.groundVertexArrayOffset=this.groundEffect.vertexArray.length,I&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Hh),this.wallMode){if(I)return void hr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;U=function(me){const Ae=me[0].x===me[me.length-1].x&&me[0].y===me[me.length-1].y;(function($t){let Dt=0;const vr=$t.length;for(let ir=0;ir<vr;ir++)Dt+=($t[(ir+1)%vr].x-$t[ir].x)*($t[(ir+1)%vr].y+$t[ir].y);return Dt>=0})(me)||(me=me.reverse());const Oe={geometry:[],joinNormals:[],indices:[]},We=[],Ze=[],Ye=[];let Je=me.length;if(Je<(Ae?3:2))return Oe;for(;Je>=2&&me[Je-1].equals(me[Je-2]);)Je--;let at,Qe,gt,Et,dt,sr=0;for(;sr<Je-1&&me[sr].equals(me[sr+1]);)sr++;Ae&&(at=me[Je-2],dt=me[sr].sub(at)._unit()._perp());for(let $t=sr;$t<Je;$t++){if(gt=$t===Je-1?Ae?me[sr+1]:void 0:me[$t+1],gt&&me[$t].equals(gt))continue;dt&&(Et=dt),at&&(Qe=at),at=me[$t],dt=gt?gt.sub(at)._unit()._perp():Et,Et=Et||dt;let Dt=Et.add(dt);Dt.x===0&&Dt.y===0||Dt._unit();const vr=Dt.x*dt.x+Dt.y*dt.y,ir=vr!==0?1/vr:1/0,cr=Et.x*dt.y-Et.y*dt.x>0;let Vr="miter";const tn=2;Vr==="miter"&&ir>tn&&(Vr="bevel"),Vr==="bevel"&&(ir>100&&(Vr="flipbevel"),ir<tn&&(Vr="miter"));const Xr=(Kr,on,an,Wn)=>{const Rn=new rt(Kr.x,Kr.y),$r=new rt(Kr.x,Kr.y);Rn.x+=on.x*Wn,Rn.y+=on.y*Wn,$r.x-=on.x*Math.max(an,1),$r.y-=on.y*Math.max(an,1),Ye.push(on),We.push(Rn),Ze.push($r)};if(Vr==="miter")Dt._mult(ir),Xr(at,Dt,0,0);else if(Vr==="flipbevel")Dt=dt.mult(-1),Xr(at,Dt,0,0),Xr(at,Dt.mult(-1),0,0);else{const Kr=-Math.sqrt(ir*ir-1),on=cr?Kr:0,an=cr?0:Kr;Qe&&Xr(at,Et,on,an),gt&&Xr(at,dt,on,an)}}Oe.geometry=[...We,...Ze.reverse(),We[0]],Oe.joinNormals=[...Ye,...Ye.reverse(),Ye[Ye.length-1]];const Jt=Oe.geometry.length-1;for(let $t=0;$t<Jt/2;$t++)if($t+1<Jt/2){let Dt=$t,vr=$t+1,ir=Jt-1-$t,cr=Jt-2-$t;Dt=Dt===0?Jt-1:Dt-1,vr=vr===0?Jt-1:vr-1,ir=ir===0?Jt-1:ir-1,cr=cr===0?Jt-1:cr-1,Oe.indices.push(ir),Oe.indices.push(vr),Oe.indices.push(Dt),Oe.indices.push(ir),Oe.indices.push(cr),Oe.indices.push(vr)}return Oe}(o[0]),o=[U.geometry]}const G=(me,Ae)=>me<(Ae.length-1)/2||me===Ae.length-1,N=this.wallMode?[o]:Q_(o,500);for(let me=N.length-1;me>=0;me--){const Ae=N[me];(Ae.length===0||(Z=Ae[0]).every(Te=>Te.x<=0)||Z.every(Te=>Te.x>=er)||Z.every(Te=>Te.y<=0)||Z.every(Te=>Te.y>=er))&&N.splice(me,1)}var Z;let J;if(I)J=aE(N,x,f);else{J=[];for(const me of N)J.push({polygon:me,bounds:x})}const he=T?this.edgeRadius:0,ye=he>0&&this.zoom<17,xe=(me,Ae)=>{if(me.length===0)return!1;const Te=me[me.length-1];return Ae.x===Te.x&&Ae.y===Te.y};for(const{polygon:me,bounds:Ae}of J){let Te=0,Oe=0;for(const Je of me)T&&!Je[0].equals(Je[Je.length-1])&&Je.push(Je[0]),Oe+=T?Je.length-1:Je.length;const We=this.segments.prepareSegment((T?5:4)*Oe,this.layoutVertexArray,this.indexArray);A.footprintSegIdx<0&&(A.footprintSegIdx=this.footprintSegments.length),A.polygonSegIdx<0&&(A.polygonSegIdx=this.polygonSegments.length);const Ze={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ye=new XM;if(Ye.vertexOffset=this.footprintVertices.length,Ye.indexOffset=3*this.footprintIndices.length,Ye.ringIndices=[],T){const Je=[],at=[];Te=We.vertexLength;for(let gt=0;gt<me.length;gt++){const Et=me[gt];Et.length&&gt!==0&&at.push(Je.length/2);const dt=[];let sr,Jt;sr=Et[1].sub(Et[0])._perp()._unit(),Ye.ringIndices.push(Et.length-1);for(let $t=1;$t<Et.length;$t++){const Dt=Et[$t],vr=Et[$t===Et.length-1?1:$t+1],ir=Dt.clone();if(he){Jt=vr.sub(Dt)._perp()._unit();const cr=sr.add(Jt)._unit(),Vr=he*Math.min(4,1/(sr.x*cr.x+sr.y*cr.y));ir.x+=Vr*cr.x,ir.y+=Vr*cr.y,ir.x=Math.round(ir.x),ir.y=Math.round(ir.y),sr=Jt}if(!z||he!==0&&!ye||xe(dt,ir)||dt.push(ir),zm(this.layoutVertexArray,ir.x,ir.y,0,0,1,1,0),this.wallMode){const cr=G($t,Et);Om(this.wallVertexArray,U.joinNormals[$t],!cr)}We.vertexLength++,this.footprintVertices.emplaceBack(Dt.x,Dt.y),Je.push(Dt.x,Dt.y),I&&Fm(this.layoutVertexExtArray,S.projectTilePoint(ir.x,ir.y,f),S.upVector(f,ir.x,ir.y))}z&&(he===0||ye)&&(dt.length!==0&&xe(dt,dt[0])&&dt.pop(),this.groundEffect.addData(dt,Ae,k))}const Qe=this.wallMode?U.indices:Am(Je,at);for(let gt=0;gt<Qe.length;gt+=3)this.footprintIndices.emplaceBack(Ye.vertexOffset+Qe[gt+0],Ye.vertexOffset+Qe[gt+1],Ye.vertexOffset+Qe[gt+2]),this.indexArray.emplaceBack(Te+Qe[gt],Te+Qe[gt+2],Te+Qe[gt+1]),We.primitiveLength++;Ye.indexCount+=Qe.length,Ye.vertexCount+=this.footprintVertices.length-Ye.vertexOffset}for(let Je=0;Je<me.length;Je++){const at=me[Je];E.startRing(A,at[0]);let Qe=at.length>4&&iE(at[at.length-2],at[0],at[1]),gt=he?yO(at[at.length-2],at[0],at[1],he):0;const Et=[];let dt,sr,Jt;sr=at[1].sub(at[0])._perp()._unit();let $t=!0;for(let Dt=1,vr=0;Dt<at.length;Dt++){let ir=at[Dt-1],cr=at[Dt];const Vr=at[Dt===at.length-1?1:Dt+1];if(E.appendEdge(A,cr,ir),Eb(cr,ir,Ae)){he&&(sr=Vr.sub(cr)._perp()._unit(),$t=!$t);continue}const tn=cr.sub(ir)._perp(),Xr=tn.x/(Math.abs(tn.x)+Math.abs(tn.y)),Kr=tn.y>0?1:0,on=ir.dist(cr);if(vr+on>32768&&(vr=0),he){Jt=Vr.sub(cr)._perp()._unit();let $r=rE(ir,cr,Vr,tE(sr,Jt),he);isNaN($r)&&($r=0);const Cn=cr.sub(ir)._unit();ir=ir.add(Cn.mult(gt))._round(),cr=cr.add(Cn.mult(-$r))._round(),gt=$r,sr=Jt,z&&this.zoom>=17&&(xe(Et,ir)||Et.push(ir),xe(Et,cr)||Et.push(cr))}const an=We.vertexLength,Wn=at.length>4&&iE(ir,cr,Vr);let Rn=oE(vr,Qe,$t);if(zm(this.layoutVertexArray,ir.x,ir.y,Xr,Kr,0,0,Rn),zm(this.layoutVertexArray,ir.x,ir.y,Xr,Kr,0,1,Rn),this.wallMode){const $r=G(Dt-1,at),Cn=U.joinNormals[Dt-1];Om(this.wallVertexArray,Cn,$r),Om(this.wallVertexArray,Cn,$r)}if(vr+=on,Rn=oE(vr,Wn,!$t),Qe=Wn,zm(this.layoutVertexArray,cr.x,cr.y,Xr,Kr,0,0,Rn),zm(this.layoutVertexArray,cr.x,cr.y,Xr,Kr,0,1,Rn),this.wallMode){const $r=G(Dt,at),Cn=U.joinNormals[Dt];Om(this.wallVertexArray,Cn,$r),Om(this.wallVertexArray,Cn,$r)}if(We.vertexLength+=4,this.indexArray.emplaceBack(an+0,an+1,an+2),this.indexArray.emplaceBack(an+1,an+3,an+2),We.primitiveLength+=2,he){const $r=Te+(Dt===1?at.length-2:Dt-2),Cn=Dt===1?Te:$r+1;if(this.indexArray.emplaceBack(an+1,$r,an+3),this.indexArray.emplaceBack($r,Cn,an+3),We.primitiveLength+=2,dt===void 0&&(dt=an),!Eb(Vr,at[Dt],Ae)){const In=Dt===at.length-1?dt:We.vertexLength;this.indexArray.emplaceBack(an+2,an+3,In),this.indexArray.emplaceBack(an+3,In+1,In),this.indexArray.emplaceBack(an+3,Cn,In+1),We.primitiveLength+=3}$t=!$t}if(I){const $r=this.layoutVertexExtArray,Cn=S.projectTilePoint(ir.x,ir.y,f),In=S.projectTilePoint(cr.x,cr.y,f),ei=S.upVector(f,ir.x,ir.y),Si=S.upVector(f,cr.x,cr.y);Fm($r,Cn,ei),Fm($r,Cn,ei),Fm($r,In,Si),Fm($r,In,Si)}}T&&(Te+=at.length-1),z&&he&&this.zoom>=17&&(Et.length!==0&&xe(Et,Et[0])&&Et.pop(),this.groundEffect.addData(Et,Ae,k,he>0))}this.footprintSegments.push(Ye),Ze.triangleCount=this.indexArray.length-Ze.triangleArrayOffset,this.polygonSegments.push(Ze),++A.footprintSegLen,++A.polygonSegLen}if(A.vertexCount=this.layoutVertexArray.length-A.vertexArrayOffset,A.groundVertexCount=this.groundEffect.vertexArray.length-A.groundVertexArrayOffset,A.vertexCount!==0){if(A.centroidXY=E.borders?YM:this.encodeCentroid(E,A),this.centroidData.push(A),E.borders){this.featuresOnBorder.push(E);const me=this.featuresOnBorder.length-1;for(let Ae=0;Ae<E.borders.length;Ae++)E.borders[Ae][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ae].push(me)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,d,m,f,C),this.groundEffect.addPaintPropertiesData(t,c,d,m,f,C),this.maxHeight=Math.max(this.maxHeight,B)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((o,c)=>this.featuresOnBorder[o].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}splitToSubtiles(){const t=[];for(let b=0;b<this.centroidData.length;b++){const C=this.centroidData[b],k=+(C.min.y+C.max.y>er),x=2*k+(+(C.min.x+C.max.x>er)^k);for(let S=0;S<C.polygonSegLen;S++){const I=C.polygonSegIdx+S;t.push({centroidIdx:b,subtile:x,polygonSegmentIdx:I,triangleSegmentIdx:this.polygonSegments[I].triangleSegIdx})}}const o=new so;t.sort((b,C)=>b.triangleSegmentIdx===C.triangleSegmentIdx?b.subtile-C.subtile:b.triangleSegmentIdx-C.triangleSegmentIdx);let c=0,f=0,d=0;for(const b of t){if(b.triangleSegmentIdx!==c)break;d++}const m=t.length;for(;f!==t.length;){c=t[f].triangleSegmentIdx;let b=0,C=f,k=f;for(let x=C;x<d&&t[x].subtile===b;x++)k++;for(;C!==d;){const x=t[C];b=x.subtile;const S=this.centroidData[x.centroidIdx].min.clone(),I=this.centroidData[x.centroidIdx].max.clone(),T={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let E=C;E<k;E++){const A=t[E],z=this.polygonSegments[A.polygonSegmentIdx],B=this.centroidData[A.centroidIdx].min,U=this.centroidData[A.centroidIdx].max,G=this.indexArray.uint16;for(let N=z.triangleArrayOffset;N<z.triangleArrayOffset+z.triangleCount;N++)o.emplaceBack(G[3*N],G[3*N+1],G[3*N+2]);T.primitiveLength+=z.triangleCount,S.x=Math.min(S.x,B.x),S.y=Math.min(S.y,B.y),I.x=Math.max(I.x,U.x),I.y=Math.max(I.y,U.y)}T.primitiveLength>0&&this.triangleSubSegments.push({segment:T,min:S,max:I}),C=k;for(let E=C;E<d&&t[E].subtile===t[C].subtile;E++)k++}f=d;for(let x=f;x<m&&t[x].triangleSegmentIdx===t[f].triangleSegmentIdx;x++)d++}o._trim(),this.indexArray=o}getVisibleSegments(t,o,c){const f=new _i;if(this.wallMode){for(const A of this.triangleSubSegments)f.segments.push(A.segment);return f}let d=0,m=0;const b=1<<t.canonical.z;if(o){const A=o.getMinMaxForTile(t);A&&(d=A.min,m=A.max)}m+=this.maxHeight;const C=t.toUnwrapped();let k;const x=[C.canonical.x/b+C.wrap,C.canonical.y/b],S=[(C.canonical.x+1)/b+C.wrap,(C.canonical.y+1)/b],I=(A,z,B)=>[A[0]*(1-B[0])+z[0]*B[0],A[1]*(1-B[1])+z[1]*B[1]],T=[],E=[];for(const A of this.triangleSubSegments){T[0]=A.min.x/er,T[1]=A.min.y/er,E[0]=A.max.x/er,E[1]=A.max.y/er;const z=I(x,S,T),B=I(x,S,E);if(new Yn([z[0],z[1],d],[B[0],B[1],m]).intersectsPrecise(c)===0){k&&(f.segments.push(k),k=void 0);continue}const U=A.segment;k&&k.vertexOffset!==U.vertexOffset&&(f.segments.push(k),k=void 0),k?(k.vertexLength+=U.vertexLength,k.primitiveLength+=U.primitiveLength):k={vertexOffset:U.vertexOffset,primitiveLength:U.primitiveLength,vertexLength:U.vertexLength,primitiveOffset:U.primitiveOffset,sortKey:void 0,vaos:{}}}return k&&f.segments.push(k),f}encodeCentroid(t,o){const c=t.centroid(),f=o.span(),d=Math.min(7,Math.round(f.x*this.tileToMeter/10)),m=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new rt(Xt(c.x,1,er-1)<<3|d,Xt(c.y,1,er-1)<<3|m)}encodeBorderCentroid(t){if(!t.borders)return new rt(0,0);const o=t.borders,c=Number.MAX_VALUE;if(o[0][0]!==c||o[1][0]!==c){const f=o[0][0]!==c?0:1;return new rt(6|(o[0][0]!==c?0:65528),(o[f][0]+o[f][1])/2<<3|6)}{const f=o[2][0]!==c?2:3;return new rt((o[f][0]+o[f][1])/2<<3|6,6|(o[2][0]!==c?0:65528))}}showCentroid(t){const o=this.centroidData[t.centroidDataIndex];o.flags&=nu,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const o=t.vertexArrayOffset,c=t.vertexCount+t.vertexArrayOffset,f=t.flags&nu?YM:t.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==f.y||d!==f.x){for(let m=o;m<c;++m)this.centroidVertexArray.emplace(m,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,o,c){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const f=o.getReplacementRegionsForTile(t.toUnwrapped());if(Tb(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const m of this.centroidData)m.flags&=2147483647;const d=[];for(const m of this.activeReplacements){if(m.order<c)continue;const b=Math.pow(2,m.footprintTileId.canonical.z-t.canonical.z);for(const C of this.centroidData)if(!(C.flags&nu||m.min.x>C.max.x||C.min.x>m.max.x||m.min.y>C.max.y||C.min.y>m.max.y))for(let k=0;k<C.footprintSegLen;k++){const x=this.footprintSegments[C.footprintSegIdx+k];if(d.length=0,_O(this.footprintVertices,x.vertexOffset,x.vertexCount,m.footprintTileId.canonical,t.canonical,d),WM(m.footprint,d,this.footprintIndices.uint16,x.indexOffset,x.indexCount,-x.vertexOffset,-b)){C.flags|=nu;break}}}for(const m of this.centroidData)this.writeCentroidToBuffer(m);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,o,c){let f=!1;for(let d=0;d<c.footprintSegLen;d++){const m=this.footprintSegments[c.footprintSegIdx+d];let b=0;for(const C of m.ringIndices){for(let k=b,x=C+b-1;k<C+b;x=k++){const S=this.footprintVertices.int16[2*(k+m.vertexOffset)+0],I=this.footprintVertices.int16[2*(k+m.vertexOffset)+1],T=this.footprintVertices.int16[2*(x+m.vertexOffset)+1];I>o!=T>o&&t<(this.footprintVertices.int16[2*(x+m.vertexOffset)+0]-S)*(o-I)/(T-I)+S&&(f=!f)}b=C}}return f}getHeightAtTileCoord(t,o){let c=Number.NEGATIVE_INFINITY,f=!0;const d=4*(t+er)*er+(o+er);if(this.partLookup.hasOwnProperty(d)){const m=this.partLookup[d];return m?{height:m.height,hidden:!!(m.flags&nu)}:void 0}for(const m of this.centroidData)t>m.max.x||m.min.x>t||o>m.max.y||m.min.y>o||this.footprintContainsPoint(t,o,m)&&m&&m.height>c&&(c=m.height,this.partLookup[d]=m,f=!!(m.flags&nu));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:f};this.partLookup[d]=void 0}}function tE(l,t){const o=l.add(t)._unit();return l.x*o.x+l.y*o.y}function yO(l,t,o,c){const f=t.sub(l)._perp()._unit(),d=o.sub(t)._perp()._unit();return rE(l,t,o,tE(f,d),c)}function rE(l,t,o,c,f){const d=Math.sqrt(1-c*c);return Math.min(l.dist(t)/3,t.dist(o)/3,f*d/c)}function Eb(l,t,o){return l.x<o[0].x&&t.x<o[0].x||l.x>o[1].x&&t.x>o[1].x||l.y<o[0].y&&t.y<o[0].y||l.y>o[1].y&&t.y>o[1].y}function nE(l,t){return l.x<t[0].x||l.x>t[1].x||l.y<t[0].y||l.y>t[1].y}function iE(l,t,o){if(l.x<0||l.x>=er||t.x<0||t.x>=er||o.x<0||o.x>=er)return!1;const c=o.sub(t),f=c.perp(),d=l.sub(t);return(c.x*d.x+c.y*d.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(d.x*d.x+d.y*d.y))>-.866&&f.x*d.x+f.y*d.y<0}function oE(l,t,o){const c=t?2|l:-3&l;return o?1|c:-2&c}function sE(){const l=Math.PI/32,t=Math.tan(l),o=V;return o*Math.sqrt(1+2*t*t)-o}function aE(l,t,o){const c=1<<o.z,f=Ee(o.x/c),d=Ee((o.x+1)/c),m=Me(o.y/c),b=Me((o.y+1)/c);return function(C,k,x,S,I=0,T){const E=[];if(!C.length||!x||!S)return E;const A=(J,he)=>{for(const ye of J)E.push({polygon:ye,bounds:he})},z=Math.ceil(Math.log2(x)),B=Math.ceil(Math.log2(S)),U=z-B,G=[];for(let J=0;J<Math.abs(U);J++)G.push(U>0?0:1);for(let J=0;J<Math.min(z,B);J++)G.push(0),G.push(1);let N=C;if(N=t0(N,k[0].y-I,k[1].y+I,1),N=t0(N,k[0].x-I,k[1].x+I,0),!N.length)return E;const Z=[];for(G.length?Z.push({polygons:N,bounds:k,depth:0}):A(N,k);Z.length;){const J=Z.pop(),he=J.depth,ye=G[he],xe=J.bounds[0],me=J.bounds[1],Ae=ye===0?xe.x:xe.y,Te=ye===0?me.x:me.y,Oe=T?T(ye,Ae,Te):.5*(Ae+Te),We=t0(J.polygons,Ae-I,Oe+I,ye),Ze=t0(J.polygons,Oe-I,Te+I,ye);if(We.length){const Ye=[xe,new rt(ye===0?Oe:me.x,ye===1?Oe:me.y)];G.length>he+1?Z.push({polygons:We,bounds:Ye,depth:he+1}):A(We,Ye)}if(Ze.length){const Ye=[new rt(ye===0?Oe:xe.x,ye===1?Oe:xe.y),me];G.length>he+1?Z.push({polygons:Ze,bounds:Ye,depth:he+1}):A(Ze,Ye)}}return E}(l,t,Math.ceil((d-f)/11.25),Math.ceil((m-b)/11.25),1,(C,k,x)=>{if(C===0)return .5*(k+x);{const S=Me((o.y+k/er)/c);return(Se(.5*(Me((o.y+x/er)/c)+S))*c-o.y)*er}})}function _O(l,t,o,c,f,d){const m=Math.pow(2,c.z-f.z);for(let b=0;b<o;b++){let C=l.int16[2*(b+t)+0],k=l.int16[2*(b+t)+1];C=(C+f.x*er)*m-c.x*er,k=(k+f.y*er)*m-c.y*er,d.push(new rt(C,k))}}let lE,cE;function Bm(l,t){return l.x*t.x+l.y*t.y}function uE(l,t){if(l.length===1){let o=0;const c=t[o++];let f;for(;!f||c.equals(f);)if(f=t[o++],!f)return 1/0;for(;o<t.length;o++){const d=t[o],m=l[0],b=f.sub(c),C=d.sub(c),k=m.sub(c),x=Bm(b,b),S=Bm(b,C),I=Bm(C,C),T=Bm(k,b),E=Bm(k,C),A=x*I-S*S,z=(I*T-S*E)/A,B=(x*E-S*T)/A,U=c.z*(1-z-B)+f.z*z+d.z*B;if(isFinite(U))return U}return 1/0}{let o=1/0;for(const c of t)o=Math.min(o,c.z);return o}}function dE(l,t,o,c,f,d,m,b){const C=m*f.getElevationAt(l,t,!0,!0),k=d[0]!==0,x=k?d[1]===0?m*(d[0]/7-450):m*function(S,I,T){const E=Math.floor(I[0]/8),A=Math.floor(I[1]/8),z=10*(I[0]-8*E),B=10*(I[1]-8*A),U=S.getElevationAt(E,A,!0,!0),G=S.getMeterToDEM(T),N=Math.floor(.5*(z*G-1)),Z=Math.floor(.5*(B*G-1)),J=S.tileCoordToPixel(E,A),he=2*N+1,ye=2*Z+1,xe=function(Ze,Ye,Je,at,Qe){return[Ze.getElevationAtPixel(Ye,Je,!0),Ze.getElevationAtPixel(Ye+Qe,Je,!0),Ze.getElevationAtPixel(Ye,Je+Qe,!0),Ze.getElevationAtPixel(Ye+at,Je+Qe,!0)]}(S,J.x-N,J.y-Z,he,ye),me=Math.abs(xe[0]-xe[1]),Ae=Math.abs(xe[2]-xe[3]),Te=Math.abs(xe[0]-xe[2])+Math.abs(xe[1]-xe[3]),Oe=Math.min(.25,.5*G*(me+Ae)/he),We=Math.min(.25,.5*G*Te/ye);return U+Math.max(Oe*z,We*B)}(f,d,b):C;return{base:C+(o===0)?-1:o,top:k?Math.max(x+c,C+o+2):C+c}}ur(o0,"FillExtrusionBucket",{omit:["layers","features"]}),ur(KM,"PartData"),ur(XM,"FootprintSegment"),ur(JM,"BorderCentroidData"),ur(eE,"GroundEffect");const xO=bn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),vO=bn([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:bO}=xO,wO=bn([{name:"a_packed",components:4,type:"Float32"}]),{members:SO}=wO,TO=bn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:CO}=TO;class hE{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.image=new ru({width:t,height:o}),this.positions={},this.uploaded=!1}getDash(t,o){const c=this.getKey(t,o);return this.positions[c]}trim(){const t=this.width,o=this.height=Jn(this.nextRow);this.image.resize({width:t,height:o})}getKey(t,o){return t.join(",")+o}getDashRanges(t,o,c){const f=[];let d=t.length%2==1?-t[t.length-1]*c:0,m=t[0]*c,b=!0;f.push({left:d,right:m,isDash:b,zeroLength:t[0]===0});let C=t[0];for(let k=1;k<t.length;k++){b=!b;const x=t[k];d=C*c,C+=x,m=C*c,f.push({left:d,right:m,isDash:b,zeroLength:x===0})}return f}addRoundDash(t,o,c){const f=o/2;for(let d=-c;d<=c;d++){const m=this.width*(this.nextRow+c+d);let b=0,C=t[b];for(let k=0;k<this.width;k++){k/C.right>1&&(C=t[++b]);const x=Math.abs(k-C.left),S=Math.abs(k-C.right),I=Math.min(x,S);let T;const E=d/c*(f+1);if(C.isDash){const A=f-Math.abs(E);T=Math.sqrt(I*I+A*A)}else T=f-Math.sqrt(I*I+E*E);this.image.data[m+k]=Math.max(0,Math.min(255,T+128))}}}addRegularDash(t,o){for(let C=t.length-1;C>=0;--C){const k=t[C],x=t[C+1];k.zeroLength?t.splice(C,1):x&&x.isDash===k.isDash&&(x.left=k.left,t.splice(C,1))}const c=t[0],f=t[t.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const d=this.width*this.nextRow;let m=0,b=t[m];for(let C=0;C<this.width;C++){C/b.right>1&&(b=t[++m]);const k=Math.abs(C-b.left),x=Math.abs(C-b.right),S=Math.min(k,x);this.image.data[d+C]=Math.max(0,Math.min(255,(b.isDash?S:-S)+o+128))}}addDash(t,o){const c=this.getKey(t,o);if(this.positions[c])return this.positions[c];const f=o==="round",d=f?7:0,m=2*d+1;if(this.nextRow+m>this.height)return hr("LineAtlas out of space"),null;t.length===0&&t.push(1);let b=0;for(let x=0;x<t.length;x++)t[x]<0&&(hr("Negative value is found in line dasharray, replacing values with 0"),t[x]=0),b+=t[x];if(b!==0){const x=this.width/b,S=this.getDashRanges(t,this.width,x);f?this.addRoundDash(S,x,d):this.addRegularDash(S,o==="square"?.5*x:0)}const C=this.nextRow+d;this.nextRow+=m;const k={tl:[C,d],br:[b,0]};return this.positions[c]=k,k}}ur(hE,"LineAtlas");const MO=rp.VectorTileFeature.types,EO=Math.cos(Math.PI/180*37.5),IO=Math.cos(Math.PI/180*5);class Ib{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new fm,this.layoutVertexArray2=new Da,this.patternVertexArray=new yl,this.indexArray=new so,this.programConfigurations=new xl(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new _i,this.maxLineLength=0,this.zOffsetVertexArray=new Yc,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=t.tessellationStep?t.tessellationStep:er/64}updateFootprints(t,o){}populate(t,o,c,f){this.hasPattern=gb("line",this.layers,o);const d=this.layers[0].layout.get("line-sort-key"),m=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!m.isConstant()||!!m.constantOr(0);const b=[];for(const{feature:S,id:I,index:T,sourceLayerIndex:E}of t){const A=this.layers[0]._featureFilter.needGeometry,z=Ut(S,A);if(!this.layers[0]._featureFilter.filter(new yi(this.zoom),z,c))continue;const B=d?d.evaluate(z,{},c):void 0,U={id:I,properties:S.properties,type:S.type,sourceLayerIndex:E,index:T,geometry:A?z.geometry:Vt(S,c,f),patterns:{},sortKey:B};b.push(U)}d&&b.sort((S,I)=>S.sortKey-I.sortKey);const{lineAtlas:C,featureIndex:k}=o,x=this.addConstantDashes(C);for(const S of b){const{geometry:I,index:T,sourceLayerIndex:E}=S;if(x&&this.addFeatureDashes(S,C),this.hasPattern){const A=yb("line",this.layers,S,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(S,I,T,c,C.positions,o.availableImages,o.brightness);k.insert(t[T].feature,I,T,E,this.index)}}addConstantDashes(t){let o=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,d=c.layout.get("line-cap").value;if(f.kind!=="constant"||d.kind!=="constant")o=!0;else{const m=d.value,b=f.value;if(!b)continue;t.addDash(b,m)}}return o}addFeatureDashes(t,o){const c=this.zoom;for(const f of this.layers){const d=f.paint.get("line-dasharray").value,m=f.layout.get("line-cap").value;if(d.kind==="constant"&&m.kind==="constant")continue;let b,C;if(d.kind==="constant"){if(b=d.value,!b)continue}else b=d.evaluate({zoom:c},t);C=m.kind==="constant"?m.value:m.evaluate({zoom:c},t),o.addDash(b,C),t.patterns[f.id]=o.getKey(b,C)}}update(t,o,c,f,d){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,o,m?this.stateDependentLayers:this.layers,c,f,d)}addFeatures(t,o,c,f,d,m){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,c,f,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,SO)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,CO)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,vO.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bO),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,c,f,d,m,b){const C=this.layers[0].layout,k=C.get("line-join").evaluate(t,{}),x=C.get("line-cap").evaluate(t,{}),S=C.get("line-miter-limit"),I=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const T of o)this.addLine(T,t,f,k,x,S,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,d,m,f,b)}addLine(t,o,c,f,d,m,b){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const C={zoom:this.zoom,lineProgress:void 0},k=this.layers[0].layout,x=f==="none";if(this.patternJoinNone=this.hasPattern&&x,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let J=0;J<t.length-1;J++)this.totalDistance+=t[J].dist(t[J+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=MO[o.type]==="Polygon";let I=t.length;for(;I>=2&&t[I-1].equals(t[I-2]);)I--;let T=0;for(;T<I-1&&t[T].equals(t[T+1]);)T++;if(I<(S?3:2))return;f==="bevel"&&(m=1.05);const E=this.overscaling<=16?15*er/(512*this.overscaling):0,A=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let z,B,U,G,N,Z;this.e1=this.e2=-1,S&&(z=t[I-2],N=t[T].sub(z)._unit()._perp());for(let J=T;J<I;J++){if(U=J===I-1?S?t[T+1]:void 0:t[J+1],U&&t[J].equals(U))continue;if(N&&(G=N),z&&(B=z),z=t[J],this.hasZOffset){const Ye=k.get("line-z-offset").value;if(Ye.kind==="constant")Z=Ye.value;else{if(this.lineClips){const Je=this.totalDistance/(this.lineClips.end-this.lineClips.start);C.lineProgress=(Je*this.lineClips.start+this.distance+(B?B.dist(z):0))/Je}else hr(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),C.lineProgress=0;Z=Ye.evaluate(C,o)}Z=Z||0}N=U?U.sub(z)._unit()._perp():G,G=G||N;const he=B&&U;let ye=he?f:S||x?"butt":d;const xe=G.x*N.x+G.y*N.y;if(x){const Ye=function(Je){if(Je.patternJoinNone){const at=Je.segmentPoints.length/2,Qe=Je.lineSoFar-Je.segmentStart;for(let gt=0;gt<at;++gt){const Et=Je.segmentPoints[2*gt+1],dt=Math.round(Je.segmentPoints[2*gt])+.5+.25*Et;Je.patternVertexArray.emplaceBack(dt,Qe,Je.segmentStart),Je.patternVertexArray.emplaceBack(dt,Qe,Je.segmentStart)}Je.segmentPoints.length=0}Je.e1=Je.e2=-1};if(he&&xe<IO){this.updateDistance(B,z),this.addCurrentVertex(z,G,1,1,A,Z),Ye(this),this.addCurrentVertex(z,N,-1,-1,A,Z);continue}if(B){if(!U){this.updateDistance(B,z),this.addCurrentVertex(z,G,1,1,A,Z),Ye(this);continue}ye="miter"}}let me=G.add(N);me.x===0&&me.y===0||me._unit();const Ae=me.x*N.x+me.y*N.y,Te=Ae!==0?1/Ae:1/0,Oe=2*Math.sqrt(2-2*Ae),We=Ae<EO&&B&&U,Ze=G.x*N.y-G.y*N.x>0;if(We&&J>T){const Ye=z.dist(B);if(Ye>2*E){const Je=z.sub(z.sub(B)._mult(E/Ye)._round());this.updateDistance(B,Je),this.addCurrentVertex(Je,G,0,0,A,Z),B=Je}}if(he&&ye==="round"&&(Te<b?ye="miter":Te<=2&&(ye="fakeround")),ye==="miter"&&Te>m&&(ye="bevel"),ye==="bevel"&&(Te>2&&(ye="flipbevel"),Te<m&&(ye="miter")),B&&this.updateDistance(B,z),ye==="miter")me._mult(Te),this.addCurrentVertex(z,me,0,0,A,Z);else if(ye==="flipbevel"){if(Te>100)me=N.mult(-1);else{const Ye=Te*G.add(N).mag()/G.sub(N).mag();me._perp()._mult(Ye*(Ze?-1:1))}this.addCurrentVertex(z,me,0,0,A,Z),this.addCurrentVertex(z,me.mult(-1),0,0,A,Z)}else if(ye==="bevel"||ye==="fakeround"){const Ye=-Math.sqrt(Te*Te-1),Je=Ze?Ye:0,at=Ze?0:Ye;if(B&&this.addCurrentVertex(z,G,Je,at,A,Z),ye==="fakeround"){const Qe=Math.round(180*Oe/Math.PI/20);for(let gt=1;gt<Qe;gt++){let Et=gt/Qe;if(Et!==.5){const sr=Et-.5;Et+=Et*sr*(Et-1)*((1.0904+xe*(xe*(3.55645-1.43519*xe)-3.2452))*sr*sr+(.848013+xe*(.215638*xe-1.06021)))}const dt=N.sub(G)._mult(Et)._add(G)._unit()._mult(Ze?-1:1);this.addHalfVertex(z,dt.x,dt.y,!1,Ze,0,A,Z)}}U&&this.addCurrentVertex(z,N,-Je,-at,A,Z)}else ye==="butt"?this.addCurrentVertex(z,me,0,0,A,Z):ye==="square"?(B||this.addCurrentVertex(z,me,-1,-1,A,Z),this.addCurrentVertex(z,me,0,0,A,Z),B&&this.addCurrentVertex(z,me,1,1,A,Z)):ye==="round"&&(B&&(this.addCurrentVertex(z,G,0,0,A,Z),this.addCurrentVertex(z,G,1,1,A,Z,!0)),U&&(this.addCurrentVertex(z,N,-1,-1,A,Z,!0),this.addCurrentVertex(z,N,0,0,A,Z)));if(We&&J<I-1){const Ye=z.dist(U);if(Ye>2*E){const Je=z.add(U.sub(z)._mult(E/Ye)._round());this.updateDistance(z,Je),this.addCurrentVertex(Je,N,0,0,A,Z),z=Je}}}}addVerticesTo(t,o,c,f,d,m,b,C,k,x){const S=(o.w-t.w)/this.tessellationStep|0;if(S>1){this.lineSoFar=t.w;const I=(o.x-t.x)/S,T=(o.y-t.y)/S,E=(o.z-t.z)/S,A=(o.w-t.w)/S;for(let z=1;z<S;++z)t.x+=I,t.y+=T,t.z+=E,this.lineSoFar+=A,this.addHalfVertex(t,c,f,x,!1,b,k,t.z),this.addHalfVertex(t,d,m,x,!0,-C,k,t.z)}this.lineSoFar=o.w,this.addHalfVertex(o,c,f,x,!1,b,k,o.z),this.addHalfVertex(o,d,m,x,!0,-C,k,o.z)}addCurrentVertex(t,o,c,f,d,m,b=!1){const C=o.x+o.y*c,k=o.y-o.x*c,x=o.y*f-o.x,S=-o.y-o.x*f;if(m!=null){const T=er+10,E=m,A=new BM(t.x,t.y,E,this.lineSoFar),z=pE(t,-10,T),B=this.lineSoFar;if(this.currentVertex)if(z){const U=this.currentVertexIsOutside,G=this.currentVertex,N=new BM(t.x,t.y,E,this.lineSoFar);NM(G,N,-10,T),pE(N,-10,T)||(U&&(this.e1=this.e2=-1,this.lineSoFar=G.w,this.addHalfVertex(G,C,k,b,!1,c,d,G.z),this.addHalfVertex(G,x,S,b,!0,-f,d,G.z)),this.addVerticesTo(G,N,C,k,x,S,c,f,d,b))}else{const U=this.currentVertex;this.currentVertexIsOutside&&(NM(U,A,-10,T),this.e1=this.e2=-1,this.lineSoFar=U.w,this.addHalfVertex(U,C,k,b,!1,c,d,U.z),this.addHalfVertex(U,x,S,b,!0,-f,d,U.z)),this.addVerticesTo(U,A,C,k,x,S,c,f,d,b)}else z||(this.addHalfVertex(t,C,k,b,!1,c,d,m),this.addHalfVertex(t,x,S,b,!0,-f,d,m));this.currentVertex=A,this.currentVertexIsOutside=z,this.lineSoFar=B}else this.addHalfVertex(t,C,k,b,!1,c,d,m),this.addHalfVertex(t,x,S,b,!0,-f,d,m)}addHalfVertex({x:t,y:o},c,f,d,m,b,C,k){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),m||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((t<<1)+(d?1:0),(o<<1)+(m?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const x=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),C.primitiveLength++),m?this.e2=x:this.e1=x,k!=null&&this.zOffsetVertexArray.emplaceBack(k)}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}function pE(l,t,o){return l.x<t||l.x>o||l.y<t||l.y>o}let fE,mE;function gE(l,t,o){return t*(er/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}function yE(l,t){return 1/gE(l,1,t.tileZoom)}function _E(l,t,o,c){return l.translatePosMatrix(c||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}ur(Ib,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const xE=l=>{const t=[];vE(l)&&t.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const o=l.paint.get("line-trim-offset");o[0]===0&&o[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER");const c=l.layout.get("line-join").constantOr("miter")==="none",f=!!l.paint.get("line-pattern").constantOr(1);return c&&f&&t.push("LINE_JOIN_NONE"),t};function vE(l){const t=l.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}let kb;const bE=()=>kb||(kb={layout:fE||(fE=new ci({"line-cap":new _r(st.layout_line["line-cap"]),"line-join":new _r(st.layout_line["line-join"]),"line-miter-limit":new Zt(st.layout_line["line-miter-limit"]),"line-round-limit":new Zt(st.layout_line["line-round-limit"]),"line-sort-key":new _r(st.layout_line["line-sort-key"]),"line-z-offset":new _r(st.layout_line["line-z-offset"]),visibility:new Zt(st.layout_line.visibility)})),paint:mE||(mE=new ci({"line-opacity":new _r(st.paint_line["line-opacity"]),"line-color":new _r(st.paint_line["line-color"]),"line-translate":new Zt(st.paint_line["line-translate"]),"line-translate-anchor":new Zt(st.paint_line["line-translate-anchor"]),"line-width":new _r(st.paint_line["line-width"]),"line-gap-width":new _r(st.paint_line["line-gap-width"]),"line-offset":new _r(st.paint_line["line-offset"]),"line-blur":new _r(st.paint_line["line-blur"]),"line-dasharray":new _r(st.paint_line["line-dasharray"]),"line-pattern":new _r(st.paint_line["line-pattern"]),"line-gradient":new Rs(st.paint_line["line-gradient"]),"line-trim-offset":new Zt(st.paint_line["line-trim-offset"]),"line-trim-fade-range":new Zt(st.paint_line["line-trim-fade-range"]),"line-trim-color":new Zt(st.paint_line["line-trim-color"]),"line-emissive-strength":new Zt(st.paint_line["line-emissive-strength"]),"line-border-width":new _r(st.paint_line["line-border-width"]),"line-border-color":new _r(st.paint_line["line-border-color"]),"line-occlusion-opacity":new Zt(st.paint_line["line-occlusion-opacity"])}))},kb);class kO extends _r{possiblyEvaluate(t,o){return o=new yi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(t,o)}evaluate(t,o,c,f){return o=Qr({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,c,f)}}let jm;function wE(l,t){return t>0?t+2*l:l}const PO=bn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),AO=bn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),DO=bn([{name:"a_projected_pos",components:4,type:"Float32"}],4);bn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const RO=bn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),LO=bn([{name:"a_texb",components:2,type:"Uint16"}]),zO=bn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),OO=bn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const SE=bn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),FO=bn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);bn([{name:"triangle",components:3,type:"Uint16"}]),bn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),bn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),bn([{type:"Float32",name:"offsetX"}]),bn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var po=24;const Fa=128;function Pb(l,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new yi(l+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=o;let d=0;for(;d<c.length&&c[d]<=l;)d++;d=Math.max(0,d-1);let m=d;for(;m<c.length&&c[m]<l+1;)m++;m=Math.min(c.length-1,m);const b=c[d],C=c[m];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:C,interpolationType:f}:{kind:"camera",minZoom:b,maxZoom:C,minSize:o.evaluate(new yi(b)),maxSize:o.evaluate(new yi(C)),interpolationType:f}}}function s0(l,{uSize:t,uSizeT:o},{lowerSize:c,upperSize:f}){return l.kind==="source"?c/Fa:l.kind==="composite"?Pr(c/Fa,f/Fa,o):t}function np(l,t){let o=0,c=0;if(l.kind==="constant")c=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:f,minZoom:d,maxZoom:m}=l,b=f?Xt(is.interpolationFactor(f,t,d,m),0,1):0;l.kind==="camera"?c=Pr(l.minSize,l.maxSize,b):o=b}return{uSizeT:o,uSize:c}}var BO=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Fa,evaluateSizeForFeature:s0,evaluateSizeForZoom:np,getSizeData:Pb});function jO(l,t,o){return l.sections.forEach(c=>{c.text=function(f,d,m){const b=d.layout.get("text-transform").evaluate(m,{});return b==="uppercase"?f=f.toLocaleUpperCase():b==="lowercase"&&(f=f.toLocaleLowerCase()),Go.applyArabicShaping&&(f=Go.applyArabicShaping(f)),f}(c.text,t,o)}),l}const Nm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function NO(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}function VO(l){return l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""||l===""}var TE,Ab,CE,Db={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function $O(){return TE||(TE=1,Db.read=function(l,t,o,c,f){var d,m,b=8*f-c-1,C=(1<<b)-1,k=C>>1,x=-7,S=o?f-1:0,I=o?-1:1,T=l[t+S];for(S+=I,d=T&(1<<-x)-1,T>>=-x,x+=b;x>0;d=256*d+l[t+S],S+=I,x-=8);for(m=d&(1<<-x)-1,d>>=-x,x+=c;x>0;m=256*m+l[t+S],S+=I,x-=8);if(d===0)d=1-k;else{if(d===C)return m?NaN:1/0*(T?-1:1);m+=Math.pow(2,c),d-=k}return(T?-1:1)*m*Math.pow(2,d-c)},Db.write=function(l,t,o,c,f,d){var m,b,C,k=8*d-f-1,x=(1<<k)-1,S=x>>1,I=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=c?0:d-1,E=c?1:-1,A=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,m=x):(m=Math.floor(Math.log(t)/Math.LN2),t*(C=Math.pow(2,-m))<1&&(m--,C*=2),(t+=m+S>=1?I/C:I*Math.pow(2,1-S))*C>=2&&(m++,C/=2),m+S>=x?(b=0,m=x):m+S>=1?(b=(t*C-1)*Math.pow(2,f),m+=S):(b=t*Math.pow(2,S-1)*Math.pow(2,f),m=0));f>=8;l[o+T]=255&b,T+=E,b/=256,f-=8);for(m=m<<f|b,k+=f;k>0;l[o+T]=255&m,T+=E,m/=256,k-=8);l[o+T-E]|=128*A}),Db}function ME(){if(CE)return Ab;CE=1,Ab=t;var l=$O();function t(N){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(N)?N:new Uint8Array(N||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var o=4294967296,c=1/o,f=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function d(N){return N.type===t.Bytes?N.readVarint()+N.pos:N.pos+1}function m(N,Z,J){return J?4294967296*Z+(N>>>0):4294967296*(Z>>>0)+(N>>>0)}function b(N,Z,J){var he=Z<=16383?1:Z<=2097151?2:Z<=268435455?3:Math.floor(Math.log(Z)/(7*Math.LN2));J.realloc(he);for(var ye=J.pos-1;ye>=N;ye--)J.buf[ye+he]=J.buf[ye]}function C(N,Z){for(var J=0;J<N.length;J++)Z.writeVarint(N[J])}function k(N,Z){for(var J=0;J<N.length;J++)Z.writeSVarint(N[J])}function x(N,Z){for(var J=0;J<N.length;J++)Z.writeFloat(N[J])}function S(N,Z){for(var J=0;J<N.length;J++)Z.writeDouble(N[J])}function I(N,Z){for(var J=0;J<N.length;J++)Z.writeBoolean(N[J])}function T(N,Z){for(var J=0;J<N.length;J++)Z.writeFixed32(N[J])}function E(N,Z){for(var J=0;J<N.length;J++)Z.writeSFixed32(N[J])}function A(N,Z){for(var J=0;J<N.length;J++)Z.writeFixed64(N[J])}function z(N,Z){for(var J=0;J<N.length;J++)Z.writeSFixed64(N[J])}function B(N,Z){return(N[Z]|N[Z+1]<<8|N[Z+2]<<16)+16777216*N[Z+3]}function U(N,Z,J){N[J]=Z,N[J+1]=Z>>>8,N[J+2]=Z>>>16,N[J+3]=Z>>>24}function G(N,Z){return(N[Z]|N[Z+1]<<8|N[Z+2]<<16)+(N[Z+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(N,Z,J){for(J=J||this.length;this.pos<J;){var he=this.readVarint(),ye=he>>3,xe=this.pos;this.type=7&he,N(ye,Z,this),this.pos===xe&&this.skip(he)}return Z},readMessage:function(N,Z){return this.readFields(N,Z,this.readVarint()+this.pos)},readFixed32:function(){var N=B(this.buf,this.pos);return this.pos+=4,N},readSFixed32:function(){var N=G(this.buf,this.pos);return this.pos+=4,N},readFixed64:function(){var N=B(this.buf,this.pos)+B(this.buf,this.pos+4)*o;return this.pos+=8,N},readSFixed64:function(){var N=B(this.buf,this.pos)+G(this.buf,this.pos+4)*o;return this.pos+=8,N},readFloat:function(){var N=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,N},readDouble:function(){var N=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,N},readVarint:function(N){var Z,J,he=this.buf;return Z=127&(J=he[this.pos++]),J<128?Z:(Z|=(127&(J=he[this.pos++]))<<7,J<128?Z:(Z|=(127&(J=he[this.pos++]))<<14,J<128?Z:(Z|=(127&(J=he[this.pos++]))<<21,J<128?Z:function(ye,xe,me){var Ae,Te,Oe=me.buf;if(Ae=(112&(Te=Oe[me.pos++]))>>4,Te<128||(Ae|=(127&(Te=Oe[me.pos++]))<<3,Te<128)||(Ae|=(127&(Te=Oe[me.pos++]))<<10,Te<128)||(Ae|=(127&(Te=Oe[me.pos++]))<<17,Te<128)||(Ae|=(127&(Te=Oe[me.pos++]))<<24,Te<128)||(Ae|=(1&(Te=Oe[me.pos++]))<<31,Te<128))return m(ye,Ae,xe);throw new Error("Expected varint not more than 10 bytes")}(Z|=(15&(J=he[this.pos]))<<28,N,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var N=this.readVarint();return N%2==1?(N+1)/-2:N/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var N=this.readVarint()+this.pos,Z=this.pos;return this.pos=N,N-Z>=12&&f?function(J,he,ye){return f.decode(J.subarray(he,ye))}(this.buf,Z,N):function(J,he,ye){for(var xe="",me=he;me<ye;){var Ae,Te,Oe,We=J[me],Ze=null,Ye=We>239?4:We>223?3:We>191?2:1;if(me+Ye>ye)break;Ye===1?We<128&&(Ze=We):Ye===2?(192&(Ae=J[me+1]))==128&&(Ze=(31&We)<<6|63&Ae)<=127&&(Ze=null):Ye===3?(Te=J[me+2],(192&(Ae=J[me+1]))==128&&(192&Te)==128&&((Ze=(15&We)<<12|(63&Ae)<<6|63&Te)<=2047||Ze>=55296&&Ze<=57343)&&(Ze=null)):Ye===4&&(Te=J[me+2],Oe=J[me+3],(192&(Ae=J[me+1]))==128&&(192&Te)==128&&(192&Oe)==128&&((Ze=(15&We)<<18|(63&Ae)<<12|(63&Te)<<6|63&Oe)<=65535||Ze>=1114112)&&(Ze=null)),Ze===null?(Ze=65533,Ye=1):Ze>65535&&(Ze-=65536,xe+=String.fromCharCode(Ze>>>10&1023|55296),Ze=56320|1023&Ze),xe+=String.fromCharCode(Ze),me+=Ye}return xe}(this.buf,Z,N)},readBytes:function(){var N=this.readVarint()+this.pos,Z=this.buf.subarray(this.pos,N);return this.pos=N,Z},readPackedVarint:function(N,Z){if(this.type!==t.Bytes)return N.push(this.readVarint(Z));var J=d(this);for(N=N||[];this.pos<J;)N.push(this.readVarint(Z));return N},readPackedSVarint:function(N){if(this.type!==t.Bytes)return N.push(this.readSVarint());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readSVarint());return N},readPackedBoolean:function(N){if(this.type!==t.Bytes)return N.push(this.readBoolean());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readBoolean());return N},readPackedFloat:function(N){if(this.type!==t.Bytes)return N.push(this.readFloat());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readFloat());return N},readPackedDouble:function(N){if(this.type!==t.Bytes)return N.push(this.readDouble());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readDouble());return N},readPackedFixed32:function(N){if(this.type!==t.Bytes)return N.push(this.readFixed32());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readFixed32());return N},readPackedSFixed32:function(N){if(this.type!==t.Bytes)return N.push(this.readSFixed32());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readSFixed32());return N},readPackedFixed64:function(N){if(this.type!==t.Bytes)return N.push(this.readFixed64());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readFixed64());return N},readPackedSFixed64:function(N){if(this.type!==t.Bytes)return N.push(this.readSFixed64());var Z=d(this);for(N=N||[];this.pos<Z;)N.push(this.readSFixed64());return N},skip:function(N){var Z=7&N;if(Z===t.Varint)for(;this.buf[this.pos++]>127;);else if(Z===t.Bytes)this.pos=this.readVarint()+this.pos;else if(Z===t.Fixed32)this.pos+=4;else{if(Z!==t.Fixed64)throw new Error("Unimplemented type: "+Z);this.pos+=8}},writeTag:function(N,Z){this.writeVarint(N<<3|Z)},realloc:function(N){for(var Z=this.length||16;Z<this.pos+N;)Z*=2;if(Z!==this.length){var J=new Uint8Array(Z);J.set(this.buf),this.buf=J,this.length=Z}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(N){this.realloc(4),U(this.buf,N,this.pos),this.pos+=4},writeSFixed32:function(N){this.realloc(4),U(this.buf,N,this.pos),this.pos+=4},writeFixed64:function(N){this.realloc(8),U(this.buf,-1&N,this.pos),U(this.buf,Math.floor(N*c),this.pos+4),this.pos+=8},writeSFixed64:function(N){this.realloc(8),U(this.buf,-1&N,this.pos),U(this.buf,Math.floor(N*c),this.pos+4),this.pos+=8},writeVarint:function(N){(N=+N||0)>268435455||N<0?function(Z,J){var he,ye;if(Z>=0?(he=Z%4294967296|0,ye=Z/4294967296|0):(ye=~(-Z/4294967296),4294967295^(he=~(-Z%4294967296))?he=he+1|0:(he=0,ye=ye+1|0)),Z>=18446744073709552e3||Z<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");J.realloc(10),function(xe,me,Ae){Ae.buf[Ae.pos++]=127&xe|128,xe>>>=7,Ae.buf[Ae.pos++]=127&xe|128,xe>>>=7,Ae.buf[Ae.pos++]=127&xe|128,xe>>>=7,Ae.buf[Ae.pos++]=127&xe|128,Ae.buf[Ae.pos]=127&(xe>>>=7)}(he,0,J),function(xe,me){var Ae=(7&xe)<<4;me.buf[me.pos++]|=Ae|((xe>>>=3)?128:0),xe&&(me.buf[me.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(me.buf[me.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(me.buf[me.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(me.buf[me.pos++]=127&xe|((xe>>>=7)?128:0),xe&&(me.buf[me.pos++]=127&xe)))))}(ye,J)}(N,this):(this.realloc(4),this.buf[this.pos++]=127&N|(N>127?128:0),N<=127||(this.buf[this.pos++]=127&(N>>>=7)|(N>127?128:0),N<=127||(this.buf[this.pos++]=127&(N>>>=7)|(N>127?128:0),N<=127||(this.buf[this.pos++]=N>>>7&127))))},writeSVarint:function(N){this.writeVarint(N<0?2*-N-1:2*N)},writeBoolean:function(N){this.writeVarint(!!N)},writeString:function(N){N=String(N),this.realloc(4*N.length),this.pos++;var Z=this.pos;this.pos=function(he,ye,xe){for(var me,Ae,Te=0;Te<ye.length;Te++){if((me=ye.charCodeAt(Te))>55295&&me<57344){if(!Ae){me>56319||Te+1===ye.length?(he[xe++]=239,he[xe++]=191,he[xe++]=189):Ae=me;continue}if(me<56320){he[xe++]=239,he[xe++]=191,he[xe++]=189,Ae=me;continue}me=Ae-55296<<10|me-56320|65536,Ae=null}else Ae&&(he[xe++]=239,he[xe++]=191,he[xe++]=189,Ae=null);me<128?he[xe++]=me:(me<2048?he[xe++]=me>>6|192:(me<65536?he[xe++]=me>>12|224:(he[xe++]=me>>18|240,he[xe++]=me>>12&63|128),he[xe++]=me>>6&63|128),he[xe++]=63&me|128)}return xe}(this.buf,N,this.pos);var J=this.pos-Z;J>=128&&b(Z,J,this),this.pos=Z-1,this.writeVarint(J),this.pos+=J},writeFloat:function(N){this.realloc(4),l.write(this.buf,N,this.pos,!0,23,4),this.pos+=4},writeDouble:function(N){this.realloc(8),l.write(this.buf,N,this.pos,!0,52,8),this.pos+=8},writeBytes:function(N){var Z=N.length;this.writeVarint(Z),this.realloc(Z);for(var J=0;J<Z;J++)this.buf[this.pos++]=N[J]},writeRawMessage:function(N,Z){this.pos++;var J=this.pos;N(Z,this);var he=this.pos-J;he>=128&&b(J,he,this),this.pos=J-1,this.writeVarint(he),this.pos+=he},writeMessage:function(N,Z,J){this.writeTag(N,t.Bytes),this.writeRawMessage(Z,J)},writePackedVarint:function(N,Z){Z.length&&this.writeMessage(N,C,Z)},writePackedSVarint:function(N,Z){Z.length&&this.writeMessage(N,k,Z)},writePackedBoolean:function(N,Z){Z.length&&this.writeMessage(N,I,Z)},writePackedFloat:function(N,Z){Z.length&&this.writeMessage(N,x,Z)},writePackedDouble:function(N,Z){Z.length&&this.writeMessage(N,S,Z)},writePackedFixed32:function(N,Z){Z.length&&this.writeMessage(N,T,Z)},writePackedSFixed32:function(N,Z){Z.length&&this.writeMessage(N,E,Z)},writePackedFixed64:function(N,Z){Z.length&&this.writeMessage(N,A,Z)},writePackedSFixed64:function(N,Z){Z.length&&this.writeMessage(N,z,Z)},writeBytesField:function(N,Z){this.writeTag(N,t.Bytes),this.writeBytes(Z)},writeFixed32Field:function(N,Z){this.writeTag(N,t.Fixed32),this.writeFixed32(Z)},writeSFixed32Field:function(N,Z){this.writeTag(N,t.Fixed32),this.writeSFixed32(Z)},writeFixed64Field:function(N,Z){this.writeTag(N,t.Fixed64),this.writeFixed64(Z)},writeSFixed64Field:function(N,Z){this.writeTag(N,t.Fixed64),this.writeSFixed64(Z)},writeVarintField:function(N,Z){this.writeTag(N,t.Varint),this.writeVarint(Z)},writeSVarintField:function(N,Z){this.writeTag(N,t.Varint),this.writeSVarint(Z)},writeStringField:function(N,Z){this.writeTag(N,t.Bytes),this.writeString(Z)},writeFloatField:function(N,Z){this.writeTag(N,t.Fixed32),this.writeFloat(Z)},writeDoubleField:function(N,Z){this.writeTag(N,t.Fixed64),this.writeDouble(Z)},writeBooleanField:function(N,Z){this.writeVarintField(N,!!Z)}},Ab}var a0=j(ME());const Rb=3;function UO(l,t,o){t.glyphs=[],l===1&&o.readMessage(WO,t)}function WO(l,t,o){if(l===3){const{id:c,bitmap:f,width:d,height:m,left:b,top:C,advance:k}=o.readMessage(GO,{});t.glyphs.push({id:c,bitmap:new ru({width:d+2*Rb,height:m+2*Rb},f),metrics:{width:d,height:m,left:b,top:C,advance:k}})}else l===4?t.ascender=o.readSVarint():l===5&&(t.descender=o.readSVarint())}function GO(l,t,o){l===1?t.id=o.readVarint():l===2?t.bitmap=o.readBytes():l===3?t.width=o.readVarint():l===4?t.height=o.readVarint():l===5?t.left=o.readSVarint():l===6?t.top=o.readSVarint():l===7&&(t.advance=o.readVarint())}const EE=Rb,Os={horizontal:1,vertical:2,horizontalOnly:3};class Vm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const c=new Vm;return c.scale=t||1,c.fontStack=o,c}static forImage(t){const o=new Vm;return o.imageName=t,o}}class ip{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const c=new ip;for(let f=0;f<t.sections.length;f++){const d=t.sections[f];d.image?c.addImageSection(d):c.addTextSection(d,o)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(o,c){let f="";for(let d=0;d<o.length;d++){const m=o.charCodeAt(d+1)||null,b=o.charCodeAt(d-1)||null;f+=!c&&(m&&id(m)&&!Nm[o[d+1]]||b&&id(b)&&!Nm[o[d-1]])||!Nm[o[d]]?o[d]:Nm[o[d]]}return f}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&l0[this.text.charCodeAt(c)];c++)t++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&l0[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const c=new ip;return c.text=this.text.substring(t,o),c.sectionIndex=this.sectionIndex.slice(t,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(Vm.forText(t.scale,t.fontStack||o));const c=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(c)}addImageSection(t){const o=t.image?t.image.namePrimary:"";if(o.length===0)return void hr("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(Vm.forImage(o)),this.sectionIndex.push(this.sections.length-1)):hr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lb(l,t,o,c,f,d,m,b,C,k,x,S,I,T,E){const A=ip.fromFeature(l,f);S===Os.vertical&&A.verticalizePunctuation(I);let z=[];const B=function(J,he,ye,xe,me,Ae){if(!J)return[];const Te=[],Oe=function(Je,at,Qe,gt,Et,dt){let sr=0;for(let Jt=0;Jt<Je.length();Jt++){const $t=Je.getSection(Jt);sr+=IE(Je.getCodePoint(Jt),$t,gt,Et,at,dt)}return sr/Math.max(1,Math.ceil(sr/Qe))}(J,he,ye,xe,me,Ae),We=J.text.indexOf("")>=0;let Ze=0;for(let Je=0;Je<J.length();Je++){const at=J.getSection(Je),Qe=J.getCodePoint(Je);if(l0[Qe]||(Ze+=IE(Qe,at,xe,me,he,Ae)),Je<J.length()-1){const gt=!((Ye=Qe)<11904||!(yr["Bopomofo Extended"](Ye)||yr.Bopomofo(Ye)||yr["CJK Compatibility Forms"](Ye)||yr["CJK Compatibility Ideographs"](Ye)||yr["CJK Compatibility"](Ye)||yr["CJK Radicals Supplement"](Ye)||yr["CJK Strokes"](Ye)||yr["CJK Symbols and Punctuation"](Ye)||yr["CJK Unified Ideographs Extension A"](Ye)||yr["CJK Unified Ideographs"](Ye)||yr["Enclosed CJK Letters and Months"](Ye)||yr["Halfwidth and Fullwidth Forms"](Ye)||yr.Hiragana(Ye)||yr["Ideographic Description Characters"](Ye)||yr["Kangxi Radicals"](Ye)||yr["Katakana Phonetic Extensions"](Ye)||yr.Katakana(Ye)||yr["Vertical Forms"](Ye)||yr["Yi Radicals"](Ye)||yr["Yi Syllables"](Ye)));(HO[Qe]||gt||at.imageName)&&Te.push(PE(Je+1,Ze,Oe,Te,qO(Qe,J.getCodePoint(Je+1),gt&&We),!1))}}var Ye;return AE(PE(J.length(),Ze,Oe,Te,0,!0))}(A,k,d,t,c,T),{processBidirectionalText:U,processStyledBidirectionalText:G}=Go;if(U&&A.sections.length===1){const J=U(A.toString(),B);for(const he of J){const ye=new ip;ye.text=he,ye.sections=A.sections;for(let xe=0;xe<he.length;xe++)ye.sectionIndex.push(0);z.push(ye)}}else if(G){const J=G(A.text,A.sectionIndex,B);for(const he of J){const ye=new ip;ye.text=he[0],ye.sectionIndex=he[1],ye.sections=A.sections,z.push(ye)}}else z=function(J,he){const ye=[],xe=J.text;let me=0;for(const Ae of he)ye.push(J.substring(me,Ae)),me=Ae;return me<xe.length&&ye.push(J.substring(me,xe.length)),ye}(A,B);const N=[],Z={positionedLines:N,text:A.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:S,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(J,he,ye,xe,me,Ae,Te,Oe,We,Ze,Ye,Je){let at=0,Qe=0,gt=0;const Et=Oe==="right"?1:Oe==="left"?0:.5;let dt=!1;for(const ir of me){const cr=ir.getSections();for(const Vr of cr){if(Vr.imageName)continue;const tn=he[Vr.fontStack];if(tn&&(dt=tn.ascender!==void 0&&tn.descender!==void 0,!dt))break}if(!dt)break}let sr=0;for(const ir of me){ir.trim();const cr=ir.getMaxScale(),Vr=(cr-1)*po,tn={positionedGlyphs:[],lineOffset:0};J.positionedLines[sr]=tn;const Xr=tn.positionedGlyphs;let Kr=0;if(!ir.length()){Qe+=Ae,++sr;continue}let on=0,an=0;for(let Rn=0;Rn<ir.length();Rn++){const $r=ir.getSection(Rn),Cn=ir.getSectionIndex(Rn),In=ir.getCodePoint(Rn);let ei=$r.scale,Si=null,Oi=null,Ti=null,fi=po,ro=0;const ji=!(We===Os.horizontal||!Ye&&!Fh(In)||Ye&&(l0[In]||(Jt=In,yr.Arabic(Jt)||yr["Arabic Supplement"](Jt)||yr["Arabic Extended-A"](Jt)||yr["Arabic Presentation Forms-A"](Jt)||yr["Arabic Presentation Forms-B"](Jt))));if($r.imageName){const fo=xe[$r.imageName];if(!fo)continue;Ti=$r.imageName,J.iconsInText=J.iconsInText||!0,Oi=fo.paddedRect;const Xn=fo.displaySize;ei=ei*po/Je,Si={width:Xn[0],height:Xn[1],left:0,top:-EE,advance:ji?Xn[1]:Xn[0],localGlyph:!1},ro=dt?-Si.height*ei:cr*po-17-Xn[1]*ei,fi=Si.advance;const as=(ji?Xn[0]:Xn[1])*ei-po*cr;as>0&&as>Kr&&(Kr=as)}else{const fo=ye[$r.fontStack];if(!fo)continue;fo[In]&&(Oi=fo[In]);const Xn=he[$r.fontStack];if(!Xn)continue;const as=Xn.glyphs[In];if(!as)continue;if(Si=as.metrics,fi=In!==8203?po:0,dt){const $a=Xn.ascender!==void 0?Math.abs(Xn.ascender):0,ca=Xn.descender!==void 0?Math.abs(Xn.descender):0,ua=($a+ca)*ei;on<ua&&(on=ua,an=($a-ca)/2*ei),ro=-$a*ei}else ro=(cr-ei)*po-17}ji?(J.verticalizable=!0,Xr.push({glyph:In,imageName:Ti,x:at,y:Qe+ro,vertical:ji,scale:ei,localGlyph:Si.localGlyph,fontStack:$r.fontStack,sectionIndex:Cn,metrics:Si,rect:Oi}),at+=fi*ei+Ze):(Xr.push({glyph:In,imageName:Ti,x:at,y:Qe+ro,vertical:ji,scale:ei,localGlyph:Si.localGlyph,fontStack:$r.fontStack,sectionIndex:Cn,metrics:Si,rect:Oi}),at+=Si.advance*ei+Ze)}Xr.length!==0&&(gt=Math.max(at-Ze,gt),dt?DE(Xr,Et,Kr,an,Ae*cr/2):DE(Xr,Et,Kr,0,Ae/2)),at=0;const Wn=Ae*cr+Kr;tn.lineOffset=Math.max(Kr,Vr),Qe+=Wn,++sr}var Jt;const $t=Qe,{horizontalAlign:Dt,verticalAlign:vr}=zb(Te);(function(ir,cr,Vr,tn,Xr,Kr){const on=(cr-Vr)*Xr,an=-Kr*tn;for(const Wn of ir)for(const Rn of Wn.positionedGlyphs)Rn.x+=on,Rn.y+=an})(J.positionedLines,Et,Dt,vr,gt,$t),J.top+=-vr*$t,J.bottom=J.top+$t,J.left+=-Dt*gt,J.right=J.left+gt,J.hasBaseline=dt}(Z,t,o,c,z,m,b,C,S,k,I,E),!function(J){for(const he of J)if(he.positionedGlyphs.length!==0)return!1;return!0}(N)&&Z}const l0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},HO={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function IE(l,t,o,c,f,d){if(t.imageName){const m=c[t.imageName];return m?m.displaySize[0]*t.scale*po/d+f:0}{const m=o[t.fontStack],b=m&&m.glyphs[l];return b?b.metrics.advance*t.scale+f:0}}function kE(l,t,o,c){const f=Math.pow(l-t,2);return c?l<t?f/2:2*f:f+Math.abs(o)*o}function qO(l,t,o){let c=0;return l===10&&(c-=1e4),o&&(c+=150),l!==40&&l!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function PE(l,t,o,c,f,d){let m=null,b=kE(t,o,f,d);for(const C of c){const k=kE(t-C.x,o,f,d)+C.badness;k<=b&&(m=C,b=k)}return{index:l,x:t,priorBreak:m,badness:b}}function AE(l){return l?AE(l.priorBreak).concat(l.index):[]}function zb(l){let t=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function DE(l,t,o,c,f){if(!(t||o||c||f))return;const d=l.length-1,m=l[d],b=(m.x+m.metrics.advance*m.scale)*t;for(let C=0;C<=d;C++)l[C].x-=b,l[C].y+=o+c+f}function ZO(l,t,o,c){const{horizontalAlign:f,verticalAlign:d}=zb(c),m=o[0]-l.displaySize[0]*f,b=o[1]-l.displaySize[1]*d;return{imagePrimary:l,imageSecondary:t,top:b,bottom:b+l.displaySize[1],left:m,right:m+l.displaySize[0]}}function RE(l,t,o,c,f,d){const m=l.imagePrimary;let b;if(m.content){const z=m.content,B=m.pixelRatio||1;b=[z[0]/B,z[1]/B,m.displaySize[0]-z[2]/B,m.displaySize[1]-z[3]/B]}const C=t.left*d,k=t.right*d;let x,S,I,T;o==="width"||o==="both"?(T=f[0]+C-c[3],S=f[0]+k+c[1]):(T=f[0]+(C+k-m.displaySize[0])/2,S=T+m.displaySize[0]);const E=t.top*d,A=t.bottom*d;return o==="height"||o==="both"?(x=f[1]+E-c[0],I=f[1]+A+c[2]):(x=f[1]+(E+A-m.displaySize[1])/2,I=x+m.displaySize[1]),{imagePrimary:m,imageSecondary:void 0,top:x,right:S,bottom:I,left:T,collisionPadding:b}}class nc extends rt{constructor(t,o,c,f,d){super(t,o),this.angle=f,this.z=c,d!==void 0&&(this.segment=d)}clone(){return new nc(this.x,this.y,this.z,this.angle,this.segment)}}function LE(l,t,o,c,f){if(t.segment===void 0)return!0;let d=t,m=t.segment+1,b=0;for(;b>-o/2;){if(m--,m<0)return!1;b-=l[m].dist(d),d=l[m]}b+=l[m].dist(l[m+1]),m++;const C=[];let k=0;for(;b<o/2;){const x=l[m],S=l[m+1];if(!S)return!1;let I=l[m-1].angleTo(x)-x.angleTo(S);for(I=Math.abs((I+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:b,angleDelta:I}),k+=I;b-C[0].distance>c;)k-=C.shift().angleDelta;if(k>f)return!1;m++,b+=x.dist(S)}return!0}function zE(l){let t=0;for(let o=0;o<l.length-1;o++)t+=l[o].dist(l[o+1]);return t}function OE(l,t,o){return l?.6*t*o:0}function FE(l,t){return Math.max(l?l.right-l.left:0,t?t.right-t.left:0)}function YO(l,t,o,c,f,d){const m=OE(o,f,d),b=FE(o,c)*d;let C=0;const k=zE(l)/2;for(let x=0;x<l.length-1;x++){const S=l[x],I=l[x+1],T=S.dist(I);if(C+T>k){const E=(k-C)/T,A=Pr(S.x,I.x,E),z=Pr(S.y,I.y,E),B=new nc(A,z,0,I.angleTo(S),x);return!m||LE(l,B,b,m,t)?B:void 0}C+=T}}function XO(l,t,o,c,f,d,m,b,C){const k=OE(c,d,m),x=FE(c,f),S=x*m,I=l[0].x===0||l[0].x===C||l[0].y===0||l[0].y===C;return t-S<t/4&&(t=S+t/4),BE(l,I?t/2*b%t:(x/2+2*d)*m*b%t,t,k,o,S,I,!1,C)}function BE(l,t,o,c,f,d,m,b,C){const k=d/2,x=zE(l);let S=0,I=t-o,T=[];for(let E=0;E<l.length-1;E++){const A=l[E],z=l[E+1],B=A.dist(z),U=z.angleTo(A);for(;I+o<S+B;){I+=o;const G=(I-S)/B,N=Pr(A.x,z.x,G),Z=Pr(A.y,z.y,G);if(N>=0&&N<C&&Z>=0&&Z<C&&I-k>=0&&I+k<=x){const J=new nc(N,Z,0,U,E);c&&!LE(l,J,d,c,f)||T.push(J)}}S+=B}return b||T.length||m||(T=BE(l,S/2,o,c,f,d,m,!0,C)),T}function jE(l,t,o,c,f){const d=[];for(let m=0;m<l.length;m++){const b=l[m];let C;for(let k=0;k<b.length-1;k++){let x=b[k],S=b[k+1];x.x<t&&S.x<t||(x.x<t?x=new rt(t,x.y+(t-x.x)/(S.x-x.x)*(S.y-x.y))._round():S.x<t&&(S=new rt(t,x.y+(t-x.x)/(S.x-x.x)*(S.y-x.y))._round()),x.y<o&&S.y<o||(x.y<o?x=new rt(x.x+(o-x.y)/(S.y-x.y)*(S.x-x.x),o)._round():S.y<o&&(S=new rt(x.x+(o-x.y)/(S.y-x.y)*(S.x-x.x),o)._round()),x.x>=c&&S.x>=c||(x.x>=c?x=new rt(c,x.y+(c-x.x)/(S.x-x.x)*(S.y-x.y))._round():S.x>=c&&(S=new rt(c,x.y+(c-x.x)/(S.x-x.x)*(S.y-x.y))._round()),x.y>=f&&S.y>=f||(x.y>=f?x=new rt(x.x+(f-x.y)/(S.y-x.y)*(S.x-x.x),f)._round():S.y>=f&&(S=new rt(x.x+(f-x.y)/(S.y-x.y)*(S.x-x.x),f)._round()),C&&x.equals(C[C.length-1])||(C=[x],d.push(C)),C.push(S)))))}}return d}function NE(l){let t=0,o=0;for(const m of l)t+=m.w*m.h,o=Math.max(o,m.w);l.sort((m,b)=>b.h-m.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let f=0,d=0;for(const m of l)for(let b=c.length-1;b>=0;b--){const C=c[b];if(!(m.w>C.w||m.h>C.h)){if(m.x=C.x,m.y=C.y,d=Math.max(d,m.y+m.h),f=Math.max(f,m.x+m.w),m.w===C.w&&m.h===C.h){const k=c.pop();b<c.length&&(c[b]=k)}else m.h===C.h?(C.x+=m.w,C.w-=m.w):m.w===C.w?(C.y+=m.h,C.h-=m.h):(c.push({x:C.x+m.w,y:C.y,w:C.w-m.w,h:m.h}),C.y+=m.h,C.h-=m.h);break}}return{w:f,h:d,fill:t/(f*d)||0}}ur(nc,"Anchor");const $m=1;class Ob{constructor(t,{pixelRatio:o,version:c,stretchX:f,stretchY:d,content:m},b){this.paddedRect=t,this.pixelRatio=o,this.stretchX=f,this.stretchY=d,this.content=m,this.version=c,this.padding=b}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class VE{constructor(t,o,c){const f={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,f,$m,m),this.addImages(o,d,2,m);const{w:b,h:C}=NE(m),k=new Ro({width:b||1,height:C||1});for(const x in t){const S=t[x],I=f[x].paddedRect;Ro.copy(S.data,k,{x:0,y:0},{x:I.x+$m,y:I.y+$m},S.data,c,S.sdf)}for(const x in o){const S=o[x],I=d[x].paddedRect;let T=d[x].padding;const E=I.x+T,A=I.y+T,z=S.data.width,B=S.data.height;T=T>1?T-1:T,Ro.copy(S.data,k,{x:0,y:0},{x:E,y:A},S.data,c),Ro.copy(S.data,k,{x:0,y:B-T},{x:E,y:A-T},{width:z,height:T},c),Ro.copy(S.data,k,{x:0,y:0},{x:E,y:A+B},{width:z,height:T},c),Ro.copy(S.data,k,{x:z-T,y:0},{x:E-T,y:A},{width:T,height:B},c),Ro.copy(S.data,k,{x:0,y:0},{x:E+z,y:A},{width:T,height:B},c),Ro.copy(S.data,k,{x:z-T,y:B-T},{x:E-T,y:A-T},{width:T,height:T},c),Ro.copy(S.data,k,{x:0,y:B-T},{x:E+z,y:A-T},{width:T,height:T},c),Ro.copy(S.data,k,{x:0,y:0},{x:E+z,y:A+B},{width:T,height:T},c),Ro.copy(S.data,k,{x:z-T,y:0},{x:E-T,y:A+B},{width:T,height:T},c)}this.image=k,this.iconPositions=f,this.patternPositions=d}addImages(t,o,c,f){for(const d in t){const m=t[d],b={x:0,y:0,w:m.data.width+2*c,h:m.data.height+2*c};f.push(b),o[d]=new Ob(b,m,c),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,o,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>t.hasImage(f,c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const f in t.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[f],t.getImage(f,c),o),this.patchUpdatedImage(this.patternPositions[f],t.getImage(f,c),o)}patchUpdatedImage(t,o,c){if(!t||!o||t.version===o.version)return;t.version=o.version;const[f,d]=t.tl;c.update(o.data,{position:{x:f,y:d}})}}ur(Ob,"ImagePosition"),ur(VE,"ImageAtlas");const Um=1e20;function $E(l,t,o,c,f,d,m,b,C){for(let k=t;k<t+c;k++)UE(l,o*d+k,d,f,m,b,C);for(let k=o;k<o+f;k++)UE(l,k*d+t,1,c,m,b,C)}function UE(l,t,o,c,f,d,m){d[0]=0,m[0]=-Um,m[1]=Um,f[0]=l[t];for(let b=1,C=0,k=0;b<c;b++){f[b]=l[t+b*o];const x=b*b;do{const S=d[C];k=(f[b]-f[S]+x-S*S)/(b-S)/2}while(k<=m[C]&&--C>-1);C++,d[C]=b,m[C]=k,m[C+1]=Um}for(let b=0,C=0;b<c;b++){for(;m[C+1]<b;)C++;const k=d[C],x=b-k;l[t+b*o]=f[k]+x*x}}const Ba=2,Fb={none:0,ideographs:1,all:2};class op{constructor(t,o,c){this.requestManager=t,this.localGlyphMode=o,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,o){this.urls[o]=t}getGlyphs(t,o,c){const f=[],d=this.urls[o]||Ve.GLYPHS_URL;for(const m in t)for(const b of t[m])f.push({stack:m,id:b});br(f,({stack:m,id:b},C)=>{let k=this.entries[m];k||(k=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=k.glyphs[b];if(x!==void 0)return void C(null,{stack:m,id:b,glyph:x});if(x=this._tinySDF(k,m,b),x)return k.glyphs[b]=x,void C(null,{stack:m,id:b,glyph:x});const S=Math.floor(b/256);if(256*S>65535)return void C(new Error("glyphs > 65535 not supported"));if(k.ranges[S])return void C(null,{stack:m,id:b,glyph:x});let I=k.requests[S];I||(I=k.requests[S]=[],op.loadGlyphRange(m,S,d,this.requestManager,(T,E)=>{if(E){k.ascender=E.ascender,k.descender=E.descender;for(const A in E.glyphs)this._doesCharSupportLocalGlyph(+A)||(k.glyphs[+A]=E.glyphs[+A]);k.ranges[S]=!0}for(const A of I)A(T,E);delete k.requests[S]})),I.push((T,E)=>{T?C(T):E&&C(null,{stack:m,id:b,glyph:E.glyphs[b]||null})})},(m,b)=>{if(m)c(m);else if(b){const C={};for(const{stack:k,id:x,glyph:S}of b)C[k]===void 0&&(C[k]={}),C[k].glyphs===void 0&&(C[k].glyphs={}),C[k].glyphs[x]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},C[k].ascender=this.entries[k].ascender,C[k].descender=this.entries[k].descender;c(null,C)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Fb.none&&(this.localGlyphMode===Fb.all?!!this.localFontFamily:!!this.localFontFamily&&(yr["CJK Unified Ideographs"](t)||yr["Hangul Syllables"](t)||yr.Hiragana(t)||yr.Katakana(t)||yr["CJK Symbols and Punctuation"](t)||yr["CJK Unified Ideographs Extension A"](t)||yr["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,o,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let d=t.tinySDF;if(!d){let A="400";/bold/i.test(o)?A="900":/medium/i.test(o)?A="500":/light/i.test(o)&&(A="200"),d=t.tinySDF=new op.TinySDF({fontFamily:f,fontWeight:A,fontSize:24*Ba,buffer:3*Ba,radius:8*Ba}),d.fontWeight=A}if(this.localGlyphs[d.fontWeight][c])return this.localGlyphs[d.fontWeight][c];const m=String.fromCodePoint(c),{data:b,width:C,height:k,glyphWidth:x,glyphHeight:S,glyphLeft:I,glyphTop:T,glyphAdvance:E}=d.draw(m);return this.localGlyphs[d.fontWeight][c]={id:c,bitmap:new ru({width:C,height:k},b),metrics:{width:x/Ba,height:S/Ba,left:I/Ba,top:T/Ba-27,advance:E/Ba,localGlyph:!0}}}}op.loadGlyphRange=function(l,t,o,c,f){const d=256*t,m=d+255,b=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",l).replace("{range}",`${d}-${m}`),ol.Glyphs);al(b,(C,k)=>{if(C)f(C);else if(k){const x={},S=function(I){return new a0(I).readFields(UO,{})}(k);for(const I of S.glyphs)x[I.id]=I;f(null,{glyphs:x,ascender:S.ascender,descender:S.descender})}})},op.TinySDF=class{constructor({fontSize:l=24,buffer:t=3,radius:o=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:d="normal",fontStyle:m="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=o;const b=this.size=l+4*t,C=this._createCanvas(b),k=this.ctx=C.getContext("2d",{willReadFrequently:!0});k.font=`${m} ${d} ${l}px ${f}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(l){const t=document.createElement("canvas");return t.width=t.height=l,t}draw(l){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:d}=this.ctx.measureText(l),m=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-f))),C=Math.min(this.size-this.buffer,m+Math.ceil(c)),k=b+2*this.buffer,x=C+2*this.buffer,S=Math.max(k*x,0),I=new Uint8ClampedArray(S),T={data:I,width:k,height:x,glyphWidth:b,glyphHeight:C,glyphTop:m,glyphLeft:0,glyphAdvance:t};if(b===0||C===0)return T;const{ctx:E,buffer:A,gridInner:z,gridOuter:B}=this;E.clearRect(A,A,b,C),E.fillText(l,A,A+m);const U=E.getImageData(A,A,b,C);B.fill(Um,0,S),z.fill(0,0,S);for(let G=0;G<C;G++)for(let N=0;N<b;N++){const Z=U.data[4*(G*b+N)+3]/255;if(Z===0)continue;const J=(G+A)*k+N+A;if(Z===1)B[J]=0,z[J]=Um;else{const he=.5-Z;B[J]=he>0?he*he:0,z[J]=he<0?he*he:0}}$E(B,0,0,k,x,k,this.f,this.v,this.z),$E(z,A,A,b,C,k,this.f,this.v,this.z);for(let G=0;G<S;G++){const N=Math.sqrt(B[G])-Math.sqrt(z[G]);I[G]=Math.round(255-255*(N/this.radius+this.cutoff))}return T}};const iu=$m;function WE(l,t,o,c){const f=[],d=l.imagePrimary,m=d.pixelRatio,b=d.paddedRect.w-2*iu,C=d.paddedRect.h-2*iu,k=l.right-l.left,x=l.bottom-l.top,S=d.stretchX||[[0,b]],I=d.stretchY||[[0,C]],T=(Ae,Te)=>Ae+Te[1]-Te[0],E=S.reduce(T,0),A=I.reduce(T,0),z=b-E,B=C-A;let U=0,G=E,N=0,Z=A,J=0,he=z,ye=0,xe=B;if(d.content&&c){const Ae=d.content;U=c0(S,0,Ae[0]),N=c0(I,0,Ae[1]),G=c0(S,Ae[0],Ae[2]),Z=c0(I,Ae[1],Ae[3]),J=Ae[0]-U,ye=Ae[1]-N,he=Ae[2]-Ae[0]-G,xe=Ae[3]-Ae[1]-Z}const me=(Ae,Te,Oe,We)=>{const Ze=u0(Ae.stretch-U,G,k,l.left),Ye=d0(Ae.fixed-J,he,Ae.stretch,E),Je=u0(Te.stretch-N,Z,x,l.top),at=d0(Te.fixed-ye,xe,Te.stretch,A),Qe=u0(Oe.stretch-U,G,k,l.left),gt=d0(Oe.fixed-J,he,Oe.stretch,E),Et=u0(We.stretch-N,Z,x,l.top),dt=d0(We.fixed-ye,xe,We.stretch,A),sr=new rt(Ze,Je),Jt=new rt(Qe,Je),$t=new rt(Qe,Et),Dt=new rt(Ze,Et),vr=new rt(Ye/m,at/m),ir=new rt(gt/m,dt/m),cr=t*Math.PI/180;if(cr){const an=Math.sin(cr),Wn=Math.cos(cr),Rn=[Wn,-an,an,Wn];sr._matMult(Rn),Jt._matMult(Rn),Dt._matMult(Rn),$t._matMult(Rn)}const Vr=Ae.stretch+Ae.fixed,tn=Oe.stretch+Oe.fixed,Xr=Te.stretch+Te.fixed,Kr=We.stretch+We.fixed,on=l.imageSecondary;return{tl:sr,tr:Jt,bl:Dt,br:$t,texPrimary:{x:d.paddedRect.x+iu+Vr,y:d.paddedRect.y+iu+Xr,w:tn-Vr,h:Kr-Xr},texSecondary:on?{x:on.paddedRect.x+iu+Vr,y:on.paddedRect.y+iu+Xr,w:tn-Vr,h:Kr-Xr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vr,pixelOffsetBR:ir,minFontScaleX:he/m/k,minFontScaleY:xe/m/x,isSDF:o}};if(c&&(d.stretchX||d.stretchY)){const Ae=GE(S,z,E),Te=GE(I,B,A);for(let Oe=0;Oe<Ae.length-1;Oe++){const We=Ae[Oe],Ze=Ae[Oe+1];for(let Ye=0;Ye<Te.length-1;Ye++)f.push(me(We,Te[Ye],Ze,Te[Ye+1]))}}else f.push(me({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:C+1}));return f}function c0(l,t,o){let c=0;for(const f of l)c+=Math.max(t,Math.min(o,f[1]))-Math.max(t,Math.min(o,f[0]));return c}function GE(l,t,o){const c=[{fixed:-iu,stretch:0}];for(const[f,d]of l){const m=c[c.length-1];c.push({fixed:f-m.stretch,stretch:m.stretch}),c.push({fixed:f-m.stretch,stretch:m.stretch+(d-f)})}return c.push({fixed:t+iu,stretch:o}),c}function u0(l,t,o,c){return l/t*o+c}function d0(l,t,o,c){return l-t*o/c}function KO(l,t,o,c){const f=t+l.positionedLines[c].lineOffset;return c===0?o+f/2:o+(f+(t+l.positionedLines[c-1].lineOffset))/2}function JO(l,t=1,o=!1){let c=1/0,f=1/0,d=-1/0,m=-1/0;const b=l[0];for(let T=0;T<b.length;T++){const E=b[T];(!T||E.x<c)&&(c=E.x),(!T||E.y<f)&&(f=E.y),(!T||E.x>d)&&(d=E.x),(!T||E.y>m)&&(m=E.y)}const C=Math.min(d-c,m-f);let k=C/2;const x=new Lf([],QO);if(C===0)return new rt(c,f);for(let T=c;T<d;T+=C)for(let E=f;E<m;E+=C)x.push(new sp(T+k,E+k,k,l));let S=function(T){let E=0,A=0,z=0;const B=T[0];for(let U=0,G=B.length,N=G-1;U<G;N=U++){const Z=B[U],J=B[N],he=Z.x*J.y-J.x*Z.y;A+=(Z.x+J.x)*he,z+=(Z.y+J.y)*he,E+=3*he}return new sp(A/E,z/E,0,T)}(l),I=x.length;for(;x.length;){const T=x.pop();(T.d>S.d||!S.d)&&(S=T,o&&console.log("found best %d after %d probes",Math.round(1e4*T.d)/1e4,I)),T.max-S.d<=t||(k=T.h/2,x.push(new sp(T.p.x-k,T.p.y-k,k,l)),x.push(new sp(T.p.x+k,T.p.y-k,k,l)),x.push(new sp(T.p.x-k,T.p.y+k,k,l)),x.push(new sp(T.p.x+k,T.p.y+k,k,l)),I+=4)}return o&&(console.log(`num probes: ${I}`),console.log(`best distance: ${S.d}`)),S.p}function QO(l,t){return t.max-l.max}class sp{constructor(t,o,c,f){this.p=new rt(t,o),this.h=c,this.d=function(d,m){let b=!1,C=1/0;for(let k=0;k<m.length;k++){const x=m[k];for(let S=0,I=x.length,T=I-1;S<I;T=S++){const E=x[S],A=x[T];E.y>d.y!=A.y>d.y&&d.x<(A.x-E.x)*(d.y-E.y)/(A.y-E.y)+E.x&&(b=!b),C=Math.min(C,Ln(d,E,A))}}return(b?1:-1)*Math.sqrt(C)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const Bb=Number.POSITIVE_INFINITY,eF=Math.sqrt(2);function HE(l,[t,o]){let c=0,f=0;if(o===Bb){t<0&&(t=0);const d=t/eF;switch(l){case"top-right":case"top-left":f=d-7;break;case"bottom-right":case"bottom-left":f=7-d;break;case"bottom":f=7-t;break;case"top":f=t-7}switch(l){case"top-right":case"bottom-right":c=-d;break;case"top-left":case"bottom-left":c=d;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),o=Math.abs(o),l){case"top-right":case"top-left":case"top":f=o-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-o}switch(l){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,f]}function jb(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tF(l,t,o,c,f,d,m,b,C,k,x,S,I,T,E){let A=d.textMaxSize.evaluate(t,{},S);A===void 0&&(A=m);const z=l.layers[0].layout,B=z.get("icon-offset").evaluate(t,{},S),U=ZE(o.horizontal)||o.vertical,G=I.name==="globe",N=po,Z=m/N,J=l.tilePixelRatio*A/N,he=(Ze=l.overscaling,l.zoom>18&&Ze>2&&(Ze>>=1),Math.max(er/(512*Ze),1)*z.get("symbol-spacing")),ye=z.get("text-padding")*l.tilePixelRatio,xe=z.get("icon-padding")*l.tilePixelRatio,me=Wt(z.get("text-max-angle")),Ae=z.get("text-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",Te=z.get("icon-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",Oe=z.get("symbol-placement"),We=he/2;var Ze;const Ye=z.get("icon-text-fit").evaluate(t,{},S),Je=z.get("icon-text-fit-padding").evaluate(t,{},S),at=Ye!=="none";let Qe;l.hasAnyIconTextFit===!1&&at&&(l.hasAnyIconTextFit=!0),c&&at&&(l.allowVerticalPlacement&&o.vertical&&(Qe=RE(c,o.vertical,Ye,Je,B,Z)),U&&(c=RE(c,U,Ye,Je,B,Z)));const gt=(Et,dt,sr)=>{if(dt.x<0||dt.x>=er||dt.y<0||dt.y>=er)return;let Jt=null;if(G){const{x:$t,y:Dt,z:vr}=I.projectTilePoint(dt.x,dt.y,sr);Jt={anchor:new nc($t,Dt,vr,0,void 0),up:I.upVector(sr,dt.x,dt.y)}}(function($t,Dt,vr,ir,cr,Vr,tn,Xr,Kr,on,an,Wn,Rn,$r,Cn,In,ei,Si,Oi,Ti,fi,ro,ji,fo,Xn,as,$a){const ca=$t.addToLineVertexArray(Dt,ir);let ua,Sd,cu,Td,ag,mk,gk,yk=0,_k=0,xk=0,vk=0,fw=-1,mw=-1;const Sl={};let bk=Vo("");const Cd=vr?vr.anchor:Dt,gw=Kr.layout.get("icon-text-fit").evaluate(fi,{},Xn)!=="none";let yw=0,_w=0;if(Kr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[yw,_w]=Kr.layout.get("text-offset").evaluate(fi,{},Xn).map(xs=>xs*po):(yw=Kr.layout.get("text-radial-offset").evaluate(fi,{},Xn)*po,_w=Bb),$t.allowVerticalPlacement&&cr.vertical){const xs=cr.vertical;if(Cn)mk=Nb(xs),Xr&&(gk=Nb(Xr));else{const vs=Kr.layout.get("text-rotate").evaluate(fi,{},Xn)+90;cu=h0(on,Cd,Dt,an,Wn,Rn,xs,$r,vs,In),Xr&&(Td=h0(on,Cd,Dt,an,Wn,Rn,Xr,Si,vs))}}if(Vr){const xs=Kr.layout.get("icon-rotate").evaluate(fi,{},Xn),vs=WE(Vr,xs,ji,gw),fp=Xr?WE(Xr,xs,ji,gw):void 0;Sd=h0(on,Cd,Dt,an,Wn,Rn,Vr,Si,xs),yk=4*vs.length;const wk=$t.iconSizeData;let Md=null;wk.kind==="source"?(Md=[Fa*Kr.layout.get("icon-size").evaluate(fi,{},Xn)],Md[0]>ou&&hr(`${$t.layerIds[0]}: Value for "icon-size" is >= ${Wm}. Reduce your "icon-size".`)):wk.kind==="composite"&&(Md=[Fa*ro.compositeIconSizes[0].evaluate(fi,{},Xn),Fa*ro.compositeIconSizes[1].evaluate(fi,{},Xn)],(Md[0]>ou||Md[1]>ou)&&hr(`${$t.layerIds[0]}: Value for "icon-size" is >= ${Wm}. Reduce your "icon-size".`)),$t.addSymbols($t.icon,vs,Md,Ti,Oi,fi,!1,vr,Dt,ca.lineStartIndex,ca.lineLength,-1,fo,Xn,as,$a),fw=$t.icon.placedSymbolArray.length-1,fp&&(_k=4*fp.length,$t.addSymbols($t.icon,fp,Md,Ti,Oi,fi,Os.vertical,vr,Dt,ca.lineStartIndex,ca.lineLength,-1,fo,Xn,as,$a),mw=$t.icon.placedSymbolArray.length-1)}for(const xs in cr.horizontal){const vs=cr.horizontal[xs];ua||(bk=Vo(vs.text),Cn?ag=Nb(vs):ua=h0(on,Cd,Dt,an,Wn,Rn,vs,$r,Kr.layout.get("text-rotate").evaluate(fi,{},Xn),In));const fp=vs.positionedLines.length===1;if(xk+=qE($t,vr,Dt,vs,tn,Kr,Cn,fi,In,ca,cr.vertical?Os.horizontal:Os.horizontalOnly,fp?Object.keys(cr.horizontal):[xs],Sl,fw,ro,fo,Xn,as),fp)break}cr.vertical&&(vk+=qE($t,vr,Dt,cr.vertical,tn,Kr,Cn,fi,In,ca,Os.vertical,["vertical"],Sl,mw,ro,fo,Xn,as));let uu=-1;const xw=(xs,vs)=>xs?Math.max(xs,vs):vs;uu=xw(ag,uu),uu=xw(mk,uu),uu=xw(gk,uu);const g5=uu>-1?1:0;$t.glyphOffsetArray.length>=65535&&hr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fi.sortKey!==void 0&&$t.addToSortKeyRanges($t.symbolInstances.length,fi.sortKey),$t.symbolInstances.emplaceBack(Dt.x,Dt.y,Cd.x,Cd.y,Cd.z,Sl.right>=0?Sl.right:-1,Sl.center>=0?Sl.center:-1,Sl.left>=0?Sl.left:-1,Sl.vertical>=0?Sl.vertical:-1,fw,mw,bk,ua!==void 0?ua:$t.collisionBoxArray.length,ua!==void 0?ua+1:$t.collisionBoxArray.length,cu!==void 0?cu:$t.collisionBoxArray.length,cu!==void 0?cu+1:$t.collisionBoxArray.length,Sd!==void 0?Sd:$t.collisionBoxArray.length,Sd!==void 0?Sd+1:$t.collisionBoxArray.length,Td||$t.collisionBoxArray.length,Td?Td+1:$t.collisionBoxArray.length,an,xk,vk,yk,_k,g5,0,yw,_w,uu,0,gw?1:0)})(l,dt,Jt,Et,o,c,f,Qe,l.layers[0],l.collisionBoxArray,t.index,t.sourceLayerIndex,l.index,ye,Ae,C,0,xe,Te,B,t,d,k,x,S,T,E)};if(Oe==="line")for(const Et of jE(t.geometry,0,0,er,er)){const dt=XO(Et,he,me,o.vertical||U,c,N,J,l.overscaling,er);for(const sr of dt)U&&rF(l,U.text,We,sr)||gt(Et,sr,S)}else if(Oe==="line-center"){for(const Et of t.geometry)if(Et.length>1){const dt=YO(Et,me,o.vertical||U,c,N,J);dt&&gt(Et,dt,S)}}else if(t.type==="Polygon")for(const Et of Q_(t.geometry,0)){const dt=JO(Et,16);gt(Et[0],new nc(dt.x,dt.y,0,0,void 0),S)}else if(t.type==="LineString")for(const Et of t.geometry)gt(Et,new nc(Et[0].x,Et[0].y,0,0,void 0),S);else if(t.type==="Point")for(const Et of t.geometry)for(const dt of Et)gt([dt],new nc(dt.x,dt.y,0,0,void 0),S)}const Wm=255,ou=Wm*Fa;function qE(l,t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z,B){const U=function(Z,J,he,ye,xe,me,Ae,Te){const Oe=[];if(J.positionedLines.length===0)return Oe;const We=ye.layout.get("text-rotate").evaluate(me,{})*Math.PI/180,Ze=function(gt){const Et=gt[0],dt=gt[1],sr=Et*dt;return sr>0?[Et,-dt]:sr<0?[-Et,dt]:Et===0?[dt,Et]:[dt,-Et]}(he);let Ye=Math.abs(J.top-J.bottom);for(const gt of J.positionedLines)Ye-=gt.lineOffset;const Je=J.positionedLines.length,at=Ye/Je;let Qe=J.top-he[1];for(let gt=0;gt<Je;++gt){const Et=J.positionedLines[gt];Qe=KO(J,at,Qe,gt);for(const dt of Et.positionedGlyphs){if(!dt.rect)continue;const sr=dt.rect||{};let Jt=EE+1,$t=!0,Dt=1,vr=0;if(dt.imageName){const Ti=Ae[dt.imageName];if(!Ti)continue;if(Ti.sdf){hr("SDF images are not supported in formatted text and will be ignored.");continue}$t=!1,Dt=Ti.pixelRatio,Jt=$m/Dt}const ir=(xe||Te)&&dt.vertical,cr=dt.metrics.advance*dt.scale/2,Vr=dt.metrics,tn=dt.rect;if(tn===null)continue;Te&&J.verticalizable&&(vr=dt.imageName?cr-dt.metrics.width*dt.scale/2:0);const Xr=xe?[dt.x+cr,dt.y]:[0,0];let Kr=[0,0],on=[0,0],an=!1;xe||(ir?(on=[dt.x+cr+Ze[0],dt.y+Ze[1]-vr],an=!0):Kr=[dt.x+cr+he[0],dt.y+he[1]-vr]);const Wn=tn.w*dt.scale/(Dt*(dt.localGlyph?Ba:1)),Rn=tn.h*dt.scale/(Dt*(dt.localGlyph?Ba:1));let $r,Cn,In,ei;if(ir){const Ti=dt.y-Qe,fi=new rt(-cr,cr-Ti),ro=-Math.PI/2,ji=new rt(...on);$r=new rt(-cr+Kr[0],Kr[1]),$r._rotateAround(ro,fi)._add(ji),$r.x+=-Ti+cr,$r.y-=(Vr.left-Jt)*dt.scale;const fo=dt.imageName?Vr.advance*dt.scale:po*dt.scale,Xn=String.fromCodePoint(dt.glyph);NO(Xn)?$r.x+=(1-Jt)*dt.scale:VO(Xn)?$r.x+=fo-Vr.height*dt.scale+(-Jt-1)*dt.scale:$r.x+=dt.imageName||Vr.width+2*Jt===tn.w&&Vr.height+2*Jt===tn.h?(fo-Rn)/2:(fo-(Vr.height+2*Jt)*dt.scale)/2,Cn=new rt($r.x,$r.y-Wn),In=new rt($r.x+Rn,$r.y),ei=new rt($r.x+Rn,$r.y-Wn)}else{const Ti=(Vr.left-Jt)*dt.scale-cr+Kr[0],fi=(-Vr.top-Jt)*dt.scale+Kr[1],ro=Ti+Wn,ji=fi+Rn;$r=new rt(Ti,fi),Cn=new rt(ro,fi),In=new rt(Ti,ji),ei=new rt(ro,ji)}if(We){let Ti;Ti=xe?new rt(0,0):an?new rt(Ze[0],Ze[1]):new rt(he[0],he[1]),$r._rotateAround(We,Ti),Cn._rotateAround(We,Ti),In._rotateAround(We,Ti),ei._rotateAround(We,Ti)}const Si=new rt(0,0),Oi=new rt(0,0);Oe.push({tl:$r,tr:Cn,bl:In,br:ei,texPrimary:sr,texSecondary:void 0,writingMode:J.writingMode,glyphOffset:Xr,sectionIndex:dt.sectionIndex,isSDF:$t,pixelOffsetTL:Si,pixelOffsetBR:Oi,minFontScaleX:0,minFontScaleY:0})}}return Oe}(0,c,C,d,m,b,f,l.allowVerticalPlacement),G=l.textSizeData;let N=null;G.kind==="source"?(N=[Fa*d.layout.get("text-size").evaluate(b,{},z)],N[0]>ou&&hr(`${l.layerIds[0]}: Value for "text-size" is >= ${Wm}. Reduce your "text-size".`)):G.kind==="composite"&&(N=[Fa*E.compositeTextSizes[0].evaluate(b,{},z),Fa*E.compositeTextSizes[1].evaluate(b,{},z)],(N[0]>ou||N[1]>ou)&&hr(`${l.layerIds[0]}: Value for "text-size" is >= ${Wm}. Reduce your "text-size".`)),l.addSymbols(l.text,U,N,C,m,b,x,t,o,k.lineStartIndex,k.lineLength,T,A,z,B,!1);for(const Z of S)I[Z]=l.text.placedSymbolArray.length-1;return 4*U.length}function ZE(l){for(const t in l)return l[t];return null}function h0(l,t,o,c,f,d,m,b,C,k){let x=m.top,S=m.bottom,I=m.left,T=m.right;const E=m.collisionPadding;if(E&&(I-=E[0],x-=E[1],T+=E[2],S+=E[3]),C){const A=new rt(I,x),z=new rt(T,x),B=new rt(I,S),U=new rt(T,S),G=Wt(C);let N=new rt(0,0);k&&(N=new rt(k[0],k[1])),A._rotateAround(G,N),z._rotateAround(G,N),B._rotateAround(G,N),U._rotateAround(G,N),I=Math.min(A.x,z.x,B.x,U.x),T=Math.max(A.x,z.x,B.x,U.x),x=Math.min(A.y,z.y,B.y,U.y),S=Math.max(A.y,z.y,B.y,U.y)}return l.emplaceBack(t.x,t.y,t.z,o.x,o.y,I,x,T,S,b,c,f,d),l.length-1}function Nb(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const t=l.bottom-l.top;return t>0?Math.max(10,t):null}function rF(l,t,o,c){const f=l.compareText;if(t in f){const d=f[t];for(let m=d.length-1;m>=0;m--)if(c.dist(d[m])<o)return!0}else f[t]=[];return f[t].push(c),!1}function YE(l,t){const o=l.fovAboveCenter,c=l.elevation?l.elevation.getMinElevationBelowMSL()*t:0,f=(l._camera.position[2]*l.worldSize-c)/Math.cos(l._pitch),d=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-l._pitch-o,.01));let m=Math.sin(l._pitch)*d+f;const b=f*(1/l._horizonShift);return l.elevation&&l.elevation.exaggeration()!==0||(m*=1+Math.max(l.zoom-17,0)),Math.min(1.01*m,b)}function Gm(l,t){if(!t.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:t};const o=Math.pow(2,-l.z),c=l.x*o,f=(l.x+1)*o,d=l.y*o,m=(l.y+1)*o,b=Ee(c),C=Ee(f),k=Me(d),x=Me(m),S=t.project(b,k),I=t.project(C,k),T=t.project(C,x),E=t.project(b,x);let A=Math.min(S.x,I.x,T.x,E.x),z=Math.min(S.y,I.y,T.y,E.y),B=Math.max(S.x,I.x,T.x,E.x),U=Math.max(S.y,I.y,T.y,E.y);const G=o/16;function N(J,he,ye,xe,me,Ae){const Te=(ye+me)/2,Oe=(xe+Ae)/2,We=t.project(Ee(Te),Me(Oe)),Ze=Math.max(0,A-We.x,z-We.y,We.x-B,We.y-U);A=Math.min(A,We.x),B=Math.max(B,We.x),z=Math.min(z,We.y),U=Math.max(U,We.y),Ze>G&&(N(J,We,ye,xe,Te,Oe),N(We,he,Te,Oe,me,Ae))}N(S,I,c,d,f,d),N(I,T,f,d,f,m),N(T,E,f,m,c,m),N(E,S,c,m,c,d),A-=G,z-=G,B+=G,U+=G;const Z=1/Math.max(B-A,U-z);return{scale:Z,x:A*Z,y:z*Z,x2:B*Z,y2:U*Z,projection:t}}function XE(l,{x:t,y:o},c=0){return new rt(((t-c)*l.scale-l.x)*er,(o*l.scale-l.y)*er)}const nF=be.mat4.identity(new Float32Array(16));class su{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,o){return{x:0,y:0,z:0}}unproject(t,o){return new W(0,0)}projectTilePoint(t,o,c){return{x:t,y:o,z:0}}locationPoint(t,o,c=!0){return t._coordinatePoint(t.locationCoordinate(o),c)}pixelsPerMeter(t,o){return ge(1,t)*o}pixelSpaceConversion(t,o,c){return 1}farthestPixelDistance(t){return YE(t,t.pixelsPerMeter)}pointCoordinate(t,o,c,f){const d=t.horizonLineFromTop(!1),m=new rt(o,Math.max(d,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(m,f))}pointCoordinate3D(t,o,c){const f=new rt(o,c);if(t.elevation)return t.elevation.pointCoordinate(f);{const d=this.pointCoordinate(t,f.x,f.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(t,o){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,o.x,o.y);const c=t.horizonLineFromTop();return o.y<c}createInversionMatrix(t,o){return nF}createTileMatrix(t,o,c){let f,d,m;const b=c.canonical,C=be.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=Gm(b,this);f=1,d=k.x+c.wrap*k.scale,m=k.y,be.mat4.scale(C,C,[f/k.scale,f/k.scale,t.pixelsPerMeter/o])}else f=o/t.zoomScale(b.z),d=(b.x+Math.pow(2,b.z)*c.wrap)*f,m=b.y*f;return be.mat4.translate(C,C,[d,m,0]),be.mat4.scale(C,C,[f/er,f/er,1]),C}upVector(t,o,c){return[0,0,1]}upVectorScale(t,o,c){return{metersToTile:1}}}class iF extends su{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[o,c]=this.parallels=t.parallels||[29.5,45.5],f=Math.sin(Wt(o));this.n=(f+Math.sin(Wt(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(t,o){const{n:c,c:f,r0:d}=this,m=Wt(t-this.center[0]),b=Wt(o),C=Math.sqrt(f-2*c*Math.sin(b))/c;return{x:C*Math.sin(m*c),y:C*Math.cos(m*c)-d,z:0}}unproject(t,o){const{n:c,c:f,r0:d}=this,m=d+o;let b=Math.atan2(t,Math.abs(m))*Math.sign(m);m*c<0&&(b-=Math.PI*Math.sign(t)*Math.sign(m));const C=Wt(this.center[0])*c;b=zr(b,-Math.PI-C,Math.PI-C);const k=Xt(wr(b/c)+this.center[0],-180,180),x=Math.asin(Xt((f-(t*t+m*m)*c*c)/(2*c),-1,1)),S=Xt(wr(x),-Re,Re);return new W(k,S)}}const Hm=1.340264,qm=-.081106,Zm=893e-6,Ym=.003796,p0=Math.sqrt(3)/2;class oF extends su{project(t,o){o=o/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(p0*Math.sin(o)),f=c*c,d=f*f*f;return{x:.5*(t*Math.cos(c)/(p0*(Hm+3*qm*f+d*(7*Zm+9*Ym*f)))/Math.PI+.5),y:1-.5*(c*(Hm+qm*f+d*(Zm+Ym*f))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=c*c,d=f*f*f;for(let x,S,I,T=0;T<12&&(S=c*(Hm+qm*f+d*(Zm+Ym*f))-o,I=Hm+3*qm*f+d*(7*Zm+9*Ym*f),x=S/I,c=Xt(c-x,-Math.PI/3,Math.PI/3),f=c*c,d=f*f*f,!(Math.abs(x)<1e-12));++T);const m=p0*t*(Hm+3*qm*f+d*(7*Zm+9*Ym*f))/Math.cos(c),b=Math.asin(Math.sin(c)/p0),C=Xt(180*m/Math.PI,-180,180),k=Xt(180*b/Math.PI,-Re,Re);return new W(C,k)}}class sF extends su{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){return{x:.5+t/360,y:.5-o/360,z:0}}unproject(t,o){const c=360*(t-.5),f=Xt(360*(.5-o),-Re,Re);return new W(c,f)}}const ap=Math.PI/2;function f0(l){return Math.tan((ap+l)/2)}class aF extends su{constructor(t){super(t),this.center=t.center||[0,30];const[o,c]=this.parallels=t.parallels||[30,30];let f=Wt(o),d=Wt(c);this.southernCenter=f+d<0,this.southernCenter&&(f=-f,d=-d);const m=Math.cos(f),b=f0(f);this.n=f===d?Math.sin(f):Math.log(m/Math.cos(d))/Math.log(f0(d)/b),this.f=m*Math.pow(f0(f),this.n)/this.n}project(t,o){o=Wt(o),this.southernCenter&&(o=-o),t=Wt(t-this.center[0]);const c=1e-6,{n:f,f:d}=this;d>0?o<-ap+c&&(o=-ap+c):o>ap-c&&(o=ap-c);const m=d/Math.pow(f0(o),f);let b=m*Math.sin(f*t),C=d-m*Math.cos(f*t);return b=.5*(b/Math.PI+.5),C=.5*(C/Math.PI+.5),{x:b,y:this.southernCenter?C:1-C,z:0}}unproject(t,o){t=(2*t-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f}=this,d=f-o,m=Math.sign(d),b=Math.sign(c)*Math.sqrt(t*t+d*d);let C=Math.atan2(t,Math.abs(d))*m;d*c<0&&(C-=Math.PI*Math.sign(t)*m);const k=Xt(wr(C/c)+this.center[0],-180,180),x=Xt(wr(2*Math.atan(Math.pow(f/b,1/c))-ap),-Re,Re);return new W(k,this.southernCenter?-x:x)}}class KE extends su{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,o){return{x:_e(t),y:Se(o),z:0}}unproject(t,o){const c=Ee(t),f=Me(o);return new W(c,f)}}const JE=Wt(Re);class lF extends su{project(t,o){const c=(o=Wt(o))*o,f=c*c;return{x:.5*((t=Wt(t))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=25,d=0,m=c*c;do{m=c*c;const k=m*m;d=(c*(1.007226+m*(.015085+k*(.028874*m-.044475-.005916*k)))-o)/(1.007226+m*(.045255+k*(.259866*m-.311325-.005916*11*k))),c=Xt(c-d,-JE,JE)}while(Math.abs(d)>1e-6&&--f>0);m=c*c;const b=Xt(wr(t/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),C=wr(c);return new W(b,C)}}const QE=Wt(Re);class cF extends su{project(t,o){o=Wt(o),t=Wt(t);const c=Math.cos(o),f=2/Math.PI,d=Math.acos(c*Math.cos(t/2)),m=Math.sin(d)/d,b=.5*(t*f+2*c*Math.sin(t/2)/m)||0,C=.5*(o+Math.sin(o)/m)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(C/Math.PI+1),z:0}}unproject(t,o){let c=t=(2*t-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,d=25;const m=1e-6;let b=0,C=0;do{const k=Math.cos(f),x=Math.sin(f),S=2*x*k,I=x*x,T=k*k,E=Math.cos(c/2),A=Math.sin(c/2),z=2*E*A,B=A*A,U=1-T*E*E,G=U?1/U:0,N=U?Math.acos(k*E)*Math.sqrt(1/U):0,Z=.5*(2*N*k*A+2*c/Math.PI)-t,J=.5*(N*x+f)-o,he=.5*G*(T*B+N*k*E*I)+1/Math.PI,ye=G*(z*S/4-N*x*A),xe=.125*G*(S*A-N*x*T*z),me=.5*G*(I*E+N*B*k)+.5,Ae=ye*xe-me*he;b=(J*ye-Z*me)/Ae,C=(Z*xe-J*he)/Ae,c=Xt(c-b,-Math.PI,Math.PI),f=Xt(f-C,-QE,QE)}while((Math.abs(b)>m||Math.abs(C)>m)&&--d>0);return new W(wr(c),wr(f))}}class eI extends su{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Wt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){const{scale:c,cosPhi:f}=this;return{x:Wt(t)*f*c+.5,y:-Math.sin(Wt(o))/f*c+.5,z:0}}unproject(t,o){const{scale:c,cosPhi:f}=this,d=-(o-.5)/c,m=Xt(wr((t-.5)/c)/f,-180,180),b=Math.asin(Xt(d*f,-1,1)),C=Xt(wr(b),-Re,Re);return new W(m,C)}}class uF extends KE{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,o,c){const f=km(t,o,c),d=Y_(bl(c));return be.vec3.transformMat4(f,f,d),{x:f[0],y:f[1],z:f[2]}}locationPoint(t,o){const c=F(o.lat,o.lng),f=be.vec3.normalize([],c),d=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(o),t._centerAltitude):t._centerAltitude,m=ge(1,0)*er*d;be.vec3.scaleAndAdd(c,c,f,m);const b=be.mat4.identity(new Float64Array(16));return be.mat4.multiply(b,t.pixelMatrix,t.globeMatrix),be.vec3.transformMat4(c,c,b),new rt(c[0],c[1])}pixelsPerMeter(t,o){return ge(1,0)*o}pixelSpaceConversion(t,o,c){const f=ge(1,t)*o,d=Pr(ge(1,45)*o,f,c);return this.pixelsPerMeter(t,o)/d}createTileMatrix(t,o,c){const f=ub(bl(c.canonical));return be.mat4.multiply(new Float64Array(16),t.globeMatrix,f)}createInversionMatrix(t,o){const{center:c}=t,f=Y_(bl(o));return be.mat4.rotateY(f,f,Wt(c.lng)),be.mat4.rotateX(f,f,Wt(c.lat)),be.mat4.scale(f,f,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(t,o,c,f){return H_(t,o,c,!0)||new nt(0,0)}pointCoordinate3D(t,o,c){const f=this.pointCoordinate(t,o,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(t,o){return!H_(t,o.x,o.y,!1)}farthestPixelDistance(t){const o=function(f,d){const m=f.cameraToCenterDistance,b=f._centerAltitude*d,C=f._camera,k=f._camera.forward(),x=be.vec3.add([],be.vec3.scale([],k,-m),[0,0,b]),S=f.worldSize/(2*Math.PI),I=[0,0,-S],T=f.width/f.height,E=Math.tan(f.fovAboveCenter),A=be.vec3.scale([],C.up(),E),z=be.vec3.scale([],C.right(),E*T),B=be.vec3.normalize([],be.vec3.add([],be.vec3.add([],k,A),z)),U=[];let G;if(new Oa(x,B).closestPointOnSphere(I,S,U)){const N=be.vec3.add([],U,I),Z=be.vec3.sub([],N,x);G=Math.cos(f.fovAboveCenter)*be.vec3.length(Z)}else{const N=be.vec3.sub([],x,I),Z=be.vec3.sub([],I,x);be.vec3.normalize(Z,Z);const J=be.vec3.length(N)-S;G=Math.sqrt(J*(J+2*S));const he=Math.acos(G/(S+J))-Math.acos(be.vec3.dot(k,Z));G*=Math.cos(he)}return 1.01*G}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=tu(t.zoom);if(c>0){const f=YE(t,ge(1,t.center.lat)*t.worldSize),d=t.worldSize/(2*Math.PI),m=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Pr(o,f+d*(1-Math.cos(m)),Math.pow(c,10))}return o}upVector(t,o,c){return km(o,c,t,1)}upVectorScale(t){return{metersToTile:tc(Z_(bl(t)))}}}function tI(l){const t=l.parallels,o=!!t&&Math.abs(t[0]+t[1])<.01;switch(l.name){case"mercator":return new KE(l);case"equirectangular":return new sF(l);case"naturalEarth":return new lF(l);case"equalEarth":return new oF(l);case"winkelTripel":return new cF(l);case"albers":return o?new eI(l):new iF(l);case"lambertConformalConic":return o?new eI(l):new aF(l);case"globe":return new uF(l)}throw new Error(`Invalid projection name: ${l.name}`)}const dF=rp.VectorTileFeature.types,hF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function m0(l,t,o,c,f,d,m,b,C,k,x,S,I){const T=b?Math.min(ou,Math.round(b[0])):0,E=b?Math.min(ou,Math.round(b[1])):0;l.emplaceBack(t,o,Math.round(32*c),Math.round(32*f),d,m,(T<<1)+(C?1:0),E,16*k,16*x,256*S,256*I)}function g0(l,t,o){l.emplaceBack(t,o)}function y0(l,t,o,c,f,d,m){l.emplaceBack(t,o,c,f,d,m)}function _0(l,t,o,c,f){l.emplaceBack(t,o,c,f),l.emplaceBack(t,o,c,f),l.emplaceBack(t,o,c,f),l.emplaceBack(t,o,c,f)}function pF(l){for(const t of l.sections)if(H1(t.text))return!0;return!1}class Vb{constructor(t){this.layoutVertexArray=new mm,this.indexArray=new so,this.programConfigurations=t,this.segments=new _i,this.dynamicLayoutVertexArray=new Da,this.opacityVertexArray=new ym,this.placedSymbolArray=new wm,this.iconTransitioningVertexArray=new _l,this.globeExtVertexArray=new gm,this.zOffsetVertexArray=new Yc}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,o,c,f,d){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,PO.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,DO.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,hF,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,LO.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,AO.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,RO.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}ur(Vb,"SymbolBuffers");class $b{constructor(t,o,c){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new c,this.segments=new _i,this.collisionVertexArray=new Zc,this.collisionVertexArrayExt=new Da}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,zO.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,OO.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ur($b,"CollisionBuffers");class x0{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.lut=t.lut,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(m=>m.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=be.mat4.identity([]),this.placementViewportMatrix=be.mat4.identity([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Pb(this.zoom,o["text-size"]),this.iconSizeData=Pb(this.zoom,o["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),d=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(m=>Os[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Vb(new xl(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("text")||t.startsWith("symbol"))),this.icon=new Vb(new xl(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("icon")||t.startsWith("symbol"))),this.glyphOffsetArray=new F_,this.lineVertexArray=new Kh,this.symbolInstances=new Sm}calculateGlyphDependencies(t,o,c,f,d){for(let m=0;m<t.length;m++){const b=t.codePointAt(m);if(b===void 0)break;if(o[b]=!0,f&&d&&b<=65535){const C=Nm[t.charAt(m)];C&&(o[C.charCodeAt(0)]=!0)}}}updateFootprints(t,o){}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!Tb(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}populate(t,o,c,f){const d=this.layers[0],m=d.layout,b=this.projection.name==="globe",C=m.get("text-font"),k=m.get("text-field"),x=m.get("icon-image"),S=(k.value.kind!=="constant"||k.value.value instanceof vo&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),I=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,T=m.get("symbol-sort-key");if(this.features=[],!S&&!I)return;const E=o.iconDependencies,A=o.glyphDependencies,z=o.availableImages,B=new yi(this.zoom);for(const{feature:U,id:G,index:N,sourceLayerIndex:Z}of t){const J=d._featureFilter.needGeometry,he=Ut(U,J);if(!d._featureFilter.filter(B,he,c))continue;if(J||(he.geometry=Vt(U,c,f)),b&&U.type!==1&&c.z<=5){const Ae=he.geometry,Te=.98078528056,Oe=(We,Ze)=>{const Ye=km(We.x,We.y,c,1),Je=km(Ze.x,Ze.y,c,1);return be.vec3.dot(Ye,Je)<Te};for(let We=0;We<Ae.length;We++)Ae[We]=Nt(Ae[We],Oe)}let ye,xe;if(S){const Ae=d.getValueAndResolveTokens("text-field",he,c,z),Te=vo.factory(Ae);pF(Te)&&(this.hasRTLText=!0),(!this.hasRTLText||cm()==="unavailable"||this.hasRTLText&&Go.isParsed())&&(ye=jO(Te,d,he))}if(I){const Ae=d.getValueAndResolveTokens("icon-image",he,c,z);xe=Ae instanceof Io?Ae:Io.fromString(Ae)}if(!ye&&!xe)continue;const me=this.sortFeaturesByKey?T.evaluate(he,{},c):void 0;if(this.features.push({id:G,text:ye,icon:xe,index:N,sourceLayerIndex:Z,geometry:he.geometry,properties:U.properties,type:dF[U.type],sortKey:me}),xe&&(E[xe.namePrimary]=!0,xe.nameSecondary&&(E[xe.nameSecondary]=!0)),ye){const Ae=C.evaluate(he,{},c).join(","),Te=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Os.vertical)>=0;for(const Oe of ye.sections)if(Oe.image)E[Oe.image.namePrimary]=!0;else{const We=zh(ye.toString()),Ze=Oe.fontStack||Ae,Ye=A[Ze]=A[Ze]||{};this.calculateGlyphDependencies(Oe.text,Ye,Te,this.allowVerticalPlacement,We)}}}m.get("symbol-placement")==="line"&&(this.features=function(U){const G={},N={},Z=[];let J=0;function he(Ae){Z.push(U[Ae]),J++}function ye(Ae,Te,Oe){const We=N[Ae];return delete N[Ae],N[Te]=We,Z[We].geometry[0].pop(),Z[We].geometry[0]=Z[We].geometry[0].concat(Oe[0]),We}function xe(Ae,Te,Oe){const We=G[Te];return delete G[Te],G[Ae]=We,Z[We].geometry[0].shift(),Z[We].geometry[0]=Oe[0].concat(Z[We].geometry[0]),We}function me(Ae,Te,Oe){const We=Oe?Te[0][Te[0].length-1]:Te[0][0];return`${Ae}:${We.x}:${We.y}`}for(let Ae=0;Ae<U.length;Ae++){const Te=U[Ae],Oe=Te.geometry,We=Te.text?Te.text.toString():null;if(!We){he(Ae);continue}const Ze=me(We,Oe),Ye=me(We,Oe,!0);if(Ze in N&&Ye in G&&N[Ze]!==G[Ye]){const Je=xe(Ze,Ye,Oe),at=ye(Ze,Ye,Z[Je].geometry);delete G[Ze],delete N[Ye],N[me(We,Z[at].geometry,!0)]=at,Z[Je].geometry=null}else Ze in N?ye(Ze,Ye,Oe):Ye in G?xe(Ze,Ye,Oe):(he(Ae),G[Ze]=J-1,N[Ye]=J-1)}return Z.filter(Ae=>Ae.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((U,G)=>U.sortKey-G.sortKey)}update(t,o,c,f,d){const m=Object.keys(t).length!==0;if(m&&!this.stateDependentLayers.length)return;const b=m?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,o,b,c,f,d),this.icon.programConfigurations.updatePaintArrays(t,o,b,c,f,d)}updateZOffset(){const t=(d,m,b)=>{c+=m,c>d.length&&d.resize(c);for(let C=-m;C<0;C++)d.emplace(C+c,b)},o=(d,m,b)=>{f+=m,f>d.length&&d.resize(f);for(let C=-m;C<0;C++)d.emplace(C+f,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,f=0;for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:C,numIconVertices:k}=m,x=m.zOffset,S=k>0;if((b>0||C>0)&&(t(this.text.zOffsetVertexArray,b,x),t(this.text.zOffsetVertexArray,C,x)),S){const{placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:T}=m;I>=0&&o(this.icon.zOffsetVertexArray,k,x),T>=0&&o(this.icon.zOffsetVertexArray,m.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=tI(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const c=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:f,y:d}of o)this.lineVertexArray.emplaceBack(f,d);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,o,c,f,d,m,b,C,k,x,S,I,T,E,A,z){const B=t.indexArray,U=t.layoutVertexArray,G=t.globeExtVertexArray,N=t.segments.prepareSegment(4*o.length,U,B,this.canOverlap?m.sortKey:void 0),Z=this.glyphOffsetArray.length,J=N.vertexLength,he=this.allowVerticalPlacement&&b===Os.vertical?Math.PI/2:0,ye=m.text&&m.text.sections;for(let me=0;me<o.length;me++){const{tl:Ae,tr:Te,bl:Oe,br:We,texPrimary:Ze,texSecondary:Ye,pixelOffsetTL:Je,pixelOffsetBR:at,minFontScaleX:Qe,minFontScaleY:gt,glyphOffset:Et,isSDF:dt,sectionIndex:sr}=o[me],Jt=N.vertexLength,$t=Et[1];if(m0(U,k.x,k.y,Ae.x,$t+Ae.y,Ze.x,Ze.y,c,dt,Je.x,Je.y,Qe,gt),m0(U,k.x,k.y,Te.x,$t+Te.y,Ze.x+Ze.w,Ze.y,c,dt,at.x,Je.y,Qe,gt),m0(U,k.x,k.y,Oe.x,$t+Oe.y,Ze.x,Ze.y+Ze.h,c,dt,Je.x,at.y,Qe,gt),m0(U,k.x,k.y,We.x,$t+We.y,Ze.x+Ze.w,Ze.y+Ze.h,c,dt,at.x,at.y,Qe,gt),C){const{x:Dt,y:vr,z:ir}=C.anchor,[cr,Vr,tn]=C.up;y0(G,Dt,vr,ir,cr,Vr,tn),y0(G,Dt,vr,ir,cr,Vr,tn),y0(G,Dt,vr,ir,cr,Vr,tn),y0(G,Dt,vr,ir,cr,Vr,tn),_0(t.dynamicLayoutVertexArray,Dt,vr,ir,he)}else _0(t.dynamicLayoutVertexArray,k.x,k.y,k.z,he);if(z){const Dt=Ye||Ze;g0(t.iconTransitioningVertexArray,Dt.x,Dt.y),g0(t.iconTransitioningVertexArray,Dt.x+Dt.w,Dt.y),g0(t.iconTransitioningVertexArray,Dt.x,Dt.y+Dt.h),g0(t.iconTransitioningVertexArray,Dt.x+Dt.w,Dt.y+Dt.h)}B.emplaceBack(Jt,Jt+1,Jt+2),B.emplaceBack(Jt+1,Jt+2,Jt+3),N.vertexLength+=4,N.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Et[0]),me!==o.length-1&&sr===o[me+1].sectionIndex||t.programConfigurations.populatePaintArrays(U.length,m,m.index,{},T,E,A,ye&&ye[sr])}const xe=C?C.anchor:k;t.placedSymbolArray.emplaceBack(xe.x,xe.y,xe.z,k.x,k.y,Z,this.glyphOffsetArray.length-Z,J,x,S,k.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],b,0,!1,0,I,0)}_commitLayoutVertex(t,o,c,f,d,m,b){t.emplaceBack(o,c,f,d,m,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(t,o,c,f,d,m,b){const C=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),k=C.vertexLength,x=b.tileAnchorX,S=b.tileAnchorY;for(let T=0;T<4;T++)c.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,o,t.padding,b.zOffset),this._commitLayoutVertex(c.layoutVertexArray,f,d,m,x,S,new rt(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,d,m,x,S,new rt(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,d,m,x,S,new rt(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,d,m,x,S,new rt(t.x1,t.y2)),C.vertexLength+=4;const I=c.indexArray;I.emplaceBack(k,k+1),I.emplaceBack(k+1,k+2),I.emplaceBack(k+2,k+3),I.emplaceBack(k+3,k),C.primitiveLength+=4}_addTextDebugCollisionBoxes(t,o,c,f,d,m){for(let b=f;b<d;b++){const C=c.get(b),k=this.getSymbolInstanceTextSize(t,m,o,b);this._addCollisionDebugVertices(C,k,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(t,o,c,f,d,m){for(let b=f;b<d;b++){const C=c.get(b),k=this.getSymbolInstanceIconSize(t,o,m.placedIconSymbolIndex);this._addCollisionDebugVertices(C,k,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,m)}}generateCollisionDebugBuffers(t,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new $b(Jl,SE.members,_l),this.iconCollisionBox=new $b(Jl,SE.members,_l);const c=np(this.iconSizeData,t),f=np(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(f,t,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(f,t,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,t,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,t,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(t,o,c,f){const d=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),m=s0(this.textSizeData,t,d)/po;return this.tilePixelRatio*m}getSymbolInstanceIconSize(t,o,c){const f=this.icon.placedSymbolArray.get(c),d=s0(this.iconSizeData,t,f);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(t,o,c,f){t.emplaceBack(o,-c,-c,f),t.emplaceBack(o,c,-c,f),t.emplaceBack(o,c,c,f),t.emplaceBack(o,-c,c,f)}_updateTextDebugCollisionBoxes(t,o,c,f,d,m){for(let b=f;b<d;b++){const C=c.get(b),k=this.getSymbolInstanceTextSize(t,m,o,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,C.padding,m.zOffset)}}_updateIconDebugCollisionBoxes(t,o,c,f,d,m){for(let b=f;b<d;b++){const C=c.get(b),k=this.getSymbolInstanceIconSize(t,o,m.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,C.padding,m.zOffset)}}updateCollisionDebugBuffers(t,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=np(this.iconSizeData,t),f=np(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(f,t,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(f,t,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(c,t,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._updateIconDebugCollisionBoxes(c,t,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,o,c,f,d,m,b,C,k){const x={};if(o<c){const{x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N,featureIndex:Z}=t.get(o);x.textBox={x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N},x.textFeatureIndex=Z}if(f<d){const{x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N,featureIndex:Z}=t.get(f);x.verticalTextBox={x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N},x.verticalTextFeatureIndex=Z}if(m<b){const{x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N,featureIndex:Z}=t.get(m);x.iconBox={x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N},x.iconFeatureIndex=Z}if(C<k){const{x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N,featureIndex:Z}=t.get(C);x.verticalIconBox={x1:S,y1:I,x2:T,y2:E,padding:A,projectedAnchorX:z,projectedAnchorY:B,projectedAnchorZ:U,tileAnchorX:G,tileAnchorY:N},x.verticalIconFeatureIndex=Z}return x}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,o){const c=t.placedSymbolArray.get(o),f=c.vertexStartIndex+4*c.numGlyphs;for(let d=c.vertexStartIndex;d<f;d+=4)t.indexArray.emplaceBack(d,d+1,d+2),t.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),c=Math.cos(t),f=[],d=[],m=[];for(let b=0;b<this.symbolInstances.length;++b){m.push(b);const C=this.symbolInstances.get(b);f.push(0|Math.round(o*C.tileAnchorX+c*C.tileAnchorY)),d.push(C.featureIndex)}return m.sort((b,C)=>f[b]-f[C]||d[C]-d[b]),m}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:k}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),d>=0&&d!==f&&this.addIndicesForPlacedSymbol(this.text,d),m>=0&&m!==d&&m!==f&&this.addIndicesForPlacedSymbol(this.text,m),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let rI,nI,Ub;ur(x0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),x0.addDynamicAttributes=_0;class iI{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ps,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ur(iI,"FormatSectionOverride",{omit:["defaultValue"]});const Wb=()=>Ub||(Ub={layout:rI||(rI=new ci({"symbol-placement":new Zt(st.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _r(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(st.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Zt(st.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Zt(st.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Zt(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new _r(st.layout_symbol["icon-size"]),"icon-text-fit":new _r(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _r(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new _r(st.layout_symbol["icon-image"]),"icon-rotate":new _r(st.layout_symbol["icon-rotate"]),"icon-padding":new Zt(st.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(st.layout_symbol["icon-keep-upright"]),"icon-offset":new _r(st.layout_symbol["icon-offset"]),"icon-anchor":new _r(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(st.layout_symbol["text-rotation-alignment"]),"text-field":new _r(st.layout_symbol["text-field"]),"text-font":new _r(st.layout_symbol["text-font"]),"text-size":new _r(st.layout_symbol["text-size"]),"text-max-width":new _r(st.layout_symbol["text-max-width"]),"text-line-height":new _r(st.layout_symbol["text-line-height"]),"text-letter-spacing":new _r(st.layout_symbol["text-letter-spacing"]),"text-justify":new _r(st.layout_symbol["text-justify"]),"text-radial-offset":new _r(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(st.layout_symbol["text-variable-anchor"]),"text-anchor":new _r(st.layout_symbol["text-anchor"]),"text-max-angle":new Zt(st.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(st.layout_symbol["text-writing-mode"]),"text-rotate":new _r(st.layout_symbol["text-rotate"]),"text-padding":new Zt(st.layout_symbol["text-padding"]),"text-keep-upright":new Zt(st.layout_symbol["text-keep-upright"]),"text-transform":new _r(st.layout_symbol["text-transform"]),"text-offset":new _r(st.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(st.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Zt(st.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(st.layout_symbol["text-optional"]),visibility:new Zt(st.layout_symbol.visibility)})),paint:nI||(nI=new ci({"icon-opacity":new _r(st.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new _r(st.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new _r(st.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new _r(st.paint_symbol["text-emissive-strength"]),"icon-color":new _r(st.paint_symbol["icon-color"]),"icon-halo-color":new _r(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new _r(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _r(st.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(st.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new _r(st.paint_symbol["icon-image-cross-fade"]),"text-opacity":new _r(st.paint_symbol["text-opacity"]),"text-occlusion-opacity":new _r(st.paint_symbol["text-occlusion-opacity"]),"text-color":new _r(st.paint_symbol["text-color"],{runtimeType:$o,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new _r(st.paint_symbol["text-halo-color"]),"text-halo-width":new _r(st.paint_symbol["text-halo-width"]),"text-halo-blur":new _r(st.paint_symbol["text-halo-blur"]),"text-translate":new Zt(st.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(st.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Zt(st.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Zt(st.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Zt(st.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Zt(st.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new _r(st.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new Zt(st.paint_symbol["symbol-elevation-reference"])}))},Ub);class v0 extends bo{constructor(t,o,c,f){super(t,Wb(),o,c,f),this._colorAdjustmentMatrix=be.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=t.paint!==void 0&&("icon-occlusion-opacity"in t.paint||"text-occlusion-opacity"in t.paint)}recalculate(t,o){super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const d of c)f.indexOf(d)<0&&f.push(d);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(t,o,c,f){return this._saturation===t&&this._contrast===o&&this._brightnessMin===c&&this._brightnessMax===f||(this._colorAdjustmentMatrix=function(d,m,b,C){d=ke(d),m=pe(m);const k=be.mat4.create(),x=d/3,S=1-2*x,I=[S,x,x,0,x,S,x,0,x,x,S,0,0,0,0,1],T=.5-.5*m,E=C-b;return be.mat4.multiply(k,[E,0,0,0,0,E,0,0,0,0,E,0,b,b,b,1],[m,0,0,0,0,m,0,0,0,0,m,0,T,T,T,1]),be.mat4.multiply(k,k,I),k}(t,o,c,f),this._saturation=t,this._contrast=o,this._brightnessMin=c,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,o,c,f){const d=this.layout.get(t).evaluate(o,{},c,f),m=this._unevaluatedLayout._values[t];return m.isDataDriven()||Ah(m.value)||!d?d:function(b,C){return C.replace(/{([^{}]+)}/g,(k,x)=>x in b?String(b[x]):"")}(o.properties,d)}createBucket(t){return new x0(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Wb().paint.overridableProperties){if(!v0.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),c=new iI(o),f=new Ph(c,o.property.specification,this.scope,this.options);let d=null;d=o.value.kind==="constant"||o.value.kind==="source"?new nm("source",f):new na("composite",f,o.value.zoomStops,o.value._interpolationType),this.paint._values[t]=new Uc(o.property,d,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&v0.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const c=t.get("text-field"),f=Wb().paint.properties[o];let d=!1;const m=b=>{for(const C of b)if(f.overrides&&f.overrides.hasOverride(C))return void(d=!0)};if(c.value.kind==="constant"&&c.value.value instanceof vo)m(c.value.value.sections);else if(c.value.kind==="source"){const b=k=>{d||(k instanceof As&&Li(k.value)===Sc?m(k.value.sections):k instanceof Ec?m(k.sections):k.eachChild(b))},C=c.value;C._styleExpression&&b(C._styleExpression.expression)}return d}getProgramIds(){return["symbol"]}getDefaultProgramParams(t,o,c){return{config:new ec(this,{zoom:o,lut:c}),overrideFog:!1}}}let oI,sI,aI,lI;var Gb=bn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Hb(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function qb(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Zb{constructor(t,o,c,f){this.context=t,this.format=c,this.useMipmap=f&&f.useMipmap,this.texture=t.gl.createTexture(),this.update(o,{premultiply:f&&f.premultiply})}update(t,o){const c=t&&t instanceof HTMLVideoElement&&t.width===0?t.videoWidth:t.width,f=t&&t instanceof HTMLVideoElement&&t.height===0?t.videoHeight:t.height,{context:d}=this,{gl:m}=d,{x:b,y:C}=o&&o.position?o.position:{x:0,y:0},k=Math.max(b+c,this.size?this.size[0]:0),x=Math.max(C+f,this.size?this.size[1]:0);!this.size||this.size[0]===k&&this.size[1]===x||(m.bindTexture(m.TEXTURE_2D,null),m.deleteTexture(this.texture),this.texture=m.createTexture(),this.size=null),m.bindTexture(m.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===m.RGBA8&&(!o||o.premultiply!==!1));const S=t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap;if(!this.size&&k>0&&x>0){const I=this.useMipmap?Math.floor(Math.log2(Math.max(k,x)))+1:1;m.texStorage2D(m.TEXTURE_2D,I,this.format,k,x),this.size=[k,x]}if(this.size)if(S)m.texSubImage2D(m.TEXTURE_2D,0,b,C,Hb(this.format),qb(this.format),t);else{const I=t.data;I&&m.texSubImage2D(m.TEXTURE_2D,0,b,C,c,f,Hb(this.format),qb(this.format),I)}this.useMipmap&&m.generateMipmap(m.TEXTURE_2D)}bind(t,o,c=!1){const{context:f}=this,{gl:d}=f;d.bindTexture(d.TEXTURE_2D,this.texture),t!==this.minFilter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,t),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap&&!c?t===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),o!==this.wrapS&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,o),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(t,o,c,f){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.magFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),this.magFilter=o),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?t===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),this.wrapS=c),f!==this.wrapT&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,f),this.wrapT=f)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class b0{constructor(t,o){this.context=t,this.texture=o}bind(t,o){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),t!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,t),this.minFilter=t),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}}function w0(l,t,o,c,f,d,m,b){const C=[l,t,1,o,c,1,f,d,1],k=[m,b,1],x=be.mat3.adjoint([],C),[S,I,T]=be.vec3.transformMat3(k,k,x);return be.mat3.multiply(C,C,[S,0,0,0,I,0,0,0,T])}function cI(l,t,o,c,f,d,m,b){const C=function(k,x,S,I,T,E,A,z){const B=w0(0,0,1,0,1,1,0,1),U=w0(k,x,S,I,T,E,A,z),G=be.mat3.adjoint([],B);return be.mat3.multiply(U,U,G)}(l,t,o,c,f,d,m,b);return[C[2]/C[8]/er,C[5]/C[8]/er]}function S0(l){return[l[0],Math.min(Math.max(l[1],-Re),Re)]}class uI extends bc{constructor(t,o,c,f){super(),this.id=t,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=o,this._dirty=!1}load(t,o){if(this._loaded=o||!1,this.fire(new ll("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Qs(this.map._requestManager.transformRequest(this.url,ol.Image),(c,f)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new $u(c)):f&&(this.image=f instanceof HTMLImageElement?or.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new b0(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new ll("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof b0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=t[0][1],c=t[0][1];for(const d of t)d[1]>c&&(c=d[1]),d[1]<o&&(o=d[1]);const f=(c+o)/2;if(f>Re?this.onNorthPole=!0:f<-Re&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=t.map(nt.fromLngLat);this.tileID=function(m){let b=1/0,C=1/0,k=-1/0,x=-1/0;for(const A of m)b=Math.min(b,A.x),C=Math.min(C,A.y),k=Math.max(k,A.x),x=Math.max(x,A.y);const S=Math.max(k-b,x-C),I=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),T=Math.pow(2,I);let E=Math.floor((b+k)/2*T);return E>1&&(E-=1),new Xi(I,E,Math.floor((C+x)/2*T))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new ll("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const B in this.tiles){const U=this.tiles[B];U.state!=="loaded"&&(U.state="loaded",U.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Gm(new Xi(0,0,0),this.map.transform.projection),c=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(B){const U=B[1].x-B[0].x,G=B[1].y-B[0].y,N=B[2].x-B[1].x,Z=B[2].y-B[1].y,J=B[3].x-B[2].x,he=B[3].y-B[2].y,ye=B[0].x-B[3].x,xe=B[0].y-B[3].y,me=U*Z-N*G,Ae=N*he-J*Z,Te=J*xe-ye*he,Oe=ye*G-U*xe;return me>0&&Ae>0&&Te>0&&Oe>0||me<0&&Ae<0&&Te<0&&Oe<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=Gm(this.tileID,this.map.transform.projection),[d,m,b,C]=this.coordinates.map(B=>{const U=f.projection.project(B[0],B[1]);return XE(f,U)._round()});this.perspectiveTransform=cI(d.x,d.y,m.x,m.y,b.x,b.y,C.x,C.y);const k=this._boundsArray=new gl;k.emplaceBack(d.x,d.y,0,0),k.emplaceBack(m.x,m.y,er,0),k.emplaceBack(C.x,C.y,0,er),k.emplaceBack(b.x,b.y,er,er),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(k,Gb.members),this.boundsSegments=_i.simpleSegment(0,0,4,2);const x=[],S=[S0((I=this.coordinates)[0]),S0(I[1]),S0(I[2]),S0(I[3])];var I;const[T,E,A,z]=function(B){let U=B[0][0],G=U,N=B[0][1],Z=N;for(let J=1;J<B.length;J++)B[J][0]<U?U=B[J][0]:B[J][0]>G&&(G=B[J][0]),B[J][1]<N?N=B[J][1]:B[J][1]>Z&&(Z=B[J][1]);return[U,N,G-U,Z-N]}(S);{const B=new gl,[U,G,N,Z]=function(Je){let at=Je[0].x,Qe=at,gt=Je[0].y,Et=gt;for(let dt=1;dt<Je.length;dt++)Je[dt].x<at?at=Je[dt].x:Je[dt].x>Qe&&(Qe=Je[dt].x),Je[dt].y<gt?gt=Je[dt].y:Je[dt].y>Et&&(Et=Je[dt].y);return[at,gt,Qe-at,Et-gt]}(c),J=Je=>[(Je.x-U)/N,(Je.y-G)/Z],[he,ye,xe,me]=c.map(J),Ae=function(Je,at,Qe,gt,Et,dt,sr,Jt){const $t=w0(0,0,1,0,1,1,0,1),Dt=w0(Je,at,Qe,gt,Et,dt,sr,Jt),vr=be.mat3.adjoint([],Dt);return be.mat3.multiply($t,$t,vr)}(he[0],he[1],ye[0],ye[1],xe[0],xe[1],me[0],me[1]);this.elevatedGlobePerspectiveTransform=cI(he[0],he[1],ye[0],ye[1],xe[0],xe[1],me[0],me[1]);const Te=(Je,at)=>{x.push(Je.lng);const Qe=Math.round((Je.lng-T)/A*er),gt=Math.round((Je.lat-E)/z*er),Et=J(at),dt=be.vec3.transformMat3([],[Et[0],Et[1],1],Ae),sr=Math.round(dt[0]/dt[2]*er),Jt=Math.round(dt[1]/dt[2]*er);B.emplaceBack(Qe,gt,sr,Jt)},Oe=c[3].x-c[0].x,We=c[3].y-c[0].y,Ze=c[2].x-c[1].x,Ye=c[2].y-c[1].y;for(let Je=0;Je<65;Je++){const at=Je/64,Qe=[c[0].x+at*Oe,c[0].y+at*We],gt=[c[1].x+at*Ze,c[1].y+at*Ye],Et=gt[0]-Qe[0],dt=gt[1]-Qe[1];for(let sr=0;sr<65;sr++){const Jt=sr/64,$t={x:Qe[0]+Et*Jt,y:Qe[1]+dt*Jt,z:0};Te(o.projection.unproject($t.x,$t.y),$t)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(B,Gb.members)}{this.maxLongitudeTriangleSize=0;let B=[],U=new so;const G=(N,Z,J)=>{U.emplaceBack(N,Z,J);const he=x[N],ye=x[Z],xe=x[J],me=Math.min(Math.min(he,ye),xe),Ae=Math.max(Math.max(he,ye),xe)-me;Ae>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ae),B.push(me+Ae/2)};for(let N=0;N<64;N++)for(let Z=0;Z<64;Z++){const J=65*N+Z,he=J+1,ye=J+65,xe=ye+1;G(J,ye,he),G(he,ye,xe)}[B,U]=function(N,Z){const J=Array.from({length:N.length},(xe,me)=>me);J.sort((xe,me)=>N[xe]-N[me]);const he=[],ye=new so;for(let xe=0;xe<J.length;xe++){const me=J[xe];he.push(N[me]);const Ae=3*me,Te=Ae+1;ye.emplaceBack(Z.uint16[Ae],Z.uint16[Te],Z.uint16[Te+1])}return[he,ye]}(B,U),this.elevatedGlobeTrianglesCenterLongitudes=B,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(U)}this.elevatedGlobeSegments=_i.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,A/er,0,z/er,0,0,E,T,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const o=this.map.painter.context,c=o.gl;!this._dirty||this.texture instanceof b0||(this.texture?this.texture.update(this.image):(this.texture=new Zb(o,this.image,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(o)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let f=(d=t+180)+360*Math.round((c[0]-d)/360);var d;const m=new _i,b=(S,I)=>{m.segments.push({vertexOffset:0,primitiveOffset:S,vertexLength:o.segments[0].vertexLength,primitiveLength:I,sortKey:void 0,vaos:{}})},C=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-f)<=C){const S=ue(c,0,c.length,f+C);return S===c.length||b(S,ut(c,S+1,c.length,f+360-C)-S),m}f<c[0]&&(f+=360);const k=ut(c,0,c.length,f-C);if(k===c.length)return b(0,c.length),m;b(0,k-0);const x=ue(c,k+1,c.length,f+C);return x!==c.length&&b(x,c.length-x),m}}const fF=(Math.pow(256,2)-1)/16907520;class dI extends bo{constructor(t,o,c,f){super(t,{layout:aI||(aI=new ci({visibility:new Zt(st.layout_raster.visibility)})),paint:lI||(lI=new ci({"raster-opacity":new Zt(st.paint_raster["raster-opacity"]),"raster-color":new Rs(st.paint_raster["raster-color"]),"raster-color-mix":new Zt(st.paint_raster["raster-color-mix"]),"raster-color-range":new Zt(st.paint_raster["raster-color-range"]),"raster-hue-rotate":new Zt(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(st.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(st.paint_raster["raster-saturation"]),"raster-contrast":new Zt(st.paint_raster["raster-contrast"]),"raster-resampling":new Zt(st.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(st.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Zt(st.paint_raster["raster-emissive-strength"]),"raster-array-band":new Zt(st.paint_raster["raster-array-band"]),"raster-elevation":new Zt(st.paint_raster["raster-elevation"])}))},o,c,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof uI&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[c,f]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(f)||c===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=Pm({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,f])}}let hI,pI,fI,mI,gI;class yI extends bo{constructor(t,o,c,f){super(t,{layout:hI||(hI=new ci({visibility:new Zt(st["layout_raster-particle"].visibility)})),paint:pI||(pI=new ci({"raster-particle-array-band":new Zt(st["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Zt(st["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Rs(st["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Zt(st["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Zt(st["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Zt(st["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Zt(st["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Zt(st["paint_raster-particle"]["raster-particle-elevation"])}))},o,c,f),this._updateColorRamp(),this.lastInvalidatedAt=or.now()}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Pm({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=or.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class mF extends bo{constructor(t,o){super(t,{},o,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function Yb(l,t,o){const c=[0,0,1],f=be.quat.identity([]);return be.quat.rotateY(f,f,o?-Wt(l)+Math.PI:Wt(l)),be.quat.rotateX(f,f,-Wt(t)),be.vec3.transformQuat(c,c,f),be.vec3.normalize(c,c)}function _I(l,t){const o=T0(l.projection,l.zoom,l.width,l.height),c=function(d,m,b,C,k){const x=new W(b.lng-180*au,b.lat),S=new W(b.lng+180*au,b.lat),I=d.project(x.lng,x.lat),T=d.project(S.lng,S.lat),E=-Math.atan2(T.y-I.y,T.x-I.x),A=nt.fromLngLat(b);A.y=Xt(A.y,-1+au,1-au);const z=A.toLngLat(),B=d.project(z.lng,z.lat),U=nt.fromLngLat(z);U.x+=au;const G=U.toLngLat(),N=d.project(G.lng,G.lat),Z=vI(N.x-B.x,N.y-B.y,E),J=nt.fromLngLat(z);J.y+=au;const he=J.toLngLat(),ye=d.project(he.lng,he.lat),xe=vI(ye.x-B.x,ye.y-B.y,E),me=Math.abs(Z.x)/Math.abs(xe.y),Ae=be.mat4.identity([]);be.mat4.rotateZ(Ae,Ae,-E*(1-(k?0:C)));const Te=be.mat4.identity([]);return be.mat4.scale(Te,Te,[1,1-(1-me)*C,1]),Te[4]=-xe.x/xe.y*C,be.mat4.rotateZ(Te,Te,E),be.mat4.multiply(Te,Ae,Te),Te}(l.projection,0,l.center,o,t),f=xI(l);return be.mat4.scale(c,c,[f,f,1]),c}function xI(l){const t=l.projection,o=T0(l.projection,l.zoom,l.width,l.height),c=Xb(t,l.center),f=Xb(t,W.convert(t.center));return Math.pow(2,c*o+(1-o)*f)}function T0(l,t,o,c,f=1/0){const d=l.range;if(!d)return 0;const m=Math.min(f,Math.max(o,c)),b=Math.log(m/1024)/Math.LN2;return Hr(d[0]+b,d[1]+b,t)}const au=1/4e4;function Xb(l,t){const o=Xt(t.lat,-Re,Re),c=new W(t.lng-180*au,o),f=new W(t.lng+180*au,o),d=l.project(c.lng,o),m=l.project(f.lng,o),b=nt.fromLngLat(c),C=nt.fromLngLat(f),k=m.x-d.x,x=m.y-d.y,S=C.x-b.x,I=C.y-b.y,T=Math.sqrt((S*S+I*I)/(k*k+x*x));return Math.log(T)/Math.LN2}function vI(l,t,o){const c=Math.cos(o),f=Math.sin(o);return{x:l*c-t*f,y:l*f+t*c}}function bI(l,t,o){be.mat4.identity(l),be.mat4.rotateZ(l,l,Wt(t[2])),be.mat4.rotateX(l,l,Wt(t[0])),be.mat4.rotateY(l,l,Wt(t[1])),be.mat4.scale(l,l,o),be.mat4.multiply(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function C0(l,t,o,c,f,d,m,b){const C=[o[0]-t[0],o[1]-t[1],0],k=[c[0]-t[0],c[1]-t[1],0];if(be.vec3.length(C)<1e-12||be.vec3.length(k)<1e-12)return be.quat.identity(l);const x=be.vec3.cross([],C,k);be.vec3.normalize(x,x),be.vec3.subtract(k,c,t),C[2]=(d-f)*b,k[2]=(m-f)*b;const S=C;return be.vec3.cross(S,C,k),be.vec3.normalize(S,S),be.quat.rotationTo(l,x,S)}function Kb(l,t,o=!1){const c=tu(t.zoom),f=function(d,m,b){const C=m.worldSize,k=[d[12],d[13],d[14]],x=Me(k[1]/C),S=Ee(k[0]/C),I=be.mat4.identity([]),T=ge(1,x)*C,E=ge(1,0)*C*qe(x,m.zoom),A=1/db(C);let z=E*A;if(b){const N=T0(m.projection,m.zoom,m.width,m.height,1024);z=A*m.projection.pixelSpaceConversion(m.center.lat,C,N)}const B=F(x,S);be.vec3.add(B,B,be.vec3.scale([],be.vec3.normalize([],B),T*z*k[2]));const U=function(N){const Z=[N[0],N[1],N[2]];let J=[0,1,0];const he=be.vec3.cross([],J,Z);return be.vec3.cross(J,Z,he),be.vec3.squaredLength(J)===0&&(J=[0,1,0],be.vec3.cross(he,Z,J)),be.vec3.normalize(he,he),be.vec3.normalize(J,J),be.vec3.normalize(Z,Z),[he[0],he[1],he[2],0,J[0],J[1],J[2],0,Z[0],Z[1],Z[2],0,N[0],N[1],N[2],1]}(B);be.mat4.scale(I,I,[z,z,z*T]),be.mat4.translate(I,I,[-k[0],-k[1],-k[2]]);const G=be.mat4.multiply([],m.globeMatrix,U);return be.mat4.multiply(G,G,I),be.mat4.multiply(G,G,d),G}(l,t,o);if(c>0){const d=function(m,b){const C=b.worldSize,k=ge(1,0)*C*qe(b.center.lat,b.zoom)/db(C),x=ge(1,b.center.lat)*C,S=be.mat4.identity([]);return be.mat4.rotateY(S,S,Wt(b.center.lng)),be.mat4.rotateX(S,S,Wt(b.center.lat)),be.mat4.translate(S,S,[0,0,n]),be.mat4.scale(S,S,[k,k,k*x]),be.mat4.translate(S,S,[b.point.x-.5*C,b.point.y-.5*C,0]),be.mat4.multiply(S,S,m),be.mat4.multiply(S,b.globeMatrix,S)}(l,t);return function(m,b,C){const k=(E,A,z)=>{const B=be.vec3.length(E),U=be.vec3.length(A),G=rc(E,A,z);return be.vec3.scale(G,G,1/be.vec3.length(G)*Pr(B,U,z))},x=k([m[0],m[1],m[2]],[b[0],b[1],b[2]],C),S=k([m[4],m[5],m[6]],[b[4],b[5],b[6]],C),I=k([m[8],m[9],m[10]],[b[8],b[9],b[10]],C),T=rc([m[12],m[13],m[14]],[b[12],b[13],b[14]],C);return[x[0],x[1],x[2],0,S[0],S[1],S[2],0,I[0],I[1],I[2],0,T[0],T[1],T[2],1]}(f,d,c)}return f}function wI(l,t,o,c){const f=Yn.projectAabbCorners(c,o);let d=Number.MAX_VALUE,m=-1;for(let k=0;k<f.length;++k){const x=f[k];x[0]=(.5*x[0]+.5)*t.width,x[1]=(.5-.5*x[1])*t.height,x[2]<d&&(m=k,d=x[2])}const b=k=>new rt(f[k][0],f[k][1]);let C;switch(m){case 0:case 6:C=[b(1),b(5),b(4),b(7),b(3),b(2),b(1)];break;case 1:case 7:C=[b(0),b(4),b(5),b(6),b(2),b(3),b(0)];break;case 3:case 5:C=[b(1),b(0),b(4),b(7),b(6),b(2),b(1)];break;default:C=[b(1),b(5),b(6),b(7),b(3),b(0),b(1)]}if(Kt(l,C))return d}const gF=bn([{name:"a_pos_3f",components:3,type:"Float32"}]),yF=bn([{name:"a_color_3f",components:3,type:"Float32"}]),_F=bn([{name:"a_color_4f",components:4,type:"Float32"}]),xF=bn([{name:"a_uv_2f",components:2,type:"Float32"}]),vF=bn([{name:"a_normal_3f",components:3,type:"Float32"}]),bF=bn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),wF=bn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),SI={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class M0{constructor(t,o,c,f){this.message=(t?`${t}: `:"")+c,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function TI(l,t){const o=l.indexOf("://")===-1;try{return new URL(l,o&&t?"http://example.com":void 0),!0}catch{return!1}}class CI{constructor(t,o){this.feature=t,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class MI{constructor(){this.instancedDataArray=new pd,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Jb{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(t,o){}populate(t,o,c,f){this.tileToMeter=$e(c);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:m,id:b,index:C,sourceLayerIndex:k}of t){const x=b??(m.properties&&m.properties.hasOwnProperty("id")?m.properties.id:void 0),S=Ut(m,d);if(!this.layers[0]._featureFilter.filter(new yi(this.zoom),S,c))continue;const I={id:x,sourceLayerIndex:k,index:C,geometry:d?S.geometry:Vt(m,c,f),properties:m.properties,type:m.type,patterns:{}},T=this.addFeature(I,I.geometry,S);T&&o.featureIndex.insert(m,I.geometry,C,k,this.index,this.instancesPerModel[T].instancedDataArray.length,er/32)}this.lookup=null}update(t,o,c,f){for(const d in this.instancesPerModel){const m=this.instancesPerModel[d];for(const b in t)m.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(m.features[m.idToFeaturesIndex[b]],t[b],m,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];for(const f of c.features){const d=this.layers[0],m=f.feature,b=this.canonical,C=d.paint.get("model-rotation").evaluate(m,{},b),k=d.paint.get("model-scale").evaluate(m,{},b),x=d.paint.get("model-translation").evaluate(m,{},b);be.vec3.exactEquals(f.rotation,C)&&be.vec3.exactEquals(f.scale,k)&&be.vec3.exactEquals(f.translation,x)||(this.evaluate(f,f.featureStates,c,!0),t=!0)}}return t}updateReplacement(t,o,c,f){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const d=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(Tb(this.activeReplacements,d))return!1;this.activeReplacements=d;let m=!1;for(const b in this.instancesPerModel){const C=this.instancesPerModel[b],k=C.instancedDataArray;for(const x of C.features){const S=x.instancedDataOffset,I=x.instancedDataCount;for(let T=0;T<I;T++){const E=16*(T+S);let A=k.float32[E+0];const z=A>er;A=z?A-er:A;const B=Math.floor(A),U=k.float32[E+1];let G=!1;for(const N of this.activeReplacements)if(!VM(N,c,SI.Model,f)&&!(N.min.x>B||B>N.max.x||N.min.y>U||U>N.max.y)&&(G=qM(HM(B,U,t.canonical,N.footprintTileId.canonical),N.footprint),G))break;k.float32[E]=G?A+er:A,m=m||G!==z}}}return m}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=t.createVertexBuffer(c.instancedDataArray,bF.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris)for(const o of this.modelUris)t.removeModel(o,"")}addFeature(t,o,c){const f=this.layers[0],d=f.layout.get("model-id").evaluate(c,{},this.canonical);if(!d)return hr(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),d;TI(d,!1)&&(this.modelUris.includes(d)||this.modelUris.push(d)),this.instancesPerModel[d]||(this.instancesPerModel[d]=new MI);const m=this.instancesPerModel[d],b=m.instancedDataArray,C=new CI(c,b.length);for(const k of o)for(const x of k){if(x.x<0||x.x>=er||x.y<0||x.y>=er)continue;const S=(this.lookupDim-1)/er,I=this.lookupDim*(x.y*S|0)+x.x*S|0;if(this.lookup){if(this.lookup[I]!==0)continue;this.lookup[I]=1}this.instanceCount++;const T=b.length;b.resize(T+1),m.instancesEvaluatedElevation.push(0),b.float32[16*T]=x.x,b.float32[16*T+1]=x.y}return C.instancedDataCount=m.instancedDataArray.length-C.instancedDataOffset,C.instancedDataCount>0&&(t.id&&(m.idToFeaturesIndex[t.id]=m.features.length),m.features.push(C),this.evaluate(C,{},m,!1)),d}getModelUris(){return this.modelUris}evaluate(t,o,c,f){const d=this.layers[0],m=t.feature,b=this.canonical,C=t.rotation=d.paint.get("model-rotation").evaluate(m,o,b),k=t.scale=d.paint.get("model-scale").evaluate(m,o,b),x=t.translation=d.paint.get("model-translation").evaluate(m,o,b),S=d.paint.get("model-color").evaluate(m,o,b);S.a=d.paint.get("model-color-mix-intensity").evaluate(m,o,b);const I=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,k[0]),Math.max(k[1],k[2])),bI(I,C,k);const T=Math.round(100*S.a)+S.b/1.05;for(let E=0;E<t.instancedDataCount;++E){const A=t.instancedDataOffset+E,z=16*A,B=c.instancedDataArray.float32;let U=0;f&&(U=B[z+6]-c.instancesEvaluatedElevation[A]);const G=0|B[z+1];B[z]=(0|B[z])+S.r/1.05,B[z+1]=G+S.g/1.05,B[z+2]=T,B[z+3]=1/(b.z>10?this.tileToMeter:$e(b,G)),B[z+4]=x[0],B[z+5]=x[1],B[z+6]=x[2]+U,B[z+7]=I[0],B[z+8]=I[1],B[z+9]=I[2],B[z+10]=I[4],B[z+11]=I[5],B[z+12]=I[6],B[z+13]=I[8],B[z+14]=I[9],B[z+15]=I[10],c.instancesEvaluatedElevation[A]=x[2]}}}let EI,II;ur(Jb,"ModelBucket",{omit:["layers"]}),ur(MI,"PerModelAttributes"),ur(CI,"ModelFeature");const vd=64,lp={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function kI(l,t,o,c,f,d,m,b,C,k=!1){const x=o.zoom,S=o.project(c),I=qe(c.lat,x),T=1/I;be.mat4.identity(l),be.mat4.translate(l,l,[S.x+m[0]*T,S.y+m[1]*T,m[2]]);let E=1,A=1;const z=o.worldSize;if(k){if(o.projection.name==="mercator"){let N=0;o.elevation&&(N=o.elevation.getAtPointOrZero(new nt(S.x/z,S.y/z),0));const Z=be.vec4.transformMat4([],[S.x,S.y,N,1],o.projMatrix)[3]/o.cameraToCenterDistance;E=Z,A=Z*qe(o.center.lat,x)}else if(o.projection.name==="globe"){const N=Kb(l,o),Z=be.mat4.multiply([],o.projMatrix,N),J=[0,0,0,1];be.vec4.transformMat4(J,J,Z);const he=J[3]/o.cameraToCenterDistance,ye=tu(x),xe=o.projection.pixelsPerMeter(c.lat,z)*qe(c.lat,x),me=o.projection.pixelsPerMeter(o.center.lat,z)*qe(o.center.lat,x);E=he/Pr(xe,Ne(o.center.lat),ye),A=he*I/xe,E*=me,A*=me}}else E=T;be.mat4.scale(l,l,[E,E,A]);const B=[...l],U=t.orientation,G=[];if(bI(G,[U[0]+f[0],U[1]+f[1],U[2]+f[2]],d),be.mat4.multiply(l,B,G),b&&o.elevation){let N=0;const Z=[];if(C&&o.elevation){N=function(ye,xe,me,Ae,Te){const Oe=xe.elevation;if(!Oe)return 0;const We=Yn.projectAabbCorners(me,Ae),Ze=ge(1,Te.lat)*xe.worldSize,Ye=function(vr,ir){const cr=[0,0,1],Vr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const tn of Vr){const Xr=vr[tn.corners[0]],Kr=vr[tn.corners[1]],on=vr[tn.corners[2]],an=[Kr[0]-Xr[0],Kr[1]-Xr[1],ir*(Kr[2]-Xr[2])],Wn=be.vec3.cross(an,an,[on[0]-Xr[0],on[1]-Xr[1],ir*(on[2]-Xr[2])]);be.vec3.normalize(Wn,Wn),tn.dotProductWithUp=be.vec3.dot(Wn,cr)}return Vr.sort((tn,Xr)=>tn.dotProductWithUp-Xr.dotProductWithUp),Vr[0].corners}(We,Ze),Je=We[Ye[0]],at=We[Ye[1]],Qe=We[Ye[2]],gt=We[Ye[3]],Et=Oe.getAtPointOrZero(new nt(Je[0]/xe.worldSize,Je[1]/xe.worldSize),0),dt=Oe.getAtPointOrZero(new nt(at[0]/xe.worldSize,at[1]/xe.worldSize),0),sr=Oe.getAtPointOrZero(new nt(Qe[0]/xe.worldSize,Qe[1]/xe.worldSize),0),Jt=Oe.getAtPointOrZero(new nt(gt[0]/xe.worldSize,gt[1]/xe.worldSize),0),$t=(Et+Jt)/2,Dt=(dt+sr)/2;return $t>Dt?dt<sr?C0(ye,at,gt,Je,dt,Jt,Et,Ze):C0(ye,Qe,Je,gt,sr,Et,Jt,Ze):Et<Jt?C0(ye,Je,at,Qe,Et,dt,sr,Ze):C0(ye,gt,Qe,at,Jt,sr,dt,Ze),Math.max($t,Dt)}(Z,o,t.aabb,l,c);const J=be.mat4.fromQuat([],Z),he=be.mat4.multiply([],J,G);be.mat4.multiply(l,B,he)}else N=o.elevation.getAtPointOrZero(new nt(S.x/z,S.y/z),0);N!==0&&(l[14]+=N)}}function Xm(l,t,o=!1){l.uploaded||(l.gfxTexture=new Zb(t,l.image,o?t.gl.R8:t.gl.RGBA8,{useMipmap:l.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function SF(l,t,o){l.indexBuffer=t.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=t.createVertexBuffer(l.vertexArray,gF.members,!1,!0),l.normalArray&&(l.normalBuffer=t.createVertexBuffer(l.normalArray,vF.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=t.createVertexBuffer(l.texcoordArray,xF.members,!1,!0)),l.colorArray&&(l.colorBuffer=t.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?yF:_F).members,!1,!0)),l.featureArray&&(l.pbrBuffer=t.createVertexBuffer(l.featureArray,wF.members,!0)),l.segments=_i.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const c=l.material;c.pbrMetallicRoughness.baseColorTexture&&Xm(c.pbrMetallicRoughness.baseColorTexture,t),c.pbrMetallicRoughness.metallicRoughnessTexture&&Xm(c.pbrMetallicRoughness.metallicRoughnessTexture,t),c.normalTexture&&Xm(c.normalTexture,t),c.occlusionTexture&&Xm(c.occlusionTexture,t,o),c.emissionTexture&&Xm(c.emissionTexture,t)}function Qb(l,t,o){if(l.meshes)for(const c of l.meshes)SF(c,t,o);if(l.children)for(const c of l.children)Qb(c,t,o)}function E0(l){if(l.meshes)for(const t of l.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(l.children)for(const t of l.children)E0(t)}function ew(l){if(l.meshes)for(const o of l.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((t=o.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(l.children)for(const o of l.children)ew(o)}class cp{constructor(t,o,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(t,o,c){const f=c||t.findDEMTileFor(o);if(!f||!f.dem)return;const d=f.dem,m=f.tileID,b=1<<o.canonical.z-m.canonical.z;return new cp(f,d.dim/er/b,[(o.canonical.x/b-m.canonical.x)*d.dim,(o.canonical.y/b-m.canonical.y)*d.dim])}tileCoordToPixel(t,o){const c=o*this._scale+this._offset[1],f=Math.floor(t*this._scale+this._offset[0]),d=Math.floor(c);return new rt(f,d)}getElevationAt(t,o,c,f){const d=t*this._scale+this._offset[0],m=o*this._scale+this._offset[1],b=Math.floor(d),C=Math.floor(m),k=this._dem;return f=!!f,c?Pr(Pr(k.get(b,C,f),k.get(b,C+1,f),m-C),Pr(k.get(b+1,C,f),k.get(b+1,C+1,f),m-C),d-b):k.get(b,C,f)}getElevationAtPixel(t,o,c){return this._dem.get(t,o,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*ge(1,t)*this._dem.stride}}const tw=new Float32Array(262144),bd=new Uint8Array(262144);function PI(l){let t=0;if(l.meshes)for(const o of l.meshes)t=Math.max(t,o.aabb.max[2]);if(l.children)for(const o of l.children)t=Math.max(t,PI(o));return t}function AI(l,t,o){if(l.meshes)for(const c of l.meshes)c.aabb.min[0]!==1/0&&o.insert(t,c.aabb.min[0],c.aabb.min[1],c.aabb.max[0],c.aabb.max[1]);if(l.children)for(const c of l.children)AI(c,t,o)}const DI=["","wall","door","roof","window","lamp","logo"];class RI{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:t.id,geometry:[],properties:{height:PI(t)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Yn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const o=new Yn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==t&&(c.transformedAabb=Yn.applyTransformFast(c.aabb,this.node.matrix),o.encapsulate(c.transformedAabb)),t++;this.aabb=o}return this.aabb}}class I0{constructor(t,o,c,f,d,m){this.id=o,this.modelTraits|=lp.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=lp.HasMapboxMeshFeatures),f&&(this.modelTraits|=lp.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=d,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const b of t)this.nodesInfo.push(new RI(b)),AI(b,m.featureIndexArray.length,m.grid),m.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,m.bucketLayerIDs.length-1,0)}updateFootprints(t,o){for(const c of this.getNodesInfo()){const f=c.node;f.footprint&&o.push({footprint:f.footprint,id:t})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const c of o){const f=c.node;this.uploaded?this.updatePbrBuffer(f):Qb(f,t,!0)}for(const c of o)E0(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let o=!1;if(!t.meshes)return o;for(const c of t.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),o=!0);return o}needsReEvaluation(t,o,c){const f=t.transform.projectionOptions,d=t.style.getBrightness(),m=this.brightness!==d;return!!(!this.uploaded||this.dirty||f.name!==this.projection.name||Km(c.paint.get("model-color").value,m)||Km(c.paint.get("model-color-mix-intensity").value,m)||Km(c.paint.get("model-roughness").value,m)||Km(c.paint.get("model-emissive-strength").value,m)||Km(c.paint.get("model-height-based-emissive-strength-multiplier").value,m))&&(this.projection=f,this.brightness=d,!0)}evaluateScale(t,o){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const c=this.getNodesInfo(),f=this.id.canonical;for(const d of c){const m=d.feature;d.evaluatedScale=o.paint.get("model-scale").evaluate(m,{},f)}}evaluate(t){const o=this.getNodesInfo();for(const c of o){if(!c.node.meshes)continue;const f=c.feature,d=c.node.meshes&&c.node.meshes[0].featureData,m=c.evaluatedColor[2],b=c.evaluatedRMEA[2],C=this.id.canonical;if(c.hasTranslucentParts=!1,d){for(let k=0;k<DI.length;k++){const x=DI[k];x.length&&(f.properties.part=x);const S=t.paint.get("model-color").evaluate(f,{},C).toRenderColor(null),I=t.paint.get("model-color-mix-intensity").evaluate(f,{},C);c.evaluatedColor[k]=[S.r,S.g,S.b,I],c.evaluatedRMEA[k][0]=t.paint.get("model-roughness").evaluate(f,{},C),c.evaluatedRMEA[k][2]=t.paint.get("model-emissive-strength").evaluate(f,{},C),c.evaluatedRMEA[k][3]=S.a,c.emissionHeightBasedParams[k]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(f,{},C),!c.hasTranslucentParts&&S.a<1&&(c.hasTranslucentParts=!0)}delete f.properties.part,CF(c,m!==c.evaluatedColor[2]||b!==c.evaluatedRMEA[2],this.modelTraits)}else c.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(f,{},C);c.evaluatedScale=t.paint.get("model-scale").evaluate(f,{},C),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,o,c,f){const d=t.findDEMTileFor(c);if(d&&(d.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const m=cp.create(t,c,d);if(!m)return;this.modelTraits&lp.HasMapboxMeshFeatures&&this.updateDEM(t,m,c,f);for(const b of this.getNodesInfo()){const C=b.node;if(!C.footprint||!C.footprint.vertices||!C.footprint.vertices.length)continue;const k=C.footprint.vertices;let x=m.getElevationAt(k[0].x,k[0].y,!0,!0);for(let S=1;S<k.length;S++)x=Math.min(x,m.getElevationAt(k[S].x,k[S].y,!0,!0));C.elevation=x}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=o}}updateDEM(t,o,c,f){let d=o._dem._modifiedForSources[f];if(d===void 0&&(o._dem._modifiedForSources[f]=[],d=o._dem._modifiedForSources[f]),d.includes(c.canonical))return;const m=o._dem.dim;d.push(c.canonical);let b=!1;for(const C of this.getNodesInfo()){const k=C.node;if(!k.footprint||!k.footprint.grid)continue;const x=k.footprint.grid,S=o.tileCoordToPixel(x.min.x,x.min.y),I=o.tileCoordToPixel(x.max.x,x.max.y),T=Math.min(Math.min(m-I.y,S.x),Math.min(S.y,m-I.x));if(T<0)continue;const E=Xt(T,2,5);let A=Math.max(0,S.x-E),z=Math.max(0,S.y-E),B=Math.min(I.x+E,m-1),U=Math.min(I.y+E,m-1);for(let J=z;J<=U;++J)for(let he=A;he<=B;++he)bd[J*m+he]=255;let G=0,N=0;for(let J=0;J<x.cellsY;++J)for(let he=0;he<x.cellsX;++he){if(!x.cells[J*x.cellsX+he])continue;const ye=o.tileCoordToPixel(x.min.x+he/x.xScale,x.min.y+J/x.yScale),xe=o.tileCoordToPixel(x.min.x+(he+1)/x.xScale,x.min.y+(J+1)/x.yScale);for(let me=ye.y;me<=Math.min(xe.y+1,m-1);++me)for(let Ae=ye.x;Ae<=Math.min(xe.x+1,m-1);++Ae)bd[me*m+Ae]===255&&(bd[me*m+Ae]=0,G+=o.getElevationAtPixel(Ae,me),N++)}const Z=G/N;A=Math.max(1,S.x-E),z=Math.max(1,S.y-E),B=Math.min(I.x+E,m-2),U=Math.min(I.y+E,m-2),b=!0;for(let J=z;J<=U;++J)for(let he=A;he<=B;++he)bd[J*m+he]===0&&(tw[J*m+he]=o._dem.set(he,J,Z));for(let J=1;J<E;++J){A=Math.max(1,S.x-J),z=Math.max(1,S.y-J),B=Math.min(I.x+J,m-2),U=Math.min(I.y+J,m-2);for(let he=z;he<=U;++he)for(let ye=A;ye<=B;++ye){const xe=he*m+ye;if(bd[xe]===255){let me=0,Ae=0,Te=-1,Oe=-1;for(let We=-1;We<=1;++We)for(let Ze=-1;Ze<=1;++Ze){const Ye=(he+We)*m+ye+Ze;if(bd[Ye]>=J)continue;const Je=tw[Ye],at=Math.abs(Je);at>Ae&&(me=Je,Ae=at,Te=Ze,Oe=We)}if(Ae>.1){const We=1-(J+.5*Math.abs(Te*Oe))/E;let Ze=o._dem.get(ye,he)+me*We;const Ye=o._dem.get(ye+Te,he+Oe),Je=o._dem.get(ye-Te,he-Oe,!0);(Ze-Ye)*(Ze-Je)>0&&(Ze=(Ye+Je)/2),tw[xe]=o._dem.set(ye,he,Ze),bd[xe]=J}}}}}b&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=or.now())}getNodesInfo(){return this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const o of t)E0(o.node),ew(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(t.toUnwrapped()),f=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const m=f[d].node;f[d].hiddenByReplacement=!!m.footprint&&!c.find(b=>b.footprint===m.footprint)}}getHeightAtTileCoord(t,o){const c=this.getNodesInfo(),f=[],d=[0,0,0],m=be.mat4.identity([]);for(let b=0;b<this.nodesInfo.length;b++){const C=c[b],k=C.node.meshes[0],x=k.transformedAabb;if(t<x.min[0]||o<x.min[1]||t>x.max[0]||o>x.max[1])continue;if(C.node.hidden===!0)return{height:1/0,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};be.mat4.invert(m,C.node.matrix),d[0]=t,d[1]=o,be.vec3.transformMat4(d,d,m);const S=(d[0]-k.aabb.min[0])/(k.aabb.max[0]-k.aabb.min[0])*vd|0,I=Math.min(63,(d[1]-k.aabb.min[1])/(k.aabb.max[1]-k.aabb.min[1])*vd|0)*vd+Math.min(63,S),T=k.heightmap[I];if(!(T<0&&C.node.footprint))return C.hiddenByReplacement?void 0:{height:T,maxHeight:C.feature.properties.height,hidden:!1,verticalScale:C.evaluatedScale[2]};if(C.node.footprint.grid.query(new rt(t,o),new rt(t,o),f),f.length>0)return{height:void 0,maxHeight:C.feature.properties.height,hidden:C.hiddenByReplacement,verticalScale:C.evaluatedScale[2]}}}}function Km(l,t){return!l.isLightConstant&&t}function TF(l,t,o,c,f,d,m,b){let C=(61440&t|(61440&t)>>4)>>8,k=(3840&t|(3840&t)>>4)>>4,x=240&t|(240&t)>>4;o[3]>0&&(C=Pr(C,255*o[0],o[3]),k=Pr(k,255*o[1],o[3]),x=Pr(x,255*o[2],o[3]));const S=C<<8|k,I=x<<8|Math.floor(255*c[3]),T=function(J){const he=Xt(J,0,2);return Math.min(Math.round(.5*he*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],E=Xt(f[0],0,1),A=Xt(f[1],0,1),z=Xt(f[2],0,1),B=Xt(f[3],0,1);let U,G,N,Z;if(E!==A&&m!==d&&A!==E){const J=m-d;G=1/(J*(A-E)),N=-(d+J*E)/(J*(A-E));const he=Xt(f[4],-1,1);Z=Math.pow(10,he),U=255*z<<8|255*B}else U=65535,G=0,N=1,Z=1;if(l.emplaceBack(S,I,T,U,G,N,Z),b){const J=b.length;b.clear();for(let he=0;he<J;he++)b.emplaceBack(S,I,T,U,G,N,Z)}}function CF(l,t,o){const c=l.node;let f=0;const d=o&lp.HasMeshoptCompression;for(const m of c.meshes){if(c.lights&&c.lightMeshIndex===f||!m.featureData)continue;m.featureArray=new qh,m.featureArray.reserve(m.featureData.length);let b=t;for(const C of m.featureData){const k=d?65535&C:C>>16&65535,x=d?C>>16&65535:65535&C,S=(15&x)<8?15&x:0,I=l.evaluatedRMEA[S],T=l.evaluatedColor[S],E=l.emissionHeightBasedParams[S];let A;if(b&&S===2&&c.lights&&(A=new qh,A.resize(10*c.lights.length)),TF(m.featureArray,k,T,I,E,m.aabb.min[2],m.aabb.max[2],A),A&&b){b=!1;const z=c.meshes[c.lightMeshIndex];z.featureArray=A,z.featureArray._trim()}}m.featureArray._trim(),f++}}function LI(l,t,o,c){const f=1<<l.z;t.lat=Me((c/er+l.y)/f),t.lng=Ee((o/er+l.x)/f)}ur(I0,"Tiled3dModelBucket",{omit:["layers"]}),ur(RI,"Tiled3dModelFeature");const MF={circle:class extends bo{constructor(l,t,o,c){super(l,{layout:Dn||(Dn=new ci({"circle-sort-key":new _r(st.layout_circle["circle-sort-key"]),visibility:new Zt(st.layout_circle.visibility)})),paint:xi||(xi=new ci({"circle-radius":new _r(st.paint_circle["circle-radius"]),"circle-color":new _r(st.paint_circle["circle-color"]),"circle-blur":new _r(st.paint_circle["circle-blur"]),"circle-opacity":new _r(st.paint_circle["circle-opacity"]),"circle-translate":new Zt(st.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _r(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _r(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _r(st.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Zt(st.paint_circle["circle-emissive-strength"])}))},t,o,c)}createBucket(l){return new xr(l)}queryRadius(l){const t=l;return ui("circle-radius",this,t)+ui("circle-stroke-width",this,t)+On(this.paint.get("circle-translate"))}queryIntersectsFeature(l,t,o,c,f,d,m,b){const C=wn(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o);return hM(l,c,d,m,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",C,k)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,t,o){const c=dM(this);return{config:new ec(this,{zoom:t,lut:o}),defines:c,overrideFog:!1}}},heatmap:class extends bo{createBucket(l){return new fM(l)}constructor(l,t,o,c){super(l,{layout:mM||(mM=new ci({visibility:new Zt(st.layout_heatmap.visibility)})),paint:gM||(gM=new ci({"heatmap-radius":new _r(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _r(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Rs(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(st.paint_heatmap["heatmap-opacity"])}))},t,o,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pm({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return ui("heatmap-radius",this,l)}queryIntersectsFeature(l,t,o,c,f,d,m,b){const C=this.paint.get("heatmap-radius").evaluate(t,o);return hM(l,c,d,m,b,!0,!0,new rt(0,0),C)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,t,o){return l==="heatmap"?{config:new ec(this,{zoom:t,lut:o}),overrideFog:!1}:{}}},hillshade:class extends bo{constructor(l,t,o,c){super(l,{layout:yM||(yM=new ci({visibility:new Zt(st.layout_hillshade.visibility)})),paint:_M||(_M=new ci({"hillshade-illumination-direction":new Zt(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(st.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Zt(st.paint_hillshade["hillshade-emissive-strength"])}))},t,o,c)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,t,o){return{overrideFog:!1}}},fill:class extends bo{constructor(l,t,o,c){super(l,{layout:MM||(MM=new ci({"fill-sort-key":new _r(st.layout_fill["fill-sort-key"]),visibility:new Zt(st.layout_fill.visibility)})),paint:EM||(EM=new ci({"fill-antialias":new Zt(st.paint_fill["fill-antialias"]),"fill-opacity":new _r(st.paint_fill["fill-opacity"]),"fill-color":new _r(st.paint_fill["fill-color"]),"fill-outline-color":new _r(st.paint_fill["fill-outline-color"]),"fill-translate":new Zt(st.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new _r(st.paint_fill["fill-pattern"]),"fill-emissive-strength":new Zt(st.paint_fill["fill-emissive-strength"]),"fill-z-offset":new _r(st.paint_fill["fill-z-offset"])}))},t,o,c)}getProgramIds(){const l=this.paint.get("fill-pattern"),t=l&&l.constantOr(1),o=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(l,t,o){return{config:new ec(this,{zoom:t,lut:o}),overrideFog:!1}}recalculate(l,t){super.recalculate(l,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new _b(l)}queryRadius(){return On(this.paint.get("fill-translate"))}queryIntersectsFeature(l,t,o,c,f,d){return!l.queryGeometry.isAboveHorizon&&Lr(en(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends bo{constructor(l,t,o,c){super(l,{layout:lE||(lE=new ci({visibility:new Zt(st["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Zt(st["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:cE||(cE=new ci({"fill-extrusion-opacity":new Zt(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _r(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _r(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _r(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _r(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Zt(st["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Zt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Zt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new _r(st["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new _r(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Zt(st["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Zt(st["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Zt(st["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Zt(st["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new _r(st["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new _r(st["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Zt(st["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},t,o,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new o0(l)}queryRadius(){return On(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,t,o,c,f,d,m,b,C){const k=wn(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(t,o),S=this.paint.get("fill-extrusion-base").evaluate(t,o),I=[0,0],T=b&&d.elevation,E=d.elevation?d.elevation.exaggeration():1,A=l.tile.getBucket(this);if(T&&A instanceof o0){const N=A.centroidVertexArray,Z=C+1;Z<N.length&&(I[0]=N.geta_centroid_pos0(Z),I[1]=N.geta_centroid_pos1(Z))}if(I[0]===0&&I[1]===1)return!1;d.projection.name==="globe"&&(c=aE([c],[new rt(0,0),new rt(er,er)],l.tileID.canonical).map(N=>N.polygon).flat());const z=T?b:null,[B,U]=function(N,Z,J,he,ye,xe,me,Ae,Te,Oe,We){return N.projection.name==="globe"?function(Ze,Ye,Je,at,Qe,gt,Et,dt,sr,Jt,$t){const Dt=[],vr=[],ir=Ze.projection.upVectorScale($t,Ze.center.lat,Ze.worldSize).metersToTile,cr=[0,0,0,1],Vr=[0,0,0,1],tn=(Kr,on,an,Wn)=>{Kr[0]=on,Kr[1]=an,Kr[2]=Wn,Kr[3]=1},Xr=sE();Je>0&&(Je+=Xr),at+=Xr;for(const Kr of Ye){const on=[],an=[];for(const Wn of Kr){const Rn=Wn.x+Qe.x,$r=Wn.y+Qe.y,Cn=Ze.projection.projectTilePoint(Rn,$r,$t),In=Ze.projection.upVector($t,Wn.x,Wn.y);let ei=Je,Si=at;if(Et){const Oi=dE(Rn,$r,Je,at,Et,dt,sr,Jt);ei+=Oi.base,Si+=Oi.top}Je!==0?tn(cr,Cn.x+In[0]*ir*ei,Cn.y+In[1]*ir*ei,Cn.z+In[2]*ir*ei):tn(cr,Cn.x,Cn.y,Cn.z),tn(Vr,Cn.x+In[0]*ir*Si,Cn.y+In[1]*ir*Si,Cn.z+In[2]*ir*Si),be.vec3.transformMat4(cr,cr,gt),be.vec3.transformMat4(Vr,Vr,gt),on.push(new xd(cr[0],cr[1],cr[2])),an.push(new xd(Vr[0],Vr[1],Vr[2]))}Dt.push(on),vr.push(an)}return[Dt,vr]}(N,Z,J,he,ye,xe,me,Ae,Te,Oe,We):me?function(Ze,Ye,Je,at,Qe,gt,Et,dt,sr){const Jt=[],$t=[],Dt=[0,0,0,1];for(const vr of Ze){const ir=[],cr=[];for(const Vr of vr){const tn=Vr.x+at.x,Xr=Vr.y+at.y,Kr=dE(tn,Xr,Ye,Je,gt,Et,dt,sr);Dt[0]=tn,Dt[1]=Xr,Dt[2]=Kr.base,Dt[3]=1,be.vec4.transformMat4(Dt,Dt,Qe),Dt[3]=Math.max(Dt[3],1e-5);const on=new xd(Dt[0]/Dt[3],Dt[1]/Dt[3],Dt[2]/Dt[3]);Dt[0]=tn,Dt[1]=Xr,Dt[2]=Kr.top,Dt[3]=1,be.vec4.transformMat4(Dt,Dt,Qe),Dt[3]=Math.max(Dt[3],1e-5);const an=new xd(Dt[0]/Dt[3],Dt[1]/Dt[3],Dt[2]/Dt[3]);ir.push(on),cr.push(an)}Jt.push(ir),$t.push(cr)}return[Jt,$t]}(Z,J,he,ye,xe,me,Ae,Te,Oe):function(Ze,Ye,Je,at,Qe){const gt=[],Et=[],dt=Qe[8]*Ye,sr=Qe[9]*Ye,Jt=Qe[10]*Ye,$t=Qe[11]*Ye,Dt=Qe[8]*Je,vr=Qe[9]*Je,ir=Qe[10]*Je,cr=Qe[11]*Je;for(const Vr of Ze){const tn=[],Xr=[];for(const Kr of Vr){const on=Kr.x+at.x,an=Kr.y+at.y,Wn=Qe[0]*on+Qe[4]*an+Qe[12],Rn=Qe[1]*on+Qe[5]*an+Qe[13],$r=Qe[2]*on+Qe[6]*an+Qe[14],Cn=Qe[3]*on+Qe[7]*an+Qe[15],In=Wn+dt,ei=Rn+sr,Si=$r+Jt,Oi=Math.max(Cn+$t,1e-5),Ti=Wn+Dt,fi=Rn+vr,ro=$r+ir,ji=Math.max(Cn+cr,1e-5);tn.push(new xd(In/Oi,ei/Oi,Si/Oi)),Xr.push(new xd(Ti/ji,fi/ji,ro/ji))}gt.push(tn),Et.push(Xr)}return[gt,Et]}(Z,J,he,ye,xe)}(d,c,S,x,k,m,z,I,E,d.center.lat,l.tileID.canonical),G=l.queryGeometry;return function(N,Z,J){let he=1/0;Lr(J,Z)&&(he=uE(J,Z[0]));for(let ye=0;ye<Z.length;ye++){const xe=Z[ye],me=N[ye];for(let Ae=0;Ae<xe.length-1;Ae++){const Te=xe[Ae],Oe=[Te,xe[Ae+1],me[Ae+1],me[Ae],Te];Kt(J,Oe)&&(he=Math.min(he,uE(J,Oe)))}}return he!==1/0&&he}(B,U,G.isPointQuery()?G.screenBounds:G.screenGeometry)}},line:class extends bo{constructor(l,t,o,c){const f=bE();super(l,f,t,o,c),f.layout&&(this.layout=new Wc(f.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Ku,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,t){super.recalculate(l,t),this.paint._values["line-floorwidth"]=(()=>{if(jm)return jm;const o=bE();return jm=new kO(o.paint.properties["line-width"].specification),jm.useIntegerZoom=!0,jm})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Ib(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,t,o){const c=xE(this);return{config:new ec(this,{zoom:t,lut:o}),defines:c,overrideFog:!1}}queryRadius(l){const t=l,o=wE(ui("line-width",this,t),ui("line-gap-width",this,t)),c=ui("line-offset",this,t);return o/2+Math.abs(c)+On(this.paint.get("line-translate"))}queryIntersectsFeature(l,t,o,c,f,d){if(l.queryGeometry.isAboveHorizon)return!1;const m=en(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,l.pixelToTileUnitsFactor),b=l.pixelToTileUnitsFactor/2*wE(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),C=this.paint.get("line-offset").evaluate(t,o);return C&&(c=function(k,x){const S=[],I=new rt(0,0);for(let T=0;T<k.length;T++){const E=k[T],A=[];for(let z=0;z<E.length;z++){const B=E[z],U=E[z+1],G=z===0?I:B.sub(E[z-1])._unit()._perp(),N=z===E.length-1?I:U.sub(B)._unit()._perp(),Z=G._add(N)._unit();Z._mult(1/(Z.x*N.x+Z.y*N.y)),A.push(Z._mult(x)._add(B))}S.push(A)}return S}(c,C*l.pixelToTileUnitsFactor)),function(k,x,S){for(let I=0;I<x.length;I++){const T=x[I];if(k.length>=3){for(let E=0;E<T.length;E++)if(Qn(k,T[E]))return!0}if(fr(k,T,S))return!0}return!1}(m,c,b)}isTileClipped(){return!0}isDraped(l){const t=this.layout.get("line-z-offset");return t.isConstant()&&!t.constantOr(0)}},symbol:v0,background:class extends bo{constructor(l,t,o,c){super(l,{layout:oI||(oI=new ci({visibility:new Zt(st.layout_background.visibility)})),paint:sI||(sI=new ci({"background-pitch-alignment":new Zt(st.paint_background["background-pitch-alignment"]),"background-color":new Zt(st.paint_background["background-color"]),"background-pattern":new Zt(st.paint_background["background-pattern"]),"background-opacity":new Zt(st.paint_background["background-opacity"]),"background-emissive-strength":new Zt(st.paint_background["background-emissive-strength"])}))},t,o,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,t,o){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:dI,"raster-particle":yI,sky:class extends bo{constructor(l,t,o,c){super(l,{layout:fI||(fI=new ci({visibility:new Zt(st.layout_sky.visibility)})),paint:mI||(mI=new ci({"sky-type":new Zt(st.paint_sky["sky-type"]),"sky-atmosphere-sun":new Zt(st.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Zt(st.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Zt(st.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Zt(st.paint_sky["sky-gradient-radius"]),"sky-gradient":new Rs(st.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Zt(st.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Zt(st.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Zt(st.paint_sky["sky-opacity"])}))},t,o,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Pm({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(l,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,d=l.style.light,m=d.properties.get("position");return f&&d.properties.get("anchor")==="viewport"&&hr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?Yb(m.azimuthal,90-m.polar,t):Yb(c[0],90-c[1],t)}const o=this.paint.get("sky-gradient-center");return Yb(o[0],90-o[1],t)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends bo{constructor(l,t,o,c){super(l,{paint:gI||(gI=new ci({}))},t,null)}},model:class extends bo{constructor(l,t,o,c){super(l,{layout:EI||(EI=new ci({visibility:new Zt(st.layout_model.visibility),"model-id":new _r(st.layout_model["model-id"])})),paint:II||(II=new ci({"model-opacity":new Zt(st.paint_model["model-opacity"]),"model-rotation":new _r(st.paint_model["model-rotation"]),"model-scale":new _r(st.paint_model["model-scale"]),"model-translation":new _r(st.paint_model["model-translation"]),"model-color":new _r(st.paint_model["model-color"]),"model-color-mix-intensity":new _r(st.paint_model["model-color-mix-intensity"]),"model-type":new Zt(st.paint_model["model-type"]),"model-cast-shadows":new Zt(st.paint_model["model-cast-shadows"]),"model-receive-shadows":new Zt(st.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Zt(st.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new _r(st.paint_model["model-emissive-strength"]),"model-roughness":new _r(st.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new _r(st.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Zt(st.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Zt(st.paint_model["model-front-cutoff"])}))},t,o,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new Jb(l)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof I0?er-1:0}queryIntersectsFeature(l,t,o,c,f,d){if(!this.modelManager)return!1;const m=this.modelManager,b=l.tile.getBucket(this);if(!(b&&b instanceof Jb))return!1;const C=b;for(const k in C.instancesPerModel){const x=C.instancesPerModel[k],S=t.id!==void 0?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(x.idToFeaturesIndex.hasOwnProperty(S)){const I=x.features[x.idToFeaturesIndex[S]],T=m.getModel(k,this.scope);if(!T)return!1;let E=be.mat4.create();const A=new W(0,0),z=C.canonical;let B=Number.MAX_VALUE;for(let U=0;U<I.instancedDataCount;++U){const G=16*(I.instancedDataOffset+U),N=x.instancedDataArray.float32,Z=[N[G+4],N[G+5],N[G+6]];LI(z,A,N[G],0|N[G+1]),kI(E,T,d,A,I.rotation,I.scale,Z,!1,!1,!1),d.projection.name==="globe"&&(E=Kb(E,d));const J=be.mat4.multiply([],d.projMatrix,E),he=l.queryGeometry,ye=wI(he.isPointQuery()?he.screenBounds:he.screenGeometry,d,J,T.aabb);ye!=null&&(B=Math.min(ye,B))}return B!==Number.MAX_VALUE&&B}}return!1}_handleOverridablePaintPropertyUpdate(l,t,o){return!(!this.layout||t.isDataDriven()||o.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const t=this._transitionablePaint._values[l];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof na}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(l,t,o,c){const f=l.tile,d=f.getBucket(this);let m=null,b=Number.MAX_VALUE;if(!(d&&d instanceof I0))return{queryFeature:m,intersectionZ:b};const C=d.getNodesInfo()[t];if(C.hiddenByReplacement||!C.node.meshes||!o.filter(new yi(f.tileID.overscaledZ),C.feature,f.tileID.canonical))return{queryFeature:m,intersectionZ:b};const k=C.node,x=c.calculatePosMatrix(f.tileID.toUnwrapped(),c.worldSize),S=C.evaluatedScale;let I=0;c.elevation&&k.elevation&&(I=k.elevation*c.elevation.exaggeration()),be.mat4.translate(x,x,[(k.anchor?k.anchor[0]:0)*(S[0]-1),(k.anchor?k.anchor[1]:0)*(S[1]-1),I]),be.mat4.scale(x,x,S),be.mat4.multiply(x,x,k.matrix);const T=l.queryGeometry,E=T.isPointQuery()?T.screenBounds:T.screenGeometry,A=function(B){const U=be.mat4.multiply([],x,B.matrix),G=be.mat4.multiply(U,c.expandedFarZProjMatrix,U);for(let N=0;N<B.meshes.length;++N){const Z=B.meshes[N];if(N===B.lightMeshIndex)continue;const J=wI(E,c,G,Z.aabb);J!=null&&(b=Math.min(J,b))}if(B.children)for(const N of B.children)A(N)};if(A(k),b===Number.MAX_VALUE)return{queryFeature:m,intersectionZ:b};const z=new W(0,0);return LI(f.tileID.canonical,z,C.node.anchor[0],C.node.anchor[1]),m={type:"Feature",geometry:{type:"Point",coordinates:[z.lng,z.lat]},properties:C.feature.properties,id:C.feature.id,state:{},layer:this.serialize()},{queryFeature:m,intersectionZ:b}}},clip:class extends bo{constructor(l,t,o,c){super(l,{layout:IM||(IM=new ci({"clip-layer-types":new Zt(st.layout_clip["clip-layer-types"]),"clip-layer-scope":new Zt(st.layout_clip["clip-layer-scope"])})),paint:kM||(kM=new ci({}))},t,o,c)}recalculate(l,t){super.recalculate(l,t)}createBucket(l){return new PM(l)}isTileClipped(){return!0}is3D(){return!0}}};class EF{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class IF{constructor(){this.tasks={},this.taskQueue=[],li(["process"],this),this.invoker=new EF(this.process),this.nextId=0}add(t,o){const c=this.nextId++,f=function({type:d,isSymbolTile:m,zoom:b}){return b=b||0,d==="message"?0:d!=="maybePrepare"||m?d!=="parseTile"||m?d==="parseTile"&&m?300-b:d==="maybePrepare"&&m?400-b:500:200-b:100-b}(o);if(f===0){try{t()}finally{}return null}return this.tasks[c]={fn:t,metadata:o,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const o=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let t=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const d=this.tasks[this.taskQueue[f]];d.priority<o&&(o=d.priority,t=f)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class zI{constructor(t,o,c){this.target=t,this.parent=o,this.mapId=c,this.callbacks={},this.cancelCallbacks={},li(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new IF}send(t,o,c,f,d=!1,m){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=m,this.callbacks[b]=c);const C=new Set;return this.target.postMessage({id:b,type:t,hasCallback:!!c,targetMapId:f,mustQueue:d,sourceMapId:this.mapId,data:Wo(o,C)},C),{cancel:()=>{c&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(t){const o=t.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(o.mustQueue||qn()){const f=this.callbacks[c],d=this.scheduler.add(()=>this.processTask(c,o),f&&f.metadata||{type:"message"});d&&(this.cancelCallbacks[c]=d)}else this.processTask(c,o)}processTask(t,o){if(delete this.cancelCallbacks[t],o.type==="<response>"){const c=this.callbacks[t];delete this.callbacks[t],c&&(o.error?c(Yl(o.error)):c(null,Yl(o.data)))}else{const c=new Set,f=o.hasCallback?(m,b)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:m?Wo(m):null,data:Wo(b,c)},c)}:m=>{},d=Yl(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,d,f);else if(this.parent.getWorkerSource){const m=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,m[0],d.source,d.scope)[m[1]](d,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class up{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Wr();const c=this.workerPool.acquire(this.id);for(let f=0;f<c.length;f++){const d=new up.Actor(c[f],o,this.id);d.name=`Worker ${f}`,this.actors.push(d)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,o,c){br(this.actors,(f,d)=>{f.send(t,o,d)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}up.Actor=zI;class OI{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,o){const c=this.toIdx(t,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,o){return this.leaves[this.toIdx(t,o)]}toIdx(t,o){return o*this.size+t}}function FI(l,t,o,c){let f=0,d=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(c[m])<1e-15){if(o[m]<l[m]||o[m]>t[m])return null}else{const b=1/c[m];let C=(l[m]-o[m])*b,k=(t[m]-o[m])*b;if(C>k){const x=C;C=k,k=x}if(C>f&&(f=C),k<d&&(d=k),f>d)return null}return f}function BI(l,t,o,c,f,d,m,b,C,k,x){const S=c-l,I=f-t,T=d-o,E=m-l,A=b-t,z=C-o,B=x[1]*z-x[2]*A,U=x[2]*E-x[0]*z,G=x[0]*A-x[1]*E,N=S*B+I*U+T*G;if(Math.abs(N)<1e-15)return null;const Z=1/N,J=k[0]-l,he=k[1]-t,ye=k[2]-o,xe=(J*B+he*U+ye*G)*Z;if(xe<0||xe>1)return null;const me=he*T-ye*I,Ae=ye*S-J*T,Te=J*I-he*S,Oe=(x[0]*me+x[1]*Ae+x[2]*Te)*Z;return Oe<0||xe+Oe>1?null:(E*me+A*Ae+z*Te)*Z}function jI(l,t,o){return(l-t)/(o-t)}function NI(l,t,o,c,f,d,m,b,C){const k=1<<o,x=d-c,S=m-f,I=(l+1)/k*x+c,T=(t+0)/k*S+f,E=(t+1)/k*S+f;b[0]=(l+0)/k*x+c,b[1]=T,C[0]=I,C[1]=E}class VI{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(d){const m=Math.ceil(Math.log2(d.dim/8)),b=[];let C=Math.ceil(Math.pow(2,m));const k=1/C,x=(T,E,A,z,B)=>{const U=z?1:0,G=(T+1)*A-U,N=E*A,Z=(E+1)*A-U;B[0]=T*A,B[1]=N,B[2]=G,B[3]=Z};let S=new OI(C);const I=[];for(let T=0;T<C*C;T++){x(T%C,Math.floor(T/C),k,!1,I);const E=lu(I[0],I[1],d),A=lu(I[2],I[1],d),z=lu(I[2],I[3],d),B=lu(I[0],I[3],d);S.minimums.push(Math.min(E,A,z,B)),S.maximums.push(Math.max(E,A,z,B)),S.leaves.push(1)}for(b.push(S),C/=2;C>=1;C/=2){const T=b[b.length-1];S=new OI(C);for(let E=0;E<C*C;E++){x(E%C,Math.floor(E/C),2,!0,I);const A=T.getElevation(I[0],I[1]),z=T.getElevation(I[2],I[1]),B=T.getElevation(I[2],I[3]),U=T.getElevation(I[0],I[3]),G=T.isLeaf(I[0],I[1]),N=T.isLeaf(I[2],I[1]),Z=T.isLeaf(I[2],I[3]),J=T.isLeaf(I[0],I[3]),he=Math.min(A.min,z.min,B.min,U.min),ye=Math.max(A.max,z.max,B.max,U.max),xe=G&&N&&Z&&J;S.maximums.push(ye),S.minimums.push(he),S.leaves.push(ye-he<=5&&xe?1:0)}b.push(S)}return b}(this.dem),c=o.length-1,f=o[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(t,o,c,f,d,m,b=1){return FI([t,o,-100],[c,f,this.maximums[0]*b],d,m)}raycast(t,o,c,f,d,m,b=1){if(!this.nodeCount)return null;const C=this.raycastRoot(t,o,c,f,d,m,b);if(C==null)return null;const k=[],x=[],S=[],I=[],T=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;T.length>0;){const{idx:E,t:A,nodex:z,nodey:B,depth:U}=T.pop();if(this.leaves[E]){NI(z,B,U,t,o,c,f,S,I);const N=1<<U,Z=(z+0)/N,J=(z+1)/N,he=(B+0)/N,ye=(B+1)/N,xe=lu(Z,he,this.dem)*b,me=lu(J,he,this.dem)*b,Ae=lu(J,ye,this.dem)*b,Te=lu(Z,ye,this.dem)*b,Oe=BI(S[0],S[1],xe,I[0],S[1],me,I[0],I[1],Ae,d,m),We=BI(I[0],I[1],Ae,S[0],I[1],Te,S[0],S[1],xe,d,m),Ze=Math.min(Oe!==null?Oe:Number.MAX_VALUE,We!==null?We:Number.MAX_VALUE);if(Ze!==Number.MAX_VALUE)return Ze;{const Ye=be.vec3.scaleAndAdd([],d,m,A);if($I(xe,me,Te,Ae,jI(Ye[0],S[0],I[0]),jI(Ye[1],S[1],I[1]))>=Ye[2])return A}continue}let G=0;for(let N=0;N<this._siblingOffset.length;N++){NI((z<<1)+this._siblingOffset[N][0],(B<<1)+this._siblingOffset[N][1],U+1,t,o,c,f,S,I),S[2]=-100,I[2]=this.maximums[this.childOffsets[E]+N]*b;const Z=FI(S,I,d,m);if(Z!=null){const J=Z;k[N]=J;let he=!1;for(let ye=0;ye<G&&!he;ye++)J>=k[x[ye]]&&(x.splice(ye,0,N),he=!0);he||(x[G]=N),G++}}for(let N=0;N<G;N++){const Z=x[N];T.push({idx:this.childOffsets[E]+Z,t:k[Z],nodex:(z<<1)+this._siblingOffset[Z][0],nodey:(B<<1)+this._siblingOffset[Z][1],depth:U+1})}}return null}_addNode(t,o,c){return this.minimums.push(t),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,o,c,f,d){if(t[f].isLeaf(o,c)===1)return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const m=f-1,b=t[m];let C=0,k=0;for(let x=0;x<this._siblingOffset.length;x++){const S=2*o+this._siblingOffset[x][0],I=2*c+this._siblingOffset[x][1],T=b.getElevation(S,I),E=b.isLeaf(S,I),A=this._addNode(T.min,T.max,E);E&&(C|=1<<x),k||(k=A)}for(let x=0;x<this._siblingOffset.length;x++)C&1<<x||this._construct(t,2*o+this._siblingOffset[x][0],2*c+this._siblingOffset[x][1],m,k+x)}}function $I(l,t,o,c,f,d){return Pr(Pr(l,o,d),Pr(t,c,d),f)}function lu(l,t,o){const c=o.dim,f=Xt(l*c-.5,0,c-1),d=Xt(t*c-.5,0,c-1),m=Math.floor(f),b=Math.floor(d),C=Math.min(m+1,c-1),k=Math.min(b+1,c-1);return $I(o.get(m,b),o.get(C,b),o.get(m,k),o.get(C,k),f-m,d-b)}const kF={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function PF(l,t,o){return(256*l*256+256*t+o)/10-1e4}function AF(l,t,o){return 256*l+t+o/256-32768}class k0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,o,c,f=!1){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void hr(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const d=this.dim=o.height-2,m=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let C=0;C<d;C++)m[this._idx(-1,C)]=m[this._idx(0,C)],m[this._idx(d,C)]=m[this._idx(d-1,C)],m[this._idx(C,-1)]=m[this._idx(C,0)],m[this._idx(C,d)]=m[this._idx(C,d-1)];m[this._idx(-1,-1)]=m[this._idx(0,0)],m[this._idx(d,-1)]=m[this._idx(d-1,0)],m[this._idx(-1,d)]=m[this._idx(0,d-1)],m[this._idx(d,d)]=m[this._idx(d-1,d-1)]}const b=c==="terrarium"?AF:PF;for(let C=0;C<m.length;++C){const k=4*C;this.floatView[C]=b(this.pixels[k],this.pixels[k+1],this.pixels[k+2])}this._timestamp=or.now()}_buildQuadTree(){this._tree=new VI(this)}get(t,o,c=!1){c&&(t=Xt(t,-1,this.dim),o=Xt(o,-1,this.dim));const f=this._idx(t,o);return this.floatView[f]}set(t,o,c){const f=this._idx(t,o),d=this.floatView[f];return this.floatView[f]=c,c-d}static getUnpackVector(t){return kF[t]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}static pack(t,o){const c=[0,0,0,0],f=k0.getUnpackVector(o);let d=Math.floor((t+f[3])/f[2]);return c[2]=d%256,d=Math.floor(d/256),c[1]=d%256,d=Math.floor(d/256),c[0]=d,c}getPixels(){return new bM({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,o,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,d=o*this.dim+this.dim,m=c*this.dim,b=c*this.dim+this.dim;switch(o){case-1:f=d-1;break;case 1:d=f+1}switch(c){case-1:m=b-1;break;case 1:b=m+1}const C=-o*this.dim,k=-c*this.dim;for(let x=m;x<b;x++)for(let S=f;S<d;S++){const I=4*this._idx(S,x),T=4*this._idx(S+C,x+k);this.pixels[I+0]=t.pixels[T+0],this.pixels[I+1]=t.pixels[T+1],this.pixels[I+2]=t.pixels[T+2],this.pixels[I+3]=t.pixels[T+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function DF(l,t,o){l===1?t.header_length=o.readFixed32():l===2?t.x=o.readVarint():l===3?t.y=o.readVarint():l===4?t.z=o.readVarint():l===5&&t.layers.push(function(c,f){return c.readFields(FF,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},f)}(o,o.readVarint()+o.pos))}function RF(l,t,o){l===1?(t.delta_filter=function(c,f){return c.readFields(LF,{block_size:0},f)}(o,o.readVarint()+o.pos),t.filter="delta_filter"):l===2?(o.readVarint(),t.filter="zigzag_filter"):l===3?(o.readVarint(),t.filter="bitshuffle_filter"):l===4&&(o.readVarint(),t.filter="byteshuffle_filter")}function LF(l,t,o){l===1&&(t.block_size=o.readVarint())}function zF(l,t,o){l===1?(o.readVarint(),t.codec="gzip_data"):l===2?(o.readVarint(),t.codec="jpeg_image"):l===3?(o.readVarint(),t.codec="webp_image"):l===4&&(o.readVarint(),t.codec="png_image")}function OF(l,t,o){l===1?t.first_byte=o.readFixed64():l===2?t.last_byte=o.readFixed64():l===3?t.filters.push(function(c,f){return c.readFields(RF,{},f)}(o,o.readVarint()+o.pos)):l===4?t.codec=function(c,f){return c.readFields(zF,{},f)}(o,o.readVarint()+o.pos):l===5?t.deprecated_offset=o.readFloat():l===6?t.deprecated_scale=o.readFloat():l===7?t.bands.push(o.readString()):l===8?t.offset=o.readDouble():l===9&&(t.scale=o.readDouble())}function FF(l,t,o){l===1?t.version=o.readVarint():l===2?t.name=o.readString():l===3?t.units=o.readString():l===4?t.tilesize=o.readVarint():l===5?t.buffer=o.readVarint():l===6?t.pixel_format=o.readVarint():l===7&&t.data_index.push(function(c,f){return c.readFields(OF,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},f)}(o,o.readVarint()+o.pos))}function BF(l,t,o){if(l===2)(function(c,f,d){c.readFields(jF,d,f)})(o,o.readVarint()+o.pos,t);else if(l===3)throw new Error("Not implemented")}function jF(l,t,o){if(l===1){let c=0;const f=o.readVarint()+o.pos;for(;o.pos<f;)t[c++]=o.readVarint()}}ur(k0,"DEMData"),ur(VI,"DemMinMaxQuadTree",{omit:["dem"]});class NF{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const o=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,o),o}put(t,o){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,o)}}function VF(l,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let o=t[3];for(let c=2;c>=1;c--){const f=c===1?1:0,d=c===2?1:0;for(let m=0;m<t[0];m++){const b=t[1]*m;for(let C=f;C<t[1];C++){const k=t[2]*(C+b);for(let x=d;x<t[2];x++){const S=t[3]*(x+k);for(let I=0;I<t[3];I++){const T=S+I;l[T]+=l[T-o]}}}}o*=t[c]}return l}function $F(l){for(let t=0,o=l.length;t<o;t++)l[t]=l[t]>>>1^-(1&l[t]);return l}function UF(l,t){switch(t){case"uint32":return l;case"uint16":for(let o=0;o<l.length;o+=2){const c=l[o],f=l[o+1];l[o]=(240&c)>>4|(61440&c)>>8|(240&f)<<4|61440&f,l[o+1]=15&c|(3840&c)>>4|(15&f)<<8|(3840&f)<<4}return l;case"uint8":for(let o=0;o<l.length;o+=4){const c=l[o],f=l[o+1],d=l[o+2],m=l[o+3];l[o+0]=(192&c)>>6|(192&f)>>4|(192&d)>>2|192&m,l[o+1]=(48&c)>>4|(48&f)>>2|48&d|(48&m)<<2,l[o+2]=(12&c)>>2|12&f|(12&d)<<2|(12&m)<<4,l[o+3]=3&c|(3&f)<<2|(3&d)<<4|(3&m)<<6}return l;default:throw new Error(`Invalid pixel format, "${t}"`)}}var Fs=Uint8Array,Jm=Uint16Array,WF=Int32Array,UI=new Fs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),WI=new Fs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),GF=new Fs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),GI=function(l,t){for(var o=new Jm(31),c=0;c<31;++c)o[c]=t+=1<<l[c-1];var f=new WF(o[30]);for(c=1;c<30;++c)for(var d=o[c];d<o[c+1];++d)f[d]=d-o[c]<<5|c;return{b:o,r:f}},HI=GI(UI,2),qI=HI.b,HF=HI.r;qI[28]=258,HF[258]=28;for(var qF=GI(WI,0).b,ZI=new Jm(32768),zi=0;zi<32768;++zi){var dp=(43690&zi)>>1|(21845&zi)<<1;ZI[zi]=((65280&(dp=(61680&(dp=(52428&dp)>>2|(13107&dp)<<2))>>4|(3855&dp)<<4))>>8|(255&dp)<<8)>>1}var Qm=function(l,t,o){for(var c=l.length,f=0,d=new Jm(t);f<c;++f)l[f]&&++d[l[f]-1];var m,b=new Jm(t);for(f=1;f<t;++f)b[f]=b[f-1]+d[f-1]<<1;m=new Jm(1<<t);var C=15-t;for(f=0;f<c;++f)if(l[f])for(var k=f<<4|l[f],x=t-l[f],S=b[l[f]-1]++<<x,I=S|(1<<x)-1;S<=I;++S)m[ZI[S]>>C]=k;return m},eg=new Fs(288);for(zi=0;zi<144;++zi)eg[zi]=8;for(zi=144;zi<256;++zi)eg[zi]=9;for(zi=256;zi<280;++zi)eg[zi]=7;for(zi=280;zi<288;++zi)eg[zi]=8;var YI=new Fs(32);for(zi=0;zi<32;++zi)YI[zi]=5;var ZF=Qm(eg,9),YF=Qm(YI,5),rw=function(l){for(var t=l[0],o=1;o<l.length;++o)l[o]>t&&(t=l[o]);return t},ja=function(l,t,o){var c=t/8|0;return(l[c]|l[c+1]<<8)>>(7&t)&o},nw=function(l,t){var o=t/8|0;return(l[o]|l[o+1]<<8|l[o+2]<<16)>>(7&t)},XF=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Na=function(l,t,o){var c=new Error(t||XF[l]);if(c.code=l,Error.captureStackTrace&&Error.captureStackTrace(c,Na),!o)throw c;return c},KF=new Fs(0),JF=typeof TextDecoder<"u"&&new TextDecoder;try{JF.decode(KF,{stream:!0})}catch{}const QF={gzip_data:"gzip"};class la extends Error{constructor(t){super(t),this.name="MRTError"}}const e5={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},XI={uint32:1,uint16:2,uint8:4},t5={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let iw;class ow{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const o=this.layers[t];if(!o)throw new la(`Layer '${t}' not found`);return o}getHeaderLength(t){const o=new Uint8Array(t),c=new DataView(t);if(o[0]!==13)throw new la("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(t){const o=new Uint8Array(t),c=this.getHeaderLength(t);if(o.length<c)throw new la(`Expected header with length >= ${c} but got buffer of length ${o.length}`);const f=function(d,m){return d.readFields(DF,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new iw(o.subarray(0,c)));if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new la(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const d of f.layers)this.layers[d.name]=new r5(d,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const o=[],c=this.getLayer(t.layerName);for(let f of t.blockIndices){const d=c.dataIndex[f],m=d.first_byte-t.firstByte,b=d.last_byte-t.firstByte;if(c._blocksInProgress.has(f))continue;const C={layerName:c.name,firstByte:m,lastByte:b,pixelFormat:c.pixelFormat,blockIndex:f,blockShape:[d.bands.length].concat(c.bandShape),buffer:c.buffer,codec:d.codec.codec,filters:d.filters.map(k=>k.filter)};c._blocksInProgress.add(f),o.push(C)}return new KI(o,()=>{o.forEach(f=>c._blocksInProgress.delete(f.blockIndex))},(f,d)=>{if(o.forEach(m=>c._blocksInProgress.delete(m.blockIndex)),f)throw f;d.forEach(m=>{this.getLayer(m.layerName).processDecodedData(m)})})}}class r5{constructor({version:t,name:o,units:c,tilesize:f,pixel_format:d,buffer:m,data_index:b},C){if(this.version=t,this.version!==1)throw new la(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=o,this.units=c,this.tileSize=f,this.buffer=m,this.pixelFormat=e5[d],this.dataIndex=b,this.bandShape=[f+2*m,f+2*m,XI[this.pixelFormat]],this._decodedBlocks=new NF(C?C.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return XI[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:t})=>t).flat()}processDecodedData(t){const o=t.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,t.data)}getBlockForBand(t){let o=0;switch(typeof t){case"string":for(const[c,f]of this.dataIndex.entries()){for(const[d,m]of f.bands.entries())if(m===t)return{bandIndex:o+d,blockIndex:c,blockBandIndex:d};o+=f.bands.length}break;case"number":for(const[c,f]of this.dataIndex.entries()){if(t>=o&&t<o+f.bands.length)return{bandIndex:t,blockIndex:c,blockBandIndex:t-o};o+=f.bands.length}break;default:throw new la(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}throw new la(`Band not found: ${JSON.stringify(t)}`)}getDataRange(t){let o=1/0,c=-1/0;const f=[],d=new Set;for(const m of t){const{blockIndex:b}=this.getBlockForBand(m);if(b<0)throw new la(`Invalid band: ${JSON.stringify(m)}`);const C=this.dataIndex[b];f.includes(b)||f.push(b),d.add(b),o=Math.min(o,C.first_byte),c=Math.max(c,C.last_byte)}if(d.size>this.cacheSize)throw new la(`Number of blocks to decode (${d.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:c,blockIndices:f}}hasBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0}hasDataForBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(t){const{blockIndex:o,blockBandIndex:c}=this.getBlockForBand(t),f=this._decodedBlocks.get(o.toString());if(!f)throw new la(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const d=this.dataIndex[o],m=this.bandShape.reduce((k,x)=>k*x,1),b=c*m,C=f.subarray(b,b+m);return{data:C,bytes:new Uint8Array(C.buffer).subarray(C.byteOffset,C.byteOffset+C.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:d.offset!==0?d.offset:d.deprecated_offset,scale:d.scale!==0?d.scale:d.deprecated_scale}}}ow.setPbf=function(l){iw=l};class KI{constructor(t,o,c){this.tasks=t,this._onCancel=o,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,o){this._finalized||(this._onComplete(t,o),this._finalized=!0)}}ow.performDecoding=function(l,t){const o=new Uint8Array(l);return Promise.all(t.tasks.map(c=>{const{layerName:f,firstByte:d,lastByte:m,pixelFormat:b,blockShape:C,blockIndex:k,filters:x,codec:S}=c,I=o.subarray(d,m+1),T=new Uint32Array(C[0]*C[1]*C[2]);let E;if(S!=="gzip_data")throw new la(`Unhandled codec: ${S}`);return E=function(A,z){if(!globalThis.DecompressionStream&&z==="gzip_data")return Promise.resolve(((N=function(he){he[0]==31&&he[1]==139&&he[2]==8||Na(6,"invalid gzip data");var ye=he[3],xe=10;4&ye&&(xe+=2+(he[10]|he[11]<<8));for(var me=(ye>>3&1)+(ye>>4&1);me>0;me-=!he[xe++]);return xe+(2&ye)}(G=A))+8>G.length&&Na(6,"invalid gzip data"),function(he,ye,xe,me){var Ae=he.length;if(!Ae||ye.f&&!ye.l)return xe||new Fs(0);var Te=!xe,Oe=Te||ye.i!=2,We=ye.i;Te&&(xe=new Fs(3*Ae));var Ze,Ye,Je=function(cu){var Td=xe.length;if(cu>Td){var ag=new Fs(Math.max(2*Td,cu));ag.set(xe),xe=ag}},at=ye.f||0,Qe=ye.p||0,gt=ye.b||0,Et=ye.l,dt=ye.d,sr=ye.m,Jt=ye.n,$t=8*Ae;do{if(!Et){at=ja(he,Qe,1);var Dt=ja(he,Qe+1,3);if(Qe+=3,!Dt){var vr=he[($r=4+((Qe+7)/8|0))-4]|he[$r-3]<<8,ir=$r+vr;if(ir>Ae){We&&Na(0);break}Oe&&Je(gt+vr),xe.set(he.subarray($r,ir),gt),ye.b=gt+=vr,ye.p=Qe=8*ir,ye.f=at;continue}if(Dt==1)Et=ZF,dt=YF,sr=9,Jt=5;else if(Dt==2){var cr=ja(he,Qe,31)+257,Vr=ja(he,Qe+10,15)+4,tn=cr+ja(he,Qe+5,31)+1;Qe+=14;for(var Xr=new Fs(tn),Kr=new Fs(19),on=0;on<Vr;++on)Kr[GF[on]]=ja(he,Qe+3*on,7);Qe+=3*Vr;var an=rw(Kr),Wn=(1<<an)-1,Rn=Qm(Kr,an);for(on=0;on<tn;){var $r,Cn=Rn[ja(he,Qe,Wn)];if(Qe+=15&Cn,($r=Cn>>4)<16)Xr[on++]=$r;else{var In=0,ei=0;for($r==16?(ei=3+ja(he,Qe,3),Qe+=2,In=Xr[on-1]):$r==17?(ei=3+ja(he,Qe,7),Qe+=3):$r==18&&(ei=11+ja(he,Qe,127),Qe+=7);ei--;)Xr[on++]=In}}var Si=Xr.subarray(0,cr),Oi=Xr.subarray(cr);sr=rw(Si),Jt=rw(Oi),Et=Qm(Si,sr),dt=Qm(Oi,Jt)}else Na(1);if(Qe>$t){We&&Na(0);break}}Oe&&Je(gt+131072);for(var Ti=(1<<sr)-1,fi=(1<<Jt)-1,ro=Qe;;ro=Qe){var ji=(In=Et[nw(he,Qe)&Ti])>>4;if((Qe+=15&In)>$t){We&&Na(0);break}if(In||Na(2),ji<256)xe[gt++]=ji;else{if(ji==256){ro=Qe,Et=null;break}var fo=ji-254;ji>264&&(fo=ja(he,Qe,(1<<($a=UI[on=ji-257]))-1)+qI[on],Qe+=$a);var Xn=dt[nw(he,Qe)&fi],as=Xn>>4;if(Xn||Na(3),Qe+=15&Xn,Oi=qF[as],as>3){var $a=WI[as];Oi+=nw(he,Qe)&(1<<$a)-1,Qe+=$a}if(Qe>$t){We&&Na(0);break}Oe&&Je(gt+131072);var ca=gt+fo;if(gt<Oi){var ua=0-Oi,Sd=Math.min(Oi,ca);for(ua+gt<0&&Na(3);gt<Sd;++gt)xe[gt]=(void 0)[ua+gt]}for(;gt<ca;++gt)xe[gt]=xe[gt-Oi]}}ye.l=Et,ye.p=ro,ye.b=gt,ye.f=at,Et&&(at=1,ye.m=sr,ye.d=dt,ye.n=Jt)}while(!at);return gt!=xe.length&&Te?(Ze=xe,((Ye=gt)==null||Ye>Ze.length)&&(Ye=Ze.length),new Fs(Ze.subarray(0,Ye))):xe.subarray(0,gt)}(G.subarray(N,-8),{i:2},new Fs(((B=G)[(U=B.length)-4]|B[U-3]<<8|B[U-2]<<16|B[U-1]<<24)>>>0))));var B,U,G,N;const Z=QF[z];if(!Z)throw new Error(`Unhandled codec: ${z}`);const J=new globalThis.DecompressionStream(Z);return new Response(new Blob([A]).stream().pipeThrough(J)).arrayBuffer().then(he=>new Uint8Array(he))}(I,S).then(A=>(function(z,B){z.readFields(BF,B)}(new iw(A),T),new t5[b](T.buffer))),E.then(A=>{for(let z=x.length-1;z>=0;z--)switch(x[z]){case"delta_filter":VF(A,C);break;case"zigzag_filter":$F(A);break;case"bitshuffle_filter":UF(A,b);break;default:throw new la(`Unhandled filter "${x[z]}"`)}return{layerName:f,blockIndex:k,data:A}}).catch(A=>{throw A})}))},ur(KI,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var tg={workerUrl:"",workerClass:null,workerParams:void 0};const sw="mapboxgl_preloaded_worker_pool";class rg{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<rg.workerCount;)this.workers.push(tg.workerClass!=null?new tg.workerClass:new self.Worker(tg.workerUrl,tg.workerParams));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[sw]}numActive(){return Object.keys(this.active).length}}let ng;function P0(){return ng||(ng=new rg),ng}rg.workerCount=2;let ig,aw,Va,hp,lw,pp=null;function JI(){return qn()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:aw||Ve.DRACO_URL}function QI(){if(qn()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(hp)return hp;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return hp=WebAssembly.validate(l)?Ve.MESHOPT_SIMD_URL:Ve.MESHOPT_URL,hp}const A0={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},n5={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},og={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function ek(l,t,o){const c=o.json.bufferViews.length,f=o.buffers.length;t.bufferView=c,o.json.bufferViews[c]={buffer:f,byteLength:l.byteLength},o.buffers[f]=l}const cw="KHR_draco_mesh_compression";function i5(l,t){const o=l.extensions&&l.extensions[cw];if(!o)return;const c=new Va.Decoder,f=ik(t,o.bufferView),d=new Va.Mesh;if(!c.DecodeArrayToMesh(f,f.byteLength,d))throw new Error("Failed to decode Draco mesh");const m=t.json.accessors[l.indices],b=A0[m.componentType],C=m.count*b.BYTES_PER_ELEMENT,k=Va._malloc(C);b===Uint16Array?c.GetTrianglesUInt16Array(d,C,k):c.GetTrianglesUInt32Array(d,C,k),ek(Va.memory.buffer.slice(k,k+C),m,t),Va._free(k);for(const x of Object.keys(o.attributes)){const S=c.GetAttributeByUniqueId(d,o.attributes[x]),I=t.json.accessors[l.attributes[x]],T=n5[I.componentType],E=I.count*og[I.type]*A0[I.componentType].BYTES_PER_ELEMENT,A=Va._malloc(E);c.GetAttributeDataArrayForAllPoints(d,S,Va[T],E,A),ek(Va.memory.buffer.slice(A,A+E),I,t),Va._free(A)}c.destroy(),d.destroy(),delete l.extensions[cw]}const D0="EXT_meshopt_compression";function o5(l,t){if(!l.extensions||!l.extensions[D0])return;const o=l.extensions[D0],c=new Uint8Array(t.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),f=new Uint8Array(o.count*o.byteStride);lw.decodeGltfBuffer(f,o.count,o.byteStride,c,o.mode,o.filter),l.buffer=t.buffers.length,l.byteOffset=0,t.buffers[l.buffer]=f.buffer,delete l.extensions[D0]}const tk=1179937895,rk=new TextDecoder("utf8");function nk(l,t){return new URL(l,t).href}function s5(l,t,o,c){return fetch(nk(l.uri,c)).then(f=>f.arrayBuffer()).then(f=>{t.buffers[o]=f})}function ik(l,t){const o=l.json.bufferViews[t];return new Uint8Array(l.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function a5(l,t,o,c){if(l.uri){const f=nk(l.uri,c);return fetch(f).then(d=>d.blob()).then(d=>createImageBitmap(d)).then(d=>{t.images[o]=d})}if(l.bufferView!==void 0){const f=ik(t,l.bufferView),d=new Blob([f],{type:l.mimeType});return createImageBitmap(d).then(m=>{t.images[o]=m})}}function ok(l,t=0,o){const c={json:null,images:[],buffers:[]};if(new Uint32Array(l,t,1)[0]===tk){const x=new Uint32Array(l,t);let S=2;const I=(x[S++]>>2)-3,T=x[S++]>>2;if(S++,c.json=JSON.parse(rk.decode(x.subarray(S,S+T))),S+=T,S<I){const E=x[S++];S++;const A=t+(S<<2);c.buffers[0]=l.slice(A,A+E)}}else c.json=JSON.parse(rk.decode(new Uint8Array(l,t)));const{buffers:f,images:d,meshes:m,extensionsUsed:b,bufferViews:C}=c.json;let k=Promise.resolve();if(f){const x=[];for(let S=0;S<f.length;S++){const I=f[S];I.uri?x.push(s5(I,c,S,o)):c.buffers[S]||(c.buffers[S]=null)}k=Promise.all(x)}return k.then(()=>{const x=[],S=b&&b.includes(cw),I=b&&b.includes(D0);if(S&&x.push(function(){if(!Va)return ig??(ig=function(T){let E,A=null;function z(){E=new Uint8Array(A.buffer)}function B(){throw new Error("Unexpected Draco error.")}const U={a:{a:B,d:function(G,N,Z){return E.copyWithin(G,N,N+Z)},c:function(G){const N=E.length,Z=Math.max(G>>>0,Math.ceil(1.2*N)),J=Math.ceil((Z-N)/65536);try{return A.grow(J),z(),!0}catch{return!1}},b:B}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(T,U):T.then(G=>G.arrayBuffer()).then(G=>WebAssembly.instantiate(G,U))).then(G=>{const{Rb:N,Qb:Z,P:J,T:he,X:ye,Ja:xe,La:me,Qa:Ae,Va:Te,Wa:Oe,eb:We,jb:Ze,f:Ye,e:Je,yb:at,zb:Qe,Ab:gt,Bb:Et,Db:dt,Gb:sr}=G.instance.exports;A=Je;const Jt=(()=>{let $t=0,Dt=0,vr=0,ir=0;return cr=>{vr&&(N(ir),N($t),Dt+=vr,vr=$t=0),$t||(Dt+=128,$t=Z(Dt));const Vr=cr.length+7&-8;let tn=$t;Vr>=Dt&&(vr=Vr,tn=ir=Z(Vr));for(let Xr=0;Xr<cr.length;Xr++)E[tn+Xr]=cr[Xr];return tn}})();return z(),Ye(),{memory:Je,_free:N,_malloc:Z,Mesh:class{constructor(){this.ptr=J()}destroy(){he(this.ptr)}},Decoder:class{constructor(){this.ptr=xe()}destroy(){Ze(this.ptr)}DecodeArrayToMesh($t,Dt,vr){const ir=Jt($t),cr=me(this.ptr,ir,Dt,vr.ptr);return!!ye(cr)}GetAttributeByUniqueId($t,Dt){return{ptr:Ae(this.ptr,$t.ptr,Dt)}}GetTrianglesUInt16Array($t,Dt,vr){Te(this.ptr,$t.ptr,Dt,vr)}GetTrianglesUInt32Array($t,Dt,vr){Oe(this.ptr,$t.ptr,Dt,vr)}GetAttributeDataArrayForAllPoints($t,Dt,vr,ir,cr){We(this.ptr,$t.ptr,Dt.ptr,vr,ir,cr)}},DT_INT8:at(),DT_UINT8:Qe(),DT_INT16:gt(),DT_UINT16:Et(),DT_UINT32:dt(),DT_FLOAT32:sr()}})}(fetch(JI())),ig.then(T=>{Va=T,ig=void 0}))}()),I&&x.push(function(){if(lw)return;const T=function(E){let A;const z=WebAssembly.instantiateStreaming(E,{}).then(G=>{A=G.instance,A.exports.__wasm_call_ctors()}),B={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},U={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:z,supported:!0,decodeGltfBuffer(G,N,Z,J,he,ye){(function(xe,me,Ae,Te,Oe,We,Ze){const Ye=xe.exports.sbrk,Je=Te+3&-4,at=Ye(Je*Oe),Qe=Ye(We.length),gt=new Uint8Array(xe.exports.memory.buffer);gt.set(We,Qe);const Et=me(at,Te,Oe,Qe,We.length);if(Et===0&&Ze&&Ze(at,Je,Oe),Ae.set(gt.subarray(at,at+Te*Oe)),Ye(at-Ye(0)),Et!==0)throw new Error(`Malformed buffer data: ${Et}`)})(A,A.exports[U[he]],G,N,Z,J,A.exports[B[ye]])}}}(fetch(QI()));return T.ready.then(()=>{lw=T})}()),d)for(let T=0;T<d.length;T++)x.push(a5(d[T],c,T,o));return(x.length?Promise.all(x):Promise.resolve()).then(()=>{if(S&&m)for(const{primitives:T}of m)for(const E of T)i5(E,c);if(I&&m&&C)for(const T of C)o5(T,c);return c})})}function wd(l,t){const o=l.json.bufferViews[t.bufferView],c=A0[t.componentType];return new c(l.buffers[o.buffer],(t.byteOffset||0)+(o.byteOffset||0),t.count*(o.byteStride&&o.byteStride!==og[t.type]*c.BYTES_PER_ELEMENT?o.byteStride/c.BYTES_PER_ELEMENT:og[t.type]))}function uw(l,t,o,c){const f=A0[t.componentType],d=function(x){switch(x){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(f),m=l.json.bufferViews[t.bufferView],b=m.byteStride?m.byteStride/f.BYTES_PER_ELEMENT:og[t.type],C=o.float32,k=C.length/o.capacity;for(let x=0,S=0;x<t.count*b;x+=b,S+=k)for(let I=0;I<k;I++)C[S+I]=c[x+I]*d;o._trim()}function l5(l,t,o){const c=l.indices,f=l.attributes,d={};d.indexArray=new so;const m=t.json.accessors[c],b=m.count/3;d.indexArray.reserve(b);const C=wd(t,m);for(let I=0;I<b;I++)d.indexArray.emplaceBack(C[3*I],C[3*I+1],C[3*I+2]);d.indexArray._trim(),d.vertexArray=new yl;const k=t.json.accessors[f.POSITION];d.vertexArray.reserve(k.count);const x=wd(t,k);for(let I=0;I<k.count;I++)d.vertexArray.emplaceBack(x[3*I],x[3*I+1],x[3*I+2]);if(d.vertexArray._trim(),d.aabb=new Yn(k.min,k.max),d.centroid=function(I,T){const E=[0,0,0],A=I.length;if(A>0){for(let z=0;z<A;z++){const B=3*I[z];E[0]+=T[B],E[1]+=T[B+1],E[2]+=T[B+2]}E[0]/=A,E[1]/=A,E[2]/=A}return E}(C,x),f.COLOR_0!==void 0){const I=t.json.accessors[f.COLOR_0],T=og[I.type],E=wd(t,I);d.colorArray=T===3?new yl:new Da,d.colorArray.resize(I.count),uw(t,I,d.colorArray,E)}if(f.NORMAL!==void 0){d.normalArray=new yl;const I=t.json.accessors[f.NORMAL];d.normalArray.resize(I.count);const T=wd(t,I);uw(t,I,d.normalArray,T)}if(f.TEXCOORD_0!==void 0&&o.length>0){d.texcoordArray=new hd;const I=t.json.accessors[f.TEXCOORD_0];d.texcoordArray.resize(I.count);const T=wd(t,I);uw(t,I,d.texcoordArray,T)}if(f._FEATURE_ID_RGBA4444!==void 0){const I=t.json.accessors[f._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(d.featureData=wd(t,I))}f._FEATURE_RGBA4444!==void 0&&(d.featureData=new Uint32Array(wd(t,t.json.accessors[f._FEATURE_RGBA4444]).buffer));const S=l.material;return d.material=function(I,T){const{emissiveFactor:E=[0,0,0],alphaMode:A="OPAQUE",alphaCutoff:z=.5,normalTexture:B,occlusionTexture:U,emissiveTexture:G,doubleSided:N}=I,{baseColorFactor:Z=[1,1,1,1],metallicFactor:J=1,roughnessFactor:he=1,baseColorTexture:ye,metallicRoughnessTexture:xe}=I.pbrMetallicRoughness||{},me=U?T[U.index]:void 0;if(U&&U.extensions&&U.extensions.KHR_texture_transform&&me){const Ae=U.extensions.KHR_texture_transform;me.offsetScale=[Ae.offset[0],Ae.offset[1],Ae.scale[0],Ae.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new An(...Z),metallicFactor:J,roughnessFactor:he,baseColorTexture:ye?T[ye.index]:void 0,metallicRoughnessTexture:xe?T[xe.index]:void 0},doubleSided:N,emissiveFactor:E,alphaMode:A,alphaCutoff:z,normalTexture:B?T[B.index]:void 0,occlusionTexture:me,emissionTexture:G?T[G.index]:void 0,defined:I.defined===void 0}}(S!==void 0?t.json.materials[S]:{defined:!1},o),d}function sk(l,t,o){const{matrix:c,rotation:f,translation:d,scale:m,mesh:b,extras:C,children:k}=l,x={};if(x.matrix=c||be.mat4.fromRotationTranslationScale([],f||[0,0,0,1],d||[0,0,0],m||[1,1,1]),b!==void 0){x.meshes=o[b];const S=x.anchor=[0,0];for(const I of x.meshes){const{min:T,max:E}=I.aabb;S[0]+=T[0]+E[0],S[1]+=T[1]+E[1]}S[0]=Math.floor(S[0]/x.meshes.length/2),S[1]=Math.floor(S[1]/x.meshes.length/2)}if(C&&(C.id&&(x.id=C.id),C.lights&&(x.lights=function(S){if(!S.length)return[];const I=function(B){const U=atob(B),G=new Uint8Array(U.length);for(let N=0;N<U.length;N++)G[N]=U.codePointAt(N);return G}(S),T=[],E=I.length/24,A=new Uint16Array(I.buffer),z=new Float32Array(I.buffer);for(let B=0;B<E;B++){const U=A[2*B*6]/30,G=A[2*B*6+1]/30,N=A[2*B*6+10]/100,Z=z[6*B+1],J=z[6*B+2],he=z[6*B+3],ye=z[6*B+4],xe=he-Z,me=ye-J,Ae=Math.hypot(xe,me);T.push({pos:[Z+.5*xe,J+.5*me,G],normal:[me/Ae,-xe/Ae,0],width:Ae,height:U,depth:N,points:[Z,J,he,ye]})}return T}(C.lights))),k){const S=[];for(const I of k)S.push(sk(t.json.nodes[I],t,o));x.children=S}return x}function c5(l){if(l.vertices.length===0||l.indices.length===0)return null;const t=new xb(l.vertices,l.indices,8,256),[o,c]=[t.min.clone(),t.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:t,min:o,max:c}}function u5(l){if(!l.extras||!l.extras.ground)return null;const t=l.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const o=t[0];if(!o||!Array.isArray(o)||o.length===0)return null;const c=[];for(const m of o){if(!Array.isArray(m)||m.length!==2)continue;const b=m[0],C=m[1];typeof b=="number"&&typeof C=="number"&&c.push(new rt(b,C))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let f=0;for(let m=0;m<c.length;m++){const b=c[m],C=c[(m+1)%c.length],k=c[(m+2)%c.length];f+=(b.x-C.x)*(k.y-C.y)-(k.x-C.x)*(b.y-C.y)}f>0&&c.reverse();const d=Am(c.flatMap(m=>[m.x,m.y]),[]);return d.length===0?null:{vertices:c,indices:d}}function d5(l,t){const o=[],c=[];let f=0;const d=[];for(const m of l){f=o.length;const b=m.vertexArray.float32,C=m.indexArray.uint16;for(let k=0;k<m.vertexArray.length;k++)d[0]=b[3*k+0],d[1]=b[3*k+1],d[2]=b[3*k+2],be.vec3.transformMat4(d,d,t),o.push(new rt(d[0],d[1]));for(let k=0;k<3*m.indexArray.length;k++)c.push(C[k]+f)}if(c.length%3!=0)return null;for(let m=0;m<c.length;m+=3){const b=o[c[m+0]],C=o[c[m+1]],k=o[c[m+2]];(b.x-C.x)*(k.y-C.y)-(k.x-C.x)*(b.y-C.y)>0&&([c[m+1],c[m+2]]=[c[m+2],c[m+1]])}return{vertices:o,indices:c}}function ak(l){const t=function(C,k){const x=[],S=WebGL2RenderingContext;if(C.json.textures)for(const I of C.json.textures){const T={magFilter:S.LINEAR,minFilter:S.NEAREST,wrapS:S.REPEAT,wrapT:S.REPEAT};I.sampler!==void 0&&Object.assign(T,C.json.samplers[I.sampler]),x.push({image:k[I.source],sampler:T,uploaded:!1})}return x}(l,l.images),o=function(C,k){const x=[];for(const S of C.json.meshes){const I=[];for(const T of S.primitives)I.push(l5(T,C,k));x.push(I)}return x}(l,t),{scenes:c,scene:f,nodes:d}=l.json,m=c?c[f||0].nodes:d,b=[];for(const C of m)b.push(sk(d[C],l,o));return function(C,k,x){const S={},I=new Set;for(let T=0;T<C.length;T++){const E=x[k[T]];if(!E.extras)continue;const A=E.extras["mapbox:footprint:version"],z=E.extras["mapbox:footprint:id"];(A||z)&&I.add(T),A==="1.0.0"&&z&&(S[z]=T)}for(let T=0;T<C.length;T++){if(I.has(T))continue;const E=C[T],A=x[k[T]];if(!A.extras)continue;let z=null;E.id in S&&(z=d5(C[S[E.id]].meshes,E.matrix)),z||(z=u5(A)),z&&(E.footprint=c5(z))}if(I.size>0){const T=Array.from(I.values()).sort((E,A)=>E-A);for(let E=T.length-1;E>=0;E--)C.splice(T[E],1)}}(b,m,l.json.nodes),b}function h5(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const t=l.vertexArray.float32,o=l.aabb.min[0]-1,c=l.aabb.min[1]-1,f=vd/(l.aabb.max[0]-o+2),d=vd/(l.aabb.max[1]-c+2);for(let m=0;m<t.length;m+=3){const b=t[m+2],C=(t[m+0]-o)*f|0,k=(t[m+1]-c)*d|0;b>l.heightmap[k*vd+C]&&(l.heightmap[k*vd+C]=b)}}function p5(l,t){const o={};o.indexArray=new so,o.indexArray.reserve(4*l.length),o.vertexArray=new yl,o.vertexArray.reserve(10*l.length),o.colorArray=new Da,o.vertexArray.reserve(10*l.length);let c=0;for(const m of l){const b=Math.min(10,Math.max(4,1.3*m.height))*t,C=[-m.normal[1],m.normal[0],0],k=Math.min(.29,.1*m.width/m.depth),x=m.width-2*m.depth*t*(k+.01),S=be.vec3.scaleAndAdd([],m.pos,C,x/2),I=be.vec3.scaleAndAdd([],m.pos,C,-x/2),T=[S[0],S[1],S[2]+m.height],E=[I[0],I[1],I[2]+m.height],A=be.vec3.scaleAndAdd([],m.normal,C,k);be.vec3.scale(A,A,b);const z=be.vec3.scaleAndAdd([],m.normal,C,-k);be.vec3.scale(z,z,b),be.vec3.add(A,S,A),be.vec3.add(z,I,z),S[2]+=.1,I[2]+=.1,o.vertexArray.emplaceBack(A[0],A[1],A[2]),o.vertexArray.emplaceBack(z[0],z[1],z[2]),o.vertexArray.emplaceBack(S[0],S[1],S[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(T[0],T[1],T[2]),o.vertexArray.emplaceBack(E[0],E[1],E[2]),o.vertexArray.emplaceBack(S[0],S[1],S[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(A[0],A[1],A[2]),o.vertexArray.emplaceBack(z[0],z[1],z[2]);const B=x/b/2;o.colorArray.emplaceBack(-B-k,-1,B,.8),o.colorArray.emplaceBack(B+k,-1,B,.8),o.colorArray.emplaceBack(-B,0,B,1.3),o.colorArray.emplaceBack(B,0,B,1.3),o.colorArray.emplaceBack(B+k,-.8,B,.7),o.colorArray.emplaceBack(B+k,-.8,B,.7),o.colorArray.emplaceBack(0,0,B,1.3),o.colorArray.emplaceBack(0,0,B,1.3),o.colorArray.emplaceBack(B+k,-1.2,B,.8),o.colorArray.emplaceBack(B+k,-1.2,B,.8),o.indexArray.emplaceBack(6+c,4+c,8+c),o.indexArray.emplaceBack(7+c,9+c,5+c),o.indexArray.emplaceBack(0+c,1+c,2+c),o.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const f={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=An.white,f.pbrMetallicRoughness=d,o.material=f,o.aabb=new Yn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}class lk{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const c=t[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const f5=["id","tile","layer","source","sourceLayer","state"];class ck{constructor(t,o,c,f,d){this.type="Feature",this._vectorTileFeature=t,this._z=o,this._x=c,this._y=f,this.properties=t.properties,this.id=d}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of f5)this[o]!==void 0&&(t[o]=this[o]);return t}}class uk{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Zl(er,16,0),this.featureIndexArray=new j_,this.promoteId=o,this.is3DTile=!1}insert(t,o,c,f,d,m=0,b=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,d,m);const k=this.grid;for(let x=0;x<o.length;x++){const S=o[x],I=[1/0,1/0,-1/0,-1/0];for(let T=0;T<S.length;T++){const E=S[T];I[0]=Math.min(I[0],E.x),I[1]=Math.min(I[1],E.y),I[2]=Math.max(I[2],E.x),I[3]=Math.max(I[3],E.y)}b!==0&&(I[0]-=b,I[1]-=b,I[2]+=b,I[3]+=b),I[0]<er&&I[1]<er&&I[2]>=0&&I[3]>=0&&k.insert(C,I[0],I[1],I[2],I[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new rp.VectorTile(new a0(this.rawTileData)).layers,this.sourceLayerCoder=new lk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,o,c,f){this.loadVTLayers();const d=t.params||{},m=Ls(d.filter),b=t.tileResult,C=t.transform,k=b.bufferedTilespaceBounds,x=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,(E,A,z,B)=>gs(b.bufferedTilespaceGeometry,E,A,z,B));x.sort(m5);let S=null;C.elevation&&x.length>0&&(S=cp.create(C.elevation,this.tileID));const I={};let T;for(let E=0;E<x.length;E++){const A=x[E];if(A===T)continue;T=A;const z=this.featureIndexArray.get(A);let B=null;if(this.is3DTile){const U=this.bucketLayerIDs[0][0],G=o[U];if(G.type!=="model")continue;const{queryFeature:N,intersectionZ:Z}=G.queryIntersectsMatchingFeature(b,z.featureIndex,m,C);N&&this.appendToResult(I,U,z.featureIndex,N,Z)}else this.loadMatchingFeature(I,z,m,d.layers,d.availableImages,o,c,f,(U,G,N,Z=0)=>(B||(B=Vt(U,this.tileID.canonical,t.tileTransform)),G.queryIntersectsFeature(b,U,N,B,this.z,t.transform,t.pixelPosMatrix,S,Z)))}return I}loadMatchingFeature(t,o,c,f,d,m,b,C,k){const{featureIndex:x,bucketIndex:S,sourceLayerIndex:I,layoutVertexArrayOffset:T}=o,E=this.bucketLayerIDs[S];if(f&&!function(U,G){for(let N=0;N<U.length;N++)if(G.indexOf(U[N])>=0)return!0;return!1}(f,E))return;const A=this.sourceLayerCoder.decode(I),z=this.vtLayers[A].feature(x);if(c.needGeometry){const U=Ut(z,!0);if(!c.filter(new yi(this.tileID.overscaledZ),U,this.tileID.canonical))return}else if(!c.filter(new yi(this.tileID.overscaledZ),z))return;const B=this.getId(z,A);for(let U=0;U<E.length;U++){const G=E[U];if(f&&f.indexOf(G)<0)continue;const N=m[G];if(!N)continue;let Z={};B!==void 0&&C&&(Z=C.getState(N.sourceLayer||"_geojsonTileLayer",B));const J=!k||k(z,N,Z,T);if(!J)continue;const he=new ck(z,this.z,this.x,this.y,B),ye=Qr({},b[G]);ye.paint=dk(ye.paint,N.paint,z,Z,d),ye.layout=dk(ye.layout,N.layout,z,Z,d),he.layer=ye,this.appendToResult(t,G,x,he,J)}}appendToResult(t,o,c,f,d){let m=t[o];m===void 0&&(m=t[o]=[]),m.push({featureIndex:c,feature:f,intersectionZ:d})}lookupSymbolFeatures(t,o,c,f,d,m,b,C){const k={};this.loadVTLayers();const x=Ls(d);for(const S of t)this.loadMatchingFeature(k,{bucketIndex:c,sourceLayerIndex:f,featureIndex:S,layoutVertexArrayOffset:0},x,m,b,C,o);return k}loadFeature(t){const{featureIndex:o,sourceLayerIndex:c}=t;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),d=this.vtFeatures[f];if(d[o])return d[o];const m=this.vtLayers[f].feature(o);return d[o]=m,m}hasLayer(t){for(const o of this.bucketLayerIDs)for(const c of o)if(t===c)return!0;return!1}getId(t,o){let c=t.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];f!=null&&(c=t.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function dk(l,t,o,c,f){return dr(l,(d,m)=>{const b=t instanceof Wc?t.get(m):null;return b&&b.evaluate?b.evaluate(o,c,f):b})}function m5(l,t){return t-l}ur(uk,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const hk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class dw{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const d=hk[15&c];if(!d)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new dw(b,m,d,t)}constructor(t,o=64,c=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const d=hk.indexOf(this.ArrayType),m=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-b%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+C,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+m+b+C),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+C,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=o,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return hw(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:m,nodeSize:b}=this,C=[0,d.length-1,0],k=[];for(;C.length;){const x=C.pop()||0,S=C.pop()||0,I=C.pop()||0;if(S-I<=b){for(let z=I;z<=S;z++){const B=m[2*z],U=m[2*z+1];B>=t&&B<=c&&U>=o&&U<=f&&k.push(d[z])}continue}const T=I+S>>1,E=m[2*T],A=m[2*T+1];E>=t&&E<=c&&A>=o&&A<=f&&k.push(d[T]),(x===0?t<=E:o<=A)&&(C.push(I),C.push(T-1),C.push(1-x)),(x===0?c>=E:f>=A)&&(C.push(T+1),C.push(S),C.push(1-x))}return k}within(t,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:d,nodeSize:m}=this,b=[0,f.length-1,0],C=[],k=c*c;for(;b.length;){const x=b.pop()||0,S=b.pop()||0,I=b.pop()||0;if(S-I<=m){for(let z=I;z<=S;z++)fk(d[2*z],d[2*z+1],t,o)<=k&&C.push(f[z]);continue}const T=I+S>>1,E=d[2*T],A=d[2*T+1];fk(E,A,t,o)<=k&&C.push(f[T]),(x===0?t-c<=E:o-c<=A)&&(b.push(I),b.push(T-1),b.push(1-x)),(x===0?t+c>=E:o+c>=A)&&(b.push(T+1),b.push(S),b.push(1-x))}return C}}function hw(l,t,o,c,f,d){if(f-c<=o)return;const m=c+f>>1;pk(l,t,m,c,f,d),hw(l,t,o,c,m-1,1-d),hw(l,t,o,m+1,f,1-d)}function pk(l,t,o,c,f,d){for(;f>c;){if(f-c>600){const k=f-c+1,x=o-c+1,S=Math.log(k),I=.5*Math.exp(2*S/3),T=.5*Math.sqrt(S*I*(k-I)/k)*(x-k/2<0?-1:1);pk(l,t,o,Math.max(c,Math.floor(o-x*I/k+T)),Math.min(f,Math.floor(o+(k-x)*I/k+T)),d)}const m=t[2*o+d];let b=c,C=f;for(sg(l,t,c,o),t[2*f+d]>m&&sg(l,t,c,f);b<C;){for(sg(l,t,b,C),b++,C--;t[2*b+d]<m;)b++;for(;t[2*C+d]>m;)C--}t[2*c+d]===m?sg(l,t,c,C):(C++,sg(l,t,C,f)),C<=o&&(c=C+1),o<=C&&(f=C-1)}}function sg(l,t,o,c){pw(l,o,c),pw(t,2*o,2*c),pw(t,2*o+1,2*c+1)}function pw(l,t,o){const c=l[t];l[t]=l[o],l[o]=c}function fk(l,t,o,c){const f=l-o,d=t-c;return f*f+d*d}i.$=k_,i.A=class extends M0{},i.B=Wl,i.C=wc,i.D=ad,i.E=bc,i.F=rm,i.G=Ih,i.H=v_,i.I=Ob,i.J=Ah,i.K=Nh,i.L=C_,i.M=nd,i.N=vh,i.O=Xu,i.P=rt,i.Q=Yu,i.R=ol,i.S=Uo,i.T=Zb,i.U=If,i.V=M0,i.W=hm,i.X=kh,i.Y=tm,i.Z=function(l){const t=l.value;let o=[];if(!t)return o;const c=Wl(t);return c!=="string"?(o=o.concat([new M0(l.key,t,`string expected, "${c}" found`)]),o):(TI(t,!0)||(o=o.concat([new M0(l.key,t,`invalid url "${t}"`)])),o)},i._=st,i.a=function(l){return Ve.API_CDN_URL_REGEX.test(l)},i.a$=bm,i.a0=ci,i.a1=Zt,i.a2=class{constructor(l){this.specification=l}possiblyEvaluate(l,t){return sn(l.expression.evaluate(t))}interpolate(l,t,o){return{x:Pr(l.x,t.x,o),y:Pr(l.y,t.y,o),z:Pr(l.z,t.z,o),azimuthal:Pr(l.azimuthal,t.azimuthal,o),polar:Pr(l.polar,t.polar,o)}}},i.a3=yi,i.a4=na,i.a5=nt,i.a6=be,i.a7=Hr,i.a8=Wc,i.a9=tu,i.aA=Zn,i.aB=dI,i.aC=yI,i.aD=uI,i.aE=function(l,t){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let c=0;c<l.length;c++){const f=document.createElement("source");jo(l[c])||(o.crossOrigin="Anonymous"),f.src=l[c],o.appendChild(f)}return{cancel:()=>{}}},i.aF=b0,i.aG=function(l){return fetch(l).then(t=>t.arrayBuffer()).then(t=>ok(t,0,l))},i.aH=ak,i.aI=class{constructor(l,t,o,c){this.id=l,this.position=t!=null?new W(t[0],t[1]):new W(0,0),this.orientation=o??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new Yn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,t){if(be.mat4.multiply(l.matrix,t,l.matrix),l.meshes)for(const o of l.meshes){const c=Yn.applyTransformFast(o.aabb,l.matrix);this.aabb.encapsulate(c)}if(l.children)for(const o of l.children)this._applyTransformations(o,l.matrix)}computeBoundsAndApplyParent(){const l=be.mat4.identity([]);for(const t of this.nodes)this._applyTransformations(t,l)}computeModelMatrix(l,t,o,c,f,d,m=!1){kI(this.matrix,this,l.transform,this.position,t,o,c,f,d,m)}upload(l){if(!this.uploaded){for(const t of this.nodes)Qb(t,l);for(const t of this.nodes)E0(t);this.uploaded=!0}}destroy(){for(const l of this.nodes)ew(l)}},i.aJ=li,i.aK=Gm,i.aL=Ee,i.aM=Me,i.aN=gl,i.aO=so,i.aP=Wr,i.aQ=Xh,i.aR=x0,i.aS=function(){Go.isLoading()||Go.isLoaded()||cm()!=="deferred"||um()},i.aT=Ls,i.aU=Ut,i.aV=ck,i.aW=uo,i.aX=Ib,i.aY=_b,i.aZ=Vt,i.a_=ml,i.aa=Pr,i.ab=er,i.ac=Uu,i.ad=class{constructor(l){this.specification=l}possiblyEvaluate(l,t){return function([o,c]){const f=sn([1,o,c]);return{x:f.x,y:f.y,z:f.z}}(l.expression.evaluate(t))}interpolate(l,t,o){return{x:Pr(l.x,t.x,o),y:Pr(l.y,t.y,o),z:Pr(l.z,t.z,o)}}},i.ae=function(l,t,o=0,c=!0){const f=new rt(o,o),d=l.sub(f),m=t.add(f),b=[d,new rt(m.x,d.y),m,new rt(d.x,m.y)];return c&&b.push(d.clone()),b},i.af=function(l,t){const o=[];for(let c=0;c<l.length;c++){const f=zr(c-1,-1,l.length-1),d=zr(c+1,-1,l.length-1),m=l[c],b=l[d],C=l[f].sub(m).unit(),k=b.sub(m).unit(),x=k.angleWithSep(C.x,C.y),S=C.add(k).unit().mult(-1*t/Math.sin(x/2));o.push(m.add(S))}return o},i.ag=XE,i.ah=gs,i.ai=function(l,t,o=0){return be.vec3.fromValues(((t.x-o)*l.scale-l.x)*er,(t.y*l.scale-l.y)*er,Fe(t.z,t.y))},i.aj=Oa,i.ak=gE,i.al=function(l){let t=1/0,o=1/0,c=-1/0,f=-1/0;for(const d of l)t=Math.min(t,d.x),o=Math.min(o,d.y),c=Math.max(c,d.x),f=Math.max(f,d.y);return{min:new rt(t,o),max:new rt(c,f)}},i.am=_e,i.an=Qn,i.ao=Mt,i.ap=Xt,i.aq=n,i.ar=function(l,t){const o={};for(let c=0;c<t.length;c++){const f=t[c];f in l&&(o[f]=l[f])}return o},i.as=ee,i.at=Se,i.au=class{constructor(l){this.entries={},this.scheduler=l}request(l,t,o,c){const f=this.entries[l]=this.entries[l]||{callbacks:[]};if(f.result){const[d,m]=f.result;return this.scheduler?this.scheduler.add(()=>{c(d,m)},t):c(d,m),()=>{}}return f.callbacks.push(c),f.cancel||(f.cancel=o((d,m)=>{f.result=[d,m];for(const b of f.callbacks)this.scheduler?this.scheduler.add(()=>{b(d,m)},t):b(d,m);setTimeout(()=>delete this.entries[l],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(d=>d!==c),f.callbacks.length||(f.cancel(),delete this.entries[l]))}}},i.av=R_,i.aw=function(l,t,o){const c=JSON.stringify(l.request);return l.data&&(this.deduped.entries[c]={result:[null,l.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},f=>{const d=al(l.request,(m,b,C,k)=>{m?f(m):b&&f(null,{vectorTile:o?void 0:new rp.VectorTile(new a0(b)),rawData:b,cacheControl:C,expires:k})});return()=>{d.cancel(),f()}},t)},i.ax=function(l){ki++,ki>Tn&&(l.getActor().send("enforceCacheSizeLimit",jr),ki=0)},i.ay=nr,i.az=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},i.b=function(l){return Ve.API_FONTS_REGEX.test(l)},i.b$=function(l){const{x:t,y:o}=l.point,{lng:c,lat:f}=l._center;return lM(t,o,l.worldSize,c,f)},i.b0=_s,i.b1=_i,i.b2=Am,i.b3=Gb,i.b4=function(l,t){const o=tu(t.zoom);if(o===0)return bl(l);const c=q_(l),f=cb(c),d=_e(c.getWest())*t.worldSize,m=_e(c.getEast())*t.worldSize,b=Se(c.getNorth())*t.worldSize,C=Se(c.getSouth())*t.worldSize,k=[d,b,0],x=[m,b,0],S=[d,C,0],I=[m,C,0],T=be.mat4.invert([],t.globeMatrix);return be.vec3.transformMat4(k,k,T),be.vec3.transformMat4(x,x,T),be.vec3.transformMat4(S,S,T),be.vec3.transformMat4(I,I,T),f[0]=rc(f[0],S,o),f[1]=rc(f[1],I,o),f[2]=rc(f[2],x,o),f[3]=rc(f[3],k,o),Yn.fromPoints(f)},i.b5=Y_,i.b6=km,i.b7=rc,i.b8=Wh,i.b9=Ho,i.bA=zr,i.bB=Wt,i.bC=ms,i.bD=ge,i.bE=function(l,t,o){l[4*t+0]=o[0],l[4*t+1]=o[1],l[4*t+2]=o[2],l[4*t+3]=o[3]},i.bF=gd,i.bG=ia,i.bH=Cm,i.bI=wo,i.bJ=Ql,i.bK=W,i.bL=tI,i.bM=Ui,i.bN=eu,i.bO=xI,i.bP=Xi,i.bQ=oM,i.bR=function(l,t,o,c,f,d,m,b,C){if(C.name==="globe")return oM(l,t,new Xi(o,c,f),!1);const k=Gm({z:o,x:c,y:f},C);return new Yn([(d+k.x/k.scale)*t,t*(k.y/k.scale),m],[(d+k.x2/k.scale)*t,t*(k.y2/k.scale),b])},i.bS=function(l,t,o){let c=0;for(let f=0;f<2;++f)l[f]>0&&(c+=(l[f]-0)*(l[f]-0)),t[f]<0&&(c+=(0-t[f])*(0-t[f]));return c},i.bT=Re,i.bU=p,i.bV=function(l){const t=be.mat4.identity(new Float64Array(16));be.mat4.multiply(t,l.pixelMatrix,l.globeMatrix);const o=[0,P,0],c=[0,R,0];return be.vec3.transformMat4(o,o,t),be.vec3.transformMat4(c,c,t),[o[0]>0&&o[0]<=l.width&&o[1]>0&&o[1]<=l.height&&!hb(l,new W(l.center.lat,90)),c[0]>0&&c[0]<=l.width&&c[1]>0&&c[1]<=l.height&&!hb(l,new W(l.center.lat,-90))]},i.bW=function(l,t){const{scale:o}=l.tileTransform,c=o*er/(l.tileSize*Math.pow(2,t.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return be.mat2.scale(new Float32Array(4),t.inverseAdjustmentMatrix,[c,c])},i.bX=T0,i.bY=_I,i.bZ=function(l){const t=_I(l,!0);return be.mat2.invert([],[t[0],t[1],t[4],t[5]])},i.b_=vl,i.ba=ow,i.bb=a0,i.bc=al,i.bd=function(l){const t=[];for(const o in l)t.push(l[o]);return t},i.be=function(l,t){const o=[];for(const c in l)c in t||o.push(c);return o},i.bf=br,i.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bh=qt,i.bi=function(l,t){const{x:o,y:c}=l.point,f=lM(o,c,l.worldSize/l._pixelsPerMercatorPixel,0,0);return be.mat4.multiply(f,f,ub(bl(t)))},i.bj=np,i.bk=Os,i.bl=s0,i.bm=function(l,t,o,c,f){const d=5*t+2;l.float32[d+0]=o,l.float32[d+1]=c,l.float32[d+2]=f},i.bn=_0,i.bo=jE,i.bp=Kt,i.bq=po,i.br=VM,i.bs=SI,i.bt=HM,i.bu=qM,i.bv=jb,i.bw=HE,i.bx=zb,i.by=dw,i.bz=An,i.c=Xe,i.c$=Do,i.c0=wr,i.c1=Ao,i.c2=s,i.c3=function(l){const t=Math.round((l+45+360)%360/90)%4;return Sr[t]},i.c4=45,i.c5=ae,i.c6=Qh,i.c7=function(l,t,o){const c=Math.sqrt(l*l+t*t+o*o),f=c>0?Math.acos(o/c)*Yt:0;let d=l!==0||t!==0?Math.atan2(-t,-l)*Yt+90:0;return d<0&&(d+=360),[c,d,f]},i.c8=$e,i.c9=Yn,i.cA=function(l){const t=Re-5;l=Xt(l,-t,t)/t*90;const o=Math.pow(Math.abs(Math.sin(Wt(l))),3);return Math.round(o*(w.length-1))},i.cB=function(l,t,o,c){const f=t.getNorth(),d=t.getSouth(),m=t.getWest(),b=t.getEast(),C=1<<l.z,k=b-m,x=f-d,S=k/v,I=-x/w[o],T=[0,S,0,I,0,0,f,m,0];if(l.z>0){const E=180/c;be.mat3.multiply(T,T,[E/k+1,0,0,0,E/x+1,0,-.5*E/S,.5*E/I,1])}return T[2]=C,T[5]=l.x,T[8]=l.y,T},i.cC=bl,i.cD=function(l,t,o){const c=be.mat4.identity(new Float64Array(16)),f=(t/(1<<l)-.5)*Math.PI*2;return be.mat4.rotateY(c,o.globeMatrix,f),Float32Array.from(c)},i.cE=class{isDataAvailableAtPoint(l){const t=this._source();if(this.isUsingMockSource()||!t||l.y<0||l.y>1)return!1;const o=t.getSource().maxzoom,c=1<<o,f=Math.floor(l.x),d=Math.floor((l.x-f)*c),m=Math.floor(l.y*c),b=this.findDEMTileFor(new Zn(o,f,o,d,m));return!(!b||!b.dem)}getAtPointOrZero(l,t=0){return this.getAtPoint(l,t)||0}getAtPoint(l,t,o=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const c=this._source();if(!c||l.y<0||l.y>1)return t;const f=c.getSource().maxzoom,d=1<<f,m=Math.floor(l.x),b=l.x-m,C=new Zn(f,m,f,Math.floor(b*d),Math.floor(l.y*d)),k=this.findDEMTileFor(C);if(!k||!k.dem)return t;const x=k.dem,S=1<<k.tileID.canonical.z,I=(b*S-k.tileID.canonical.x)*x.dim,T=(l.y*S-k.tileID.canonical.y)*x.dim,E=Math.floor(I),A=Math.floor(T);return(o?this.exaggeration():1)*Pr(Pr(x.get(E,A),x.get(E,A+1),T-A),Pr(x.get(E+1,A),x.get(E+1,A+1),T-A),I-E)}getAtTileOffset(l,t,o){const c=1<<l.canonical.z;return this.getAtPointOrZero(new nt(l.wrap+(l.canonical.x+t/er)/c,(l.canonical.y+o/er)/c))}getAtTileOffsetFunc(l,t,o,c){return f=>{const d=this.getAtTileOffset(l,f.x,f.y),m=c.upVector(l.canonical,f.x,f.y),b=c.upVectorScale(l.canonical,t,o).metersToTile;return be.vec3.scale(m,m,d*b),m}}getForTilePoints(l,t,o,c){if(this.isUsingMockSource())return!1;const f=cp.create(this,l,c);return!!f&&(t.forEach(d=>{d[2]=this.exaggeration()*f.getElevationAt(d[0],d[1],o)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(l);if(!t||!t.dem)return null;const o=t.dem.tree,c=t.tileID,f=1<<l.canonical.z-c.canonical.z;let d=l.canonical.x/f-c.canonical.x,m=l.canonical.y/f-c.canonical.y,b=0;for(let C=0;C<l.canonical.z-c.canonical.z&&!o.leaves[b];C++){d*=2,m*=2;const k=2*Math.floor(m)+Math.floor(d);b=o.childOffsets[b]+k,d%=1,m%=1}return{min:this.exaggeration()*o.minimums[b],max:this.exaggeration()*o.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,t,o){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let t=!1,o=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const f of l){const d=this.getMinMaxForTile(f.tileID);d&&(o=Math.min(o,d.min),c=Math.max(c,d.max),t=!0)}return t?{min:o,max:c}:null}},i.cF=bM,i.cG=tc,i.cH=function(l,t){return[Math.pow(l[0],2.2)*t,Math.pow(l[1],2.2)*t,Math.pow(l[2],2.2)*t]},i.cI=aM,i.cJ=ke,i.cK=pe,i.cL=256,i.cM=function(l,t){const o=[0,0,0],c=Y_(bl(t.canonical));return be.vec3.transformMat4(o,o,c),be.vec3.transformMat4(o,o,l),o},i.cN=l=>({u_camera_to_center_distance:new wo(l),u_extrude_scale:new Em(l),u_device_pixel_ratio:new wo(l),u_matrix:new gd(l),u_inv_rot_matrix:new gd(l),u_merc_center:new ia(l),u_tile_id:new Cm(l),u_zoom_transition:new wo(l),u_up_dir:new Cm(l),u_emissive_strength:new wo(l)}),i.cO=l=>({u_matrix:new gd(l),u_pixels_to_tile_units:new Em(l),u_device_pixel_ratio:new wo(l),u_units_to_pixels:new ia(l),u_dash_image:new Ql(l),u_gradient_image:new Ql(l),u_image_height:new wo(l),u_texsize:new ia(l),u_tile_units_to_pixels:new wo(l),u_alpha_discard_threshold:new wo(l),u_trim_offset:new ia(l),u_trim_fade_range:new ia(l),u_trim_color:new Qh(l),u_emissive_strength:new wo(l)}),i.cP=l=>({u_matrix:new gd(l),u_texsize:new ia(l),u_pixels_to_tile_units:new Em(l),u_device_pixel_ratio:new wo(l),u_image:new Ql(l),u_units_to_pixels:new ia(l),u_tile_units_to_pixels:new wo(l),u_alpha_discard_threshold:new wo(l),u_trim_offset:new ia(l)}),i.cQ=Po,i.cR=FO,i.cS=BO,i.cT=dM,i.cU=(l,t,o,c,f,d)=>{const m=l.transform,b=m.projection.name==="globe";let C;if(d.paint.get("circle-pitch-alignment")==="map")if(b){const x=aM(m.zoom,t.canonical)*m._pixelsPerMercatorPixel;C=Float32Array.from([x,0,0,x])}else C=m.calculatePixelsToTileUnitsMatrix(o);else C=new Float32Array([m.pixelsToGLUnits[0],0,0,m.pixelsToGLUnits[1]]);const k={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(m.projection),u_matrix:l.translatePosMatrix(t.projMatrix,o,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:or.devicePixelRatio,u_extrude_scale:C,u_inv_rot_matrix:V4,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(b){k.u_inv_rot_matrix=c,k.u_merc_center=f,k.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],k.u_zoom_transition=tu(m.zoom);const x=f[0]*er,S=f[1]*er;k.u_up_dir=m.projection.upVector(new Xi(0,0,0),x,S)}return k},i.cV=xE,i.cW=(l,t,o,c,f,d)=>{const m=l.transform;return{u_matrix:_E(l,t,o,c),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:m.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:f,u_image:0,u_tile_units_to_pixels:yE(t,m),u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:d}},i.cX=(l,t,o,c,f,d,m)=>{const b=l.transform,C=b.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:_E(l,t,o,c),u_pixels_to_tile_units:C,u_device_pixel_ratio:d,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:vE(o)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:yE(t,l.transform),u_alpha_discard_threshold:0,u_trim_offset:m,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength")}},i.cY=Jn,i.cZ=Pm,i.c_=sE,i.ca=sn,i.cb=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},i.cc=function(l){return l({pluginStatus:to,pluginURL:fl}),lm.on("pluginStateChange",l),l},i.cd=up,i.ce=P0,i.cf=op,i.cg=Fb,i.ch=Nu,i.ci=I_,i.cj=Fr,i.ck=Vo,i.cl=Zr,i.cm=function(l){const t=l.indexOf(Hc);return t>=0?l.slice(0,t):l},i.cn=function(l){return l.indexOf(Hc)>=0},i.co=function(l){const t=l.indexOf(Hc);return t>=0?l.slice(t+1):""},i.cp=function(l){const t=[],o=l.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},i.cq=function(l,t,o,c){return l.type==="custom"?new mF(l,t):new MF[l.type](l,t,o,c)},i.cr=gr,i.cs=lm,i.ct=sl,i.cu=Mm,i.cv=class extends za{constructor(l){super(l),this.current=rb}set(l,t,o){if(this.fetchUniformLocation(l,t)){for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},i.cw=dn,i.cx=function(l,t,o){const c=tu(o.zoom),f=l.style.map._antialias,d=t.options.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return c===0&&!f&&!d},i.cy=function(l){const t=l.pixelsPerMeter,o=t/ge(1,l.center.lat),c=be.mat4.identity(new Float64Array(16));return be.mat4.translate(c,c,[l.point.x,l.point.y,0]),be.mat4.scale(c,c,[o,o,t]),Float32Array.from(c)},i.cz=q_,i.d=function(l){return Ve.API_TILEJSON_REGEX.test(l)},i.d$=j,i.d0=o0,i.d1=nu,i.d2=450,i.d3=7,i.d4=fF,i.d5=bn,i.d6=Zh,i.d7=256,i.d8=ub,i.d9=yl,i.dA=cM,i.dB=function(l){const t=[0,0,0],o=be.mat4.identity(new Float64Array(16));return be.mat4.multiply(o,l.pixelMatrix,l.globeMatrix),be.vec3.transformMat4(t,t,o),new rt(t[0],t[1])},i.dC=function(l,t,o=!1){if(to===od||to===sd||to===Bh)throw new Error("setRTLTextPlugin cannot be called multiple times.");fl=or.resolveURL(l),to=od,$c=t,am(),o||um()},i.dD=cm,i.dE=function(){P0().acquire(sw)},i.dF=function(){const l=ng;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(sw),ng=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dG=rg,i.dH=function(l){const t=ti();if(!t)return;const o=t.delete(Br);l&&o.catch(l).then(()=>l())},i.dI=tg,i.dJ=JI,i.dK=function(l){aw=or.resolveURL(l),pp||(pp=new up(P0(),new bc)),pp.broadcast("setDracoUrl",aw)},i.dL=QI,i.dM=function(l){hp=or.resolveURL(l),pp||(pp=new up(P0(),new bc)),pp.broadcast("setMeshoptUrl",hp)},i.dN=ur,i.dO=ru,i.dP=Ba,i.dQ=lk,i.dR=uk,i.dS=hE,i.dT=dr,i.dU=VE,i.dV=function(l,t,o,c,f,d,m,b,C,k,x){l.createArrays(),l.tilePixelRatio=er/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const S=l.layers[0].layout,I=l.layers[0]._unevaluatedLayout._values,T={};if(l.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:U}=l.textSizeData;T.compositeTextSizes=[I["text-size"].possiblyEvaluate(new yi(B),b),I["text-size"].possiblyEvaluate(new yi(U),b)]}if(l.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:U}=l.iconSizeData;T.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new yi(B),b),I["icon-size"].possiblyEvaluate(new yi(U),b)]}T.layoutTextSize=I["text-size"].possiblyEvaluate(new yi(C+1),b),T.layoutIconSize=I["icon-size"].possiblyEvaluate(new yi(C+1),b),T.textMaxSize=I["text-size"].possiblyEvaluate(new yi(18),b);const E=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",A=S.get("text-size");let z=!1;for(const B of l.features)if(B.icon&&B.icon.nameSecondary){z=!0;break}for(const B of l.features){const U=S.get("text-font").evaluate(B,{},b).join(","),G=A.evaluate(B,{},b),N=T.layoutTextSize.evaluate(B,{},b),Z=(T.layoutIconSize.evaluate(B,{},b),{horizontal:{},vertical:void 0}),J=B.text;let he,ye=[0,0];if(J){const Ae=J.toString(),Te=S.get("text-letter-spacing").evaluate(B,{},b)*po,Oe=S.get("text-line-height").evaluate(B,{},b)*po,We=W1(Ae)?Te:0,Ze=S.get("text-anchor").evaluate(B,{},b),Ye=S.get("text-variable-anchor");if(!Ye){const Et=S.get("text-radial-offset").evaluate(B,{},b);ye=Et?HE(Ze,[Et*po,Bb]):S.get("text-offset").evaluate(B,{},b).map(dt=>dt*po)}let Je=E?"center":S.get("text-justify").evaluate(B,{},b);const at=S.get("symbol-placement")==="point",Qe=at?S.get("text-max-width").evaluate(B,{},b)*po:1/0,gt=Et=>{l.allowVerticalPlacement&&zh(Ae)&&(Z.vertical=Lb(J,t,o,f,U,Qe,Oe,Ze,Et,We,ye,Os.vertical,!0,N,G))};if(!E&&Ye){const Et=Je==="auto"?Ye.map(sr=>jb(sr)):[Je];let dt=!1;for(let sr=0;sr<Et.length;sr++){const Jt=Et[sr];if(!Z.horizontal[Jt])if(dt)Z.horizontal[Jt]=Z.horizontal[0];else{const $t=Lb(J,t,o,f,U,Qe,Oe,"center",Jt,We,ye,Os.horizontal,!1,N,G);$t&&(Z.horizontal[Jt]=$t,dt=$t.positionedLines.length===1)}}gt("left")}else{if(Je==="auto"&&(Je=jb(Ze)),at||S.get("text-writing-mode").indexOf("horizontal")>=0||!zh(Ae)){const Et=Lb(J,t,o,f,U,Qe,Oe,Ze,Je,We,ye,Os.horizontal,!1,N,G);Et&&(Z.horizontal[Je]=Et)}gt(at?"left":Je)}}let xe=!1;if(B.icon&&B.icon.namePrimary){const Ae=c[B.icon.namePrimary];Ae&&(he=ZO(f[B.icon.namePrimary],B.icon.nameSecondary?f[B.icon.nameSecondary]:void 0,S.get("icon-offset").evaluate(B,{},b),S.get("icon-anchor").evaluate(B,{},b)),xe=Ae.sdf,l.sdfIcons===void 0?l.sdfIcons=Ae.sdf:l.sdfIcons!==Ae.sdf&&hr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ae.pixelRatio!==l.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const me=ZE(Z.horizontal)||Z.vertical;l.iconsInText||(l.iconsInText=!!me&&me.iconsInText),(me||he)&&tF(l,B,Z,he,c,T,N,0,ye,xe,m,b,k,x,z)}d&&l.generateCollisionDebugBuffers(C,l.collisionBoxArray)},i.dW=rp,i.dX=k0,i.dY=Bt,i.dZ=FM,i.d_=ME,i.da=La,i.db=vm,i.dc=function(l,t,o,c,f){return Xt((l-t)/(o-t)*(f-c)+c,c,f)},i.dd=Eh,i.de=qe,i.df=class{constructor(l,t,o,c){this.context=l,this.format=c,this.size=o,this.texture=l.gl.createTexture();const[f,d,m]=this.size,{gl:b}=l;b.bindTexture(b.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),b.texImage3D(b.TEXTURE_3D,0,this.format,f,d,m,0,Hb(this.format),qb(this.format),t.data)}bind(l,t){const{context:o}=this,{gl:c}=o;c.bindTexture(c.TEXTURE_3D,this.texture),l!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,l),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,l),this.minFilter=l),t!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,t),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},i.dg=Kb,i.dh=[1,1,1],i.di=cp,i.dj=lp,i.dk=_l,i.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new rt(1/0,1/0),max:new rt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,t=!1){const o=UM(new rt(0,0),new rt(er,er),l),c=[];if(t&&!Sb(o,this._globalClipBounds))return c;for(const f of this._activeRegions){if(f.hiddenByOverlap||!Sb(o,f))continue;const d=uO(f.min,f.max,l);c.push({min:d.min,max:d.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return c}setSources(l){this._setSources(l.map(t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const o=[];for(const c of t.cache.getVisibleCoordinates()){const f=t.cache.getTile(c).buckets[t.layer];f&&f.updateFootprints(c.toUnwrapped(),o)}return o},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope})))}_addSource(l){const t=l.getFootprints();if(t.length===0)return;const o=l.getOrder(),c=l.getClipMask(),f=l.getClipScope();for(const d of t){if(!d.footprint)continue;const m=UM(d.footprint.min,d.footprint.max,d.id);this._activeRegions.push({min:m.min,max:m.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:d.id,footprint:d.footprint,order:o,clipMask:c,clipScope:f})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((t,o)=>t.priority-o.priority||n0(t.min,o.min)||n0(t.max,o.max)||t.order-o.order||t.clipMask-o.clipMask||function(c,f){const d=(m,b)=>m+b;return c.length-f.length||c.reduce(d,"").localeCompare(f.reduce(d,""))}(t.clipScope,o.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let t=0;for(;!l&&t!==this._activeRegions.length;){const o=this._activeRegions[t],c=this._prevRegions[t];l=o.priority!==c.priority||!$M(o,c)||o.order!==c.order||o.clipMask!==c.clipMask||!qt(o.clipScope,c.clipScope),++t}}if(l){++this._updateTime;for(const o of this._activeRegions)o.order!==r0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const t=o=>{const c=this._activeRegions;if(o>=c.length)return o;const f=c[o].priority;for(;o<c.length&&c[o].priority===f;)++o;return o};if(this._sourceIds.length>1){let o=0,c=t(o);for(;o!==c;){let f=o;const d=o;for(;f!==c;){const m=this._activeRegions[f];m.hiddenByOverlap=!1;for(let b=0;b<d;b++){const C=this._activeRegions[b];if(!C.hiddenByOverlap&&m.order===r0&&Sb(m,C)&&(m.hiddenByOverlap=GM(m.footprint,m.tileId,C.footprint,C.tileId),m.hiddenByOverlap))break}++f}o=c,c=t(o)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=l.length-1;t>=0;t--)this._addSource(l[t]);this._computeReplacement()}},i.dm=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,t){const o=new ml,c=new so,f=[],d=l+1+2,m=t[0]+1,b=t[0]+1+(1+t.length),C=(k,x,S)=>{let I=k===d-1?k-2:k===0?k:k-1;return I+=S?24575:0,[I,x]};for(let k=0;k<d;++k)o.emplaceBack(...C(k,0,!0));for(let k=0;k<m;++k)for(let x=0;x<d;++x)o.emplaceBack(...C(x,k,(x===0||x===d-1)&&!0));for(let k=0;k<t.length;++k){const x=t[k];for(let S=0;S<d;++S)o.emplaceBack(...C(S,x,!0))}for(let k=0;k<t.length;++k){const x=c.length,S=t[k]+1+2,I=new so;for(let A=0;A<S-1;A++){const z=A===S-2,B=z?d*(b-t.length+k-A):d;for(let U=0;U<d-1;U++){const G=A*d+U;A===0||z||U===0||U===d-2?(I.emplaceBack(G+1,G,G+B),I.emplaceBack(G+B,G+B+1,G+1)):(c.emplaceBack(G+1,G,G+B),c.emplaceBack(G+B,G+B+1,G+1))}}const T=_i.simpleSegment(0,x,o.length,c.length-x);for(let A=0;A<I.uint16.length;A+=3)c.emplaceBack(I.uint16[A],I.uint16[A+1],I.uint16[A+2]);const E=_i.simpleSegment(0,x,o.length,c.length-x);f.push({withoutSkirts:T,withSkirts:E})}return{vertices:o,indices:c,segments:f}}_createGrid(l){const t=this._fillGridMeshWithLods(v,w);this._gridSegments=t.segments,this._gridBuffer=l.createVertexBuffer(t.vertices,_s.members),this._gridIndexBuffer=l.createIndexBuffer(t.indices,!0)}_createPoles(l){const t=new so;for(let m=0;m<=v;m++)t.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=l.createIndexBuffer(t,!0);const o=new La,c=new La,f=new La,d=new La;this._poleSegments=[];for(let m=0,b=0;m<s;m++){const C=360/(1<<m);o.emplaceBack(0,-n,0,.5,0),c.emplaceBack(0,-n,0,.5,1),f.emplaceBack(0,-n,0,.5,.5),d.emplaceBack(0,-n,0,.5,.5);for(let k=0;k<=v;k++){let x=k/v,S=0;const I=Pr(0,C,x),[T,E,A]=O(j4,N4,I,n);o.emplaceBack(T,E,A,x,S),c.emplaceBack(T,E,A,x,1-S);const z=Wt(I);x=.5+.5*Math.sin(z),S=.5+.5*Math.cos(z),f.emplaceBack(T,E,A,x,S),d.emplaceBack(T,E,A,x,1-S)}this._poleSegments.push(_i.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(o,ss,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(c,ss,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(f,ss,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(d,ss,!1)}getGridBuffers(l,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},i.dn=r0,i.dp=Tt,i.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.dr=ar,i.ds=Ue,i.dt=F,i.du=function([l,t,o]){const c=Math.hypot(l,t,o),f=Math.atan2(l,o),d=.5*Math.PI-Math.acos(-t/c);return new W(wr(f),wr(d))},i.dv=Xb,i.dw=V,i.dx=function(l){const t=l.navigator?l.navigator.userAgent:null;return!!function(o){if(eo==null){const c=o.navigator?o.navigator.userAgent:null;eo=!!o.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return eo}(l)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dy=function(l,t){jr=l,Tn=t},i.dz=hb,i.e=Ve,i.e0=function(l){let t=0;if(new Uint32Array(l,0,1)[0]!==tk){const o=new Uint32Array(l,0,7),[,,c,f,d,m]=o;t=o.byteLength+f+d+m+d,(c!==l.byteLength||t>=l.byteLength)&&hr("Invalid b3dm header information.")}return ok(l,t)},i.e1=function(l,t){const o=ak(l);for(const c of o){for(const f of c.meshes)h5(f);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(p5(c.lights,t)))}return o},i.e2=I0,i.e3=zI,i.e4=Go,i.e5=function(l){Ii(),Yr!=null&&Yr.then(t=>{t.keys().then(o=>{for(let c=0;c<o.length-l;c++)t.delete(o[c])})})},i.f=function(l){return l.indexOf("mapbox:")===0},i.g=function(l,t){return sl(Qr(l,{method:"GET"}),t)},i.h=Be,i.i=function(l){return Ve.API_STYLE_REGEX.test(l)&&!Xe(l)},i.j=function(l){return decodeURIComponent(atob(l).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(t,o)=>String.fromCharCode(+("0x"+o))))},i.l=Qr,i.m=Zi,i.n=function(l,t){return sl(Qr(l,{type:"json"}),t)},i.o=Qs,i.p=function(l,t){return sl(Qr(l,{method:"POST"}),t)},i.q=or,i.r=Ro,i.s=function(l){try{const t=self[l];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=$u,i.u=function(){return function l(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},i.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},i.w=hr,i.x=ll,i.y=2,i.z=NE}),M(["./shared"],function(i){function j(ut){const ue=ut?ut.url.toString():void 0;return ue?performance.getEntriesByName(ue):[]}function H(ut){if(typeof ut=="number"||typeof ut=="boolean"||typeof ut=="string"||ut==null)return JSON.stringify(ut);if(Array.isArray(ut)){let pe="[";for(const ke of ut)pe+=`${H(ke)},`;return`${pe}]`}let ue="{";for(const pe of Object.keys(ut).sort())ue+=`${pe}:${H(ut[pe])},`;return`${ue}}`}function q(ut){let ue="";for(const pe of i.bg)ue+=`/${H(ut[pe])}`;return ue}class X{constructor(ue){this.keyCache={},this._layers={},this._layerConfigs={},ue&&this.replace(ue)}replace(ue,pe){this._layerConfigs={},this._layers={},this.update(ue,[],pe)}update(ue,pe,ke){this._options=ke;for(const Be of ue)this._layerConfigs[Be.id]=Be,(this._layers[Be.id]=i.cq(Be,this.scope,null,this._options)).compileFilter(ke),this.keyCache[Be.id]&&delete this.keyCache[Be.id];for(const Be of pe)delete this.keyCache[Be],delete this._layerConfigs[Be],delete this._layers[Be];this.familiesBySource={};const Ve=function(Be,Xe){const lt={};for(let ct=0;ct<Be.length;ct++){const yt=Xe&&Xe[Be[ct].id]||q(Be[ct]);Xe&&(Xe[Be[ct].id]=yt);let mt=lt[yt];mt||(mt=lt[yt]=[]),mt.push(Be[ct])}const et=[];for(const ct in lt)et.push(lt[ct]);return et}(i.bd(this._layerConfigs),this.keyCache);for(const Be of Ve){const Xe=Be.map(jt=>this._layers[jt.id]),lt=Xe[0];if(lt.visibility==="none")continue;const et=lt.source||"";let ct=this.familiesBySource[et];ct||(ct=this.familiesBySource[et]={});const yt=lt.sourceLayer||"_geojsonTileLayer";let mt=ct[yt];mt||(mt=ct[yt]=[]),mt.push(Xe)}}}const se=1*i.dP;class ne{constructor(ue){const pe={},ke=[];for(const lt in ue){const et=ue[lt],ct=pe[lt]={};for(const yt in et.glyphs){const mt=et.glyphs[+yt];if(!mt||mt.bitmap.width===0||mt.bitmap.height===0)continue;const jt=mt.metrics.localGlyph?se:1,nr={x:0,y:0,w:mt.bitmap.width+2*jt,h:mt.bitmap.height+2*jt};ke.push(nr),ct[yt]=nr}}const{w:Ve,h:Be}=i.z(ke),Xe=new i.dO({width:Ve||1,height:Be||1});for(const lt in ue){const et=ue[lt];for(const ct in et.glyphs){const yt=et.glyphs[+ct];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const mt=pe[lt][ct],jt=yt.metrics.localGlyph?se:1;i.dO.copy(yt.bitmap,Xe,{x:0,y:0},{x:mt.x+jt,y:mt.y+jt},yt.bitmap)}}this.image=Xe,this.positions=pe}}i.dN(ne,"GlyphAtlas");class le{constructor(ue){this.tileID=new i.aA(ue.tileID.overscaledZ,ue.tileID.wrap,ue.tileID.canonical.z,ue.tileID.canonical.x,ue.tileID.canonical.y),this.tileZoom=ue.tileZoom,this.uid=ue.uid,this.zoom=ue.zoom,this.lut=ue.lut,this.canonical=ue.tileID.canonical,this.pixelRatio=ue.pixelRatio,this.tileSize=ue.tileSize,this.source=ue.source,this.scope=ue.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ue.showCollisionBoxes,this.collectResourceTiming=!!ue.collectResourceTiming,this.promoteId=ue.promoteId,this.isSymbolTile=ue.isSymbolTile,this.tileTransform=i.aK(ue.tileID.canonical,ue.projection),this.projection=ue.projection,this.brightness=ue.brightness,this.extraShadowCaster=!!ue.extraShadowCaster,this.tessellationStep=ue.tessellationStep}parse(ue,pe,ke,Ve,Be){this.status="parsing",this.data=ue,this.collisionBoxArray=new i.aQ;const Xe=new i.dQ(Object.keys(ue.layers).sort()),lt=new i.dR(this.tileID,this.promoteId);lt.bucketLayerIDs=[];const et={},ct=new i.dS(256,256),yt={featureIndex:lt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:ct,availableImages:ke,brightness:this.brightness},mt=pe.familiesBySource[this.source];for(const jr in mt){const Tn=ue.layers[jr];if(!Tn)continue;let Pn=!1,Yr=!1,En=!1;for(const ki of mt[jr])ki[0].type==="symbol"?Pn=!0:Yr=!0,ki[0].is3D()&&ki[0].type!=="model"&&(En=!0);if(this.extraShadowCaster&&!En||this.isSymbolTile===!0&&!Pn||this.isSymbolTile===!1&&!Yr)continue;Tn.version===1&&i.w(`Vector tile source "${this.source}" layer "${jr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ti=Xe.encode(jr),Ii=[];for(let ki=0;ki<Tn.length;ki++){const Zi=Tn.feature(ki),Bo=lt.getId(Zi,jr);Ii.push({feature:Zi,id:Bo,index:ki,sourceLayerIndex:ti})}for(const ki of mt[jr]){const Zi=ki[0];(!this.extraShadowCaster||Zi.is3D()&&Zi.type!=="model")&&(this.isSymbolTile!==void 0&&Zi.type==="symbol"!==this.isSymbolTile||Zi.minzoom&&this.zoom<Math.floor(Zi.minzoom)||Zi.maxzoom&&this.zoom>=Zi.maxzoom||Zi.visibility!=="none"&&(de(ki,this.zoom,yt.brightness,ke),(et[Zi.id]=Zi.createBucket({index:lt.bucketLayerIDs.length,layers:ki,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ti,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Ii,yt,this.tileID.canonical,this.tileTransform),lt.bucketLayerIDs.push(ki.map(Bo=>Bo.id))))}}let jt,nr,or,Or;ct.trim();const Fr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Br=()=>{if(jt)return this.status="done",Be(jt);if(this.extraShadowCaster)this.status="done",Be(null,{buckets:i.bd(et).filter(jr=>!jr.isEmpty()),featureIndex:lt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:yt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(nr&&or&&Or){const jr=new ne(nr),Tn=new i.dU(or,Or,this.lut);for(const Pn in et){const Yr=et[Pn];Yr instanceof i.aR?(de(Yr.layers,this.zoom,yt.brightness,ke),i.dV(Yr,nr,jr.positions,or,Tn.iconPositions,this.showCollisionBoxes,ke,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):Yr.hasPattern&&(Yr instanceof i.aX||Yr instanceof i.aY||Yr instanceof i.d0)&&(de(Yr.layers,this.zoom,yt.brightness,ke),Yr.addFeatures(yt,this.tileID.canonical,Tn.patternPositions,ke,this.tileTransform,this.brightness))}this.status="done",Be(null,{buckets:i.bd(et).filter(Pn=>!Pn.isEmpty()),featureIndex:lt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:jr.image,lineAtlas:ct,imageAtlas:Tn,brightness:yt.brightness})}};if(!this.extraShadowCaster){const jr=i.dT(yt.glyphDependencies,Yr=>Object.keys(Yr).map(Number));Object.keys(jr).length?Ve.send("getGlyphs",{uid:this.uid,stacks:jr,scope:this.scope},(Yr,En)=>{jt||(jt=Yr,nr=En,Br())},void 0,!1,Fr):nr={};const Tn=Object.keys(yt.iconDependencies);Tn.length?Ve.send("getImages",{icons:Tn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Yr,En)=>{jt||(jt=Yr,or=En,Br())},void 0,!1,Fr):or={};const Pn=Object.keys(yt.patternDependencies);Pn.length?Ve.send("getImages",{icons:Pn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Yr,En)=>{jt||(jt=Yr,Or=En,Br())},void 0,!1,Fr):Or={}}Br()}}function de(ut,ue,pe,ke){const Ve=new i.a3(ue,{brightness:pe});for(const Be of ut)Be.recalculate(Ve,ke)}class te extends i.E{constructor(ue,pe,ke,Ve,Be,Xe){super(),this.actor=ue,this.layerIndex=pe,this.availableImages=ke,this.loadVectorData=Be||i.aw,this.loading={},this.loaded={},this.deduped=new i.au(ue.scheduler),this.isSpriteLoaded=Ve,this.scheduler=ue.scheduler,this.brightness=Xe}loadTile(ue,pe){const ke=ue.uid,Ve=ue&&ue.request,Be=Ve&&Ve.collectResourceTiming,Xe=this.loading[ke]=new le(ue);Xe.abort=this.loadVectorData(ue,(lt,et)=>{const ct=!this.loading[ke];if(delete this.loading[ke],ct||lt||!et)return Xe.status="done",ct||(this.loaded[ke]=Xe),pe(lt);const yt=et.rawData,mt={};et.expires&&(mt.expires=et.expires),et.cacheControl&&(mt.cacheControl=et.cacheControl),Xe.vectorTile=et.vectorTile||new i.dW.VectorTile(new i.bb(yt));const jt=()=>{Xe.parse(Xe.vectorTile,this.layerIndex,this.availableImages,this.actor,(nr,or)=>{if(nr||!or)return pe(nr);const Or={};if(Be){const Fr=j(Ve);Fr.length>0&&(Or.resourceTiming=JSON.parse(JSON.stringify(Fr)))}pe(null,i.l({rawTileData:yt.slice(0)},or,mt,Or))})};this.isSpriteLoaded?jt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(jt,{type:"parseTile",isSymbolTile:ue.isSymbolTile,zoom:ue.tileZoom}):jt()}),this.loaded=this.loaded||{},this.loaded[ke]=Xe})}reloadTile(ue,pe){const ke=this.loaded,Ve=ue.uid;if(ke&&ke[Ve]){const Be=ke[Ve];Be.showCollisionBoxes=ue.showCollisionBoxes,Be.projection=ue.projection,Be.brightness=ue.brightness,Be.tileTransform=i.aK(ue.tileID.canonical,ue.projection),Be.extraShadowCaster=ue.extraShadowCaster,Be.lut=ue.lut;const Xe=(lt,et)=>{const ct=Be.reloadCallback;ct&&(delete Be.reloadCallback,Be.parse(Be.vectorTile,this.layerIndex,this.availableImages,this.actor,ct)),pe(lt,et)};Be.status==="parsing"?Be.reloadCallback=Xe:Be.status==="done"&&(Be.vectorTile?Be.parse(Be.vectorTile,this.layerIndex,this.availableImages,this.actor,Xe):Xe())}else pe(null,void 0)}abortTile(ue,pe){const ke=ue.uid,Ve=this.loading[ke];Ve&&(Ve.abort&&Ve.abort(),delete this.loading[ke]),pe()}removeTile(ue,pe){const ke=this.loaded,Ve=ue.uid;ke&&ke[Ve]&&delete ke[Ve],pe()}}class Q{loadTile(ue,pe){const{uid:ke,encoding:Ve,rawImageData:Be,padding:Xe}=ue,lt=ImageBitmap&&Be instanceof ImageBitmap?this.getImageData(Be,Xe):Be;pe(null,new i.dX(ke,lt,Ve,Xe<1))}getImageData(ue,pe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ue.width,ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ue.width,this.offscreenCanvas.height=ue.height,this.offscreenCanvasContext.drawImage(ue,0,0,ue.width,ue.height);const ke=this.offscreenCanvasContext.getImageData(-pe,-pe,ue.width+2*pe,ue.height+2*pe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ke}}i.ba.setPbf(i.bb);class K{decodeRasterArray({task:ue,buffer:pe},ke){i.ba.performDecoding(pe,ue).then(Ve=>{ke(null,Ve)},Ve=>{ke(Ve)})}}const ce=i.dW.VectorTileFeature.prototype.toGeoJSON;class fe{constructor(ue){this._feature=ue,this.extent=i.ab,this.type=ue.type,this.properties=ue.tags,"id"in ue&&!isNaN(ue.id)&&(this.id=parseInt(ue.id,10))}loadGeometry(){if(this._feature.type===1){const ue=[];for(const pe of this._feature.geometry)ue.push([new i.P(pe[0],pe[1])]);return ue}{const ue=[];for(const pe of this._feature.geometry){const ke=[];for(const Ve of pe)ke.push(new i.P(Ve[0],Ve[1]));ue.push(ke)}return ue}}toGeoJSON(ue,pe,ke){return ce.call(this,ue,pe,ke)}}class Ie{constructor(ue){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ab,this.length=ue.length,this._features=ue}feature(ue){return new fe(this._features[ue])}}const Ce=64/4096,we=128;class ot{constructor(){this.features=new Map}clear(){this.features.clear()}load(ue=[],pe){for(const ke of ue){const Ve=ke.id;if(Ve==null)continue;let Be=this.features.get(Ve);Be&&this.updateCache(Be,pe),ke.geometry?(Be=ve(ke),this.updateCache(Be,pe),this.features.set(Ve,Be)):this.features.delete(Ve),this.updateCache(Be,pe)}}updateCache(ue,pe){for(const{canonical:ke,uid:Ve}of Object.values(pe)){const{z:Be,x:Xe,y:lt}=ke;oe(ue,Math.pow(2,Be),Xe,lt)&&delete pe[Ve]}}getTile(ue,pe,ke){const Ve=Math.pow(2,ue),Be=[];for(const Xe of this.features.values())oe(Xe,Ve,pe,ke)&&Be.push(ze(Xe,Ve,pe,ke));return{features:Be}}getFeatures(){return[...this.features.values()]}}function oe({minX:ut,minY:ue,maxX:pe,maxY:ke},Ve,Be,Xe){return ut<(Be+1+Ce)/Ve&&ue<(Xe+1+Ce)/Ve&&pe>(Be-Ce)/Ve&&ke>(Xe-Ce)/Ve}function ve(ut){const{id:ue,geometry:pe,properties:ke}=ut;if(!pe)return;if(pe.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ve,coordinates:Be}=pe,Xe={id:ue,type:1,geometry:[],tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},lt=Xe.geometry;if(Ve==="Point")je(Be,lt,Xe);else if(Ve==="MultiPoint")for(const et of Be)je(et,lt,Xe);else if(Ve==="LineString")Xe.type=2,He(Be,lt,Xe);else if(Ve==="MultiLineString")Xe.type=2,Le(Be,lt,Xe);else if(Ve==="Polygon")Xe.type=3,Le(Be,lt,Xe,!0);else{if(Ve!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Xe.type=3;for(const et of Be)Le(et,lt,Xe,!0)}return Xe}function je([ut,ue],pe,ke){const Ve=i.am(ut);let Be=i.at(ue);Be=Be<0?0:Be>1?1:Be,pe.push(Ve,Be),ke.minX=Math.min(ke.minX,Ve),ke.minY=Math.min(ke.minY,Be),ke.maxX=Math.max(ke.maxX,Ve),ke.maxY=Math.max(ke.maxY,Be)}function He(ut,ue,pe,ke=!1,Ve=!1){const Be=[];for(const Xe of ut)je(Xe,Be,pe);ue.push(Be),ke&&function(Xe,lt){let et=0;for(let ct=0,yt=Xe.length,mt=yt-2;ct<yt;mt=ct,ct+=2)et+=(Xe[ct]-Xe[mt])*(Xe[ct+1]+Xe[mt+1]);if(et>0===lt)for(let ct=0,yt=Xe.length;ct<yt/2;ct+=2){const mt=Xe[ct],jt=Xe[ct+1];Xe[ct]=Xe[yt-2-ct],Xe[ct+1]=Xe[yt-1-ct],Xe[yt-2-ct]=mt,Xe[yt-1-ct]=jt}}(Be,Ve)}function Le(ut,ue,pe,ke=!1){for(let Ve=0;Ve<ut.length;Ve++)He(ut[Ve],ue,pe,ke,Ve===0)}function ze(ut,ue,pe,ke){const{id:Ve,type:Be,geometry:Xe,tags:lt}=ut,et=[];if(Be===1)(function(ct,yt,mt,jt,nr){for(let or=0;or<ct.length;or+=2){const Or=Math.round(i.ab*(ct[or+0]*yt-mt)),Fr=Math.round(i.ab*(ct[or+1]*yt-jt));nr.push([Or,Fr])}})(Xe,ue,pe,ke,et);else for(const ct of Xe)Pe(ct,ue,pe,ke,et);return{id:Ve,type:Be,geometry:et,tags:lt}}function Pe(ut,ue,pe,ke,Ve){const Be=-we,Xe=i.ab+we;let lt;for(let et=0;et<ut.length-2;et+=2){let ct=Math.round(i.ab*(ut[et+0]*ue-pe)),yt=Math.round(i.ab*(ut[et+1]*ue-ke)),mt=Math.round(i.ab*(ut[et+2]*ue-pe)),jt=Math.round(i.ab*(ut[et+3]*ue-ke));const nr=mt-ct,or=jt-yt;ct<Be&&mt<Be||(ct<Be?(yt+=Math.round(or*((Be-ct)/nr)),ct=Be):mt<Be&&(jt=yt+Math.round(or*((Be-ct)/nr)),mt=Be),yt<Be&&jt<Be||(yt<Be?(ct+=Math.round(nr*((Be-yt)/or)),yt=Be):jt<Be&&(mt=ct+Math.round(nr*((Be-yt)/or)),jt=Be),ct>=Xe&&mt>=Xe||(ct>=Xe?(yt+=Math.round(or*((Xe-ct)/nr)),ct=Xe):mt>=Xe&&(jt=yt+Math.round(or*((Xe-ct)/nr)),mt=Xe),yt>=Xe&&jt>=Xe||(yt>=Xe?(ct+=Math.round(nr*((Xe-yt)/or)),yt=Xe):jt>=Xe&&(mt=ct+Math.round(nr*((Xe-yt)/or)),jt=Xe),lt&&ct===lt[lt.length-1][0]&&yt===lt[lt.length-1][1]||(lt=[[ct,yt]],Ve.push(lt)),lt.push([mt,jt])))))}}var tt,De,Ke,Ge={exports:{}},ft=function(){if(Ke)return Ge.exports;Ke=1;var ut=i.d_(),ue=function(){if(De)return tt;De=1;var yt=i.dY(),mt=i.dZ().VectorTileFeature;function jt(or,Or){this.options=Or||{},this.features=or,this.length=or.length}function nr(or,Or){this.id=typeof or.id=="number"?or.id:void 0,this.type=or.type,this.rawGeometry=or.type===1?[or.geometry]:or.geometry,this.properties=or.tags,this.extent=Or||4096}return tt=jt,jt.prototype.feature=function(or){return new nr(this.features[or],this.options.extent)},nr.prototype.loadGeometry=function(){var or=this.rawGeometry;this.geometry=[];for(var Or=0;Or<or.length;Or++){for(var Fr=or[Or],Br=[],jr=0;jr<Fr.length;jr++)Br.push(new yt(Fr[jr][0],Fr[jr][1]));this.geometry.push(Br)}return this.geometry},nr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var or=this.geometry,Or=1/0,Fr=-1/0,Br=1/0,jr=-1/0,Tn=0;Tn<or.length;Tn++)for(var Pn=or[Tn],Yr=0;Yr<Pn.length;Yr++){var En=Pn[Yr];Or=Math.min(Or,En.x),Fr=Math.max(Fr,En.x),Br=Math.min(Br,En.y),jr=Math.max(jr,En.y)}return[Or,Br,Fr,jr]},nr.prototype.toGeoJSON=mt.prototype.toGeoJSON,tt}();function pe(yt){var mt=new ut;return function(jt,nr){for(var or in jt.layers)nr.writeMessage(3,ke,jt.layers[or])}(yt,mt),mt.finish()}function ke(yt,mt){var jt;mt.writeVarintField(15,yt.version||1),mt.writeStringField(1,yt.name||""),mt.writeVarintField(5,yt.extent||4096);var nr={keys:[],values:[],keycache:{},valuecache:{}};for(jt=0;jt<yt.length;jt++)nr.feature=yt.feature(jt),mt.writeMessage(2,Ve,nr);var or=nr.keys;for(jt=0;jt<or.length;jt++)mt.writeStringField(3,or[jt]);var Or=nr.values;for(jt=0;jt<Or.length;jt++)mt.writeMessage(4,ct,Or[jt])}function Ve(yt,mt){var jt=yt.feature;jt.id!==void 0&&mt.writeVarintField(1,jt.id),mt.writeMessage(2,Be,yt),mt.writeVarintField(3,jt.type),mt.writeMessage(4,et,jt)}function Be(yt,mt){var jt=yt.feature,nr=yt.keys,or=yt.values,Or=yt.keycache,Fr=yt.valuecache;for(var Br in jt.properties){var jr=jt.properties[Br],Tn=Or[Br];if(jr!==null){Tn===void 0&&(nr.push(Br),Or[Br]=Tn=nr.length-1),mt.writeVarint(Tn);var Pn=typeof jr;Pn!=="string"&&Pn!=="boolean"&&Pn!=="number"&&(jr=JSON.stringify(jr));var Yr=Pn+":"+jr,En=Fr[Yr];En===void 0&&(or.push(jr),Fr[Yr]=En=or.length-1),mt.writeVarint(En)}}}function Xe(yt,mt){return(mt<<3)+(7&yt)}function lt(yt){return yt<<1^yt>>31}function et(yt,mt){for(var jt=yt.loadGeometry(),nr=yt.type,or=0,Or=0,Fr=jt.length,Br=0;Br<Fr;Br++){var jr=jt[Br],Tn=1;nr===1&&(Tn=jr.length),mt.writeVarint(Xe(1,Tn));for(var Pn=nr===3?jr.length-1:jr.length,Yr=0;Yr<Pn;Yr++){Yr===1&&nr!==1&&mt.writeVarint(Xe(2,Pn-1));var En=jr[Yr].x-or,ti=jr[Yr].y-Or;mt.writeVarint(lt(En)),mt.writeVarint(lt(ti)),or+=En,Or+=ti}nr===3&&mt.writeVarint(Xe(7,1))}}function ct(yt,mt){var jt=typeof yt;jt==="string"?mt.writeStringField(1,yt):jt==="boolean"?mt.writeBooleanField(7,yt):jt==="number"&&(yt%1!=0?mt.writeDoubleField(3,yt):yt<0?mt.writeSVarintField(6,yt):mt.writeVarintField(5,yt))}return Ge.exports=pe,Ge.exports.fromVectorTileJs=pe,Ge.exports.fromGeojsonVt=function(yt,mt){mt=mt||{};var jt={};for(var nr in yt)jt[nr]=new ue(yt[nr].features,mt),jt[nr].name=nr,jt[nr].version=mt.version,jt[nr].extent=mt.extent;return pe({layers:jt})},Ge.exports.GeoJSONWrapper=ue,Ge.exports}(),Gt=i.d$(ft);const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},wt=Math.fround||(Rt=new Float32Array(1),ut=>(Rt[0]=+ut,Rt[0]));var Rt;const It=3,zt=5,At=6;class kt{constructor(ue){this.options=Object.assign(Object.create(Ft),ue),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ue){const{log:pe,minZoom:ke,maxZoom:Ve}=this.options;pe&&console.time("total time");const Be=`prepare ${ue.length} points`;pe&&console.time(Be),this.points=ue;const Xe=[];for(let et=0;et<ue.length;et++){const ct=ue[et];if(!ct.geometry)continue;const[yt,mt]=ct.geometry.coordinates,jt=wt(Ht(yt)),nr=wt(xt(mt));Xe.push(jt,nr,1/0,et,-1,1),this.options.reduce&&Xe.push(0)}let lt=this.trees[Ve+1]=this._createTree(Xe);pe&&console.timeEnd(Be);for(let et=Ve;et>=ke;et--){const ct=+Date.now();lt=this.trees[et]=this._createTree(this._cluster(lt,et)),pe&&console.log("z%d: %d clusters in %dms",et,lt.numItems,+Date.now()-ct)}return pe&&console.timeEnd("total time"),this}getClusters(ue,pe){let ke=((ue[0]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,ue[1]));let Be=ue[2]===180?180:((ue[2]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,ue[3]));if(ue[2]-ue[0]>=360)ke=-180,Be=180;else if(ke>Be){const mt=this.getClusters([ke,Ve,180,Xe],pe),jt=this.getClusters([-180,Ve,Be,Xe],pe);return mt.concat(jt)}const lt=this.trees[this._limitZoom(pe)],et=lt.range(Ht(ke),xt(Xe),Ht(Be),xt(Ve)),ct=lt.data,yt=[];for(const mt of et){const jt=this.stride*mt;yt.push(ct[jt+zt]>1?Ot(ct,jt,this.clusterProps):this.points[ct[jt+It]])}return yt}getChildren(ue){const pe=this._getOriginId(ue),ke=this._getOriginZoom(ue),Ve="No cluster with the specified id.",Be=this.trees[ke];if(!Be)throw new Error(Ve);const Xe=Be.data;if(pe*this.stride>=Xe.length)throw new Error(Ve);const lt=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),et=Be.within(Xe[pe*this.stride],Xe[pe*this.stride+1],lt),ct=[];for(const yt of et){const mt=yt*this.stride;Xe[mt+4]===ue&&ct.push(Xe[mt+zt]>1?Ot(Xe,mt,this.clusterProps):this.points[Xe[mt+It]])}if(ct.length===0)throw new Error(Ve);return ct}getLeaves(ue,pe,ke){const Ve=[];return this._appendLeaves(Ve,ue,pe=pe||10,ke=ke||0,0),Ve}getTile(ue,pe,ke){const Ve=this.trees[this._limitZoom(ue)],Be=Math.pow(2,ue),{extent:Xe,radius:lt}=this.options,et=lt/Xe,ct=(ke-et)/Be,yt=(ke+1+et)/Be,mt={features:[]};return this._addTileFeatures(Ve.range((pe-et)/Be,ct,(pe+1+et)/Be,yt),Ve.data,pe,ke,Be,mt),pe===0&&this._addTileFeatures(Ve.range(1-et/Be,ct,1,yt),Ve.data,Be,ke,Be,mt),pe===Be-1&&this._addTileFeatures(Ve.range(0,ct,et/Be,yt),Ve.data,-1,ke,Be,mt),mt.features.length?mt:null}getClusterExpansionZoom(ue){let pe=this._getOriginZoom(ue)-1;for(;pe<=this.options.maxZoom;){const ke=this.getChildren(ue);if(pe++,ke.length!==1)break;ue=ke[0].properties.cluster_id}return pe}_appendLeaves(ue,pe,ke,Ve,Be){const Xe=this.getChildren(pe);for(const lt of Xe){const et=lt.properties;if(et&&et.cluster?Be+et.point_count<=Ve?Be+=et.point_count:Be=this._appendLeaves(ue,et.cluster_id,ke,Ve,Be):Be<Ve?Be++:ue.push(lt),ue.length===ke)break}return Be}_createTree(ue){const pe=new i.by(ue.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ke=0;ke<ue.length;ke+=this.stride)pe.add(ue[ke],ue[ke+1]);return pe.finish(),pe.data=ue,pe}_addTileFeatures(ue,pe,ke,Ve,Be,Xe){for(const lt of ue){const et=lt*this.stride,ct=pe[et+zt]>1;let yt,mt,jt;if(ct)yt=be(pe,et,this.clusterProps),mt=pe[et],jt=pe[et+1];else{const Or=this.points[pe[et+It]];yt=Or.properties;const[Fr,Br]=Or.geometry.coordinates;mt=Ht(Fr),jt=xt(Br)}const nr={type:1,geometry:[[Math.round(this.options.extent*(mt*Be-ke)),Math.round(this.options.extent*(jt*Be-Ve))]],tags:yt};let or;or=ct||this.options.generateId?pe[et+It]:this.points[pe[et+It]].id,or!==void 0&&(nr.id=or),Xe.features.push(nr)}}_limitZoom(ue){return Math.max(this.options.minZoom,Math.min(Math.floor(+ue),this.options.maxZoom+1))}_cluster(ue,pe){const{radius:ke,extent:Ve,reduce:Be,minPoints:Xe}=this.options,lt=ke/(Ve*Math.pow(2,pe)),et=ue.data,ct=[],yt=this.stride;for(let mt=0;mt<et.length;mt+=yt){if(et[mt+2]<=pe)continue;et[mt+2]=pe;const jt=et[mt],nr=et[mt+1],or=ue.within(et[mt],et[mt+1],lt),Or=et[mt+zt];let Fr=Or;for(const Br of or){const jr=Br*yt;et[jr+2]>pe&&(Fr+=et[jr+zt])}if(Fr>Or&&Fr>=Xe){let Br,jr=jt*Or,Tn=nr*Or,Pn=-1;const Yr=(mt/yt<<5)+(pe+1)+this.points.length;for(const En of or){const ti=En*yt;if(et[ti+2]<=pe)continue;et[ti+2]=pe;const Ii=et[ti+zt];jr+=et[ti]*Ii,Tn+=et[ti+1]*Ii,et[ti+4]=Yr,Be&&(Br||(Br=this._map(et,mt,!0),Pn=this.clusterProps.length,this.clusterProps.push(Br)),Be(Br,this._map(et,ti)))}et[mt+4]=Yr,ct.push(jr/Fr,Tn/Fr,1/0,Yr,-1,Fr),Be&&ct.push(Pn)}else{for(let Br=0;Br<yt;Br++)ct.push(et[mt+Br]);if(Fr>1)for(const Br of or){const jr=Br*yt;if(!(et[jr+2]<=pe)){et[jr+2]=pe;for(let Tn=0;Tn<yt;Tn++)ct.push(et[jr+Tn])}}}}return ct}_getOriginId(ue){return ue-this.points.length>>5}_getOriginZoom(ue){return(ue-this.points.length)%32}_map(ue,pe,ke){if(ue[pe+zt]>1){const Xe=this.clusterProps[ue[pe+At]];return ke?Object.assign({},Xe):Xe}const Ve=this.points[ue[pe+It]].properties,Be=this.options.map(Ve);return ke&&Be===Ve?Object.assign({},Be):Be}}function Ot(ut,ue,pe){return{type:"Feature",id:ut[ue+It],properties:be(ut,ue,pe),geometry:{type:"Point",coordinates:[(ke=ut[ue],360*(ke-.5)),Bt(ut[ue+1])]}};var ke}function be(ut,ue,pe){const ke=ut[ue+zt],Ve=ke>=1e4?`${Math.round(ke/1e3)}k`:ke>=1e3?Math.round(ke/100)/10+"k":ke,Be=ut[ue+At],Xe=Be===-1?{}:Object.assign({},pe[Be]);return Object.assign(Xe,{cluster:!0,cluster_id:ut[ue+It],point_count:ke,point_count_abbreviated:Ve})}function Ht(ut){return ut/360+.5}function xt(ut){const ue=Math.sin(ut*Math.PI/180),pe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return pe<0?0:pe>1?1:pe}function Bt(ut){const ue=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(ue))/Math.PI-90}function rt(ut,ue,pe,ke){let Ve=ke;const Be=ue+(pe-ue>>1);let Xe,lt=pe-ue;const et=ut[ue],ct=ut[ue+1],yt=ut[pe],mt=ut[pe+1];for(let jt=ue+3;jt<pe;jt+=3){const nr=qt(ut[jt],ut[jt+1],et,ct,yt,mt);if(nr>Ve)Xe=jt,Ve=nr;else if(nr===Ve){const or=Math.abs(jt-Be);or<lt&&(Xe=jt,lt=or)}}Ve>ke&&(Xe-ue>3&&rt(ut,ue,Xe,ke),ut[Xe+2]=Ve,pe-Xe>3&&rt(ut,Xe,pe,ke))}function qt(ut,ue,pe,ke,Ve,Be){let Xe=Ve-pe,lt=Be-ke;if(Xe!==0||lt!==0){const et=((ut-pe)*Xe+(ue-ke)*lt)/(Xe*Xe+lt*lt);et>1?(pe=Ve,ke=Be):et>0&&(pe+=Xe*et,ke+=lt*et)}return Xe=ut-pe,lt=ue-ke,Xe*Xe+lt*lt}function Lt(ut,ue,pe,ke){const Ve={id:ut??null,type:ue,geometry:pe,tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ue==="Point"||ue==="MultiPoint"||ue==="LineString")Yt(Ve,pe);else if(ue==="Polygon")Yt(Ve,pe[0]);else if(ue==="MultiLineString")for(const Be of pe)Yt(Ve,Be);else if(ue==="MultiPolygon")for(const Be of pe)Yt(Ve,Be[0]);return Ve}function Yt(ut,ue){for(let pe=0;pe<ue.length;pe+=3)ut.minX=Math.min(ut.minX,ue[pe]),ut.minY=Math.min(ut.minY,ue[pe+1]),ut.maxX=Math.max(ut.maxX,ue[pe]),ut.maxY=Math.max(ut.maxY,ue[pe+1])}function Wt(ut,ue,pe,ke){if(!ue.geometry)return;const Ve=ue.geometry.coordinates;if(Ve&&Ve.length===0)return;const Be=ue.geometry.type,Xe=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2);let lt=[],et=ue.id;if(pe.promoteId?et=ue.properties[pe.promoteId]:pe.generateId&&(et=ke||0),Be==="Point")wr(Ve,lt);else if(Be==="MultiPoint")for(const ct of Ve)wr(ct,lt);else if(Be==="LineString")Sr(Ve,lt,Xe,!1);else if(Be==="MultiLineString"){if(pe.lineMetrics){for(const ct of Ve)lt=[],Sr(ct,lt,Xe,!1),ut.push(Lt(et,"LineString",lt,ue.properties));return}dn(Ve,lt,Xe,!1)}else if(Be==="Polygon")dn(Ve,lt,Xe,!0);else{if(Be!=="MultiPolygon"){if(Be==="GeometryCollection"){for(const ct of ue.geometry.geometries)Wt(ut,{id:et,geometry:ct,properties:ue.properties},pe,ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const ct of Ve){const yt=[];dn(ct,yt,Xe,!0),lt.push(yt)}}ut.push(Lt(et,Be,lt,ue.properties))}function wr(ut,ue){ue.push(Tt(ut[0]),ar(ut[1]),0)}function Sr(ut,ue,pe,ke){let Ve,Be,Xe=0;for(let et=0;et<ut.length;et++){const ct=Tt(ut[et][0]),yt=ar(ut[et][1]);ue.push(ct,yt,0),et>0&&(Xe+=ke?(Ve*yt-ct*Be)/2:Math.sqrt(Math.pow(ct-Ve,2)+Math.pow(yt-Be,2))),Ve=ct,Be=yt}const lt=ue.length-3;ue[2]=1,rt(ue,0,lt,pe),ue[lt+2]=1,ue.size=Math.abs(Xe),ue.start=0,ue.end=ue.size}function dn(ut,ue,pe,ke){for(let Ve=0;Ve<ut.length;Ve++){const Be=[];Sr(ut[Ve],Be,pe,ke),ue.push(Be)}}function Tt(ut){return ut/360+.5}function ar(ut){const ue=Math.sin(ut*Math.PI/180),pe=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return pe<0?0:pe>1?1:pe}function Xt(ut,ue,pe,ke,Ve,Be,Xe,lt){if(ke/=ue,Be>=(pe/=ue)&&Xe<ke)return ut;if(Xe<pe||Be>=ke)return null;const et=[];for(const ct of ut){const yt=ct.geometry;let mt=ct.type;const jt=Ve===0?ct.minX:ct.minY,nr=Ve===0?ct.maxX:ct.maxY;if(jt>=pe&&nr<ke){et.push(ct);continue}if(nr<pe||jt>=ke)continue;let or=[];if(mt==="Point"||mt==="MultiPoint")Hr(yt,or,pe,ke,Ve);else if(mt==="LineString")zr(yt,or,pe,ke,Ve,!1,lt.lineMetrics);else if(mt==="MultiLineString")Qr(yt,or,pe,ke,Ve,!1);else if(mt==="Polygon")Qr(yt,or,pe,ke,Ve,!0);else if(mt==="MultiPolygon")for(const Or of yt){const Fr=[];Qr(Or,Fr,pe,ke,Ve,!0),Fr.length&&or.push(Fr)}if(or.length){if(lt.lineMetrics&&mt==="LineString"){for(const Or of or)et.push(Lt(ct.id,mt,Or,ct.tags));continue}mt!=="LineString"&&mt!=="MultiLineString"||(or.length===1?(mt="LineString",or=or[0]):mt="MultiLineString"),mt!=="Point"&&mt!=="MultiPoint"||(mt=or.length===3?"Point":"MultiPoint"),et.push(Lt(ct.id,mt,or,ct.tags))}}return et.length?et:null}function Hr(ut,ue,pe,ke,Ve){for(let Be=0;Be<ut.length;Be+=3){const Xe=ut[Be+Ve];Xe>=pe&&Xe<=ke&&pn(ue,ut[Be],ut[Be+1],ut[Be+2])}}function zr(ut,ue,pe,ke,Ve,Be,Xe){let lt=br(ut);const et=Ve===0?Wr:Jn;let ct,yt,mt=ut.start;for(let Fr=0;Fr<ut.length-3;Fr+=3){const Br=ut[Fr],jr=ut[Fr+1],Tn=ut[Fr+2],Pn=ut[Fr+3],Yr=ut[Fr+4],En=Ve===0?Br:jr,ti=Ve===0?Pn:Yr;let Ii=!1;Xe&&(ct=Math.sqrt(Math.pow(Br-Pn,2)+Math.pow(jr-Yr,2))),En<pe?ti>pe&&(yt=et(lt,Br,jr,Pn,Yr,pe),Xe&&(lt.start=mt+ct*yt)):En>ke?ti<ke&&(yt=et(lt,Br,jr,Pn,Yr,ke),Xe&&(lt.start=mt+ct*yt)):pn(lt,Br,jr,Tn),ti<pe&&En>=pe&&(yt=et(lt,Br,jr,Pn,Yr,pe),Ii=!0),ti>ke&&En<=ke&&(yt=et(lt,Br,jr,Pn,Yr,ke),Ii=!0),!Be&&Ii&&(Xe&&(lt.end=mt+ct*yt),ue.push(lt),lt=br(ut)),Xe&&(mt+=ct)}let jt=ut.length-3;const nr=ut[jt],or=ut[jt+1],Or=Ve===0?nr:or;Or>=pe&&Or<=ke&&pn(lt,nr,or,ut[jt+2]),jt=lt.length-3,Be&&jt>=3&&(lt[jt]!==lt[0]||lt[jt+1]!==lt[1])&&pn(lt,lt[0],lt[1],lt[2]),lt.length&&ue.push(lt)}function br(ut){const ue=[];return ue.size=ut.size,ue.start=ut.start,ue.end=ut.end,ue}function Qr(ut,ue,pe,ke,Ve,Be){for(const Xe of ut)zr(Xe,ue,pe,ke,Ve,Be,!1)}function pn(ut,ue,pe,ke){ut.push(ue,pe,ke)}function Wr(ut,ue,pe,ke,Ve,Be){const Xe=(Be-ue)/(ke-ue);return pn(ut,Be,pe+(Ve-pe)*Xe,1),Xe}function Jn(ut,ue,pe,ke,Ve,Be){const Xe=(Be-pe)/(Ve-pe);return pn(ut,ue+(ke-ue)*Xe,Be,1),Xe}function li(ut,ue){const pe=[];for(let ke=0;ke<ut.length;ke++){const Ve=ut[ke],Be=Ve.type;let Xe;if(Be==="Point"||Be==="MultiPoint"||Be==="LineString")Xe=Dr(Ve.geometry,ue);else if(Be==="MultiLineString"||Be==="Polygon"){Xe=[];for(const lt of Ve.geometry)Xe.push(Dr(lt,ue))}else if(Be==="MultiPolygon"){Xe=[];for(const lt of Ve.geometry){const et=[];for(const ct of lt)et.push(Dr(ct,ue));Xe.push(et)}}pe.push(Lt(Ve.id,Be,Xe,Ve.tags))}return pe}function Dr(ut,ue){const pe=[];pe.size=ut.size,ut.start!==void 0&&(pe.start=ut.start,pe.end=ut.end);for(let ke=0;ke<ut.length;ke+=3)pe.push(ut[ke]+ue,ut[ke+1],ut[ke+2]);return pe}function dr(ut,ue){if(ut.transformed)return ut;const pe=1<<ut.z,ke=ut.x,Ve=ut.y;for(const Be of ut.features){const Xe=Be.geometry,lt=Be.type;if(Be.geometry=[],lt===1)for(let et=0;et<Xe.length;et+=2)Be.geometry.push(gr(Xe[et],Xe[et+1],ue,pe,ke,Ve));else for(let et=0;et<Xe.length;et++){const ct=[];for(let yt=0;yt<Xe[et].length;yt+=2)ct.push(gr(Xe[et][yt],Xe[et][yt+1],ue,pe,ke,Ve));Be.geometry.push(ct)}}return ut.transformed=!0,ut}function gr(ut,ue,pe,ke,Ve,Be){return[Math.round(pe*(ut*ke-Ve)),Math.round(pe*(ue*ke-Be))]}function Zr(ut,ue,pe,ke,Ve){const Be=ue===Ve.maxZoom?0:Ve.tolerance/((1<<ue)*Ve.extent),Xe={features:[],numPoints:0,numSimplified:0,numFeatures:ut.length,source:null,x:pe,y:ke,z:ue,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const lt of ut)hn(Xe,lt,Be,Ve);return Xe}function hn(ut,ue,pe,ke){const Ve=ue.geometry,Be=ue.type,Xe=[];if(ut.minX=Math.min(ut.minX,ue.minX),ut.minY=Math.min(ut.minY,ue.minY),ut.maxX=Math.max(ut.maxX,ue.maxX),ut.maxY=Math.max(ut.maxY,ue.maxY),Be==="Point"||Be==="MultiPoint")for(let lt=0;lt<Ve.length;lt+=3)Xe.push(Ve[lt],Ve[lt+1]),ut.numPoints++,ut.numSimplified++;else if(Be==="LineString")hr(Xe,Ve,ut,pe,!1,!1);else if(Be==="MultiLineString"||Be==="Polygon")for(let lt=0;lt<Ve.length;lt++)hr(Xe,Ve[lt],ut,pe,Be==="Polygon",lt===0);else if(Be==="MultiPolygon")for(let lt=0;lt<Ve.length;lt++){const et=Ve[lt];for(let ct=0;ct<et.length;ct++)hr(Xe,et[ct],ut,pe,!0,ct===0)}if(Xe.length){let lt=ue.tags||null;if(Be==="LineString"&&ke.lineMetrics){lt={};for(const ct in ue.tags)lt[ct]=ue.tags[ct];lt.mapbox_clip_start=Ve.start/Ve.size,lt.mapbox_clip_end=Ve.end/Ve.size}const et={geometry:Xe,type:Be==="Polygon"||Be==="MultiPolygon"?3:Be==="LineString"||Be==="MultiLineString"?2:1,tags:lt};ue.id!==null&&(et.id=ue.id),ut.features.push(et)}}function hr(ut,ue,pe,ke,Ve,Be){const Xe=ke*ke;if(ke>0&&ue.size<(Ve?Xe:ke))return void(pe.numPoints+=ue.length/3);const lt=[];for(let et=0;et<ue.length;et+=3)(ke===0||ue[et+2]>Xe)&&(pe.numSimplified++,lt.push(ue[et],ue[et+1])),pe.numPoints++;Ve&&function(et,ct){let yt=0;for(let mt=0,jt=et.length,nr=jt-2;mt<jt;nr=mt,mt+=2)yt+=(et[mt]-et[nr])*(et[mt+1]+et[nr+1]);if(yt>0===ct)for(let mt=0,jt=et.length;mt<jt/2;mt+=2){const nr=et[mt],or=et[mt+1];et[mt]=et[jt-2-mt],et[mt+1]=et[jt-1-mt],et[jt-2-mt]=nr,et[jt-1-mt]=or}}(lt,Be),ut.push(lt)}const Mn={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class bi{constructor(ue,pe){const ke=(pe=this.options=function(Be,Xe){for(const lt in Xe)Be[lt]=Xe[lt];return Be}(Object.create(Mn),pe)).debug;if(ke&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ve=function(Be,Xe){const lt=[];if(Be.type==="FeatureCollection")for(let et=0;et<Be.features.length;et++)Wt(lt,Be.features[et],Xe,et);else Wt(lt,Be.type==="Feature"?Be:{geometry:Be},Xe);return lt}(ue,pe);this.tiles={},this.tileCoords=[],ke&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ve=function(Be,Xe){const lt=Xe.buffer/Xe.extent;let et=Be;const ct=Xt(Be,1,-1-lt,lt,0,-1,2,Xe),yt=Xt(Be,1,1-lt,2+lt,0,-1,2,Xe);return(ct||yt)&&(et=Xt(Be,1,-lt,1+lt,0,-1,2,Xe)||[],ct&&(et=li(ct,1).concat(et)),yt&&(et=et.concat(li(yt,-1)))),et}(Ve,pe),Ve.length&&this.splitTile(Ve,0,0,0),ke&&(Ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ue,pe,ke,Ve,Be,Xe,lt){const et=[ue,pe,ke,Ve],ct=this.options,yt=ct.debug;for(;et.length;){Ve=et.pop(),ke=et.pop(),pe=et.pop(),ue=et.pop();const mt=1<<pe,jt=sn(pe,ke,Ve);let nr=this.tiles[jt];if(!nr&&(yt>1&&console.time("creation"),nr=this.tiles[jt]=Zr(ue,pe,ke,Ve,ct),this.tileCoords.push({z:pe,x:ke,y:Ve}),yt)){yt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,ke,Ve,nr.numFeatures,nr.numPoints,nr.numSimplified),console.timeEnd("creation"));const Ii=`z${pe}`;this.stats[Ii]=(this.stats[Ii]||0)+1,this.total++}if(nr.source=ue,Be==null){if(pe===ct.indexMaxZoom||nr.numPoints<=ct.indexMaxPoints)continue}else{if(pe===ct.maxZoom||pe===Be)continue;if(Be!=null){const Ii=Be-pe;if(ke!==Xe>>Ii||Ve!==lt>>Ii)continue}}if(nr.source=null,ue.length===0)continue;yt>1&&console.time("clipping");const or=.5*ct.buffer/ct.extent,Or=.5-or,Fr=.5+or,Br=1+or;let jr=null,Tn=null,Pn=null,Yr=null,En=Xt(ue,mt,ke-or,ke+Fr,0,nr.minX,nr.maxX,ct),ti=Xt(ue,mt,ke+Or,ke+Br,0,nr.minX,nr.maxX,ct);ue=null,En&&(jr=Xt(En,mt,Ve-or,Ve+Fr,1,nr.minY,nr.maxY,ct),Tn=Xt(En,mt,Ve+Or,Ve+Br,1,nr.minY,nr.maxY,ct),En=null),ti&&(Pn=Xt(ti,mt,Ve-or,Ve+Fr,1,nr.minY,nr.maxY,ct),Yr=Xt(ti,mt,Ve+Or,Ve+Br,1,nr.minY,nr.maxY,ct),ti=null),yt>1&&console.timeEnd("clipping"),et.push(jr||[],pe+1,2*ke,2*Ve),et.push(Tn||[],pe+1,2*ke,2*Ve+1),et.push(Pn||[],pe+1,2*ke+1,2*Ve),et.push(Yr||[],pe+1,2*ke+1,2*Ve+1)}}getTile(ue,pe,ke){ue=+ue,pe=+pe,ke=+ke;const Ve=this.options,{extent:Be,debug:Xe}=Ve;if(ue<0||ue>24)return null;const lt=1<<ue,et=sn(ue,pe=pe+lt&lt-1,ke);if(this.tiles[et])return dr(this.tiles[et],Be);Xe>1&&console.log("drilling down to z%d-%d-%d",ue,pe,ke);let ct,yt=ue,mt=pe,jt=ke;for(;!ct&&yt>0;)yt--,mt>>=1,jt>>=1,ct=this.tiles[sn(yt,mt,jt)];return ct&&ct.source?(Xe>1&&(console.log("found parent tile z%d-%d-%d",yt,mt,jt),console.time("drilling down")),this.splitTile(ct.source,yt,mt,jt,ue,pe,ke),Xe>1&&console.timeEnd("drilling down"),this.tiles[et]?dr(this.tiles[et],Be):null):null}}function sn(ut,ue,pe){return 32*((1<<ut)*pe+ue)+ut}function qn(ut,ue){const pe=ut.tileID.canonical;if(!this._geoJSONIndex)return void ue(null,null);const ke=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!ke)return void ue(null,null);const Ve=new Ie(ke.features);let Be=Gt(Ve);Be.byteOffset===0&&Be.byteLength===Be.buffer.byteLength||(Be=new Uint8Array(Be)),ue(null,{vectorTile:Ve,rawData:Be.buffer})}class uo extends te{constructor(ue,pe,ke,Ve,Be,Xe){super(ue,pe,ke,Ve,qn,Xe),Be&&(this.loadGeoJSON=Be),this._dynamicIndex=new ot}loadData(ue,pe){const ke=ue&&ue.request,Ve=ke&&ke.collectResourceTiming;this.loadGeoJSON(ue,(Be,Xe)=>{if(Be||!Xe)return pe(Be);if(typeof Xe!="object")return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));{try{if(ue.filter){const et=i.M(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(et.result==="error")throw new Error(et.value.map(ct=>`${ct.key}: ${ct.message}`).join(", "));Xe.features=Xe.features.filter(ct=>et.value.evaluate({zoom:0},ct))}ue.dynamic?(Xe.type==="Feature"&&(Xe={type:"FeatureCollection",features:[Xe]}),ue.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Xe.features,this.loaded),ue.cluster&&(Xe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ue.cluster?new kt(function({superclusterOptions:et,clusterProperties:ct}){if(!ct||!et)return et;const yt={},mt={},jt={accumulated:null,zoom:0},nr={properties:null},or=Object.keys(ct);for(const Or of or){const[Fr,Br]=ct[Or],jr=i.M(Br),Tn=i.M(typeof Fr=="string"?[Fr,["accumulated"],["get",Or]]:Fr);yt[Or]=jr.value,mt[Or]=Tn.value}return et.map=Or=>{nr.properties=Or;const Fr={};for(const Br of or)Fr[Br]=yt[Br].evaluate(jt,nr);return Fr},et.reduce=(Or,Fr)=>{nr.properties=Fr;for(const Br of or)jt.accumulated=Or[Br],Or[Br]=mt[Br].evaluate(jt,nr)},et}(ue)).load(Xe.features):ue.dynamic?this._dynamicIndex:function(et,ct){return new bi(et,ct)}(Xe,ue.geojsonVtOptions)}catch(et){return pe(et)}const lt={};if(Ve){const et=j(ke);et&&(lt.resourceTiming={},lt.resourceTiming[ue.source]=JSON.parse(JSON.stringify(et)))}pe(null,lt)}})}reloadTile(ue,pe){const ke=this.loaded;return ke&&ke[ue.uid]?ue.partial?pe(null,void 0):super.reloadTile(ue,pe):this.loadTile(ue,pe)}loadGeoJSON(ue,pe){if(ue.request)i.n(ue.request,pe);else{if(typeof ue.data!="string")return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));try{return pe(null,JSON.parse(ue.data))}catch{return pe(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ue,pe){try{pe(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(ke){pe(ke)}}getClusterChildren(ue,pe){try{pe(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(ke){pe(ke)}}getClusterLeaves(ue,pe){try{pe(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(ke){pe(ke)}}}class _o{constructor(ue,pe){this.tileID=new i.aA(ue.tileID.overscaledZ,ue.tileID.wrap,ue.tileID.canonical.z,ue.tileID.canonical.x,ue.tileID.canonical.y),this.tileZoom=ue.tileZoom,this.uid=ue.uid,this.zoom=ue.zoom,this.canonical=ue.tileID.canonical,this.pixelRatio=ue.pixelRatio,this.tileSize=ue.tileSize,this.source=ue.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ue.projection,this.brightness=pe}parse(ue,pe,ke,Ve){this.status="parsing";const Be=new i.aA(ke.tileID.overscaledZ,ke.tileID.wrap,ke.tileID.canonical.z,ke.tileID.canonical.x,ke.tileID.canonical.y),Xe={},lt=pe.familiesBySource[ke.source],et=new i.dR(Be,ke.promoteId);return et.bucketLayerIDs=[],et.is3DTile=!0,i.e0(ue).then(ct=>{if(!ct)return Ve(new Error("Could not parse tile"));const yt=i.e1(ct,1/i.c8(ke.tileID.canonical)),mt=ct.json.extensionsUsed&&ct.json.extensionsUsed.includes("MAPBOX_mesh_features")||ct.json.asset.extras&&ct.json.asset.extras.MAPBOX_mesh_features,jt=ct.json.extensionsUsed&&ct.json.extensionsUsed.includes("EXT_meshopt_compression"),nr=new i.a3(this.zoom,{brightness:this.brightness});for(const or in lt)for(const Or of lt[or]){const Fr=Or[0];et.bucketLayerIDs.push(Or.map(jr=>jr.id)),Fr.recalculate(nr,[]);const Br=new i.e2(yt,Be,mt,jt,this.brightness,et);mt||(Br.needsUpload=!0),Xe[Fr.fqid]=Br,Br.evaluate(Fr)}this.status="done",Ve(null,{buckets:Xe,featureIndex:et})}).catch(ct=>Ve(new Error(ct.message)))}}class eo{constructor(ue,pe,ke,Ve,Be,Xe){this.actor=ue,this.layerIndex=pe,this.brightness=Xe,this.loading={},this.loaded={}}loadTile(ue,pe){const ke=ue.uid,Ve=this.loading[ke]=new _o(ue,this.brightness);i.bc(ue.request,(Be,Xe)=>{const lt=!this.loading[ke];return delete this.loading[ke],lt||Be?(Ve.status="done",lt||(this.loaded[ke]=Ve),pe(Be)):Xe&&Xe.byteLength!==0?void Ve.parse(Xe,this.layerIndex,ue,(et,ct)=>{Ve.status="done",this.loaded=this.loaded||{},this.loaded[ke]=Ve,et||!ct?pe(et):pe(null,ct)}):(Ve.status="done",this.loaded[ke]=Ve,pe())})}reloadTile(ue,pe){const ke=this.loaded,Ve=ue.uid;if(ke&&ke[Ve]){const Be=ke[Ve];Be.projection=ue.projection,Be.brightness=ue.brightness;const Xe=(lt,et)=>{Be.reloadCallback&&(delete Be.reloadCallback,this.loadTile(ue,pe)),pe(lt,et)};Be.status==="parsing"?Be.reloadCallback=Xe:Be.status==="done"&&this.loadTile(ue,pe)}}abortTile(ue,pe){const ke=ue.uid;this.loading[ke]&&delete this.loading[ke],pe()}removeTile(ue,pe){const ke=this.loaded,Ve=ue.uid;ke&&ke[Ve]&&delete ke[Ve],pe()}}class ms{constructor(ue){this.self=ue,this.actor=new i.e3(ue,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=i.bL({name:"mercator"}),this.workerSourceTypes={vector:te,geojson:uo,"batched-model":eo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(pe,ke)=>{if(this.workerSourceTypes[pe])throw new Error(`Worker source with name "${pe}" already registered.`);this.workerSourceTypes[pe]=ke},this.self.registerRTLTextPlugin=pe=>{if(i.e4.isParsed())throw new Error("RTL text plugin already registered.");i.e4.applyArabicShaping=pe.applyArabicShaping,i.e4.processBidirectionalText=pe.processBidirectionalText,i.e4.processStyledBidirectionalText=pe.processStyledBidirectionalText}}clearCaches(ue,pe,ke){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],delete this.rasterArrayWorkerSource,ke()}checkIfReady(ue,pe,ke){ke()}setReferrer(ue,pe){this.referrer=pe}spriteLoaded(ue,{scope:pe,isLoaded:ke}){if(this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),this.isSpriteLoaded[ue][pe]=ke,this.workerSources[ue]&&this.workerSources[ue][pe])for(const Ve in this.workerSources[ue][pe]){const Be=this.workerSources[ue][pe][Ve];for(const Xe in Be){const lt=Be[Xe];lt instanceof te&&(lt.isSpriteLoaded=ke,lt.fire(new i.x("isSpriteLoaded")))}}}setImages(ue,{scope:pe,images:ke},Ve){if(this.availableImages[ue]||(this.availableImages[ue]={}),this.availableImages[ue][pe]=ke,this.workerSources[ue]&&this.workerSources[ue][pe]){for(const Be in this.workerSources[ue][pe]){const Xe=this.workerSources[ue][pe][Be];for(const lt in Xe)Xe[lt].availableImages=ke}Ve()}else Ve()}setProjection(ue,pe){this.projections[ue]=i.bL(pe)}setBrightness(ue,pe,ke){this.brightness=pe,ke()}setLayers(ue,pe,ke){this.getLayerIndex(ue,pe.scope).replace(pe.layers,pe.options),ke()}updateLayers(ue,pe,ke){this.getLayerIndex(ue,pe.scope).update(pe.layers,pe.removedIds,pe.options),ke()}loadTile(ue,pe,ke){pe.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,pe.type,pe.source,pe.scope).loadTile(pe,ke)}loadDEMTile(ue,pe,ke){this.getDEMWorkerSource(ue,pe.source,pe.scope).loadTile(pe,ke)}decodeRasterArray(ue,pe,ke){this.getRasterArrayWorkerSource().decodeRasterArray(pe,ke)}reloadTile(ue,pe,ke){pe.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,pe.type,pe.source,pe.scope).reloadTile(pe,ke)}abortTile(ue,pe,ke){this.getWorkerSource(ue,pe.type,pe.source,pe.scope).abortTile(pe,ke)}removeTile(ue,pe,ke){this.getWorkerSource(ue,pe.type,pe.source,pe.scope).removeTile(pe,ke)}removeSource(ue,pe,ke){if(!(this.workerSources[ue]&&this.workerSources[ue][pe.scope]&&this.workerSources[ue][pe.scope][pe.type]&&this.workerSources[ue][pe.scope][pe.type][pe.source]))return;const Ve=this.workerSources[ue][pe.scope][pe.type][pe.source];delete this.workerSources[ue][pe.scope][pe.type][pe.source],Ve.removeSource!==void 0?Ve.removeSource(pe,ke):ke()}loadWorkerSource(ue,pe,ke){try{this.self.importScripts(pe.url),ke()}catch(Ve){ke(Ve.toString())}}syncRTLPluginState(ue,pe,ke){try{i.e4.setState(pe);const Ve=i.e4.getPluginURL();if(i.e4.isLoaded()&&!i.e4.isParsed()&&Ve!=null){this.self.importScripts(Ve);const Be=i.e4.isParsed();ke(Be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ve}`),Be)}}catch(Ve){ke(Ve.toString())}}setDracoUrl(ue,pe){this.dracoUrl=pe}getAvailableImages(ue,pe){this.availableImages[ue]||(this.availableImages[ue]={});let ke=this.availableImages[ue][pe];return ke||(ke=[]),ke}getLayerIndex(ue,pe){this.layerIndexes[ue]||(this.layerIndexes[ue]={});let ke=this.layerIndexes[ue][pe];return ke||(ke=this.layerIndexes[ue][pe]=new X,ke.scope=pe),ke}getWorkerSource(ue,pe,ke,Ve){return this.workerSources[ue]||(this.workerSources[ue]={}),this.workerSources[ue][Ve]||(this.workerSources[ue][Ve]={}),this.workerSources[ue][Ve][pe]||(this.workerSources[ue][Ve][pe]={}),this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),this.workerSources[ue][Ve][pe][ke]||(this.workerSources[ue][Ve][pe][ke]=new this.workerSourceTypes[pe]({send:(Be,Xe,lt,et,ct,yt)=>{this.actor.send(Be,Xe,lt,ue,ct,yt)},scheduler:this.actor.scheduler},this.getLayerIndex(ue,Ve),this.getAvailableImages(ue,Ve),this.isSpriteLoaded[ue][Ve],void 0,this.brightness)),this.workerSources[ue][Ve][pe][ke]}getDEMWorkerSource(ue,pe,ke){return this.demWorkerSources[ue]||(this.demWorkerSources[ue]={}),this.demWorkerSources[ue][ke]||(this.demWorkerSources[ue][ke]={}),this.demWorkerSources[ue][ke][pe]||(this.demWorkerSources[ue][ke][pe]=new Q),this.demWorkerSources[ue][ke][pe]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new K),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ue,pe){i.e5(pe)}getWorkerPerformanceMetrics(ue,pe,ke){ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ms(self)),ms}),M(["./shared"],function(i){var j="3.7.0";const H={create:"create",load:"load",fullLoad:"fullLoad"},q={mark(h){performance.mark(h)},measure(h,n,s){performance.measure(h,n,s)}};function X(h){const n=h.name.split("?")[0];return i.a(n)&&n.includes("mapbox-gl.js")?"javascript":i.a(n)&&n.includes("mapbox-gl.css")?"css":i.b(n)?"fontRange":i.c(n)?"sprite":i.i(n)?"style":i.d(n)?"tilejson":"other"}var se,ne={},le=function(){if(se)return ne;function h(p){return!n(p)}function n(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,w,P=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(P);try{w=new Worker(R),v=!0}catch{v=!1}return w&&w.terminate(),URL.revokeObjectURL(R),v}()?function(){var v=document.createElement("canvas");v.width=v.height=1;var w=v.getContext("2d");if(!w)return!1;var P=w.getImageData(0,0,1,1);return P&&P.width===v.width}()?(s[y=p&&p.failIfMajorPerformanceCaveat]===void 0&&(s[y]=function(v){var w,P=function(R){var O=document.createElement("canvas"),F=Object.create(h.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=R,O.getContext("webgl2",F)}(v);if(!P)return!1;try{w=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!w||P.isContextLost())&&(P.shaderSource(w,"void main() {}"),P.compileShader(w),P.getShaderParameter(w,P.COMPILE_STATUS)===!0)}(y)),s[y]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var y}se=1,ne.supported=h,ne.notSupportedReason=n;var s={};return h.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},ne}();function de(h,n,s){const p=document.createElement(h);return n!=null&&(p.className=n),s&&s.appendChild(p),p}function te(h,n,s){const p=document.createElementNS("http://www.w3.org/2000/svg",h);for(const y of Object.keys(n))p.setAttributeNS(null,y,String(n[y]));return s&&s.appendChild(p),p}const Q=typeof document<"u"?document.documentElement&&document.documentElement.style:null,K=Q&&Q.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ce;function fe(){Q&&K&&(ce=Q[K],Q[K]="none")}function Ie(){Q&&K&&(Q[K]=ce)}function Ce(h){h.preventDefault(),h.stopPropagation(),window.removeEventListener("click",Ce,!0)}function we(){window.addEventListener("click",Ce,!0),window.setTimeout(()=>{window.removeEventListener("click",Ce,!0)},0)}function ot(h,n){const s=h.getBoundingClientRect();return je(h,s,n)}function oe(h,n){const s=h.getBoundingClientRect(),p=[];for(let y=0;y<n.length;y++)p.push(je(h,s,n[y]));return p}function ve(h){return window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function je(h,n,s){const p=h.offsetWidth===n.width?1:h.offsetWidth/n.width;return new i.P((s.clientX-n.left)*p,(s.clientY-n.top)*p)}const He="01",Le="NO_ACCESS_TOKEN";class ze{constructor(n,s,p){this._transformRequestFn=n,this._customAccessToken=s,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const n=function(){let s="";for(let p=0;p<10;p++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",He,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,s){return this._transformRequestFn&&this._transformRequestFn(n,s)||{url:n}}normalizeStyleURL(n,s){if(!i.f(n))return n;const p=tt(n);return p.params.push(`sdk=js-${j}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeGlyphsURL(n,s){if(!i.f(n))return n;const p=tt(n);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeModelURL(n,s){if(!i.f(n))return n;const p=tt(n);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeSourceURL(n,s,p,y){if(!i.f(n))return n;const v=tt(n);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),p&&v.params.push(`language=${p}`),y&&v.params.push(`worldview=${y}`),this._makeAPIURL(v,this._customAccessToken||s)}normalizeSpriteURL(n,s,p,y){const v=tt(n);return i.f(n)?(v.path=`/styles/v1${v.path}/sprite${s}${p}`,this._makeAPIURL(v,this._customAccessToken||y)):(v.path+=`${s}${p}`,De(v))}normalizeTileURL(n,s,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!i.f(n))return n;const y=tt(n);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||p&&y.authority!=="raster"&&p===512?"@2x":""}${i.m.supported?".webp":"$1"}`),y.authority==="raster"?y.path=`/${i.e.RASTER_URL_PREFIX}${y.path}`:y.authority==="rasterarrays"?y.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${y.path}`:y.authority==="3dtiles"?y.path=`/${i.e.TILES3D_URL_PREFIX}${y.path}`:(y.path=y.path.replace(/^.+\/v4\//,"/"),y.path=`/${i.e.TILE_URL_VERSION}${y.path}`);const v=this._customAccessToken||function(w){for(const P of w){const R=P.match(/^access_token=(.*)$/);if(R)return R[1]}return null}(y.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&y.params.push(`sku=${this._skuToken}`),this._makeAPIURL(y,v)}canonicalizeTileURL(n,s){const p=tt(n);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return n;let y="mapbox://";p.path.match(/^\/raster\/v1\//)?y+=`raster/${p.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?y+=`rasterarrays/${p.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:y+=`tiles/${p.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let v=p.params;return s&&(v=v.filter(w=>!w.match(/^access_token=/))),v.length&&(y+=`?${v.join("&")}`),y}canonicalizeTileset(n,s){const p=!!s&&i.f(s),y=[];for(const v of n.tiles||[])i.h(v)?y.push(this.canonicalizeTileURL(v,p)):y.push(v);return y}_makeAPIURL(n,s){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",y=tt(i.e.API_URL);if(n.protocol=y.protocol,n.authority=y.authority,n.protocol==="http"){const v=n.params.indexOf("secure");v>=0&&n.params.splice(v,1)}if(y.path!=="/"&&(n.path=`${y.path}${n.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return De(n);if(s=s||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return n.params=n.params.filter(v=>v.indexOf("access_token")===-1),n.params.push(`access_token=${s||""}`),De(n)}}const Pe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function tt(h){const n=h.match(Pe);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function De(h){const n=h.params.length?`?${h.params.join("&")}`:"";return`${h.protocol}://${h.authority}${h.path}${n}`}const Ke="mapbox.eventData";function Ge(h){if(!h)return null;const n=h.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(i.j(n[1]))}catch{return null}}class ft{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const s=Ge(i.e.ACCESS_TOKEN);let p="";return p=s&&s.u?i.k(s.u):i.e.ACCESS_TOKEN||"",n?`${Ke}.${n}:${p}`:`${Ke}:${p}`}fetchEventData(){const n=i.s("localStorage"),s=this.getStorageKey(),p=this.getStorageKey("uuid");if(n)try{const y=localStorage.getItem(s);y&&(this.eventData=JSON.parse(y));const v=localStorage.getItem(p);v&&(this.anonId=v)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const n=i.s("localStorage"),s=this.getStorageKey(),p=this.getStorageKey("uuid"),y=this.anonId;if(n&&y)try{localStorage.setItem(p,y),Object.keys(this.eventData).length>=1&&localStorage.setItem(s,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,s,p,y){if(!i.e.EVENTS_URL)return;const v=tt(i.e.EVENTS_URL);v.params.push(`access_token=${y||i.e.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(n).toISOString()},P=s?i.l(w,s):w,R={url:De(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=i.p(R,O=>{this.pendingRequest=null,p(O),this.saveEventData(),this.processRequests(y)})}queueRequest(n,s){this.queue.push(n),this.processRequests(s)}}const Gt=new class extends ft{constructor(h){super("appUserTurnstile"),this._customAccessToken=h}postTurnstileEvent(h,n){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(h)&&h.some(s=>i.f(s)||i.h(s))&&this.queueRequest(Date.now(),n)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=Ge(i.e.ACCESS_TOKEN),s=n?n.u:i.e.ACCESS_TOKEN;let p=s!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),p=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),w=new Date(y),P=(y-this.eventData.lastSuccess)/864e5;p=p||P>=1||P<-1||v.getDate()!==w.getDate()}else p=!0;p?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:j,skuId:He,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=y,this.eventData.tokenU=s)},h):this.processRequests()}},Ft=Gt.postTurnstileEvent.bind(Gt),wt=new class extends ft{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(h,n,s,p){this.skuToken=n,this.errorCb=p,i.e.EVENTS_URL&&(s||i.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},s):this.errorCb(new Error(Le)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:j,skuId:He,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):n&&(this.success[n]=!0)},h))}remove(){this.errorCb=null}},Rt=wt.postMapLoadEvent.bind(wt),It=new class extends ft{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(h){let n=this.mapInstanceIdMap.get(h);return n||(n=i.u(),this.mapInstanceIdMap.set(h,n)),n}getEventId(h){const n=this.eventIdPerMapInstanceMap.get(h)||0;return this.eventIdPerMapInstanceMap.set(h,n+1),n}postStyleLoadEvent(h,n){const{map:s,style:p,importedStyles:y}=n;if(!i.e.EVENTS_URL||!h&&!i.e.ACCESS_TOKEN)return;const v=this.getMapInstanceId(s),w={mapInstanceId:v,eventId:this.getEventId(v),style:p};y.length&&(w.importedStyles=y),this.queueRequest({timestamp:Date.now(),payload:w},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:s}=this.queue.shift();this.postEvent(n,s,()=>{},h)}},zt=It.postStyleLoadEvent.bind(It),At=new class extends ft{constructor(){super("gljs.performance")}postPerformanceEvent(h,n){i.e.EVENTS_URL&&(h||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:s}=this.queue.shift(),p=function(y){const v=performance.getEntriesByType("resource"),w=performance.getEntriesByType("mark"),P=function(W){const ee={};if(W){for(const re in W)if(re!=="other")for(const ie of W[re]){const ae=`${re}ResolveRangeMin`,_e=`${re}ResolveRangeMax`,Se=`${re}RequestCount`,ge=`${re}RequestCachedCount`;ee[ae]=Math.min(ee[ae]||1/0,ie.startTime),ee[_e]=Math.max(ee[_e]||-1/0,ie.responseEnd);const Ee=Me=>{ee[Me]===void 0&&(ee[Me]=0),++ee[Me]};ie.transferSize!==void 0&&ie.transferSize===0&&Ee(ge),Ee(Se)}}return ee}(function(W,ee){const re={};if(W)for(const ie of W){const ae=ee(ie);re[ae]===void 0&&(re[ae]=[]),re[ae].push(ie)}return re}(v,X)),R=window.devicePixelRatio,O=navigator.connection||navigator.mozConnection||navigator.webkitConnection,F=O?O.effectiveType:void 0,V={counters:[],metadata:[],attributes:[]},$=(W,ee,re)=>{re!=null&&W.push({name:ee,value:re.toString()})};for(const W in P)$(V.counters,W,P[W]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&($(V.counters,"interactionRangeMin",y.interactionRange[0]),$(V.counters,"interactionRangeMax",y.interactionRange[1])),w)for(const W of Object.keys(H)){const ee=H[W],re=w.find(ie=>ie.name===ee);re&&$(V.counters,ee,re.startTime)}return $(V.counters,"visibilityHidden",y.visibilityHidden),$(V.attributes,"style",function(W){if(W)for(const ee of W){const re=ee.name.split("?")[0];if(i.i(re)){const ie=re.split("/").slice(-2);if(ie.length===2)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(v)),$(V.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),$(V.attributes,"fogEnabled",y.fogEnabled?"true":"false"),$(V.attributes,"projection",y.projection),$(V.attributes,"zoom",y.zoom),$(V.metadata,"devicePixelRatio",R),$(V.metadata,"connectionEffectiveType",F),$(V.metadata,"navigatorUserAgent",navigator.userAgent),$(V.metadata,"screenWidth",window.screen.width),$(V.metadata,"screenHeight",window.screen.height),$(V.metadata,"windowWidth",window.innerWidth),$(V.metadata,"windowHeight",window.innerHeight),$(V.metadata,"mapWidth",y.width/R),$(V.metadata,"mapHeight",y.height/R),$(V.metadata,"webglRenderer",y.renderer),$(V.metadata,"webglVendor",y.vendor),$(V.metadata,"sdkVersion",j),$(V.metadata,"sdkIdentifier","mapbox-gl-js"),V}(s);for(const y of p.metadata);for(const y of p.counters);for(const y of p.attributes);this.postEvent(n,p,()=>{},h)}},kt=At.postPerformanceEvent.bind(At),Ot=new class extends ft{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(h,n,s,p){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const y=tt(i.e.API_URL+i.e.SESSION_PATH);y.params.push(`sku=${n||""}`),y.params.push(`access_token=${p||i.e.ACCESS_TOKEN||""}`);const v={url:De(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(v,w=>{this.pendingRequest=null,s(w),this.saveEventData(),this.processRequests(p)})}getSessionAPI(h,n,s,p){this.skuToken=n,this.errorCb=p,i.e.SESSION_PATH&&i.e.API_URL&&(s||i.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},s):this.errorCb(new Error(Le)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||this.getSession(s,this.skuToken,p=>{p?this.errorCb(p):n&&(this.success[n]=!0)},h)}remove(){this.errorCb=null}},be=Ot.getSessionAPI.bind(Ot),Ht=new Set;function xt(h,n){n?Ht.add(h):Ht.delete(h)}class Bt{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,s){this._updatedSourceCaches[n]=s,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const s=n.scope;this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._updatedLayers[s].add(n.id),this.setDirty()}removeLayer(n){const s=n.scope;this._removedLayers[s]=this._removedLayers[s]||{},this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._removedLayers[s][n.id]=n,this._updatedLayers[s].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const s in this._updatedLayers)n[s]=n[s]||{},n[s].updatedIds=Array.from(this._updatedLayers[s].values());for(const s in this._removedLayers)n[s]=n[s]||{},n[s].removedIds=Object.keys(this._removedLayers[s]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(n){this._updatedImages.add(n),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function rt(h){const{userImage:n}=h;return!!(n&&n.render&&n.render())&&(h.data.replace(new Uint8Array(n.data.buffer)),!0)}class qt extends i.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(n){this.images[n]={},this.loaded[n]=!1,this.updatedImages[n]={},this.patterns[n]={},this.callbackDispatchedThisFrame[n]={},this.atlasImage[n]=new i.r({width:1,height:1})}isLoaded(){for(const n in this.loaded)if(!this.loaded[n])return!1;return!0}setLoaded(n,s){if(this.loaded[s]!==n&&(this.loaded[s]=n,n)){for(const{ids:p,callback:y}of this.requestors)this._notify(p,s,y);this.requestors=[]}}hasImage(n,s){return!!this.getImage(n,s)}getImage(n,s){return this.images[s][n]}addImage(n,s,p){this._validate(n,p)&&(this.images[s][n]=p)}_validate(n,s){let p=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new i.t(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new i.t(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(s.content,s)||(this.fire(new i.t(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,s){if(!n)return!0;let p=0;for(const y of n){if(y[0]<p||y[1]<y[0]||s<y[1])return!1;p=y[1]}return!0}_validateContent(n,s){return!(n&&(n.length!==4||n[0]<0||s.data.width<n[0]||n[1]<0||s.data.height<n[1]||n[2]<0||s.data.width<n[2]||n[3]<0||s.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,s,p){p.version=this.images[s][n].version+1,this.images[s][n]=p,this.updatedImages[s][n]=!0}removeImage(n,s){const p=this.images[s][n];delete this.images[s][n],delete this.patterns[s][n],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(n){return Object.keys(this.images[n])}getImages(n,s,p){let y=!0;const v=!!this.loaded[s];if(!v)for(const w of n)this.images[s][w]||(y=!1);v||y?this._notify(n,s,p):this.requestors.push({ids:n,scope:s,callback:p})}getUpdatedImages(n){return this.updatedImages[n]}_notify(n,s,p){const y={};for(const v of n){this.images[s][v]||this.fire(new i.x("styleimagemissing",{id:v}));const w=this.images[s][v];w?y[v]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!!(w.userImage&&w.userImage.render)}:i.w(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,y)}getPixelSize(n){const{width:s,height:p}=this.atlasImage[n];return{width:s,height:p}}getPattern(n,s,p){const y=this.patterns[s][n],v=this.getImage(n,s);if(!v)return null;if(y&&y.position.version===v.version)return y.position;if(y)y.position.version=v.version;else{const w={w:v.data.width+2*i.y,h:v.data.height+2*i.y,x:0,y:0},P=new i.I(w,v,i.y);this.patterns[s][n]={bin:w,position:P}}return this._updatePatternAtlas(s,p),this.patterns[s][n].position}bind(n,s){const p=n.gl;let y=this.atlasTexture[s];y?this.dirty&&(y.update(this.atlasImage[s]),this.dirty=!1):(y=new i.T(n,this.atlasImage[s],p.RGBA8),this.atlasTexture[s]=y),y.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(n,s){const p=[];for(const P in this.patterns[n])p.push(this.patterns[n][P].bin);const{w:y,h:v}=i.z(p),w=this.atlasImage[n];w.resize({width:y||1,height:v||1});for(const P in this.patterns[n]){const{bin:R,position:O}=this.patterns[n][P];let F=O.padding;const V=R.x+F,$=R.y+F,W=this.images[n][P].data,ee=W.width,re=W.height;F=F>1?F-1:F,i.r.copy(W,w,{x:0,y:0},{x:V,y:$},{width:ee,height:re},s),i.r.copy(W,w,{x:0,y:re-F},{x:V,y:$-F},{width:ee,height:F},s),i.r.copy(W,w,{x:0,y:0},{x:V,y:$+re},{width:ee,height:F},s),i.r.copy(W,w,{x:ee-F,y:0},{x:V-F,y:$},{width:F,height:re},s),i.r.copy(W,w,{x:0,y:0},{x:V+ee,y:$},{width:F,height:re},s),i.r.copy(W,w,{x:ee-F,y:re-F},{x:V-F,y:$-F},{width:F,height:F},s),i.r.copy(W,w,{x:0,y:re-F},{x:V+ee,y:$-F},{width:F,height:F},s),i.r.copy(W,w,{x:0,y:0},{x:V+ee,y:$+re},{width:F,height:F},s),i.r.copy(W,w,{x:ee-F,y:0},{x:V-F,y:$+re},{width:F,height:F},s)}this.dirty=!0}beginFrame(){for(const n in this.images)this.callbackDispatchedThisFrame[n]={}}dispatchRenderCallbacks(n,s){for(const p of n){if(this.callbackDispatchedThisFrame[s][p])continue;this.callbackDispatchedThisFrame[s][p]=!0;const y=this.images[s][p];rt(y)&&this.updateImage(p,s,y)}}}function Lt(h){const n=h.key,s=h.value,p=h.valueSpec||{},y=h.objectElementValidators||{},v=h.style,w=h.styleSpec;let P=[];const R=i.B(s);if(R!=="object")return[new i.V(n,s,`object expected, ${R} found`)];for(const O in s){const F=O.split(".")[0];let V;y[F]?V=y[F]:p[F]?V=hr:y["*"]?V=y["*"]:p["*"]&&(V=hr),V?P=P.concat(V({key:(n&&`${n}.`)+O,value:s[O],valueSpec:p[F]||p["*"],style:v,styleSpec:w,object:s,objectKey:O},s)):P.push(new i.A(n,s[O],`unknown property "${O}"`))}for(const O in p)y[O]||p[O].required&&p[O].default===void 0&&s[O]===void 0&&P.push(new i.V(n,s,`missing required property "${O}"`));return P}function Yt(h){const n=h.value,s=h.valueSpec,p=h.style,y=h.styleSpec,v=h.key,w=h.arrayElementValidator||hr;if(i.B(n)!=="array")return[new i.V(v,n,`array expected, ${i.B(n)} found`)];if(s.length&&n.length!==s.length)return[new i.V(v,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new i.V(v,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let P={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};y.$version<7&&(P.function=s.function),i.B(s.value)==="object"&&(P=s.value);let R=[];for(let O=0;O<n.length;O++)R=R.concat(w({array:n,arrayIndex:O,value:n[O],valueSpec:P,style:p,styleSpec:y,key:`${v}[${O}]`},!0));return R}function Wt(h){const n=h.key,s=h.value,p=h.valueSpec;let y=i.B(s);if(y==="number"&&s!=s&&(y="NaN"),y!=="number")return[new i.V(n,s,`number expected, ${y} found`)];if("minimum"in p){let v=p.minimum;if(i.B(p.minimum)==="array"&&(v=p.minimum[h.arrayIndex]),s<v)return[new i.V(n,s,`${s} is less than the minimum value ${v}`)]}if("maximum"in p){let v=p.maximum;if(i.B(p.maximum)==="array"&&(v=p.maximum[h.arrayIndex]),s>v)return[new i.V(n,s,`${s} is greater than the maximum value ${v}`)]}return[]}function wr(h){const n=h.valueSpec,s=i.D(h.value.type);let p,y,v,w={};const P=s!=="categorical"&&h.value.property===void 0,R=!P,O=i.B(h.value.stops)==="array"&&i.B(h.value.stops[0])==="array"&&i.B(h.value.stops[0][0])==="object",F=Lt({key:h.key,value:h.value,valueSpec:h.styleSpec.function,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(W){if(s==="identity")return[new i.V(W.key,W.value,'identity function may not have a "stops" property')];let ee=[];const re=W.value;return ee=ee.concat(Yt({key:W.key,value:re,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:V})),i.B(re)==="array"&&re.length===0&&ee.push(new i.V(W.key,re,"array must have at least one stop")),ee},default:function(W){return hr({key:W.key,value:W.value,valueSpec:n,style:W.style,styleSpec:W.styleSpec})}}});return s==="identity"&&P&&F.push(new i.V(h.key,h.value,'missing required property "property"')),s==="identity"||h.value.stops||F.push(new i.V(h.key,h.value,'missing required property "stops"')),s==="exponential"&&h.valueSpec.expression&&!i.F(h.valueSpec)&&F.push(new i.V(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(R&&!i.G(h.valueSpec)?F.push(new i.V(h.key,h.value,"property functions not supported")):P&&!i.H(h.valueSpec)&&F.push(new i.V(h.key,h.value,"zoom functions not supported"))),s!=="categorical"&&!O||h.value.property!==void 0||F.push(new i.V(h.key,h.value,'"property" property is required')),F;function V(W){let ee=[];const re=W.value,ie=W.key;if(i.B(re)!=="array")return[new i.V(ie,re,`array expected, ${i.B(re)} found`)];if(re.length!==2)return[new i.V(ie,re,`array length 2 expected, length ${re.length} found`)];if(O){if(i.B(re[0])!=="object")return[new i.V(ie,re,`object expected, ${i.B(re[0])} found`)];if(re[0].zoom===void 0)return[new i.V(ie,re,"object stop key must have zoom")];if(re[0].value===void 0)return[new i.V(ie,re,"object stop key must have value")];const ae=i.D(re[0].zoom);if(typeof ae!="number")return[new i.V(ie,re[0].zoom,"stop zoom values must be numbers")];if(v&&v>ae)return[new i.V(ie,re[0].zoom,"stop zoom values must appear in ascending order")];ae!==v&&(v=ae,y=void 0,w={}),ee=ee.concat(Lt({key:`${ie}[0]`,value:re[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Wt,value:$}}))}else ee=ee.concat($({key:`${ie}[0]`,value:re[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},re));return i.J(i.K(re[1]))?ee.concat([new i.V(`${ie}[1]`,re[1],"expressions are not allowed in function stops.")]):ee.concat(hr({key:`${ie}[1]`,value:re[1],valueSpec:n,style:W.style,styleSpec:W.styleSpec}))}function $(W,ee){const re=i.B(W.value),ie=i.D(W.value),ae=W.value!==null?W.value:ee;if(p){if(re!==p)return[new i.V(W.key,ae,`${re} stop domain type must match previous stop domain type ${p}`)]}else p=re;if(re!=="number"&&re!=="string"&&re!=="boolean"&&typeof ie!="number"&&typeof ie!="string"&&typeof ie!="boolean")return[new i.V(W.key,ae,"stop domain value must be a number, string, or boolean")];if(re!=="number"&&s!=="categorical"){let _e=`number expected, ${re} found`;return i.G(n)&&s===void 0&&(_e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(W.key,ae,_e)]}return s!=="categorical"||re!=="number"||typeof ie=="number"&&isFinite(ie)&&Math.floor(ie)===ie?s!=="categorical"&&re==="number"&&typeof ie=="number"&&typeof y=="number"&&y!==void 0&&ie<y?[new i.V(W.key,ae,"stop domain values must appear in ascending order")]:(y=ie,s==="categorical"&&ie in w?[new i.V(W.key,ae,"stop domain values must be unique")]:(w[ie]=!0,[])):[new i.V(W.key,ae,`integer expected, found ${String(ie)}`)]}}function Sr(h){const n=(h.expressionContext==="property"?i.L:i.M)(i.K(h.value),h.valueSpec);if(n.result==="error")return n.value.map(p=>new i.V(`${h.key}${p.key}`,h.value,p.message));const s=n.value.expression||n.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!s.outputDefined())return[new i.V(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!i.N(s))return[new i.V(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter")return dn(s,h);if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!i.O(s,["zoom","feature-state"]))return[new i.V(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!i.Q(s))return[new i.V(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dn(h,n){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const y of n.valueSpec.expression.parameters)s.delete(y);if(s.size===0)return[];const p=[];return h instanceof i.S&&s.has(h.name)?[new i.V(n.key,n.value,`["${h.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(h.eachChild(y=>{p.push(...dn(y,n))}),p)}function Tt(h){const n=h.key,s=h.value,p=h.valueSpec,y=[];return Array.isArray(p.values)?p.values.indexOf(i.D(s))===-1&&y.push(new i.V(n,s,`expected one of [${p.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(p.values).indexOf(i.D(s))===-1&&y.push(new i.V(n,s,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(s)} found`)),y}function ar(h){return i.W(i.K(h.value))?Sr(i.C({},h,{expressionContext:"filter",valueSpec:h.styleSpec[`filter_${h.layerType||"fill"}`]})):Xt(h)}function Xt(h){const n=h.value,s=h.key;if(i.B(n)!=="array")return[new i.V(s,n,`array expected, ${i.B(n)} found`)];const p=h.styleSpec;let y,v=[];if(n.length<1)return[new i.V(s,n,"filter array must have at least 1 element")];switch(v=v.concat(Tt({key:`${s}[0]`,value:n[0],valueSpec:p.filter_operator,style:h.style,styleSpec:h.styleSpec})),i.D(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&i.D(n[1])==="$type"&&v.push(new i.V(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new i.V(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(y=i.B(n[1]),y!=="string"&&v.push(new i.V(`${s}[1]`,n[1],`string expected, ${y} found`)));for(let w=2;w<n.length;w++)y=i.B(n[w]),i.D(n[1])==="$type"?v=v.concat(Tt({key:`${s}[${w}]`,value:n[w],valueSpec:p.geometry_type,style:h.style,styleSpec:h.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&v.push(new i.V(`${s}[${w}]`,n[w],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)v=v.concat(Xt({key:`${s}[${w}]`,value:n[w],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":y=i.B(n[1]),n.length!==2?v.push(new i.V(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):y!=="string"&&v.push(new i.V(`${s}[1]`,n[1],`string expected, ${y} found`))}return v}function Hr(h,n){const s=h.key,p=h.style,y=h.layer,v=h.styleSpec,w=h.value,P=h.objectKey,R=v[`${n}_${h.layerType}`];if(!R)return[];const O=P.match(/^(.*)-transition$/);if(n==="paint"&&O&&R[O[1]]&&R[O[1]].transition)return hr({key:s,value:w,valueSpec:v.transition,style:p,styleSpec:v});const F=h.valueSpec||R[P];if(!F)return[new i.A(s,w,`unknown property "${P}"`)];let V;if(i.B(w)==="string"&&i.G(F)&&!F.tokens&&(V=/^{([^}]+)}$/.exec(w))){const W=`\`{ "type": "identity", "property": ${V?JSON.stringify(V[1]):'"_"'} }\``;return[new i.V(s,w,`"${P}" does not support interpolation syntax
Use an identity property function instead: ${W}.`)]}const $=[];if(h.layerType==="symbol")P!=="text-field"||!p||p.glyphs||p.imports||$.push(new i.V(s,w,'use of "text-field" requires a style "glyphs" property')),P==="text-font"&&i.X(i.K(w))&&i.D(w.type)==="identity"&&$.push(new i.V(s,w,'"text-font" does not support identity functions'));else if(h.layerType==="model"&&n==="paint"&&y&&y.layout&&y.layout.hasOwnProperty("model-id")&&i.G(F)&&(i.Y(F)||i.H(F))){const W=i.L(i.K(w),F),ee=W.value.expression||W.value._styleExpression.expression;ee&&!i.O(ee,["measure-light"])&&(P==="model-emissive-strength"&&i.Q(ee)&&i.N(ee)||$.push(new i.V(s,w,`${P} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return $.concat(hr({key:h.key,value:w,valueSpec:F,style:p,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:P}))}function zr(h){return Hr(h,"paint")}function br(h){return Hr(h,"layout")}function Qr(h){let n=[];const s=h.value,p=h.key,y=h.style,v=h.styleSpec;s.type||s.ref||n.push(new i.V(p,s,'either "type" or "ref" is required'));let w=i.D(s.type);const P=i.D(s.ref);if(s.id){const R=i.D(s.id);for(let O=0;O<h.arrayIndex;O++){const F=y.layers[O];i.D(F.id)===R&&n.push(new i.V(p,s.id,`duplicate layer id "${s.id}", previously used at line ${F.id.__line__}`))}}if("ref"in s){let R;["type","source","source-layer","filter","layout"].forEach(O=>{O in s&&n.push(new i.V(p,s[O],`"${O}" is prohibited for ref layers`))}),y.layers.forEach(O=>{i.D(O.id)===P&&(R=O)}),R?R.ref?n.push(new i.V(p,s.ref,"ref cannot reference another ref layer")):w=i.D(R.type):typeof P=="string"&&n.push(new i.V(p,s.ref,`ref layer "${P}" not found`))}else if(w!=="background"&&w!=="sky"&&w!=="slot")if(s.source){const R=y.sources&&y.sources[s.source],O=R&&i.D(R.type);R?O==="vector"&&w==="raster"?n.push(new i.V(p,s.source,`layer "${s.id}" requires a raster source`)):O==="raster"&&w!=="raster"?n.push(new i.V(p,s.source,`layer "${s.id}" requires a vector source`)):O!=="vector"||s["source-layer"]?O==="raster-dem"&&w!=="hillshade"?n.push(new i.V(p,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="raster-array"||["raster","raster-particle"].includes(w)?w!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||O==="geojson"&&R.lineMetrics?w==="raster-particle"&&O!=="raster-array"&&n.push(new i.V(p,s.source,`layer "${s.id}" requires a 'raster-array' source.`)):n.push(new i.V(p,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new i.V(p,s.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new i.V(p,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new i.V(p,s.source,`source "${s.source}" not found`))}else n.push(new i.V(p,s,'missing required property "source"'));return n=n.concat(Lt({key:p,value:s,valueSpec:v.layer,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{"*":()=>[],type:()=>hr({key:`${p}.type`,value:s.type,valueSpec:v.layer.type,style:h.style,styleSpec:h.styleSpec,object:s,objectKey:"type"}),filter:R=>ar(i.C({layerType:w},R)),layout:R=>Lt({layer:s,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":O=>br(i.C({layerType:w},O))}}),paint:R=>Lt({layer:s,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":O=>zr(i.C({layerType:w,layer:s},O))}})}})),n}function pn(h){const n=h.value,s=h.key,p=i.B(n);return p!=="string"?[new i.V(s,n,`string expected, ${p} found`)]:[]}const Wr={promoteId:function({key:h,value:n}){if(i.B(n)==="string")return pn({key:h,value:n});{const s=[];for(const p in n)s.push(...pn({key:`${h}.${p}`,value:n[p]}));return s}}};function Jn(h){const n=h.value,s=h.key,p=h.styleSpec,y=h.style;if(!n.type)return[new i.V(s,n,'"type" is required')];const v=i.D(n.type);let w=[];switch(["vector","raster","raster-dem","raster-array"].includes(v)&&(n.url||n.tiles||w.push(new i.A(s,n,'Either "url" or "tiles" is required.'))),v){case"vector":case"raster":case"raster-dem":case"raster-array":return w=w.concat(Lt({key:s,value:n,valueSpec:p[`source_${v.replace("-","_")}`],style:h.style,styleSpec:p,objectElementValidators:Wr})),w;case"geojson":if(w=Lt({key:s,value:n,valueSpec:p.source_geojson,style:y,styleSpec:p,objectElementValidators:Wr}),n.cluster)for(const P in n.clusterProperties){const[R,O]=n.clusterProperties[P],F=typeof R=="string"?[R,["accumulated"],["get",P]]:R;w.push(...Sr({key:`${s}.${P}.map`,value:O,expressionContext:"cluster-map"})),w.push(...Sr({key:`${s}.${P}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return w;case"video":return Lt({key:s,value:n,valueSpec:p.source_video,style:y,styleSpec:p});case"image":return Lt({key:s,value:n,valueSpec:p.source_image,style:y,styleSpec:p});case"canvas":return[new i.V(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tt({key:`${s}.type`,value:n.type,valueSpec:{values:li(p)},style:y,styleSpec:p})}}function li(h){return h.source.reduce((n,s)=>{const p=h[s];return p.type.type==="enum"&&(n=n.concat(Object.keys(p.type.values))),n},[])}function Dr(h){const n=h.value,s=h.styleSpec,p=s.light,y=h.style;let v=[];const w=i.B(n);if(n===void 0)return v;if(w!=="object")return v=v.concat([new i.V("light",n,`object expected, ${w} found`)]),v;for(const P in n){const R=P.match(/^(.*)-transition$/);v=v.concat(R&&p[R[1]]&&p[R[1]].transition?hr({key:P,value:n[P],valueSpec:s.transition,style:y,styleSpec:s}):p[P]?hr({key:P,value:n[P],valueSpec:p[P],style:y,styleSpec:s}):[new i.V(P,n[P],`unknown property "${P}"`)])}return v}function dr(h){const n=h.value;let s=[];if(!n)return s;const p=i.B(n);if(p!=="object")return s=s.concat([new i.V("light-3d",n,`object expected, ${p} found`)]),s;const y=h.styleSpec,v=y["light-3d"],w=h.key,P=h.style,R=h.style.lights;for(const V of["type","id"])if(!(V in n))return s=s.concat([new i.V("light-3d",n,`missing property ${V} on light`)]),s;if(n.type&&R)for(let V=0;V<h.arrayIndex;V++){const $=i.D(n.type),W=R[V];i.D(W.type)===$&&s.push(new i.V(w,n.id,`duplicate light type "${n.type}", previously defined at line ${W.id.__line__}`))}const O=`properties_light_${n.type}`;if(!(O in y))return s=s.concat([new i.V("light-3d",n,`Invalid light type ${n.type}`)]),s;const F=y[O];for(const V in n)if(V==="properties"){const $=n[V],W=i.B($);if(W!=="object")return s=s.concat([new i.V("properties",$,`object expected, ${W} found`)]),s;for(const ee in $)s=s.concat(F[ee]?hr({key:ee,value:$[ee],valueSpec:F[ee],style:P,styleSpec:y}):[new i.A(h.key,$[ee],`unknown property "${ee}"`)])}else{const $=V.match(/^(.*)-transition$/);s=s.concat($&&v[$[1]]&&v[$[1]].transition?hr({key:V,value:n[V],valueSpec:y.transition,style:P,styleSpec:y}):v[V]?hr({key:V,value:n[V],valueSpec:v[V],style:P,styleSpec:y}):[new i.A(V,n[V],`unknown property "${V}"`)])}return s}function gr(h){const n=h.value,s=h.key,p=h.style,y=h.styleSpec,v=y.terrain;let w=[];const P=i.B(n);if(n===void 0||P==="null")return w;if(P!=="object")return w=w.concat([new i.V("terrain",n,`object expected, ${P} found`)]),w;for(const R in n){const O=R.match(/^(.*)-transition$/);w=w.concat(O&&v[O[1]]&&v[O[1]].transition?hr({key:R,value:n[R],valueSpec:y.transition,style:p,styleSpec:y}):v[R]?hr({key:R,value:n[R],valueSpec:v[R],style:p,styleSpec:y}):[new i.A(R,n[R],`unknown property "${R}"`)])}if(n.source){const R=p.sources&&p.sources[n.source],O=R&&i.D(R.type);R?O!=="raster-dem"&&w.push(new i.V(s,n.source,`terrain cannot be used with a source of type ${String(O)}, it only be used with a "raster-dem" source type`)):w.push(new i.V(s,n.source,`source "${n.source}" not found`))}else w.push(new i.V(s,n,'terrain is missing required property "source"'));return w}function Zr(h){const n=h.value,s=h.style,p=h.styleSpec,y=p.fog;let v=[];const w=i.B(n);if(n===void 0)return v;if(w!=="object")return v=v.concat([new i.V("fog",n,`object expected, ${w} found`)]),v;for(const P in n){const R=P.match(/^(.*)-transition$/);v=v.concat(R&&y[R[1]]&&y[R[1]].transition?hr({key:P,value:n[P],valueSpec:p.transition,style:s,styleSpec:p}):y[P]?hr({key:P,value:n[P],valueSpec:y[P],style:s,styleSpec:p}):[new i.A(P,n[P],`unknown property "${P}"`)])}return v}const hn={"*":()=>[],array:Yt,boolean:function(h){const n=h.value,s=h.key,p=i.B(n);return p!=="boolean"?[new i.V(s,n,`boolean expected, ${p} found`)]:[]},number:Wt,color:function(h){const n=h.key,s=h.value,p=i.B(s);return p!=="string"?[new i.V(n,s,`color expected, ${p} found`)]:i.U.parseCSSColor(s)===null?[new i.V(n,s,`color expected, "${s}" found`)]:[]},enum:Tt,filter:ar,function:wr,layer:Qr,object:Lt,source:Jn,model:i.Z,light:Dr,"light-3d":dr,terrain:gr,fog:Zr,string:pn,formatted:function(h){return pn(h).length===0?[]:Sr(h)},resolvedImage:function(h){return pn(h).length===0?[]:Sr(h)},projection:function(h){const n=h.value,s=h.styleSpec,p=s.projection,y=h.style;let v=[];const w=i.B(n);if(w==="object")for(const P in n)v=v.concat(hr({key:P,value:n[P],valueSpec:p[P],style:y,styleSpec:s}));else w!=="string"&&(v=v.concat([new i.V("projection",n,`object or string expected, ${w} found`)]));return v},import:function(h){const{value:n,styleSpec:s}=h,{data:p,...y}=n;Object.defineProperty(y,"__line__",{value:n.__line__,enumerable:!1});let v=Lt(i.C({},h,{value:y,valueSpec:s.import}));return i.D(y.id)===""&&v.push(new i.V(`${h.key}.id`,y,"import id can't be an empty string")),p&&(v=v.concat(bi(p,s,{key:`${h.key}.data`}))),v}};function hr(h,n=!1){const s=h.value,p=h.valueSpec,y=h.styleSpec;if(p.expression&&i.X(i.D(s)))return wr(h);if(p.expression&&i.J(i.K(s)))return Sr(h);if(p.type&&hn[p.type]){const v=hn[p.type](h);return n===!0&&v.length>0&&i.B(h.value)==="array"?Sr(h):v}return Lt(i.C({},h,{valueSpec:p.type?y[p.type]:p}))}function Mn(h){const n=h.value,s=h.key,p=pn(h);return p.length||(n.indexOf("{fontstack}")===-1&&p.push(new i.V(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&p.push(new i.V(s,n,'"glyphs" url must include a "{range}" token'))),p}function bi(h,n=i._,s={}){return hr({key:s.key||"",value:h,valueSpec:n.$root,styleSpec:n,style:h,objectElementValidators:{glyphs:Mn,"*":()=>[]}})}function sn(h,n=i._){return Be(bi(h,n))}const qn=h=>Be(Jn(h)),uo=h=>Be(Dr(h)),_o=h=>Be(dr(h)),eo=h=>Be(gr(h)),ms=h=>Be(Zr(h)),ut=h=>Be(Qr(h)),ue=h=>Be(ar(h)),pe=h=>Be(zr(h)),ke=h=>Be(br(h)),Ve=h=>Be(i.Z(h));function Be(h){return h.slice().sort((n,s)=>n.line&&s.line?n.line-s.line:0)}function Xe(h,n){let s=!1;if(n&&n.length)for(const p of n)p instanceof i.A?i.w(p.message):(h.fire(new i.t(new Error(p.message))),s=!0);return s}let lt;class et extends i.E{constructor(n,s="flat"){super(),this._transitionable=new i.$(lt||(lt=new i.a0({anchor:new i.a1(i._.light.anchor),position:new i.a2(i._.light.position),color:new i.a1(i._.light.color),intensity:new i.a1(i._.light.intensity)}))),this.setLight(n,s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,s,p={}){this._validate(uo,n,p)||(this._transitionable.setTransitionOrValue(n),this.id=s)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,s,p){return(!p||p.validate!==!1)&&Xe(this,n.call(sn,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i._})))}}const ct=new i.a0({source:new i.a1(i._.terrain.source),exaggeration:new i.a1(i._.terrain.exaggeration)});let yt=class extends i.E{constructor(h,n,s,p){super(),this.scope=s,this._transitionable=new i.$(ct,s,p),this._transitionable.setTransitionOrValue(h,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(h,n){this._transitionable.setTransitionOrValue(h,n)}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}getExaggeration(h){return this._transitioning.possiblyEvaluate(new i.a3(h)).get("exaggeration")}isZoomDependent(){const h=this._transitionable._values.exaggeration;return h!=null&&h.value!=null&&h.value.expression!=null&&h.value.expression instanceof i.a4}};const mt=45,jt=65,nr=.05;function or(h,n,s,p){const y=i.a7(mt,jt,s),[v,w]=Or(h,p);let P=1-Math.min(1,Math.exp((n-v)/(w-v)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*y*h.alpha}function Or(h,n){const s=.5/Math.tan(.5*n);return[h.range[0]+s,h.range[1]+s]}function Fr(h,n,s,p,y){const v=i.a6.vec3.transformMat4([],[n,s,p],y.mercatorFogMatrix);return or(h,i.a6.vec3.length(v),y.pitch,y._fov)}function Br(h,n,s,p,y,v,w){const P=[[s,p,0],[y,p,0],[y,v,0],[s,v,0]];let R=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(const F of P){const V=i.a6.vec3.transformMat4([],F,n),$=i.a6.vec3.length(V);R=Math.min(R,$),O=Math.max(O,$)}return[or(h,R,w.pitch,w._fov),or(h,O,w.pitch,w._fov)]}const jr=new i.a0({range:new i.a1(i._.fog.range),color:new i.a1(i._.fog.color),"high-color":new i.a1(i._.fog["high-color"]),"space-color":new i.a1(i._.fog["space-color"]),"horizon-blend":new i.a1(i._.fog["horizon-blend"]),"star-intensity":new i.a1(i._.fog["star-intensity"]),"vertical-range":new i.a1(i._.fog["vertical-range"])});class Tn extends i.E{constructor(n,s,p,y){super(),this._transitionable=new i.$(jr,p,new Map(y)),this.set(n,y),this._transitioning=this._transitionable.untransitioned(),this._transform=s,this.properties=new i.a8(jr),this.scope=p}get state(){const n=this._transform,s=n.projection.name==="globe",p=i.a9(n.zoom),y=this.properties.get("range"),v=[.5,3];return{range:s?[i.aa(v[0],y[0],p),i.aa(v[1],y[1],p)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,s,p={}){if(this._validate(ms,n,p))return;const y=i.l({},n);for(const v of Object.keys(i._.fog))y[v]===void 0&&(y[v]=i._.fog[v].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,s)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.a7(mt,jt,n))*s.a}getOpacityAtLatLng(n,s){return this._transform.projection.supportsFog?function(p,y,v){const w=i.a5.fromLngLat(y),P=v.elevation?v.elevation.getAtPointOrZero(w):0;return Fr(p,w.x,w.y,P,v)}(this.state,n,s):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const s=this._transform.calculateFogTileMatrix(n.toUnwrapped());return Br(this.state,s,0,0,i.ab,i.ab,this._transform)}getOpacityForBounds(n,s,p,y,v){return this._transform.projection.supportsFog?Br(this.state,n,s,p,y,v,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?Or(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const s=[4,5,6,7];for(const p of s){const y=n.points[p];let v;if(y[2]>=0)v=y;else{const w=n.points[p-4];v=i.ac(w,y,w[2]/(w[2]-y[2]))}if(Fr(this.state,v[0],v[1],0,this._transform)>=nr)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,s,p){return(!p||p.validate!==!1)&&Xe(this,n.call(sn,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i._})))}}class Pn extends i.E{constructor(n,s,p,y){super(),this.scope=p,this._options=n,this.properties=new i.a8(s),this._transitionable=new i.$(s,p,new Map(y)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,s){this._options=n,this._transitionable.setTransitionOrValue(n.properties,s)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let Yr,En;class ti{constructor(n,s,p,y){this.screenBounds=n,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(n,s){let p,y;if(n instanceof i.P||typeof n[0]=="number"){const v=i.P.convert(n);p=[v],y=s.isPointAboveHorizon(v)}else{const v=i.P.convert(n[0]),w=i.P.convert(n[1]);p=[v,w],y=i.ae(v,w).every(P=>s.isPointAboveHorizon(P))}return new ti(p,s.getCameraPoint(),y,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return i.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const s=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],y=i.ae(s,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(y[3]=this.cameraPoint)),i.af(y,n)}bufferedCameraGeometryGlobe(n){const s=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],y=i.ae(s,p,n),v=this.cameraPoint.clone();switch(3*((v.y>s.y)+(v.y>p.y))+((v.x>s.x)+(v.x>p.x))){case 0:y[0]=v,y[4]=v.clone();break;case 1:y.splice(1,0,v);break;case 2:y[1]=v;break;case 3:y.splice(4,0,v);break;case 5:y.splice(2,0,v);break;case 6:y[3]=v;break;case 7:y.splice(3,0,v);break;case 8:y[2]=v}return y}containsTile(n,s,p,y=0){const v=n.queryPadding/s._pixelsPerMercatorPixel+1,w=p?this._bufferedCameraMercator(v,s):this._bufferedScreenMercator(v,s);let P=n.tileID.wrap+(w.unwrapped?y:0);const R=w.polygon.map(ie=>i.ag(n.tileTransform,ie,P));if(!i.ah(R,0,0,i.ab,i.ab))return;P=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const O=this.screenGeometryMercator.polygon.map(ie=>i.ai(n.tileTransform,ie,P)),F=O.map(ie=>new i.P(ie[0],ie[1])),V=s.getFreeCameraOptions().position||new i.a5(0,0,0),$=i.ai(n.tileTransform,V,P),W=O.map(ie=>{const ae=i.a6.vec3.sub(ie,ie,$);return i.a6.vec3.normalize(ae,ae),new i.aj($,ae)}),ee=i.ak(n,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:W,bufferedTilespaceGeometry:R,bufferedTilespaceBounds:(re=i.al(R),re.min.x=i.ap(re.min.x,0,i.ab),re.min.y=i.ap(re.min.y,0,i.ab),re.max.x=i.ap(re.max.x,0,i.ab),re.max.y=i.ap(re.max.y,0,i.ab),re),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:ee};var re}_bufferedScreenMercator(n,s){const p=Zi(n);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let y;return y=s.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),s):{polygon:this.bufferedScreenGeometry(n).map(v=>s.pointCoordinate3D(v)),unwrapped:!0},this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(n,s){const p=Zi(n);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let y;return y=s.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),s):{polygon:this.bufferedCameraGeometry(n).map(v=>s.pointCoordinate3D(v)),unwrapped:!0},this._cameraRaycastCache[p]=y,y}}_projectAndResample(n,s){const p=function(v,w){const P=i.a6.mat4.multiply([],w.pixelMatrix,w.globeMatrix),R=[0,-i.aq,0,1],O=[0,i.aq,0,1],F=[0,0,0,1];i.a6.vec4.transformMat4(R,R,P),i.a6.vec4.transformMat4(O,O,P),i.a6.vec4.transformMat4(F,F,P);const V=new i.P(R[0]/R[3],R[1]/R[3]),$=new i.P(O[0]/O[3],O[1]/O[3]),W=i.an(v,V)&&R[3]<F[3],ee=i.an(v,$)&&O[3]<F[3];if(!W&&!ee)return null;const re=function(Fe,Re,Ne){for(let qe=1;qe<Fe.length;qe++){const Ue=ki(Re.pointCoordinate3D(Fe[qe-1]).x),$e=ki(Re.pointCoordinate3D(Fe[qe]).x);if(Ne<0){if(Ue<$e)return{idx:qe,t:-Ue/($e-1-Ue)}}else if($e<Ue)return{idx:qe,t:(1-Ue)/($e+1-Ue)}}return null}(v,w,W?-1:1);if(!re)return null;const{idx:ie,t:ae}=re;let _e=ie>1?Ii(v.slice(0,ie),w):[],Se=ie<v.length?Ii(v.slice(ie),w):[];_e=_e.map(Fe=>new i.P(ki(Fe.x),Fe.y)),Se=Se.map(Fe=>new i.P(ki(Fe.x),Fe.y));const ge=[..._e];ge.length===0&&ge.push(Se[Se.length-1]);const Ee=i.aa(ge[ge.length-1].y,(Se.length===0?_e[0]:Se[0]).y,ae);let Me;return Me=W?[new i.P(0,Ee),new i.P(0,0),new i.P(1,0),new i.P(1,Ee)]:[new i.P(1,Ee),new i.P(1,1),new i.P(0,1),new i.P(0,Ee)],ge.push(...Me),Se.length===0?ge.push(_e[0]):ge.push(...Se),{polygon:ge.map(Fe=>new i.a5(Fe.x,Fe.y)),unwrapped:!1}}(n,s);if(p)return p;const y=function(v,w){let P=!1,R=-1/0,O=0;for(let V=0;V<v.length-1;V++)v[V].x>R&&(R=v[V].x,O=V);for(let V=0;V<v.length-1;V++){const $=(O+V)%(v.length-1),W=v[$],ee=v[$+1];Math.abs(W.x-ee.x)>.5&&(W.x<ee.x?(W.x+=1,$===0&&(v[v.length-1].x+=1)):(ee.x+=1,$+1===v.length-1&&(v[0].x+=1)),P=!0)}const F=i.am(w.center.lng);return P&&F<Math.abs(F-1)&&v.forEach(V=>{V.x-=1}),{polygon:v,unwrapped:P}}(Ii(n,s).map(v=>new i.P(ki(v.x),v.y)),s);return{polygon:y.polygon.map(v=>new i.a5(v.x,v.y)),unwrapped:y.unwrapped}}}function Ii(h,n){return i.ao(h,s=>{const p=n.pointCoordinate3D(s);s.x=p.x,s.y=p.y},1/256)}function ki(h){return h<0?1+h%1:h%1}function Zi(h){return 100*h|0}function Bo(h,n,s,p,y){const v=function(P,R){if(P)return y(P);if(R){if(h.url&&R.tiles&&h.tiles&&delete h.tiles,R.variants){if(!Array.isArray(R.variants))return y(new Error("variants must be an array"));for(const F of R.variants){if(F==null||typeof F!="object"||F.constructor!==Object)return y(new Error("variant must be an object"));if(!Array.isArray(F.capabilities))return y(new Error("capabilities must be an array"));if(F.capabilities.length===1&&F.capabilities[0]==="meshopt"){R=i.l(R,F);break}}}const O=i.ar(i.l(R,h),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(O.vectorLayers=R.vector_layers,O.vectorLayerIds=O.vectorLayers.map(F=>F.id)),R.raster_layers&&(O.rasterLayers=R.raster_layers,O.rasterLayerIds=O.rasterLayers.map(F=>F.id)),O.tiles=n.canonicalizeTileset(O,h.url),y(null,O)}},w=function(P,R,O){if(!P)return null;if(!R&&!O)return P;O=O||P.worldview_default;const F=Object.values(P.language||{});if(F.length===0)return null;const V=Object.values(P.worldview||{});if(V.length===0)return null;const $=F.every(ee=>ee===R),W=V.every(ee=>ee===O);return $&&W?P:R in(P.language_options||{})||O in(P.worldview_options||{})?null:P.language_options&&P.worldview_options?P:null}(h.data,s,p);return w?i.q.frame(()=>v(null,w)):h.url?i.n(n.transformRequest(n.normalizeSourceURL(h.url,null,s,p),i.R.Source),v):i.q.frame(()=>{const{data:P,...R}=h;v(null,R)})}class Is{constructor(n,s,p){this.bounds=i.as.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const s=Math.pow(2,n.z),p=Math.floor(i.am(this.bounds.getWest())*s),y=Math.floor(i.at(this.bounds.getNorth())*s),v=Math.ceil(i.am(this.bounds.getEast())*s),w=Math.ceil(i.at(this.bounds.getSouth())*s);return n.x>=p&&n.x<v&&n.y>=y&&n.y<w}}class Nl extends i.E{constructor(n,s,p,y){if(super(),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ar(s,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},s),this._collectResourceTiming=!!s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new i.au}load(n){this._loaded=!1,this.fire(new i.x("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=Bo(this._options,this.map._requestManager,s,p,(y,v)=>{this._tileJSONRequest=null,this._loaded=!0,y?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),p&&p.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new i.t(y))):v&&(i.l(this,v),v.bounds&&(this.tileBounds=new Is(v.bounds,this.minzoom,this.maxzoom)),Ft(v.tiles,this.map._requestManager._customAccessToken),this.fire(new i.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.x("data",{dataType:"source",sourceDataType:"content"}))),n&&n(y)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(n,s){const p=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),y=this.map._requestManager.transformRequest(p,i.R.Tile),v=this.map.style?this.map.style.getLut(this.scope):null,w={request:y,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,lut:v?{image:v.image.clone()}:null,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(w.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=s:n.request=n.actor.send("reloadTile",w,P.bind(this));else if(n.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",w,P.bind(this),void 0,!0);else{const R=i.aw.call({deduped:this._deduped},w,(O,F)=>{O||!F?P.call(this,O):(w.data={cacheControl:F.cacheControl,expires:F.expires,rawData:F.rawData.slice(0)},n.actor&&n.actor.send("loadTile",w,P.bind(this),void 0,!0))},!0);n.request={cancel:R}}function P(R,O){return delete n.request,n.aborted?s(null):R&&R.status!==404?s(R):(O&&O.resourceTiming&&(n.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&n.setExpiryData(O),n.loadVectorData(O,this.map.painter),i.ax(this.dispatcher),s(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,s){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Vl extends i.E{constructor(n,s,p,y){super(),this.id=n,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},s),i.l(this,i.ar(s,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new i.x("dataloading",{dataType:"source"})),this._tileJSONRequest=Bo(this._options,this.map._requestManager,null,null,(s,p)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new i.t(s)):p&&(i.l(this,p),p.bounds&&(this.tileBounds=new Is(p.bounds,this.minzoom,this.maxzoom)),Ft(p.tiles),this.fire(new i.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.x("data",{dataType:"source",sourceDataType:"content"}))),n&&n(s)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,s){const p=i.q.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);n.request=i.o(this.map._requestManager.transformRequest(y,i.R.Tile),(v,w,P,R)=>(delete n.request,n.aborted?(n.state="unloaded",s(null)):v?(n.state="errored",s(v)):w?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:P,expires:R}),n.setTexture(w,this.map.painter),n.state="loaded",i.ax(this.dispatcher),void s(null)):s(null)))}abortTile(n,s){n.request&&(n.request.cancel(),delete n.request),s&&s()}unloadTile(n,s){n.texture&&n.texture instanceof i.T?(n.destroy(!0),n.texture&&n.texture instanceof i.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),s&&s()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class il extends Vl{constructor(n,s,p,y){super(n,s,p,y),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},s)}triggerRepaint(n){const s=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);s&&s.enabled&&p&&s._clearRenderCacheForTile(p.id,n.tileID),this.map.triggerRepaint()}loadTile(n,s){const p=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),y=this.map._requestManager.transformRequest(p,i.R.Tile);n.requestParams=y,n.actor||(n.actor=this.dispatcher.getActor()),n.request=n.fetchHeader(void 0,(v,w,P,R)=>{if(delete n.request,n.aborted)return n.state="unloaded",s(null);if(v)return v.code===20?void 0:(n.state="errored",s(v));this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:P,expires:R}),n.state="empty",s(null)})}unloadTile(n,s){const p=n.texture;p&&p instanceof i.T?(n.destroy(!0),this.map.painter.saveTileTexture(p)):(n.destroy(),n.flushQueues(),n._isHeaderLoaded=!1,delete n._mrt,delete n.textureDescriptor),n.fbo&&(n.fbo.destroy(),delete n.fbo),delete n.request,delete n.requestParams,delete n.neighboringTiles,n.state="unloaded"}prepareTile(n,s,p){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBand(s,p,(y,v)=>{if(y)return n.state="errored",this.fire(new i.t(y)),void this.triggerRepaint(n);v&&(n.setTexture(v,this.map.painter),n.state="loaded",this.triggerRepaint(n))}))}getInitialBand(n){if(!this.rasterLayers)return 0;const s=this.rasterLayers.find(({id:v})=>v===n),p=s&&s.fields,y=p&&p.bands&&p.bands;return y?y[0]:0}getTextureDescriptor(n,s,p){if(!n)return;const y=s.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!y)return;let v=null;s instanceof i.aB?v=s.paint.get("raster-array-band"):s instanceof i.aC&&(v=s.paint.get("raster-particle-array-band"));const w=v||this.getInitialBand(y);if(w!=null)if(n.textureDescriptor){if(!n.updateNeeded(y,w)||p)return Object.assign({},n.textureDescriptor,{texture:n.texture})}else this.prepareTile(n,y,w)}}const xc={vector:Nl,raster:Vl,"raster-dem":class extends Vl{constructor(h,n,s,p){super(h,n,s,p),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(h,n){const s=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,v){y&&(h.state="errored",n(y)),v&&(h.dem=v,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",n(null))}h.request=i.o(this.map._requestManager.transformRequest(s,i.R.Tile),(function(y,v,w,P){if(delete h.request,h.aborted)h.state="unloaded",n(null);else if(y)h.state="errored",n(y);else if(v){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:w,expires:P});const R=ImageBitmap&&v instanceof ImageBitmap&&i.ay(),O=1-(v.width-i.az(v.width))/2;O<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const F=R?v:i.q.getImageData(v,O),V={uid:h.uid,coord:h.tileID,source:this.id,scope:this.scope,rawImageData:F,encoding:this.encoding,padding:O};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",V,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(h){const n=h.canonical,s=Math.pow(2,n.z),p=(n.x-1+s)%s,y=n.x===0?h.wrap-1:h.wrap,v=(n.x+1+s)%s,w=n.x+1===s?h.wrap+1:h.wrap,P={};return P[new i.aA(h.overscaledZ,y,n.z,p,n.y).key]={backfilled:!1},P[new i.aA(h.overscaledZ,w,n.z,v,n.y).key]={backfilled:!1},n.y>0&&(P[new i.aA(h.overscaledZ,y,n.z,p,n.y-1).key]={backfilled:!1},P[new i.aA(h.overscaledZ,h.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},P[new i.aA(h.overscaledZ,w,n.z,v,n.y-1).key]={backfilled:!1}),n.y+1<s&&(P[new i.aA(h.overscaledZ,y,n.z,p,n.y+1).key]={backfilled:!1},P[new i.aA(h.overscaledZ,h.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},P[new i.aA(h.overscaledZ,w,n.z,v,n.y+1).key]={backfilled:!1}),P}},"raster-array":il,geojson:class extends i.E{constructor(h,n,s,p){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(p),this._data=n.data,this._options=i.l({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const y=i.ab/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*y,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*y,extent:i.ab,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:i.ab,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*y,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}updateData(h){if(!this._options.dynamic)return this.fire(new i.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof h!="string"&&(h.type==="Feature"&&(h={type:"FeatureCollection",features:[h]}),h.type!=="FeatureCollection"))return this.fire(new i.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof h!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const s of this._data.features)n.set(s.id,s);for(const s of h.features)n.set(s.id,s);this._data.features=[...n.values()]}else this._data=h;return this._updateWorkerData(!0),this}getClusterExpansionZoom(h,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id,scope:this.scope},n),this}getClusterChildren(h,n){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id,scope:this.scope},n),this}getClusterLeaves(h,n,s,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:h,limit:n,offset:s},p),this}_updateWorkerData(h=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.x("dataloading",{dataType:"source"})),this._loaded=!1;const n=i.l({append:h},this.workerOptions);n.scope=this.scope;const s=this._data;typeof s=="string"?(n.request=this.map._requestManager.transformRequest(i.q.resolveURL(s),i.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(p,y)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new i.t(p));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(v.resourceTiming=y.resourceTiming[this.id]),h&&(this._partialReload=!0),this.fire(new i.x("data",v)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(h),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,n){const s=h.actor?"reloadTile":"loadTile";h.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,y=this._partialReload,v={type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:p?{image:p.image.clone()}:null,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:y};h.request=this.actor.send(s,v,(w,P)=>y&&!P?(h.state="loaded",n(null)):(delete h.request,h.destroy(),h.aborted?n(null):w?n(w):(h.loadVectorData(P,this.map.painter,s==="reloadTile"),n(null))),void 0,s==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h,n){this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id,scope:this.scope}),h.destroy()}onRemove(h){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aD{constructor(h,n,s,p){super(h,n,s,p),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const n of h.urls)this.urls.push(this.map._requestManager.transformRequest(n,i.R.Source).url);i.aE(this.urls,(n,s)=>{this._loaded=!0,n?this.fire(new i.t(n)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const n=this.video.seekable;h<n.start(0)||h>n.end(0)?this.fire(new i.t(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,n=h.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(h,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aD,model:class extends i.E{constructor(h,n,s,p){super(),this.id=h,this.type="model",this.models=[],this._loaded=!1,this._options=n}load(){const h=[];for(const n in this._options.models){const s=this._options.models[n],p=i.aG(this.map._requestManager.transformRequest(s.uri,i.R.Model).url).then(y=>{if(!y)return;const v=i.aH(y),w=new i.aI(n,s.position,s.orientation,v);w.computeBoundsAndApplyParent(),this.models.push(w)}).catch(y=>{this.fire(new i.t(new Error(`Could not load model ${n} from ${s.uri}: ${y.message}`)))});h.push(p)}return Promise.allSettled(h).then(()=>{this._loaded=!0,this.fire(new i.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(n=>{this.fire(new i.t(new Error(`Could not load models: ${n.message}`)))})}onAdd(h){this.map=h,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(h,n){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(h,n,s,p){super(),this.type="batched-model",this.id=h,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=s,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(h){this.map=h,this.load()}load(h){this._loaded=!1,this.fire(new i.x("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=Bo(this._options,this.map._requestManager,n,s,(p,y)=>{this._tileJSONRequest=null,this._loaded=!0,p?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),s&&s.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new i.t(p))):y&&(i.l(this,y),y.bounds&&(this.tileBounds=new Is(y.bounds,this.minzoom,this.maxzoom)),Ft(y.tiles,this.map._requestManager._customAccessToken),this.fire(new i.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.x("data",{dataType:"source",sourceDataType:"content"}))),h&&h(p)})}hasTransition(){return!1}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loaded(){return this._loaded}loadTile(h,n){const s=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(s,i.R.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:h.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(h.actor&&h.state!=="expired")if(h.state==="loading")h.reloadCallback=n;else{if(h.buckets){const v=Object.values(h.buckets);for(const w of v)w.dirty=!0;return void(h.state="loaded")}h.request=h.actor.send("reloadTile",p,y.bind(this))}else h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",p,y.bind(this),void 0,!0);function y(v,w){return h.aborted?n(null):v&&v.status!==404?n(v):(w&&(w.resourceTiming&&(h.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&h.setExpiryData(w),h.buckets={...h.buckets,...w.buckets},w.featureIndex&&(h.latestFeatureIndex=w.featureIndex)),h.state="loaded",void n(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aD{constructor(h,n,s,p){super(h,n,s,p),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(v=>typeof v!="number"))||this.fire(new i.t(new i.V(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.t(new i.V(`sources.${h}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new i.t(new i.V(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new i.t(new i.V(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.t(new i.V(`sources.${h}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(h){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!h&&!this._playing||this.texture instanceof i.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends i.E{constructor(h,n,s,p){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=n,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Is(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ar(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this.map=h,this._loaded=!1,this.fire(new i.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:n,y:s,z:p}=h.canonical;return this._implementation.hasTile({x:n,y:s,z:p})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,n){const{x:s,y:p,z:y}=h.tileID.canonical,v=new AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:s,y:p,z:y},{signal:v.signal})).then((function(w){return delete h.request,h.aborted?(h.state="unloaded",n(null)):w===void 0?(h.state="errored",n(null)):w===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",n(null)):function(P){return P instanceof ImageData||P instanceof HTMLCanvasElement||P instanceof ImageBitmap||P instanceof HTMLImageElement}(w)?(this.loadTileData(h,w),h.state="loaded",void n(null)):(h.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(w=>{w.code!==20&&(h.state="errored",n(w))}),h.request.cancel=()=>v.abort()}loadTileData(h,n){h.setTexture(n,this.map.painter)}unloadTile(h,n){if(h.texture&&h.texture instanceof i.T?(h.destroy(!0),h.texture&&h.texture instanceof i.T&&this.map.painter.saveTileTexture(h.texture)):h.destroy(),this._implementation.unloadTile){const{x:s,y:p,z:y}=h.tileID.canonical;this._implementation.unloadTile({x:s,y:p,z:y})}n&&n()}abortTile(h,n){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){const h=i.av(this.id,this.scope);this.map.style.clearSource(h)}_update(){this.fire(new i.x("data",{dataType:"source",sourceDataType:"content"}))}}},ol=function(h,n,s,p){const y=new xc[n.type](h,n,s,p);if(y.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${y.id}`);return i.aJ(["load","abort","unload","serialize","prepare"],y),y};function ju(h,n){const s=i.a6.mat4.identity([]);return i.a6.mat4.scale(s,s,[.5*h.width,.5*-h.height,1]),i.a6.mat4.translate(s,s,[1,-1,0]),i.a6.mat4.multiply(s,s,h.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(s)}function Nu(h,n,s,p,y,v,w,P=!1){const R=h.tilesIn(p,w,P);R.sort(al);const O=[];for(const V of R)O.push({wrappedTileID:V.tile.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(n,s,h._state,V,y,v,ju(h.transform,V.tile.tileID),P)});const F=function(V){const $={},W={};for(const ee of V){const re=ee.queryResults,ie=ee.wrappedTileID,ae=W[ie]=W[ie]||{};for(const _e in re){const Se=re[_e],ge=ae[_e]=ae[_e]||{},Ee=$[_e]=$[_e]||[];for(const Me of Se)ge[Me.featureIndex]||(ge[Me.featureIndex]=!0,Ee.push(Me))}}return $}(O);for(const V in F)F[V].forEach($=>{const W=$.feature,ee=W.layer;ee&&ee.type!=="background"&&ee.type!=="sky"&&ee.type!=="slot"&&(W.source=ee.source,ee["source-layer"]&&(W.sourceLayer=ee["source-layer"]),W.state=W.id!==void 0?h.getFeatureState(ee["source-layer"],W.id):{})});return F}function sl(h,n){const s=h.getRenderableIds().map(v=>h.getTileByID(v)),p=[],y={};for(let v=0;v<s.length;v++){const w=s[v],P=w.tileID.canonical.key;y[P]||(y[P]=!0,w.querySourceFeatures(p,n))}return p}function al(h,n){const s=h.tileID,p=n.tileID;return s.overscaledZ-p.overscaledZ||s.canonical.y-p.canonical.y||s.wrap-p.wrap||s.canonical.x-p.canonical.x}const jo=32,Ri=33,ks=new Uint16Array(8184);for(let h=0;h<2046;h++){let n=h+2,s=0,p=0,y=0,v=0,w=0,P=0;for(1&n?y=v=w=jo:s=p=P=jo;(n>>=1)>1;){const O=s+y>>1,F=p+v>>1;1&n?(y=s,v=p,s=w,p=P):(s=y,p=v,y=w,v=P),w=O,P=F}const R=4*h;ks[R+0]=s,ks[R+1]=p,ks[R+2]=y,ks[R+3]=v}const No=new Uint16Array(2178),Qs=new Uint8Array(1089),Vu=new Uint16Array(1089);function Tf(h){return h===0?-.03125:h===32?.03125:0}const Cf={type:2,extent:i.ab,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ab+1,0),new i.P(i.ab+1,i.ab+1),new i.P(0,i.ab+1),new i.P(0,0)]]};class ea{constructor(n,s,p,y,v){this.tileID=n,this.uid=i.aP(),this.uses=0,this.tileSize=s,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,y&&y.style&&(this._lastUpdatedBrightness=y.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(n){const s=n+this.timeAdded;s<i.q.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,s,p){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(y,v){const w={};if(!v)return w;for(const P of y){const R=P.layerIds.map(O=>v.getLayer(O)).filter(Boolean);if(R.length!==0){P.layers=R,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map(O=>R.filter(F=>F.id===O)[0]));for(const O of R)w[O.fqid]=P}}return w}(n.buckets,s.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const v=this.buckets[y];if(v instanceof i.aR){if(this.hasSymbolBuckets=!0,!p)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const v=this.buckets[y];if(v instanceof i.aR&&v.hasRTLText){this.hasRTLText=!0,i.aS();break}}this.queryPadding=0;for(const y in this.buckets){const v=this.buckets[y],w=s.style.getOwnLayer(y);if(!w)continue;const P=w.queryRadius(v);this.queryPadding=Math.max(this.queryPadding,P)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new i.aQ}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.fqid]}upload(n){for(const y in this.buckets){const v=this.buckets[y];v.uploadPending()&&v.upload(n)}const s=n.gl,p=this.imageAtlas;if(p&&!p.uploaded){const y=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new i.T(n,p.image,s.RGBA8,{useMipmap:y}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(n,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(n,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(n,s,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,p),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const y=s.style.getBrightness();(this._lastUpdatedBrightness||y)&&(this._lastUpdatedBrightness&&y&&Math.abs(this._lastUpdatedBrightness-y)<.001||(this._lastUpdatedBrightness=y,this.updateBuckets(s)))}queryRenderedFeatures(n,s,p,y,v,w,P,R){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:y,pixelPosMatrix:P,transform:w,params:v,tileTransform:this.tileTransform},n,s,p):{}}querySourceFeatures(n,s){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),v=s?s.sourceLayer:"",w=y._geojsonTileLayer||y[v];if(!w)return;const P=i.aT(s&&s.filter),{z:R,x:O,y:F}=this.tileID.canonical,V={z:R,x:O,y:F};for(let $=0;$<w.length;$++){const W=w.feature($);if(P.needGeometry){const ie=i.aU(W,!0);if(!P.filter(new i.a3(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!P.filter(new i.a3(this.tileID.overscaledZ),W))continue;const ee=p.getId(W,v),re=new i.aV(W,R,O,F,ee);re.tile=V,n.push(re)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const s=this.expirationTime;if(n.cacheControl){const p=i.aW(n.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(s)if(this.expirationTime<s)y=!0;else{const v=this.expirationTime-s;v?this.expirationTime=p+Math.max(v,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,s){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(n).length!==0&&s&&this.updateBuckets(s)}updateBuckets(n){if(!this.latestFeatureIndex)return;const s=this.latestFeatureIndex.loadVTLayers(),p=n.style.listImages(),y=n.style.getBrightness();for(const v in this.buckets){if(!n.style.hasLayer(v))continue;const w=this.buckets[v],P=w.layers[0].sourceLayer||"_geojsonTileLayer",R=s[P],O=n.style.getOwnSourceCache(w.layers[0].source);let F={};O&&(F=O._state.getState(P,void 0)),w.update(F,R,p,this.imageAtlas&&this.imageAtlas.patternPositions||{},y),(w instanceof i.aX||w instanceof i.aY)&&n._terrain&&n._terrain.enabled&&O&&w.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(O.id,this.tileID);const V=n&&n.style&&n.style.getOwnLayer(v);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=i.q.now()+n}setTexture(n,s){const p=s.context,y=p.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture&&this.texture instanceof i.T?this.texture.update(n):(this.texture=new i.T(p,n,y.RGBA8,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE))}setDependencies(n,s){const p={};for(const y of s)p[y]=!0;this.dependencies[n]=p}hasDependency(n,s){for(const p of n){const y=this.dependencies[p];if(y){for(const v of s)if(y[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const p=i.aZ(Cf,this.tileID.canonical,this.tileTransform)[0],y=new i.a_,v=new i.a$;for(let w=0;w<p.length;w++){const{x:P,y:R}=p[w];y.emplaceBack(P,R),v.emplaceBack(w)}v.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(v),this._tileDebugBuffer=n.createVertexBuffer(y,i.b0.members),this._tileDebugSegments=i.b1.simpleSegment(0,0,y.length,v.length)}_makeTileBoundsBuffers(n,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const p=i.aZ(Cf,this.tileID.canonical,this.tileTransform)[0];let y,v;if(this.isRaster){const w=function(P,R){const O=i.aK(P,R),F=Math.pow(2,P.z);for(let ie=0;ie<Ri;ie++)for(let ae=0;ae<Ri;ae++){const _e=i.aL((P.x+(ae+Tf(ae))/jo)/F),Se=i.aM((P.y+(ie+Tf(ie))/jo)/F),ge=R.project(_e,Se),Ee=ie*Ri+ae;No[2*Ee+0]=Math.round((ge.x*O.scale-O.x)*i.ab),No[2*Ee+1]=Math.round((ge.y*O.scale-O.y)*i.ab)}Qs.fill(0),Vu.fill(0);for(let ie=2045;ie>=0;ie--){const ae=4*ie,_e=ks[ae+0],Se=ks[ae+1],ge=ks[ae+2],Ee=ks[ae+3],Me=_e+ge>>1,Fe=Se+Ee>>1,Re=Me+Fe-Se,Ne=Fe+_e-Me,qe=Se*Ri+_e,Ue=Ee*Ri+ge,$e=Fe*Ri+Me,nt=Math.hypot((No[2*qe+0]+No[2*Ue+0])/2-No[2*$e+0],(No[2*qe+1]+No[2*Ue+1])/2-No[2*$e+1])>=16;Qs[$e]=Qs[$e]||(nt?1:0),ie<1022&&(Qs[$e]=Qs[$e]||Qs[(Se+Ne>>1)*Ri+(_e+Re>>1)]||Qs[(Ee+Ne>>1)*Ri+(ge+Re>>1)])}const V=new i.aN,$=new i.aO;let W=0;function ee(ie,ae){const _e=ae*Ri+ie;return Vu[_e]===0&&(V.emplaceBack(No[2*_e+0],No[2*_e+1],ie*i.ab/jo,ae*i.ab/jo),Vu[_e]=++W),Vu[_e]-1}function re(ie,ae,_e,Se,ge,Ee){const Me=ie+_e>>1,Fe=ae+Se>>1;if(Math.abs(ie-ge)+Math.abs(ae-Ee)>1&&Qs[Fe*Ri+Me])re(ge,Ee,ie,ae,Me,Fe),re(_e,Se,ge,Ee,Me,Fe);else{const Re=ee(ie,ae),Ne=ee(_e,Se),qe=ee(ge,Ee);$.emplaceBack(Re,Ne,qe)}}return re(0,0,jo,jo,jo,0),re(jo,jo,0,0,0,jo),{vertices:V,indices:$}}(this.tileID.canonical,s);y=w.vertices,v=w.indices}else{y=new i.aN,v=new i.aO;for(const{x:P,y:R}of p)y.emplaceBack(P,R,0,0);const w=i.b2(y.int16,void 0,4);for(let P=0;P<w.length;P+=3)v.emplaceBack(w[P],w[P+1],w[P+2])}this._tileBoundsBuffer=n.createVertexBuffer(y,i.b3.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(v),this._tileBoundsSegments=i.b1.simpleSegment(0,0,y.length,v.length)}_makeGlobeTileDebugBuffers(n,s){const p=s.projection;if(!p||p.name!=="globe"||s.freezeTileCoverage)return;const y=this.tileID.canonical,v=i.b4(y,s),w=i.b5(v),P=i.a9(s.zoom);let R;P>0&&(R=i.a6.mat4.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,y,s,w,R,P),this._makeGlobeTileDebugTextBuffer(n,y,s,w,R,P)}_globePoint(n,s,p,y,v,w,P){let R=i.b6(n,s,p);if(w){const O=1<<p.z,F=i.am(y.center.lng),V=i.at(y.center.lat),$=(p.x+.5)/O-F;let W=0;$>.5?W=-1:$<-.5&&(W=1);let ee=(n/i.ab+p.x)/O+W,re=(s/i.ab+p.y)/O;ee=(ee-F)*y._pixelsPerMercatorPixel+F,re=(re-V)*y._pixelsPerMercatorPixel+V;const ie=[ee*y.worldSize,re*y.worldSize,0];i.a6.vec3.transformMat4(ie,ie,w),R=i.b7(R,ie,P)}return i.a6.vec3.transformMat4(R,R,v)}_makeGlobeTileDebugBorderBuffer(n,s,p,y,v,w){const P=new i.a_,R=new i.a$,O=new i.b8,F=($,W,ee,re,ie)=>{const ae=(ee-$)/(ie-1),_e=(re-W)/(ie-1),Se=P.length;for(let ge=0;ge<ie;ge++){const Ee=$+ge*ae,Me=W+ge*_e;P.emplaceBack(Ee,Me);const Fe=this._globePoint(Ee,Me,s,p,y,v,w);O.emplaceBack(Fe[0],Fe[1],Fe[2]),R.emplaceBack(Se+ge)}},V=i.ab;F(0,0,V,0,16),F(V,0,V,V,16),F(V,V,0,V,16),F(0,V,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(R),this._tileDebugBuffer=n.createVertexBuffer(P,i.b0.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(O,i.b9.members),this._tileDebugSegments=i.b1.simpleSegment(0,0,P.length,R.length)}_makeGlobeTileDebugTextBuffer(n,s,p,y,v,w){const P=i.ab/4,R=new i.a_,O=new i.aO,F=new i.b8,V=25;O.reserve(32),R.reserve(V),F.reserve(V);const $=(W,ee)=>V*W+ee;for(let W=0;W<V;W++){const ee=W*P;for(let re=0;re<V;re++){const ie=re*P;R.emplaceBack(ie,ee);const ae=this._globePoint(ie,ee,s,p,y,v,w);F.emplaceBack(ae[0],ae[1],ae[2])}}for(let W=0;W<4;W++)for(let ee=0;ee<4;ee++){const re=$(W,ee),ie=$(W,ee+1),ae=$(W+1,ee),_e=$(W+1,ee+1);O.emplaceBack(re,ie,ae),O.emplaceBack(ae,ie,_e)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(O),this._tileDebugTextBuffer=n.createVertexBuffer(R,i.b0.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(F,i.b9.members),this._tileDebugTextSegments=i.b1.simpleSegment(0,0,V,32)}destroy(n=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.ba.setPbf(i.bb);class nh extends ea{constructor(n,s,p,y,v){super(n,s,p,y,v),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(n,s){const p=s.context,y=p.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture&&this.texture instanceof i.T?this.texture.update(n,{premultiply:!1}):this.texture=new i.T(p,n,y.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(n=16384,s){const p=this._mrt=new i.ba(30),y=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=i.bc(y,(v,w,P,R)=>{if(v)s(v);else try{const O=p.getHeaderLength(w);if(O>n)return void(this.request=this.fetchHeader(O,s));p.parseHeader(w),this._isHeaderLoaded=!0;let F=0;for(const V of Object.values(p.layers))F=Math.max(F,V.dataIndex[V.dataIndex.length-1].last_byte);w.byteLength>=F&&(this.entireBuffer=w),s(null,this.entireBuffer||w,P,R)}catch(O){s(O)}}),this.request}fetchBand(n,s,p){const y=this._mrt;if(!this._isHeaderLoaded||!y)return void p(new Error("Tile header is not ready"));const v=this.actor;if(!v)return void p(new Error("Can't fetch tile band without an actor"));let w;const P=(V,$)=>{w.complete(V,$),V?p(V):(this.updateTextureDescriptor(n,s),p(null,this.textureDescriptor&&this.textureDescriptor.img))},R=(V,$)=>{if(V)return p(V);const W=v.send("decodeRasterArray",{buffer:$,task:w},P,void 0,!0);this._workQueue.push(()=>{W&&W.cancel(),w.cancel()})},O=y.getLayer(n);if(!O)return void p(new Error(`Unknown sourceLayer "${n}"`));if(O.hasDataForBand(s))return this.updateTextureDescriptor(n,s),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const F=O.getDataRange([s]);if(w=y.createDecodingTask(F),!w||w.tasks.length)if(this.flushQueues(),this.entireBuffer)R(null,this.entireBuffer.slice(F.firstByte,F.lastByte+1));else{const V=Object.assign({},this.requestParams,{headers:{Range:`bytes=${F.firstByte}-${F.lastByte}`}}),$=i.bc(V,R);this._fetchQueue.push(()=>{$.cancel(),w.cancel()})}else p(null)}updateNeeded(n,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==n)&&this.state!=="errored"}updateTextureDescriptor(n,s){if(!this._mrt)return;const p=this._mrt.getLayer(n);if(!p||!p.hasBand(s)||!p.hasDataForBand(s))return;const{bytes:y,tileSize:v,buffer:w,offset:P,scale:R}=p.getBandView(s),O=v+2*w,F={data:y,width:O,height:O},V=this.texture;V&&V instanceof i.T&&V.update(F,{premultiply:!1}),this.textureDescriptor={layer:n,band:s,img:F,buffer:w,offset:P,tileSize:v,format:p.pixelFormat,mix:[R,256*R,65536*R,16777216*R]}}}class Wy{constructor(n,s){this.max=n,this.onRemove=s,this.reset()}reset(){for(const n in this.data)for(const s of this.data[n])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(n,s,p){const y=n.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const v={value:s,timeout:void 0};if(p!==void 0&&(v.timeout=setTimeout(()=>{this.remove(n,v)},p)),this.data[y].push(v),this.order.push(y),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value}getByKey(n){const s=this.data[n];return s?s[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,s){if(!this.has(n))return this;const p=n.wrapped().key,y=s===void 0?0:this.data[p].indexOf(s),v=this.data[p][y];return this.data[p].splice(y,1),v.timeout&&clearTimeout(v.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(v.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(n){const s=[];for(const p in this.data)for(const y of this.data[p])n(y.value)||s.push(y);for(const p of s)this.remove(p.value.tileID,p)}}class A1{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,s,p){const y=String(s);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][y]=this.stateChanges[n][y]||{},i.l(this.stateChanges[n][y],p),this.deletedStates[n]===null){this.deletedStates[n]={};for(const v in this.state[n])v!==y&&(this.deletedStates[n][v]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][y]===null){this.deletedStates[n][y]={};for(const v in this.state[n][y])p[v]||(this.deletedStates[n][y][v]=null)}else for(const v in p)this.deletedStates[n]&&this.deletedStates[n][y]&&this.deletedStates[n][y][v]===null&&delete this.deletedStates[n][y][v]}removeFeatureState(n,s,p){if(this.deletedStates[n]===null)return;const y=String(s);if(this.deletedStates[n]=this.deletedStates[n]||{},p&&s!==void 0)this.deletedStates[n][y]!==null&&(this.deletedStates[n][y]=this.deletedStates[n][y]||{},this.deletedStates[n][y][p]=null);else if(s!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][y])for(p in this.deletedStates[n][y]={},this.stateChanges[n][y])this.deletedStates[n][y][p]=null;else this.deletedStates[n][y]=null;else this.deletedStates[n]=null}getState(n,s){const p=this.state[n]||{},y=this.stateChanges[n]||{},v=this.deletedStates[n];if(v===null)return{};if(s!==void 0){const P=String(s),R=i.l({},p[P],y[P]);if(v){const O=v[s];if(O===null)return{};for(const F in O)delete R[F]}return R}const w=i.l({},p,y);if(v)for(const P in v)delete w[P];return w}initializeTileState(n,s){n.setFeatureState(this.state,s)}coalesceChanges(n,s){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const v={};for(const w in this.stateChanges[y])this.state[y][w]||(this.state[y][w]={}),i.l(this.state[y][w],this.stateChanges[y][w]),v[w]=this.state[y][w];p[y]=v}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const v={};if(this.deletedStates[y]===null)for(const w in this.state[y])v[w]={},this.state[y][w]={};else for(const w in this.deletedStates[y]){if(this.deletedStates[y][w]===null)this.state[y][w]={};else if(this.state[y][w])for(const P of Object.keys(this.deletedStates[y][w]))delete this.state[y][w][P];v[w]=this.state[y][w]}p[y]=p[y]||{},i.l(p[y],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in n)n[y].setFeatureState(p,s)}}class Vo extends i.E{constructor(n,s,p){super(),this.id=n,this._onlySymbols=p,s.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new Wy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new A1,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,s){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,s)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const p=this._tiles[s];p.upload(n),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bd(this._tiles).map(n=>n.tileID).sort(ll).map(n=>n.key)}getRenderableIds(n,s){const p=[];for(const y in this._tiles)this._isIdRenderable(+y,n,s)&&p.push(this._tiles[y]);return n?p.sort((y,v)=>{const w=y.tileID,P=v.tileID,R=new i.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),O=new i.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-P.overscaledZ||O.y-R.y||O.x-R.x}).map(y=>y.tileID.key):p.map(y=>y.tileID).sort(ll).map(y=>y.key)}hasRenderableParent(n){const s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(n,s,p){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())&&(p||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,s){const p=this._tiles[n];p&&(p.state!=="loading"&&(p.state=s),this._loadTile(p,this._tileLoaded.bind(this,p,n,s)))}_tileLoaded(n,s,p,y){if(y)if(n.state="errored",y.status!==404)this._source.fire(new i.t(y,{tile:n}));else{if(this._source.fire(new i.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform)}else n.timeAdded=i.q.now(),p==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.x("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const s=this.getRenderableIds();for(let y=0;y<s.length;y++){const v=s[y];if(n.neighboringTiles&&n.neighboringTiles[v]){const w=this.getTileByID(v);p(n,w),p(w,n)}}function p(y,v){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let w=v.tileID.canonical.x-y.tileID.canonical.x;const P=v.tileID.canonical.y-y.tileID.canonical.y,R=Math.pow(2,y.tileID.canonical.z),O=v.tileID.key;w===0&&P===0||Math.abs(P)>1||(Math.abs(w)>1&&(Math.abs(w+R)===1?w+=R:Math.abs(w-R)===1&&(w-=R)),v.dem&&y.dem&&(y.dem.backfillBorder(v.dem,w,P),y.neighboringTiles&&y.neighboringTiles[O]&&(y.neighboringTiles[O].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,s,p,y){for(const v in this._tiles){let w=this._tiles[v];if(y[v]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>p)continue;let P=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const O=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[O.key],w&&w.hasData()&&(P=O)}let R=P;for(;R.overscaledZ>s;)if(R=R.scaledTo(R.overscaledZ-1),n[R.key]){y[P.key]=P;break}}}findLoadedParent(n,s){if(n.key in this._loadedParentTiles){const p=this._loadedParentTiles[n.key];return p&&p.tileID.overscaledZ>=s?p:null}for(let p=n.overscaledZ-1;p>=s;p--){const y=n.scaledTo(p),v=this._getLoadedTile(y);if(v)return v}}_getLoadedTile(n){const s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,s){s=s||this._source.tileSize;const p=Math.ceil(n.width/s)+1,y=Math.ceil(n.height/s)+1,v=Math.floor(p*y*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(P)}handleWrapJump(n){const s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){const p={};for(const y in this._tiles){const v=this._tiles[y];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+s),p[v.tileID.key]=v}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(n,s,p,y){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(n,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const v=this._source.type==="batched-model";let w;if(this.used||this.usedForTerrain){if(this._source.tileID)w=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new i.aA(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y));else if(this.tileCoverLift!==0){const O=n.clone();O.tileCoverLift=this.tileCoverLift,w=O.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:v}),this._source.minzoom<=1&&n.projection.name==="globe"&&(w.push(new i.aA(1,0,1,0,0)),w.push(new i.aA(1,0,1,1,0)),w.push(new i.aA(1,0,1,0,1)),w.push(new i.aA(1,0,1,1,1)))}else if(w=n.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:v}),this._source.hasTile){const O=this._source.hasTile.bind(this._source);w=w.filter(F=>O(F))}}else w=[];if(w.length>0&&this.castsShadows&&y&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!$u(this._source.type)){const O=n.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),F=Math.min(O,this._source.maxzoom);if(v){const V=n.extendTileCover(w,F);for(const $ of V)w.push($)}else{const V=n.extendTileCover(w,F,y);for(const $ of V)this._shadowCasterTiles[$.key]=!0,w.push($)}}const P=this._updateRetainedTiles(w);if($u(this._source.type)&&w.length!==0){const O={},F={},V=Object.keys(P);for(const W of V){const ee=P[W],re=this._tiles[W];if(!re||re.fadeEndTime&&re.fadeEndTime<=i.q.now())continue;const ie=this.findLoadedParent(ee,Math.max(ee.overscaledZ-Vo.maxOverzooming,this._source.minzoom));ie&&(this._addTile(ie.tileID),O[ie.tileID.key]=ie.tileID),F[W]=ee}const $=w[w.length-1].overscaledZ;for(const W in this._tiles){const ee=this._tiles[W];if(P[W]||!ee.hasData())continue;let re=ee.tileID;for(;re.overscaledZ>$;){re=re.scaledTo(re.overscaledZ-1);const ie=this._tiles[re.key];if(ie&&ie.hasData()&&F[re.key]){P[W]=ee.tileID;break}}}for(const W in O)P[W]||(this._coveredTiles[W]=!0,P[W]=O[W])}for(const O in P)this._tiles[O].clearFadeHold();const R=i.be(this._tiles,P);for(const O of R){const F=this._tiles[O];F.hasSymbolBuckets&&!F.holdingForFade()?F.setHoldDuration(this.map._fadeDuration):F.hasSymbolBuckets&&!F.symbolFadeFinished()||this._removeTile(+O)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const s={};if(n.length===0)return s;const p={},y=n.reduce((O,F)=>Math.min(O,F.overscaledZ),1/0),v=n[0].overscaledZ,w=Math.max(v-Vo.maxOverzooming,this._source.minzoom),P=Math.max(v+Vo.maxUnderzooming,this._source.minzoom),R={};for(const O of n){const F=this._addTile(O);s[O.key]=O,F.hasData()||y<this._source.maxzoom&&(R[O.key]=O)}this._retainLoadedChildren(R,y,P,s);for(const O of n){let F=this._tiles[O.key];if(F.hasData())continue;if(O.canonical.z>=this._source.maxzoom){const $=O.children(this._source.maxzoom)[0],W=this.getTile($);if(W&&W.hasData()){s[$.key]=$;continue}}else{const $=O.children(this._source.maxzoom);if(s[$[0].key]&&s[$[1].key]&&s[$[2].key]&&s[$[3].key])continue}let V=F.wasRequested();for(let $=O.overscaledZ-1;$>=w;--$){const W=O.scaledTo($);if(p[W.key]||(p[W.key]=!0,F=this.getTile(W),!F&&V&&(F=this._addTile(W)),F&&(s[W.key]=W,V=F.wasRequested(),F.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const s=[];let p,y=this._tiles[n].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}s.push(y.key);const v=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(v),p)break;y=v}for(const v of s)this._loadedParentTiles[v]=p}}_addTile(n){let s=this._tiles[n.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),s;s=this._cache.getAndRemove(n),s&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));const p=!!s;if(!p){const y=this.map?this.map.painter:null,v=this._source.tileSize*n.overscaleFactor();s=this._source.type==="raster-array"?new nh(n,v,this.transform.tileZoom,y,this._isRaster):new ea(n,v,this.transform.tileZoom,y,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))}return s?(s.uses++,this._tiles[n.key]=s,p||this._source.fire(new i.x("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(n,s){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const p=s.getExpiryTimeout();p&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},p))}_removeTile(n){const s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,s,p){const y=[],v=this.transform;if(!v)return y;const w=v.projection.name==="globe",P=i.am(v.center.lng);for(const R in this._tiles){const O=this._tiles[R];if(p&&O.clearQueryDebugViz(),O.holdingForFade())continue;let F;if(w){const V=O.tileID.canonical;if(V.z===0){const $=[Math.abs(i.ap(P,...vc(V,-1))-P),Math.abs(i.ap(P,...vc(V,1))-P)];F=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(i.ap(P,...vc(V,-1))-P),Math.abs(i.ap(P,...vc(V,0))-P),Math.abs(i.ap(P,...vc(V,1))-P)];F=[$.indexOf(Math.min(...$))-1]}}else F=[0];for(const V of F){const $=n.containsTile(O,v,s,V);$&&y.push($)}}return y}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,s){const p=this.getRenderableIds(n,s).map(v=>this._tiles[v].tileID),y=this.transform.projection.name==="globe";for(const v of p)v.projMatrix=this.transform.calculateProjMatrix(v.toUnwrapped()),v.expandedProjMatrix=y?this.transform.calculateProjMatrix(v.toUnwrapped(),!1,!0):v.projMatrix;return p}sortCoordinatesByDistance(n){const s=n.slice(),p=this.transform._camera.position,y=this.transform._camera.forward(),v={};for(const w of s){const P=1/(1<<w.canonical.z);v[w.key]=((w.canonical.x+.5)*P+w.wrap-p[0])*y[0]+((w.canonical.y+.5)*P-p[1])*y[1]-p[2]*y[2]}return s.sort((w,P)=>v[w.key]-v[P.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if($u(this._source.type))for(const n in this._tiles){const s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(n,s,p){this._state.updateState(n=n||"_geojsonTileLayer",s,p)}removeFeatureState(n,s,p){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,p)}getFeatureState(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)}setDependencies(n,s,p){const y=this._tiles[n];y&&y.setDependencies(s,p)}reloadTilesForDependencies(n,s){for(const p in this._tiles)this._tiles[p].hasDependency(n,s)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(n,s))}_preloadTiles(n,s){if(!this._sourceLoaded){const R=()=>{this._sourceLoaded&&(this._source.off("data",R),this._preloadTiles(n,s))};return void this._source.on("data",R)}const p=new Map,y=Array.isArray(n)?n:[n],v=this.map.painter.terrain,w=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const R of y){const O=R.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const F of O)p.set(F.key,F);this.usedForTerrain&&R.updateElevation(!1)}const P=Array.from(p.values());i.bf(P,(R,O)=>{const F=new ea(R,this._source.tileSize*R.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(F,V=>{this._source.type==="raster-dem"&&F.dem&&this._backfillDEM(F),O(V,F)})},s)}}function ll(h,n){const s=Math.abs(2*h.wrap)-+(h.wrap<0),p=Math.abs(2*n.wrap)-+(n.wrap<0);return h.overscaledZ-n.overscaledZ||p-s||n.canonical.y-h.canonical.y||n.canonical.x-h.canonical.x}function $u(h){return h==="raster"||h==="image"||h==="video"||h==="custom"}function vc(h,n){const s=1<<h.z;return[h.x/s+n,(h.x+1)/s+n]}Vo.maxOverzooming=10,Vo.maxUnderzooming=3;class Mf{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,s=!1;for(const p in this.style._mergedLayers){const y=this.style._mergedLayers[p];if(y.type==="fill-extrusion")this.layers.push({layer:y,visible:n,visibilityChanged:s});else if(y.type==="model"){const v=this.style.getLayerSource(y);v&&v.type==="batched-model"&&this.layers.push({layer:y,visible:n,visibilityChanged:s})}}}onNewFrame(n){this.layersGotHidden=!1;for(const s of this.layers){const p=s.layer;let y=!1;p.type==="fill-extrusion"?y=!p.isHidden(n)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(y=!p.isHidden(n)&&p.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!y&&s.visible,s.visible=y}}updateZOffset(n,s){this.currentBuildingBuckets=[];for(const y of this.layers){const v=y.layer,w=this.style.getLayerSourceCache(v);let P=1;v.type==="fill-extrusion"&&(P=y.visible?v.paint.get("fill-extrusion-vertical-scale"):0);let R=w?w.getTile(s):null;if(!R&&w&&s.canonical.z>w.getSource().minzoom){let O=s.scaledTo(Math.min(w.getSource().maxzoom,s.overscaledZ-1));for(;O.overscaledZ>=w.getSource().minzoom&&(R=w.getTile(O),!R&&O.overscaledZ!==0);)O=O.scaledTo(O.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:R?R.getBucket(v):null,tileID:R?R.tileID:s,verticalScale:P})}n.hasAnyZOffset=!1;let p=!1;for(let y=0;y<n.symbolInstances.length;y++){const v=n.symbolInstances.get(y),w=v.zOffset,P=this._getHeightAtTileOffset(s,v.tileAnchorX,v.tileAnchorY);v.zOffset=P!==Number.NEGATIVE_INFINITY?P:w,p||w===v.zOffset||(p=!0),n.hasAnyZOffset||v.zOffset===0||(n.hasAnyZOffset=!0)}p&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,s,p,y){let v=s,w=p;if(n.canonical.z!==y.canonical.z){const P=y.canonical,R=1/(1<<n.canonical.z-P.z);v=(s+n.canonical.x*i.ab)*R-P.x*i.ab|0,w=(p+n.canonical.y*i.ab)*R-P.y*i.ab|0}return{tileX:v,tileY:w}}_getHeightAtTileOffset(n,s,p){let y,v;for(let w=0;w<this.layers.length;++w){if(this.layers[w].layer.type!=="fill-extrusion")continue;const{bucket:P,tileID:R,verticalScale:O}=this.currentBuildingBuckets[w];if(!P)continue;const{tileX:F,tileY:V}=this._mapCoordToOverlappingTile(n,s,p,R),$=P.getHeightAtTileCoord(F,V);$&&$.height!==void 0&&($.hidden?y=$.height:v=Math.max($.height*O,v||0))}if(v!==void 0)return v;for(let w=0;w<this.layers.length;++w){const P=this.layers[w];if(P.layer.type!=="model"||!P.visible)continue;const{bucket:R,tileID:O}=this.currentBuildingBuckets[w];if(!R)continue;const{tileX:F,tileY:V}=this._mapCoordToOverlappingTile(n,s,p,O),$=R.getHeightAtTileCoord(F,V);if($&&!$.hidden)return $.height===void 0&&y!==void 0?Math.min($.maxHeight,y)*$.verticalScale:$.height?$.height*$.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function bc(h,n){const s={};for(const p in h)p!=="ref"&&(s[p]=h[p]);return i.bg.forEach(p=>{p in n&&(s[p]=n[p])}),s}function Ef(h){h=h.slice();const n=Object.create(null);for(let s=0;s<h.length;s++)n[h[s].id]=h[s];for(let s=0;s<h.length;s++)"ref"in h[s]&&(h[s]=bc(h[s],n[h[s].ref]));return h}const vn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function If(h,n,s){s.push({command:vn.addSource,args:[h,n[h]]})}function An(h,n,s){n.push({command:vn.removeSource,args:[h]}),s[h]=!0}function D1(h,n,s,p){An(h,s,p),If(h,n,s)}function Pr(h,n,s){let p;for(p in h[s])if(h[s].hasOwnProperty(p)&&p!=="data"&&!i.bh(h[s][p],n[s][p]))return!1;for(p in n[s])if(n[s].hasOwnProperty(p)&&p!=="data"&&!i.bh(h[s][p],n[s][p]))return!1;return!0}function Uu(h,n,s,p,y,v){let w;for(w in n=n||{},h=h||{})h.hasOwnProperty(w)&&(i.bh(h[w],n[w])||s.push({command:v,args:[p,w,n[w],y]}));for(w in n)n.hasOwnProperty(w)&&!h.hasOwnProperty(w)&&(i.bh(h[w],n[w])||s.push({command:v,args:[p,w,n[w],y]}))}function $l(h){return h.id}function wc(h,n){return h[n.id]=n,h}class ta{constructor(n,s){this.reset(n,s)}reset(n,s){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=i.ap(n,0,1);let s=1,p=this._distances[s];const y=n*this.paddedLength+this.padding;for(;p<y&&s<this._distances.length;)p=this._distances[++s];const v=s-1,w=this._distances[v],P=p-w,R=P>0?(y-w)/P:0;return this.points[v].mult(1-R).add(this.points[s].mult(R))}}class ih{constructor(n,s,p){const y=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(s/p);for(let w=0;w<this.xCellCount*this.yCellCount;w++)y.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,s,p,y,v){this._forEachCell(s,p,y,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(v)}insertCircle(n,s,p,y){this._forEachCell(s-y,p-y,s+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(p),this.circles.push(y)}_insertBoxCell(n,s,p,y,v,w){this.boxCells[v].push(w)}_insertCircleCell(n,s,p,y,v,w){this.circleCells[v].push(w)}_query(n,s,p,y,v,w){if(p<0||n>this.width||y<0||s>this.height)return!v&&[];const P=[];if(n<=0&&s<=0&&this.width<=p&&this.height<=y){if(v)return!0;for(let R=0;R<this.boxKeys.length;R++)P.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const O=this.circles[3*R],F=this.circles[3*R+1],V=this.circles[3*R+2];P.push({key:this.circleKeys[R],x1:O-V,y1:F-V,x2:O+V,y2:F+V})}return w?P.filter(w):P}return this._forEachCell(n,s,p,y,this._queryCell,P,{hitTest:v,seenUids:{box:{},circle:{}}},w),v?P.length>0:P}_queryCircle(n,s,p,y,v){const w=n-p,P=n+p,R=s-p,O=s+p;if(P<0||w>this.width||O<0||R>this.height)return!y&&[];const F=[];return this._forEachCell(w,R,P,O,this._queryCellCircle,F,{hitTest:y,circle:{x:n,y:s,radius:p},seenUids:{box:{},circle:{}}},v),y?F.length>0:F}query(n,s,p,y,v){return this._query(n,s,p,y,!1,v)}hitTest(n,s,p,y,v){return this._query(n,s,p,y,!0,v)}hitTestCircle(n,s,p,y){return this._queryCircle(n,s,p,!0,y)}_queryCell(n,s,p,y,v,w,P,R){const O=P.seenUids,F=this.boxCells[v];if(F!==null){const $=this.bboxes;for(const W of F)if(!O.box[W]){O.box[W]=!0;const ee=4*W;if(n<=$[ee+2]&&s<=$[ee+3]&&p>=$[ee+0]&&y>=$[ee+1]&&(!R||R(this.boxKeys[W]))){if(P.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[W],x1:$[ee],y1:$[ee+1],x2:$[ee+2],y2:$[ee+3]})}}}const V=this.circleCells[v];if(V!==null){const $=this.circles;for(const W of V)if(!O.circle[W]){O.circle[W]=!0;const ee=3*W;if(this._circleAndRectCollide($[ee],$[ee+1],$[ee+2],n,s,p,y)&&(!R||R(this.circleKeys[W]))){if(P.hitTest)return w.push(!0),!0;{const re=$[ee],ie=$[ee+1],ae=$[ee+2];w.push({key:this.circleKeys[W],x1:re-ae,y1:ie-ae,x2:re+ae,y2:ie+ae})}}}}}_queryCellCircle(n,s,p,y,v,w,P,R){const O=P.circle,F=P.seenUids,V=this.boxCells[v];if(V!==null){const W=this.bboxes;for(const ee of V)if(!F.box[ee]){F.box[ee]=!0;const re=4*ee;if(this._circleAndRectCollide(O.x,O.y,O.radius,W[re+0],W[re+1],W[re+2],W[re+3])&&(!R||R(this.boxKeys[ee])))return w.push(!0),!0}}const $=this.circleCells[v];if($!==null){const W=this.circles;for(const ee of $)if(!F.circle[ee]){F.circle[ee]=!0;const re=3*ee;if(this._circlesCollide(W[re],W[re+1],W[re+2],O.x,O.y,O.radius)&&(!R||R(this.circleKeys[ee])))return w.push(!0),!0}}}_forEachCell(n,s,p,y,v,w,P,R){const O=this._convertToXCellCoord(n),F=this._convertToYCellCoord(s),V=this._convertToXCellCoord(p),$=this._convertToYCellCoord(y);for(let W=O;W<=V;W++)for(let ee=F;ee<=$;ee++)if(v.call(this,n,s,p,y,this.xCellCount*ee+W,w,P,R))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,s,p,y,v,w){const P=y-n,R=v-s,O=p+w;return O*O>P*P+R*R}_circleAndRectCollide(n,s,p,y,v,w,P){const R=(w-y)/2,O=Math.abs(n-(y+R));if(O>R+p)return!1;const F=(P-v)/2,V=Math.abs(s-(v+F));if(V>F+p)return!1;if(O<=R||V<=F)return!0;const $=O-R,W=V-F;return $*$+W*W<=p*p}}const Ps={unknown:0,flipRequired:1,flipNotRequired:2},pr=Math.tan(85*Math.PI/180);function fn(h,n,s,p,y,v,w){const P=i.a6.mat4.create();if(s)if(v.name==="globe"){const R=i.bi(y,n);i.a6.mat4.multiply(P,P,R)}else{const R=i.a6.mat2.invert([],w);P[0]=R[0],P[1]=R[1],P[4]=R[2],P[5]=R[3],p||i.a6.mat4.rotateZ(P,P,y.angle)}else i.a6.mat4.multiply(P,y.labelPlaneMatrix,h);return P}function mn(h,n,s,p,y,v,w){const P=fn(h,n,s,p,y,v,w);return v.name==="globe"&&s||(P[2]=P[6]=P[10]=P[14]=0),P}function $o(h,n,s,p,y,v,w){if(s){if(v.name==="globe"){const P=fn(h,n,s,p,y,v,w);return i.a6.mat4.invert(P,P),i.a6.mat4.multiply(P,h,P),P}{const P=i.a6.mat4.clone(h),R=i.a6.mat4.identity([]);return R[0]=w[0],R[1]=w[1],R[4]=w[2],R[5]=w[3],i.a6.mat4.multiply(P,P,R),p||i.a6.mat4.rotateZ(P,P,-y.angle),P}}return y.glCoordMatrix}function xo(h,n,s,p){const y=[h,n,s,1];s?i.a6.vec4.transformMat4(y,y,p):sh(y,y,p);const v=y[3];return y[0]/=v,y[1]/=v,y[2]/=v,y}function xn(h,n){return Math.min(.5+h/n*.5,1.5)}function oh(h,n){const s=h[0]/h[3],p=h[1]/h[3];return s>=-n[0]&&s<=n[0]&&p>=-n[1]&&p<=n[1]}function Sc(h,n,s,p,y,v,w,P,R,O){const F=s.transform,V=p?h.textSizeData:h.iconSizeData,$=i.bj(V,s.transform.zoom),W=F.projection.name==="globe",ee=[256/s.width*2+1,256/s.height*2+1],re=p?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;re.clear();let ie=null;W&&(ie=p?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const ae=h.lineVertexArray,_e=p?h.text.placedSymbolArray:h.icon.placedSymbolArray,Se=s.transform.width/s.transform.height;let ge,Ee=!1;for(let Me=0;Me<_e.length;Me++){const Fe=_e.get(Me),{numGlyphs:Re,writingMode:Ne}=Fe;if(Ne!==i.bk.vertical||Ee||ge===i.bk.horizontal||(Ee=!0),ge=Ne,(Fe.hidden||Ne===i.bk.vertical)&&!Ee){ra(Re,re);continue}Ee=!1;const qe=new i.P(Fe.tileAnchorX,Fe.tileAnchorY);let{x:Ue,y:$e,z:nt}=F.projection.projectTilePoint(qe.x,qe.y,O.canonical);if(R){const[Ct,Pt,xr]=R(qe);Ue+=Ct,$e+=Pt,nt+=xr}const pt=[Ue,$e,nt,1];if(i.a6.vec4.transformMat4(pt,pt,n),!oh(pt,ee)){ra(Re,re);continue}const Mt=pt[3],ht=xn(s.transform.getCameraToCenterDistance(F.projection),Mt),Nt=i.bl(V,$,Fe),it=w?Nt/ht:Nt*ht,St=xo(Ue,$e,nt,y);if(St[3]<=0){ra(Re,re);continue}let _t={};const Vt=w?null:R,Ut=wi(Fe,it,!1,P,n,y,v,h.glyphOffsetArray,ae,re,ie,St,qe,_t,Se,Vt,F.projection,O,w);Ee=Ut.useVertical,Vt&&Ut.needsFlipping&&(_t={}),(Ut.notEnoughRoom||Ee||Ut.needsFlipping&&wi(Fe,it,!0,P,n,y,v,h.glyphOffsetArray,ae,re,ie,St,qe,_t,Se,Vt,F.projection,O,w).notEnoughRoom)&&ra(Re,re)}p?(h.text.dynamicLayoutVertexBuffer.updateData(re),ie&&h.text.globeExtVertexBuffer&&h.text.globeExtVertexBuffer.updateData(ie)):(h.icon.dynamicLayoutVertexBuffer.updateData(re),ie&&h.icon.globeExtVertexBuffer&&h.icon.globeExtVertexBuffer.updateData(ie))}function Tc(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re){const{lineStartIndex:ie,glyphStartIndex:ae,segment:_e}=P,Se=ae+P.numGlyphs,ge=ie+P.lineLength,Ee=n.getoffsetX(ae),Me=n.getoffsetX(Se-1),Fe=Mc(h*Ee,s,p,y,v,w,_e,ie,ge,R,O,F,V,$,!0,W,ee,re);if(!Fe)return null;const Re=Mc(h*Me,s,p,y,v,w,_e,ie,ge,R,O,F,V,$,!0,W,ee,re);return Re?{first:Fe,last:Re}:null}function Eo(h,n,s,p){return h===i.bk.horizontal&&Math.abs(p)>Math.abs(s)?{useVertical:!0}:h===i.bk.vertical?p>0?{needsFlipping:!0}:null:n!==Ps.unknown&&function(y,v){return y===0||Math.abs(v/y)>pr}(s,p)?n===Ps.flipRequired?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null}function wi(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie,ae,_e){const Se=n/24,ge=h.lineOffsetX*Se,Ee=h.lineOffsetY*Se,{lineStartIndex:Me,glyphStartIndex:Fe,numGlyphs:Re,segment:Ne,writingMode:qe,flipState:Ue}=h,$e=Me+h.lineLength,nt=pt=>{if(F){const[it,St,_t]=pt.up,Vt=O.length;i.bm(F,Vt+0,it,St,_t),i.bm(F,Vt+1,it,St,_t),i.bm(F,Vt+2,it,St,_t),i.bm(F,Vt+3,it,St,_t)}const[Mt,ht,Nt]=pt.point;i.bn(O,Mt,ht,Nt,pt.angle)};if(Re>1){const pt=Tc(Se,P,ge,Ee,s,V,$,h,R,v,W,re,!1,ie,ae,_e);if(!pt)return{notEnoughRoom:!0};if(p&&!s){let[Mt,ht,Nt]=pt.first.point,[it,St,_t]=pt.last.point;[Mt,ht]=xo(Mt,ht,Nt,w),[it,St]=xo(it,St,_t,w);const Vt=Eo(qe,Ue,(it-Mt)*ee,St-ht);if(h.flipState=Vt&&Vt.needsFlipping?Ps.flipRequired:Ps.flipNotRequired,Vt)return Vt}nt(pt.first);for(let Mt=Fe+1;Mt<Fe+Re-1;Mt++){const ht=Mc(Se*P.getoffsetX(Mt),ge,Ee,s,V,$,Ne,Me,$e,R,v,W,re,!1,!1,ie,ae,_e);if(!ht)return O.length-=4*(Mt-Fe),{notEnoughRoom:!0};nt(ht)}nt(pt.last)}else{if(p&&!s){const Mt=xo($.x,$.y,0,y),ht=Me+Ne+1,Nt=new i.P(R.getx(ht),R.gety(ht)),it=xo(Nt.x,Nt.y,0,y),St=it[3]>0?it:Cc($,Nt,Mt,1,y,void 0,ie,ae.canonical),_t=Eo(qe,Ue,(St[0]-Mt[0])*ee,St[1]-Mt[1]);if(h.flipState=_t&&_t.needsFlipping?Ps.flipRequired:Ps.flipNotRequired,_t)return _t}const pt=Mc(Se*P.getoffsetX(Fe),ge,Ee,s,V,$,Ne,Me,$e,R,v,W,re,!1,!1,ie,ae,_e);if(!pt)return{notEnoughRoom:!0};nt(pt)}return{}}function Gy(h,n,s,p,y){const{x:v,y:w,z:P}=p.projectTilePoint(h.x,h.y,n);if(!y)return xo(v,w,P,s);const[R,O,F]=y(h);return xo(v+R,w+O,P+F,s)}function Cc(h,n,s,p,y,v,w,P){const R=Gy(h.sub(n)._unit()._add(h),P,y,w,v);return i.a6.vec3.sub(R,s,R),i.a6.vec3.normalize(R,R),i.a6.vec3.scaleAndAdd(R,s,R,p)}function Mc(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie,ae){const _e=p?h-n:h+n;let Se=_e>0?1:-1,ge=0;p&&(Se*=-1,ge=Math.PI),Se<0&&(ge+=Math.PI);let Ee=P+w+(Se>0?0:1)|0,Me=y,Fe=y,Re=0,Ne=0;const qe=Math.abs(_e),Ue=[],$e=[];let nt=v,pt=nt;const Mt=()=>Cc(pt,nt,Fe,qe-Re+1,F,$,re,ie.canonical);for(;Re+Ne<=qe;){if(Ee+=Se,Ee<P||Ee>=R)return null;if(Fe=Me,pt=nt,Ue.push(Fe),W&&$e.push(pt),nt=new i.P(O.getx(Ee),O.gety(Ee)),Me=V[Ee],!Me){const Pt=Gy(nt,ie.canonical,F,re,$);Me=Pt[3]>0?V[Ee]=Pt:Mt()}Re+=Ne,Ne=i.a6.vec3.distance(Fe,Me)}ee&&$&&(V[Ee]&&(Me=Mt(),Ne=i.a6.vec3.distance(Fe,Me)),V[Ee]=Me);const ht=(qe-Re)/Ne,Nt=nt.sub(pt)._mult(ht)._add(pt),it=i.a6.vec3.sub([],Me,Fe),St=i.a6.vec3.scaleAndAdd([],Fe,it,ht);let _t=[0,0,1],Vt=it[0],Ut=it[1];if(ae&&(_t=re.upVector(ie.canonical,Nt.x,Nt.y),_t[0]!==0||_t[1]!==0||_t[2]!==1)){const Pt=[_t[2],0,-_t[0]],xr=i.a6.vec3.cross([],_t,Pt);i.a6.vec3.normalize(Pt,Pt),i.a6.vec3.normalize(xr,xr),Vt=i.a6.vec3.dot(it,Pt),Ut=i.a6.vec3.dot(it,xr)}if(s){const Pt=i.a6.vec3.cross([],_t,it);i.a6.vec3.normalize(Pt,Pt),i.a6.vec3.scaleAndAdd(St,St,Pt,s*Se)}const Ct=ge+Math.atan2(Ut,Vt);return Ue.push(St),W&&$e.push(Nt),{point:St,angle:Ct,path:Ue,tilePath:$e,up:_t}}function ra(h,n){const s=n.length,p=s+4*h;n.resize(p),n.float32.fill(-1/0,4*s,4*p)}function sh(h,n,s){const p=n[0],y=n[1];return h[0]=s[0]*p+s[4]*y+s[12],h[1]=s[1]*p+s[5]*y+s[13],h[3]=s[3]*p+s[7]*y+s[15],h}const es=100;class vo{constructor(n,s,p=new ih(n.width+200,n.height+200,25),y=new ih(n.width+200,n.height+200,25)){this.transform=n,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+es,this.screenBottomBoundary=n.height+es,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=s}placeCollisionBox(n,s,p,y,v,w,P,R){let O=p.projectedAnchorX,F=p.projectedAnchorY,V=p.projectedAnchorZ;const $=p.elevation,W=p.tileID,ee=n.getProjection();if($&&W){const[Me,Fe,Re]=ee.upVector(W.canonical,p.tileAnchorX,p.tileAnchorY),Ne=ee.upVectorScale(W.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;O+=Me*$*Ne,F+=Fe*$*Ne,V+=Re*$*Ne}const re=this.projectAndGetPerspectiveRatio(P,O,F,V,p.tileID,ee.name==="globe"||!!$||this.transform.pitch>0,ee),ie=w*re.perspectiveRatio,ae=(p.x1*s+y.x-p.padding)*ie+re.point.x,_e=(p.y1*s+y.y-p.padding)*ie+re.point.y,Se=(p.x2*s+y.x+p.padding)*ie+re.point.x,ge=(p.y2*s+y.y+p.padding)*ie+re.point.y,Ee=re.perspectiveRatio<=.55||re.occluded;return!this.isInsideGrid(ae,_e,Se,ge)||!v&&this.grid.hitTest(ae,_e,Se,ge,R)||Ee?{box:[],offscreen:!1,occluded:re.occluded}:{box:[ae,_e,Se,ge],offscreen:this.isOffscreen(ae,_e,Se,ge),occluded:!1}}placeCollisionCircles(n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re){const ie=[],ae=this.transform.elevation,_e=n.getProjection(),Se=ae?ae.getAtTileOffsetFunc(re,this.transform.center.lat,this.transform.worldSize,_e):null,ge=new i.P(p.tileAnchorX,p.tileAnchorY);let{x:Ee,y:Me,z:Fe}=_e.projectTilePoint(ge.x,ge.y,re.canonical);if(Se){const[Nt,it,St]=Se(ge);Ee+=Nt,Me+=it,Fe+=St}const Re=_e.name==="globe",Ne=this.projectAndGetPerspectiveRatio(P,Ee,Me,Fe,re,Re||!!ae||this.transform.pitch>0,_e),{perspectiveRatio:qe}=Ne,Ue=(V?w/qe:w*qe)/i.bq,$e=xo(Ee,Me,Fe,R),nt=Ne.signedDistanceFromCamera>0?Tc(Ue,v,p.lineOffsetX*Ue,p.lineOffsetY*Ue,!1,$e,ge,p,y,R,{},ae&&!V?Se:null,V&&!!ae,_e,re,V):null;let pt=!1,Mt=!1,ht=!0;if(nt&&!Ne.occluded){const Nt=.5*W*qe+ee,it=new i.P(-100,-100),St=new i.P(this.screenRightBoundary,this.screenBottomBoundary),_t=new ta,{first:Vt,last:Ut}=nt,Ct=Vt.path.length;let Pt=[];for(let lr=Ct-1;lr>=1;lr--)Pt.push(Vt.path[lr]);for(let lr=1;lr<Ut.path.length;lr++)Pt.push(Ut.path[lr]);const xr=2.5*Nt;O&&(Pt=Pt.map(([lr,Lr,fr],kr)=>(Se&&!Re&&(fr=Se(kr<Ct-1?Vt.tilePath[Ct-1-kr]:Ut.tilePath[kr-Ct+2])[2]),xo(lr,Lr,fr,O))),Pt.some(lr=>lr[3]<=0)&&(Pt=[]));let Kt=[];if(Pt.length>0){let lr=1/0,Lr=-1/0,fr=1/0,kr=-1/0;for(const rn of Pt)lr=Math.min(lr,rn[0]),fr=Math.min(fr,rn[1]),Lr=Math.max(Lr,rn[0]),kr=Math.max(kr,rn[1]);Lr>=it.x&&lr<=St.x&&kr>=it.y&&fr<=St.y&&(Kt=[Pt.map(rn=>new i.P(rn[0],rn[1]))],(lr<it.x||Lr>St.x||fr<it.y||kr>St.y)&&(Kt=i.bo(Kt,it.x,it.y,St.x,St.y)))}for(const lr of Kt){_t.reset(lr,.25*Nt);let Lr=0;Lr=_t.length<=.5*Nt?1:Math.ceil(_t.paddedLength/xr)+1;for(let fr=0;fr<Lr;fr++){const kr=fr/Math.max(Lr-1,1),rn=_t.lerp(kr),Jr=rn.x+es,Ln=rn.y+es;ie.push(Jr,Ln,Nt,0);const Un=Jr-Nt,Qn=Ln-Nt,gs=Jr+Nt,Pi=Ln+Nt;if(ht=ht&&this.isOffscreen(Un,Qn,gs,Pi),Mt=Mt||this.isInsideGrid(Un,Qn,gs,Pi),!s&&this.grid.hitTestCircle(Jr,Ln,Nt,$)&&(pt=!0,!F))return{circles:[],offscreen:!1,collisionDetected:pt,occluded:!1}}}}return{circles:!F&&pt||!Mt?[]:ie,offscreen:ht,collisionDetected:pt,occluded:Ne.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let p=1/0,y=1/0,v=-1/0,w=-1/0;for(const F of n){const V=new i.P(F.x+es,F.y+es);p=Math.min(p,V.x),y=Math.min(y,V.y),v=Math.max(v,V.x),w=Math.max(w,V.y),s.push(V)}const P=this.grid.query(p,y,v,w).concat(this.ignoredGrid.query(p,y,v,w)),R={},O={};for(const F of P){const V=F.key;if(R[V.bucketInstanceId]===void 0&&(R[V.bucketInstanceId]={}),R[V.bucketInstanceId][V.featureIndex])continue;const $=[new i.P(F.x1,F.y1),new i.P(F.x2,F.y1),new i.P(F.x2,F.y2),new i.P(F.x1,F.y2)];i.bp(s,$)&&(R[V.bucketInstanceId][V.featureIndex]=!0,O[V.bucketInstanceId]===void 0&&(O[V.bucketInstanceId]=[]),O[V.bucketInstanceId].push(V.featureIndex))}return O}insertCollisionBox(n,s,p,y,v){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:v},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,s,p,y,v){const w=s?this.ignoredGrid:this.grid,P={bucketInstanceId:p,featureIndex:y,collisionGroupID:v};for(let R=0;R<n.length;R+=4)w.insertCircle(P,n[R],n[R+1],n[R+2])}projectAndGetPerspectiveRatio(n,s,p,y,v,w,P){const R=[s,p,y,1];let O=!1;y||this.transform.pitch>0?(i.a6.vec4.transformMat4(R,R,n),this.fogState&&v&&P.name!=="globe"&&(O=function($,W,ee,re,ie,ae){const _e=ae.calculateFogTileMatrix(ie),Se=[W,ee,re];return i.a6.vec3.transformMat4(Se,Se,_e),or($,i.a6.vec3.length(Se),ae.pitch,ae._fov)}(this.fogState,s,p,y,v.toUnwrapped(),this.transform)>.9)):sh(R,R,n);const F=R[3];return{point:new i.P((R[0]/F+1)/2*this.transform.width+es,(-R[1]/F+1)/2*this.transform.height+es),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/F*.5,1.5),signedDistanceFromCamera:F,occluded:w&&R[2]>F||O}}isOffscreen(n,s,p,y){return p<es||n>=this.screenRightBoundary||y<es||s>this.screenBottomBoundary}isInsideGrid(n,s,p,y){return p>=0&&n<this.gridRightBoundary&&y>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const n=i.a6.mat4.identity([]);return i.a6.mat4.translate(n,n,[-100,-100,0]),n}}function Io(h,n,s){const p=n.createTileMatrix(h,h.worldSize,s.toUnwrapped());return i.a6.mat4.multiply(new Float32Array(16),h.projMatrix,p)}function Hy(h,n,s){if(n.projection.name===s.projection.name)return h.projMatrix;const p=s.clone();return p.setProjection(n.projection),Io(p,n.getProjection(),h)}function cl(h,n,s){return n.name===s.projection.name?h.projMatrix:Io(s,n,h)}class Li{constructor(n,s,p,y){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ko{constructor(n,s,p,y,v,w=!1){this.text=new Li(n?n.text:null,s,p,v),this.icon=new Li(n?n.icon:null,s,y,v),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class As{constructor(n,s,p,y=!1){this.text=n,this.icon=s,this.skipFade=p,this.clipped=y}}class Yi{constructor(){this.invProjMatrix=i.a6.mat4.create(),this.viewportMatrix=i.a6.mat4.create(),this.circles=[]}}class kf{constructor(n,s,p,y,v){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=v}}class Ds{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:p=>p.collisionGroupID===s}}return this.collisionGroups[n]}}function Ec(h,n,s,p,y){const{horizontalAlign:v,verticalAlign:w}=i.bx(h),P=-(v-.5)*n,R=-(w-.5)*s,O=i.bw(h,p);return new i.P(P+O[0]*y,R+O[1]*y)}function Ul(h,n,s,p,y){const v=new i.P(h,n);return s&&v._rotate(p?y:-y),v}class Wl{constructor(n,s,p,y,v,w){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new vo(this.transform,v),this.buildingIndex=w,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ds(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,s,p,y){const v=p.getBucket(s),w=p.latestFeatureIndex;if(!v||!w||s.fqid!==v.layerIds[0])return;const P=v.layers[0].layout,R=v.layers[0].paint,O=p.collisionBoxArray,F=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),V=p.tileSize/i.ab,$=p.tileID.toUnwrapped();this.transform.setProjection(v.projection);const W=(ee=p.tileID,re=v.getProjection(),ie=this.transform,re.name===this.projection?ie.calculateProjMatrix(ee.toUnwrapped()):Io(ie,re,ee));var ee,re,ie;const ae=P.get("text-pitch-alignment")==="map",_e=P.get("text-rotation-alignment")==="map";s.compileFilter();const Se=s.dynamicFilter(),ge=s.dynamicFilterNeedsFeature(),Ee=this.transform.calculatePixelsToTileUnitsMatrix(p),Me=mn(W,p.tileID.canonical,ae,_e,this.transform,v.getProjection(),Ee);let Fe=null;if(ae){const qe=$o(W,p.tileID.canonical,ae,_e,this.transform,v.getProjection(),Ee);Fe=i.a6.mat4.multiply([],this.transform.labelPlaneMatrix,qe)}let Re=null;Se&&p.latestFeatureIndex&&(Re={unwrappedTileID:$,dynamicFilter:Se,dynamicFilterNeedsFeature:ge}),this.retainedQueryData[v.bucketInstanceId]=new kf(v.bucketInstanceId,w,v.sourceLayerIndex,v.index,p.tileID);const Ne={bucket:v,layout:P,paint:R,posMatrix:W,textLabelPlaneMatrix:Me,labelToScreenMatrix:Fe,clippingData:Re,scale:F,textPixelRatio:V,holdingForFade:p.holdingForFade(),collisionBoxArray:O,partiallyEvaluatedTextSize:i.bj(v.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:i.bj(v.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(y)for(const qe of v.sortKeyRanges){const{sortKey:Ue,symbolInstanceStart:$e,symbolInstanceEnd:nt}=qe;n.push({sortKey:Ue,symbolInstanceStart:$e,symbolInstanceEnd:nt,parameters:Ne})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:Ne})}attemptAnchorPlacement(n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie,ae,_e){const{textOffset0:Se,textOffset1:ge,crossTileID:Ee}=$,Me=[Se,ge],Fe=Ec(n,p,y,Me,v),Re=this.collisionIndex.placeCollisionBox(ee,v,s,Ul(Fe.x,Fe.y,w,P,this.transform.angle),V,R,O,F.predicate);if(ie){const Ne=ee.getSymbolInstanceIconSize(_e,this.transform.zoom,$.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ee,Ne,ie,Ul(Fe.x,Fe.y,w,P,this.transform.angle),V,R,O,F.predicate).box.length===0)return}if(Re.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ee]&&this.prevPlacement.placements[Ee]&&this.prevPlacement.placements[Ee].text&&(Ne=this.prevPlacement.variableOffsets[Ee].anchor),this.variableOffsets[Ee]={textOffset:Me,width:p,height:y,anchor:n,textScale:v,prevAnchor:Ne},this.markUsedJustification(ee,n,$,re),ee.allowVerticalPlacement&&(this.markUsedOrientation(ee,re,$),this.placedOrientations[Ee]=re),{shift:Fe,placedGlyphBoxes:Re}}}placeLayerBucketPart(n,s,p,y){const{bucket:v,layout:w,paint:P,posMatrix:R,textLabelPlaneMatrix:O,labelToScreenMatrix:F,clippingData:V,textPixelRatio:$,holdingForFade:W,collisionBoxArray:ee,partiallyEvaluatedTextSize:re,partiallyEvaluatedIconSize:ie,collisionGroup:ae,latestFeatureIndex:_e}=n.parameters,Se=w.get("text-optional"),ge=w.get("icon-optional"),Ee=w.get("text-allow-overlap"),Me=w.get("icon-allow-overlap"),Fe=w.get("text-rotation-alignment")==="map",Re=w.get("text-pitch-alignment")==="map",Ne=w.get("symbol-z-elevate"),qe=P.get("symbol-z-offset"),Ue=P.get("symbol-elevation-reference")==="sea";this.transform.setProjection(v.projection);let $e=Ee&&(Me||!v.hasIconData()||ge),nt=Me&&(Ee||!v.hasTextData()||Se);const pt=!qe.isConstant();!v.collisionArrays&&ee&&v.deserializeCollisionBoxes(ee),p&&y&&v.updateCollisionDebugBuffers(this.transform.zoom,ee);const Mt=(ht,Nt,it)=>{const{crossTileID:St,numVerticalGlyphVertices:_t}=ht;let Vt=null;if(V&&V.dynamicFilterNeedsFeature||pt){const en=this.retainedQueryData[v.bucketInstanceId];Vt=_e.loadFeature({featureIndex:ht.featureIndex,bucketIndex:en.bucketIndex,sourceLayerIndex:en.sourceLayerIndex,layoutVertexArrayOffset:0})}if(V&&!(0,V.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Vt,this.retainedQueryData[v.bucketInstanceId].tileID.canonical,new i.P(ht.tileAnchorX,ht.tileAnchorY),this.transform.calculateDistanceTileData(V.unwrappedTileID)))return this.placements[St]=new As(!1,!1,!1,!0),void s.add(St);const Ut=qe.evaluate(Vt,{});if(s.has(St))return;if(W)return void(this.placements[St]=new As(!1,!1,!1));let Ct=!1,Pt=!1,xr=!0,Kt=!1,lr=!1,Lr=null,fr={box:null,offscreen:null,occluded:null},kr={box:null,offscreen:null,occluded:null},rn=null,Jr=null,Ln=null,Un=0,Qn=0,gs=0;it.textFeatureIndex?Un=it.textFeatureIndex:ht.useRuntimeCollisionCircles&&(Un=ht.featureIndex),it.verticalTextFeatureIndex&&(Qn=it.verticalTextFeatureIndex);const Pi=en=>{en.tileID=this.retainedQueryData[v.bucketInstanceId].tileID;const wn=this.transform.elevation;en.elevation=Ue?Ut:Ut+(wn?wn.getAtTileOffset(en.tileID,en.tileAnchorX,en.tileAnchorY):0),en.elevation+=ht.zOffset},un=it.textBox;if(un){Pi(un);const en=Dn=>{let xi=i.bk.horizontal;if(v.allowVerticalPlacement&&!Dn&&this.prevPlacement){const Ai=this.prevPlacement.placedOrientations[St];Ai&&(this.placedOrientations[St]=Ai,xi=Ai,this.markUsedOrientation(v,xi,ht))}return xi},wn=(Dn,xi)=>{if(v.allowVerticalPlacement&&_t>0&&it.verticalTextBox){for(const Ai of v.writingModes)if(Ai===i.bk.vertical?(fr=xi(),kr=fr):fr=Dn(),fr&&fr.box&&fr.box.length)break}else fr=Dn()};if(w.get("text-variable-anchor")){let Dn=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[St]){const yn=this.prevPlacement.variableOffsets[St];Dn.indexOf(yn.anchor)>0&&(Dn=Dn.filter($i=>$i!==yn.anchor),Dn.unshift(yn.anchor))}const xi=(yn,$i,Xi)=>{const Ui=v.getSymbolInstanceTextSize(re,ht,this.transform.zoom,Nt),Zn=(yn.x2-yn.x1)*Ui+2*yn.padding,Ao=(yn.y2-yn.y1)*Ui+2*yn.padding,Do=ht.hasIconTextFit&&!Me?$i:null;Do&&Pi(Do);let ys={box:[],offscreen:!1,occluded:!1};const ss=Ee?2*Dn.length:Dn.length;for(let Ho=0;Ho<ss;++Ho){const _s=this.attemptAnchorPlacement(Dn[Ho%Dn.length],yn,Zn,Ao,Ui,Fe,Re,$,R,ae,Ho>=Dn.length,ht,Nt,v,Xi,Do,re,ie);if(_s&&(ys=_s.placedGlyphBoxes,ys&&ys.box&&ys.box.length)){Ct=!0,Lr=_s.shift;break}}return ys};wn(()=>xi(un,it.iconBox,i.bk.horizontal),()=>{const yn=it.verticalTextBox;return yn&&Pi(yn),v.allowVerticalPlacement&&!(fr&&fr.box&&fr.box.length)&&_t>0&&yn?xi(yn,it.verticalIconBox,i.bk.vertical):{box:null,offscreen:null,occluded:null}}),fr&&(Ct=fr.box,xr=fr.offscreen,Kt=fr.occluded);const Ai=en(!(!fr||!fr.box));if(!Ct&&this.prevPlacement){const yn=this.prevPlacement.variableOffsets[St];yn&&(this.variableOffsets[St]=yn,this.markUsedJustification(v,yn.anchor,ht,Ai))}}else{const Dn=(xi,Ai)=>{const yn=v.getSymbolInstanceTextSize(re,ht,this.transform.zoom,Nt),$i=this.collisionIndex.placeCollisionBox(v,yn,xi,new i.P(0,0),Ee,$,R,ae.predicate);return $i&&$i.box&&$i.box.length&&(this.markUsedOrientation(v,Ai,ht),this.placedOrientations[St]=Ai),$i};wn(()=>Dn(un,i.bk.horizontal),()=>{const xi=it.verticalTextBox;return v.allowVerticalPlacement&&_t>0&&xi?(Pi(xi),Dn(xi,i.bk.vertical)):{box:null,offscreen:null,occluded:null}}),en(!!(fr&&fr.box&&fr.box.length))}}if(rn=fr,Ct=rn&&rn.box&&rn.box.length>0,xr=rn&&rn.offscreen,Kt=rn&&rn.occluded,ht.useRuntimeCollisionCircles){const en=v.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex>=0?ht.centerJustifiedTextSymbolIndex:ht.verticalPlacedTextSymbolIndex),wn=i.bl(v.textSizeData,re,en),Dn=w.get("text-padding");Jr=this.collisionIndex.placeCollisionCircles(v,Ee,en,v.lineVertexArray,v.glyphOffsetArray,wn,R,O,F,p,Re,ae.predicate,ht.collisionCircleDiameter*wn/i.bq,Dn,this.retainedQueryData[v.bucketInstanceId].tileID),Ct=Ee||Jr.circles.length>0&&!Jr.collisionDetected,xr=xr&&Jr.offscreen,Kt=Jr.occluded}if(it.iconFeatureIndex&&(gs=it.iconFeatureIndex),it.iconBox){const en=wn=>{Pi(wn);const Dn=ht.hasIconTextFit&&Lr?Ul(Lr.x,Lr.y,Fe,Re,this.transform.angle):new i.P(0,0),xi=v.getSymbolInstanceIconSize(ie,this.transform.zoom,ht.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(v,xi,wn,Dn,Me,$,R,ae.predicate)};kr&&kr.box&&kr.box.length&&it.verticalIconBox?(Ln=en(it.verticalIconBox),Pt=Ln.box.length>0):(Ln=en(it.iconBox),Pt=Ln.box.length>0),xr=xr&&Ln.offscreen,lr=Ln.occluded}const Nn=Se||ht.numHorizontalGlyphVertices===0&&_t===0,ui=ge||ht.numIconVertices===0;if(Nn||ui?ui?Nn||(Pt=Pt&&Ct):Ct=Pt&&Ct:Pt=Ct=Pt&&Ct,Ct&&rn&&rn.box&&this.collisionIndex.insertCollisionBox(rn.box,w.get("text-ignore-placement"),v.bucketInstanceId,kr&&kr.box&&Qn?Qn:Un,ae.ID),Pt&&Ln&&this.collisionIndex.insertCollisionBox(Ln.box,w.get("icon-ignore-placement"),v.bucketInstanceId,gs,ae.ID),Jr&&(Ct&&this.collisionIndex.insertCollisionCircles(Jr.circles,w.get("text-ignore-placement"),v.bucketInstanceId,Un,ae.ID),p)){const en=v.bucketInstanceId;let wn=this.collisionCircleArrays[en];wn===void 0&&(wn=this.collisionCircleArrays[en]=new Yi);for(let Dn=0;Dn<Jr.circles.length;Dn+=4)wn.circles.push(Jr.circles[Dn+0]),wn.circles.push(Jr.circles[Dn+1]),wn.circles.push(Jr.circles[Dn+2]),wn.circles.push(Jr.collisionDetected?1:0)}const On=v.projection.name!=="globe";$e=$e&&(On||!Kt),nt=nt&&(On||!lr),this.placements[St]=new As(Ct||$e,Pt||nt,xr||v.justReloaded),s.add(St)};if(Ne&&this.buildingIndex&&(this.buildingIndex.updateZOffset(v,this.retainedQueryData[v.bucketInstanceId].tileID),v.updateZOffset()),v.sortFeaturesByY){const ht=v.getSortedSymbolIndexes(this.transform.angle);for(let Nt=ht.length-1;Nt>=0;--Nt){const it=ht[Nt];Mt(v.symbolInstances.get(it),it,v.collisionArrays[it])}v.hasAnyZOffset&&i.w(`${v.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(v.hasAnyZOffset){const ht=v.getSortedIndexesByZOffset();for(let Nt=0;Nt<ht.length;++Nt){const it=ht[Nt];Mt(v.symbolInstances.get(it),it,v.collisionArrays[it])}}else for(let ht=n.symbolInstanceStart;ht<n.symbolInstanceEnd;ht++)Mt(v.symbolInstances.get(ht),ht,v.collisionArrays[ht]);if(p&&v.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[v.bucketInstanceId];i.a6.mat4.invert(ht.invProjMatrix,R),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(n,s,p,y){const{leftJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:R,crossTileID:O}=p,F=i.bv(s),V=y===i.bk.vertical?R:F==="left"?v:F==="center"?w:F==="right"?P:-1;v>=0&&(n.text.placedSymbolArray.get(v).crossTileID=V>=0&&v!==V?0:O),w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=V>=0&&w!==V?0:O),P>=0&&(n.text.placedSymbolArray.get(P).crossTileID=V>=0&&P!==V?0:O),R>=0&&(n.text.placedSymbolArray.get(R).crossTileID=V>=0&&R!==V?0:O)}markUsedOrientation(n,s,p){const y=s===i.bk.horizontal||s===i.bk.horizontalOnly?s:0,v=s===i.bk.vertical?s:0,{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:O}=p,F=n.text.placedSymbolArray;w>=0&&(F.get(w).placedOrientation=y),P>=0&&(F.get(P).placedOrientation=y),R>=0&&(F.get(R).placedOrientation=y),O>=0&&(F.get(O).placedOrientation=v)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let p=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const y=s?s.symbolFadeChange(n):1,v=s?s.opacities:{},w=s?s.variableOffsets:{},P=s?s.placedOrientations:{};for(const R in this.placements){const O=this.placements[R],F=v[R];F?(this.opacities[R]=new ko(F,y,O.text,O.icon,null,O.clipped),p=p||O.text!==F.text.placed||O.icon!==F.icon.placed):(this.opacities[R]=new ko(null,y,O.text,O.icon,O.skipFade,O.clipped),p=p||O.text||O.icon)}for(const R in v){const O=v[R];if(!this.opacities[R]){const F=new ko(O,y,!1,!1);F.isHidden()||(this.opacities[R]=F,p=p||O.text.placed||O.icon.placed)}}for(const R in w)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=w[R]);for(const R in P)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=P[R]);p?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)}updateLayerOpacities(n,s,p,y){const v=new Set;for(const w of s){const P=w.getBucket(n);P&&w.latestFeatureIndex&&n.fqid===P.layerIds[0]&&(this.updateBucketOpacities(P,v,w,w.collisionBoxArray,p,y,w.tileID,n.scope),P.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(P,w.tileID),P.updateZOffset()))}}updateBucketOpacities(n,s,p,y,v,w,P,R){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const O=n.layers[0].layout,F=n.layers[0].paint,V=!!n.layers[0].dynamicFilter(),$=new ko(null,0,!1,!1,!0),W=O.get("text-allow-overlap"),ee=O.get("icon-allow-overlap"),re=O.get("text-variable-anchor"),ie=O.get("text-rotation-alignment")==="map",ae=O.get("text-pitch-alignment")==="map",_e=F.get("symbol-z-offset"),Se=F.get("symbol-elevation-reference")==="sea",ge=!_e.isConstant(),Ee=new ko(null,0,W&&(ee||!n.hasIconData()||O.get("icon-optional")),ee&&(W||!n.hasTextData()||O.get("text-optional")),!0);!n.collisionArrays&&y&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(y);const Me=(Re,Ne,qe)=>{for(let Ue=0;Ue<Ne/4;Ue++)Re.opacityVertexArray.emplaceBack(qe)};let Fe=0;w&&n.updateReplacement(P,w);for(let Re=0;Re<n.symbolInstances.length;Re++){const Ne=n.symbolInstances.get(Re),{numHorizontalGlyphVertices:qe,numVerticalGlyphVertices:Ue,crossTileID:$e,numIconVertices:nt,tileAnchorX:pt,tileAnchorY:Mt}=Ne;let ht=null;if(Ne&&ge){const Kt=this.retainedQueryData[n.bucketInstanceId];ht=p.latestFeatureIndex.loadFeature({featureIndex:Ne.featureIndex,bucketIndex:Kt.bucketIndex,sourceLayerIndex:Kt.sourceLayerIndex,layoutVertexArrayOffset:0})}const Nt=_e.evaluate(ht,{}),it=s.has($e);let St=this.opacities[$e];it?St=$:St||(St=Ee,this.opacities[$e]=St),s.add($e);const _t=qe>0||Ue>0,Vt=nt>0,Ut=this.placedOrientations[$e],Ct=Ut===i.bk.vertical,Pt=Ut===i.bk.horizontal||Ut===i.bk.horizontalOnly;!_t&&!Vt||St.isHidden()||Fe++;let xr=!1;if((_t||Vt)&&w)for(const Kt of n.activeReplacements){if(i.br(Kt,v,i.bs.Symbol,R)||Kt.min.x>pt||pt>Kt.max.x||Kt.min.y>Mt||Mt>Kt.max.y)continue;const lr=i.bt(pt,Mt,P.canonical,Kt.footprintTileId.canonical);if(xr=i.bu(lr,Kt.footprint),xr)break}if(_t){const Kt=xr?kc:Ic(St.text);Me(n.text,qe,Ct?kc:Kt),Me(n.text,Ue,Pt?kc:Kt);const lr=St.text.isHidden(),{leftJustifiedTextSymbolIndex:Lr,centerJustifiedTextSymbolIndex:fr,rightJustifiedTextSymbolIndex:kr,verticalPlacedTextSymbolIndex:rn}=Ne,Jr=n.text.placedSymbolArray,Ln=lr||Ct?1:0;Lr>=0&&(Jr.get(Lr).hidden=Ln),fr>=0&&(Jr.get(fr).hidden=Ln),kr>=0&&(Jr.get(kr).hidden=Ln),rn>=0&&(Jr.get(rn).hidden=lr||Pt?1:0);const Un=this.variableOffsets[$e];Un&&this.markUsedJustification(n,Un.anchor,Ne,Ut);const Qn=this.placedOrientations[$e];Qn&&(this.markUsedJustification(n,"left",Ne,Qn),this.markUsedOrientation(n,Qn,Ne))}if(Vt){const Kt=xr?kc:Ic(St.icon),{placedIconSymbolIndex:lr,verticalPlacedIconSymbolIndex:Lr}=Ne,fr=n.icon.placedSymbolArray,kr=St.icon.isHidden()?1:0;lr>=0&&(Me(n.icon,nt,Ct?kc:Kt),fr.get(lr).hidden=kr),Lr>=0&&(Me(n.icon,Ne.numVerticalIconVertices,Pt?kc:Kt),fr.get(Lr).hidden=kr)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Kt=n.collisionArrays[Re];if(Kt){let lr=new i.P(0,0),Lr=!0;if(Kt.textBox||Kt.verticalTextBox){if(re){const kr=this.variableOffsets[$e];kr?(lr=Ec(kr.anchor,kr.width,kr.height,kr.textOffset,kr.textScale),ie&&lr._rotate(ae?this.transform.angle:-this.transform.angle)):Lr=!1}V&&(Lr=!St.clipped),Kt.textBox&&ah(n.textCollisionBox.collisionVertexArray,St.text.placed,!Lr||Ct,Nt,Se,lr.x,lr.y),Kt.verticalTextBox&&ah(n.textCollisionBox.collisionVertexArray,St.text.placed,!Lr||Pt,Nt,Se,lr.x,lr.y)}const fr=Lr&&!!(!Pt&&Kt.verticalIconBox);Kt.iconBox&&ah(n.iconCollisionBox.collisionVertexArray,St.icon.placed,fr,Nt,Se,Ne.hasIconTextFit?lr.x:0,Ne.hasIconTextFit?lr.y:0),Kt.verticalIconBox&&ah(n.iconCollisionBox.collisionVertexArray,St.icon.placed,!fr,Nt,Se,Ne.hasIconTextFit?lr.x:0,Ne.hasIconTextFit?lr.y:0)}}}if(n.fullyClipped=Fe===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const Re=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Re.invProjMatrix,n.placementViewportMatrix=Re.viewportMatrix,n.collisionCircleArray=Re.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,s){const p=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function ah(h,n,s,p,y,v,w){h.emplaceBack(n?1:0,s?1:0,v||0,w||0,p,y?1:0),h.emplaceBack(n?1:0,s?1:0,v||0,w||0,p,y?1:0),h.emplaceBack(n?1:0,s?1:0,v||0,w||0,p,y?1:0),h.emplaceBack(n?1:0,s?1:0,v||0,w||0,p,y?1:0)}const ka=Math.pow(2,25),R1=Math.pow(2,24),qy=Math.pow(2,17),Uo=Math.pow(2,16),L1=Math.pow(2,9),lh=Math.pow(2,8),Zy=Math.pow(2,1);function Ic(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const n=h.placed?1:0,s=Math.floor(127*h.opacity);return s*ka+n*R1+s*qy+n*Uo+s*L1+n*lh+s*Zy+n}const kc=0;class z1{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,s,p,y,v){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(s.getBucketParts(w,y,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((P,R)=>P.sortKey-R.sortKey));this._currentPartIndex<w.length;){const P=w[this._currentPartIndex];if(s.placeLayerBucketPart(P,this._seenCrossTileIDs,p,P.symbolInstanceStart===0),this._currentPartIndex++,v())return!0}return!1}}class Wu{constructor(n,s,p,y,v,w,P,R,O){this.placement=new Wl(n,v,w,P,R,O),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(n,s,p,y){const v=i.q.now(),w=()=>{const P=i.q.now()-v;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=s[n[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=R)&&(!P.maxzoom||P.maxzoom>R)){const O=P,F=O.layout.get("symbol-z-elevate"),V=O.layout.get("symbol-sort-key").constantOr(1)!==void 0,$=O.layout.get("symbol-z-order"),W=$==="viewport-y"||$==="auto"&&!($!=="viewport-y"&&V),ee=O.layout.get("text-allow-overlap")||O.layout.get("icon-allow-overlap")||O.layout.get("text-ignore-placement")||O.layout.get("icon-ignore-placement"),re=W&&ee,ie=this._inProgressLayer=this._inProgressLayer||new z1(O),ae=i.av(P.source,P.scope);if(ie.continuePlacement(F||re?y[ae]:p[ae],this.placement,this._showCollisionBoxes,P,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Gl=512/i.ab/2;class O1{constructor(n,s,p){this.tileID=n,this.bucketInstanceId=p,this.index=new i.by(s.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=n.canonical.x*i.ab,v=n.canonical.y*i.ab;for(let w=0;w<s.length;w++){const{key:P,crossTileID:R,tileAnchorX:O,tileAnchorY:F}=s.get(w),V=Math.floor((y+O)*Gl),$=Math.floor((v+F)*Gl);this.index.add(V,$),this.keys.push(P),this.crossTileIDs.push(R)}this.index.finish()}findMatches(n,s,p){const y=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),v=Gl/Math.pow(2,s.canonical.z-this.tileID.canonical.z),w=s.canonical.x*i.ab,P=s.canonical.y*i.ab;for(let R=0;R<n.length;R++){const O=n.get(R);if(O.crossTileID)continue;const{key:F,tileAnchorX:V,tileAnchorY:$}=O,W=Math.floor((w+V)*v),ee=Math.floor((P+$)*v),re=this.index.range(W-y,ee-y,W+y,ee+y);for(const ie of re){const ae=this.crossTileIDs[ie];if(this.keys[ie]===F&&!p.has(ae)){p.add(ae),O.crossTileID=ae;break}}}}}class Pc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Yy{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const s=Math.round((n-this.lng)/360);if(s!==0)for(const p in this.indexes){const y=this.indexes[p],v={};for(const w in y){const P=y[w];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+s),v[P.tileID.key]=P}this.indexes[p]=v}this.lng=n}addBucket(n,s,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let v=0;v<s.symbolInstances.length;v++)s.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const y=this.usedCrossTileIDs[n.overscaledZ];for(const v in this.indexes){const w=this.indexes[v];if(Number(v)>n.overscaledZ)for(const P in w){const R=w[P];R.tileID.isChildOf(n)&&R.findMatches(s.symbolInstances,n,y)}else{const P=w[n.scaledTo(Number(v)).key];P&&P.findMatches(s.symbolInstances,n,y)}}for(let v=0;v<s.symbolInstances.length;v++){const w=s.symbolInstances.get(v);w.crossTileID||(w.crossTileID=p.generate(),y.add(w.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new O1(n,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(n,s){for(const p of s.crossTileIDs)this.usedCrossTileIDs[n].delete(p)}removeStaleBuckets(n){let s=!1;for(const p in this.indexes){const y=this.indexes[p];for(const v in y)n[y[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[v]),delete y[v],s=!0)}return s}}class ch{constructor(){this.layerIndexes={},this.crossTileIDs=new Pc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,s,p,y){let v=this.layerIndexes[n.fqid];v===void 0&&(v=this.layerIndexes[n.fqid]=new Yy);let w=!1;const P={};y.name!=="globe"&&v.handleWrapJump(p);for(const R of s){const O=R.getBucket(n);O&&n.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(R.tileID,O,this.crossTileIDs)&&(w=!0),P[O.bucketInstanceId]=!0)}return v.removeStaleBuckets(P)&&(w=!0),w}pruneUnusedLayers(n){const s={};n.forEach(p=>{s[p]=!0});for(const p in this.layerIndexes)s[p]||delete this.layerIndexes[p]}}const ts=771;class cn{constructor(n,s,p,y){this.blendFunction=n,this.blendColor=s,this.mask=p,this.blendEquation=y}}cn.Replace=[1,0,1,0],cn.disabled=new cn(cn.Replace,i.bz.transparent,[!1,!1,!1,!1]),cn.unblended=new cn(cn.Replace,i.bz.transparent,[!0,!0,!0,!0]),cn.alphaBlended=new cn([1,ts,1,ts],i.bz.transparent,[!0,!0,!0,!0]),cn.alphaBlendedNonPremultiplied=new cn([770,ts,770,ts],i.bz.transparent,[!0,!0,!0,!0]),cn.multiply=new cn([774,0,774,0],i.bz.transparent,[!0,!0,!0,!0]);class Tr{constructor(n,s,p){this.func=n,this.mask=s,this.range=p}}Tr.ReadOnly=!1,Tr.ReadWrite=!0,Tr.disabled=new Tr(519,Tr.ReadOnly,[0,1]);const Pf=7680;class qr{constructor(n,s,p,y,v,w){this.test=n,this.ref=s,this.mask=p,this.fail=y,this.depthFail=v,this.pass=w}}qr.disabled=new qr({func:519,mask:0},0,0,Pf,Pf,Pf);const Af=1029,Gu=2305;class Nr{constructor(n,s,p){this.enable=n,this.mode=s,this.frontFace=p}}function Df(h,n){const s=i.bC(h,3);i.a6.mat4.fromQuat(h,n),i.bE(h,3,s)}function uh(h,n){const s=i.a6.quat.identity([]);return i.a6.quat.rotateZ(s,s,-n),i.a6.quat.rotateX(s,s,-h),s}function Rf(h,n){const s=[h[0],h[1],0],p=[n[0],n[1],0];if(i.a6.vec3.length(s)>=1e-15){const w=i.a6.vec3.normalize([],s);i.a6.vec3.scale(p,w,i.a6.vec3.dot(p,w)),n[0]=p[0],n[1]=p[1]}const y=i.a6.vec3.cross([],n,h);if(i.a6.vec3.len(y)<1e-15)return null;const v=Math.atan2(-y[1],y[0]);return uh(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),v)}Nr.disabled=new Nr(!1,Af,Gu),Nr.backCCW=new Nr(!0,Af,Gu),Nr.backCW=new Nr(!0,Af,2304),Nr.frontCW=new Nr(!0,1028,2304),Nr.frontCCW=new Nr(!0,1028,Gu);class ul{constructor(n,s){this.position=n,this.orientation=s}get position(){return this._position}set position(n){if(n){const s=n instanceof i.a5?n:new i.a5(n[0],n[1],n[2]);this._renderWorldCopies&&(s.x=i.bA(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(n,s){if(this.orientation=null,!this.position)return;const p=this.position,y=this._elevation?this._elevation.getAtPointOrZero(i.a5.fromLngLat(n)):0,v=i.a5.fromLngLat(n,y),w=[v.x-p.x,v.y-p.y,v.z-p.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=Rf(w,s)}setPitchBearing(n,s){this.orientation=uh(i.bB(n),i.bB(-s))}}class Hl{constructor(n,s){this._transform=i.a6.mat4.identity([]),this.orientation=s,this.position=n}get mercatorPosition(){const n=this.position;return new i.a5(n[0],n[1],n[2])}get position(){const n=i.bC(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var s;n&&i.bE(this._transform,3,[(s=n)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||i.a6.quat.identity([]),n&&Df(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,s){this._orientation=uh(n,s),Df(this._transform,this._orientation)}forward(){const n=i.bC(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=i.bC(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=i.bC(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,s){const p=new Float64Array(16);return i.a6.mat4.invert(p,this.getWorldToCamera(n,s)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,s,p){const y=this.position;i.a6.vec3.scale(y,y,-n);const v=new Float64Array(16);return i.a6.mat4.fromScaling(v,[p,p,p]),i.a6.mat4.translate(v,v,y),v[10]*=s,v}getWorldToCamera(n,s){const p=new Float64Array(16),y=new Float64Array(4),v=this.position;return i.a6.quat.conjugate(y,this._orientation),i.a6.vec3.scale(v,v,-n),i.a6.mat4.fromQuat(p,y),i.a6.mat4.translate(p,p,v),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=s,p[9]*=s,p[10]*=s,p[11]*=s,p}getCameraToClipPerspective(n,s,p,y){const v=new Float64Array(16);return i.a6.mat4.perspective(v,n,s,p,y),v}getCameraToClipOrthographic(n,s,p,y,v,w){const P=new Float64Array(16);return i.a6.mat4.ortho(P,n,s,p,y,v,w),P}getDistanceToElevation(n,s=!1){const p=n===0?0:i.bD(n,s?i.aM(this.position[1]):this.position[1]),y=this.forward();return(p-this.position[2])/y[2]}clone(){return new Hl([...this.position],[...this.orientation])}}const ho={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class dh{constructor(n=0,s=0,p=0,y=0){if(isNaN(n)||n<0||isNaN(s)||s<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=p,this.right=y}interpolate(n,s,p){return s.top!=null&&n.top!=null&&(this.top=i.aa(n.top,s.top,p)),s.bottom!=null&&n.bottom!=null&&(this.bottom=i.aa(n.bottom,s.bottom,p)),s.left!=null&&n.left!=null&&(this.left=i.aa(n.left,s.left,p)),s.right!=null&&n.right!=null&&(this.right=i.aa(n.right,s.right,p)),this}getCenter(n,s){const p=i.ap((this.left+n-this.right)/2,0,n),y=i.ap((this.top+s-this.bottom)/2,0,s);return new i.P(p,y)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new dh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ac=(h,n,s)=>(1-s)*h+s*n,Dc=h=>h*h*h*h*h;class hh{constructor(n,s,p,y,v,w,P){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=p??0,this._maxPitch=y??60,this.setProjection(w),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new i.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new dh,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Hl,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const n=new hh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,s=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(n||p)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return i.ar(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=i.bL(this.projectionOptions);const p=this.getProjection(),y=!i.bh(s,p);return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bL({name:"mercator"});const s=n!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bA(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const s=-n*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=i.a6.mat2.create(),i.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const s=i.ap(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=i.bB(n),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,s=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!s||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;s||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,v=0;for(let w=0;w<s.length;w++){const P=new i.P(s[w][0]*this.width,p+s[w][1]*(this.height-p)),R=n.pointCoordinate(P);if(!R)continue;const O=1/Math.hypot(R[0]-this._camera.position[0],R[1]-this._camera.position[1]);y+=R[3]*O,v+=O}return v===0?NaN:y/v}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*s,y=this._mercatorZfromZoom(n),v=this._mercatorZfromZoom(this._maxZoom),w=Math.max(y-p,v);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let p;p=n.z<this._camera.position[2]?[s.x,s.y,s.z]:[n.x,n.y,n.z];const y=i.a6.vec3.length(i.a6.vec3.sub([],this._camera.position,p));return i.ap(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let s=!1;if(n.orientation&&!i.a6.quat.exactEquals(n.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(n.orientation)),n.position){const p=[n.position.x,n.position.y,n.position.z];i.a6.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,s=new ul;return s.position=new i.a5(n[0],n[1],n[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(n){if(!i.a6.quat.length(n))return!1;i.a6.quat.normalize(n,n);const s=i.a6.vec3.transformQuat([],[0,0,-1],n),p=i.a6.vec3.transformQuat([],[0,-1,0],n);if(p[2]<0)return!1;const y=Rf(s,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(n){const s=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;n[2]=i.ap(n[2],y/p,y/s),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,s,p){this._unmodified=!1,this._edgeInsets.interpolate(n,s,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(n){const s=[new i.bM(0,n)];if(this.renderWorldCopies){const p=this.pointCoordinate(new i.P(0,0)),y=this.pointCoordinate(new i.P(this.width,0)),v=this.pointCoordinate(new i.P(this.width,this.height)),w=this.pointCoordinate(new i.P(0,this.height)),P=Math.floor(Math.min(p.x,y.x,v.x,w.x)),R=Math.floor(Math.max(p.x,y.x,v.x,w.x)),O=1;for(let F=P-O;F<=R+O;F++)F!==0&&s.push(new i.bM(F,n))}return s}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,s,p){let y=[];const v=p!==void 0,w=!v;if(w&&this.zoom<s||v&&p[0]===0&&p[1]===0)return y;const P=new Set,R=(F,V,$,W,ee)=>{const re=i.c1(V,F,$,W,ee);P.has(re)||(y.push(new i.aA(F,V,$,W,ee)),P.add(re))};for(let F=0;F<n.length;F++){const V=n[F];if(w&&V.canonical.z!==s)continue;const $=V.canonical,W=V.overscaledZ,ee=V.wrap,re=1<<$.z,ie=$.x+1<re,ae=$.x>0,_e=$.y+1<re,Se=$.y>0,ge=V.wrap-(ae?0:1),Ee=V.wrap+(ie?0:1),Me=ae?$.x-1:re-1,Fe=ie?$.x+1:0;if(v)p[0]<0?(R(W,Ee,$.z,Fe,$.y),p[1]<0&&_e&&(R(W,ee,$.z,$.x,$.y+1),R(W,Ee,$.z,Fe,$.y+1)),p[1]>0&&Se&&(R(W,ee,$.z,$.x,$.y-1),R(W,Ee,$.z,Fe,$.y-1))):p[0]>0?(R(W,ge,$.z,Me,$.y),p[1]<0&&_e&&(R(W,ee,$.z,$.x,$.y+1),R(W,ge,$.z,Me,$.y+1)),p[1]>0&&Se&&(R(W,ee,$.z,$.x,$.y-1),R(W,ge,$.z,Me,$.y-1))):p[1]<0&&_e?R(W,ee,$.z,$.x,$.y+1):Se&&R(W,ee,$.z,$.x,$.y-1);else{const Re=V.visibleQuadrants;1&Re&&(R(W,ge,$.z,Me,$.y),Se&&(R(W,ee,$.z,$.x,$.y-1),R(W,ge,$.z,Me,$.y-1))),2&Re&&(R(W,Ee,$.z,Fe,$.y),Se&&(R(W,ee,$.z,$.x,$.y-1),R(W,Ee,$.z,Fe,$.y-1))),4&Re&&(R(W,ge,$.z,Me,$.y),_e&&(R(W,ee,$.z,$.x,$.y+1),R(W,ge,$.z,Me,$.y+1))),8&Re&&(R(W,Ee,$.z,Fe,$.y),_e&&(R(W,ee,$.z,$.x,$.y+1),R(W,Ee,$.z,Fe,$.y+1)))}}const O=[];for(const F of y)y.some(V=>F.isChildOf(V))||O.push(F);if(y=O.filter(F=>!n.some(V=>!!(F.overscaledZ<s&&V.isChildOf(F))||F.equals(V)||F.isChildOf(V))),w){const F=1<<s,V=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),$=[F*V.x,F*V.y],W=4,ee=W*W;y=y.filter(re=>{const ie=re.canonical.x+.5-$[0],ae=re.canonical.y+.5-$[1];return ie*ie+ae*ae<ee})}return y}coveringTiles(n){let s=this.coveringZoomLevel(n);const p=s,y=this.elevation&&this.elevation.exaggeration(),v=y&&!n.isTerrainDEM,w=this.projection.name==="mercator";if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);const P=this.locationCoordinate(this.center),R=this.center.lat,O=1<<s,F=[O*P.x,O*P.y,0],V=this.projection.name==="globe",$=!V,W=i.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,$),ee=V?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),re=O*i.bD(1,this.center.lat),ie=this._camera.position[2]/i.bD(1,this.center.lat),ae=[O*ee.x,O*ee.y,ie*($?1:re)],_e=V||y,Se=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),ge=this.isLODDisabled(!0)?s:0;let Ee;if(this._elevation&&n.isTerrainDEM)Ee=1e4*this._elevation.exaggeration();else if(this._elevation){const it=this._elevation.getMinMaxForVisibleTiles();Ee=it?it.max:this._centerAltitude}else Ee=this._centerAltitude;const Me=n.isTerrainDEM?-Ee:this._elevation?this._elevation.getMinElevationBelowMSL():0,Fe=this.projection.isReprojectedInTileSpace?i.bO(this):1,Re=it=>{const _t=new i.a5(it.x+25e-6,it.y,it.z),Vt=new i.a5(it.x,it.y+25e-6,it.z),Ut=it.toLngLat(),Ct=_t.toLngLat(),Pt=Vt.toLngLat(),xr=this.locationCoordinate(Ut),Kt=this.locationCoordinate(Ct),lr=this.locationCoordinate(Pt),Lr=Math.hypot(Kt.x-xr.x,Kt.y-xr.y),fr=Math.hypot(lr.x-xr.x,lr.y-xr.y);return Math.sqrt(Lr*fr)*Fe/25e-6},Ne=it=>{const St=Ee,_t=Me;return{aabb:i.bR(this,O,0,0,0,it,_t,St,this.projection),zoom:0,x:0,y:0,minZ:_t,maxZ:St,wrap:it,fullyVisible:!1}},qe=[];let Ue=[];const $e=s,nt=n.reparseOverscaled?p:s,pt=(ie-this._centerAltitude)*re,Mt=it=>{if(!this._elevation||!it.tileID||!w)return;const St=this._elevation.getMinMaxForTile(it.tileID),_t=it.aabb;St?(_t.min[2]=St.min,_t.max[2]=St.max,_t.center[2]=(_t.min[2]+_t.max[2])/2):(it.shouldSplit=Nt(it),it.shouldSplit||(_t.min[2]=_t.max[2]=_t.center[2]=this._centerAltitude))},ht=(it,St)=>{if(.707*St<it)return 1;const _t=St/it;return _t/(1.4144271570014144+(Math.pow(1.1,_t-1.4144271570014144+1)-1)/(1.1-1)-1)},Nt=it=>{if(it.zoom<ge)return!0;if(it.zoom===$e)return!1;if(it.shouldSplit!=null)return it.shouldSplit;const St=it.aabb.distanceX(ae),_t=it.aabb.distanceY(ae);let Vt=pt,Ut=1;if(V){Vt=it.aabb.distanceZ(ae);const fr=Math.pow(2,it.zoom),kr=i.aM((it.y+1)/fr),rn=i.aM(it.y/fr),Jr=Math.min(Math.max(R,kr),rn),Ln=i.c5(Jr)/i.c5(R);if(Ut=Jr===R?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ln/this._mercatorScaleRatio),this.zoom<=i.c2&&it.zoom===$e-1&&Ln>=.9)return!0}else if(v&&(Vt=it.aabb.distanceZ(ae)*re),this.projection.isReprojectedInTileSpace&&p<=5){const fr=Math.pow(2,it.zoom),kr=Re(new i.a5((it.x+.5)/fr,(it.y+.5)/fr));Ut=kr>.85?1:kr}if(!w){const fr=Math.sqrt(St*St+_t*_t+Vt*Vt);let kr=(1<<$e-it.zoom)*Se*Ut;return kr*=ht(Math.max(Vt,pt),fr),fr<kr}let Ct=Number.MAX_VALUE,Pt=0;const xr=it.aabb.getCorners(),Kt=[];for(const fr of xr){i.a6.vec3.sub(Kt,fr,ae),V||(v?Kt[2]*=re:Kt[2]=pt);const kr=i.a6.vec3.dot(Kt,this._camera.forward());kr<Ct&&(Ct=kr,Pt=Math.abs(Kt[2]))}let lr=(1<<$e-it.zoom)*Se*Ut;if(lr*=ht(Math.max(Pt,pt),Ct),Ct<lr)return!0;const Lr=it.aabb.closestPoint(F);return Lr[0]===F[0]&&Lr[1]===F[1]};if(this.renderWorldCopies)for(let it=1;it<=3;it++)qe.push(Ne(-it)),qe.push(Ne(it));for(qe.push(Ne(0));qe.length>0;){const it=qe.pop(),St=it.x,_t=it.y;let Vt=it.fullyVisible;const Ut=()=>this.projection.name==="globe"&&(it.y===0||it.y===(1<<it.zoom)-1);if(!Vt){let Ct=_e?it.aabb.intersects(W):it.aabb.intersectsFlat(W);if(Ct===0&&Ut()){const Pt=new i.bP(it.zoom,St,_t);Ct=i.bQ(this,O,Pt,!0).intersects(W)}if(Ct===0)continue;Vt=Ct===2}if(it.zoom!==$e&&Nt(it))for(let Ct=0;Ct<4;Ct++){const Pt=(St<<1)+Ct%2,xr=(_t<<1)+(Ct>>1),Kt={aabb:w?it.aabb.quadrant(Ct):i.bR(this,O,it.zoom+1,Pt,xr,it.wrap,it.minZ,it.maxZ,this.projection),zoom:it.zoom+1,x:Pt,y:xr,wrap:it.wrap,fullyVisible:Vt,tileID:void 0,shouldSplit:void 0,minZ:it.minZ,maxZ:it.maxZ};v&&!V&&(Kt.tileID=new i.aA(it.zoom+1===$e?nt:it.zoom+1,it.wrap,it.zoom+1,Pt,xr),Mt(Kt)),qe.push(Kt)}else{const Ct=it.zoom===$e?nt:it.zoom;if(n.minzoom&&n.minzoom>Ct)continue;let Pt=0;if(!Vt){let Lr=_e?it.aabb.intersectsPrecise(W):it.aabb.intersectsPreciseFlat(W);if(Lr===0&&Ut()){const fr=new i.bP(it.zoom,St,_t);Lr=i.bQ(this,O,fr,!0).intersectsPrecise(W)}if(Lr===0)continue;if(n.calculateQuadrantVisibility)if(W.containsPoint(it.aabb.center))Pt=15;else for(let fr=0;fr<4;fr++)it.aabb.quadrant(fr).intersects(W)!==0&&(Pt|=1<<fr)}const xr=F[0]-(.5+St+(it.wrap<<it.zoom))*(1<<s-it.zoom),Kt=F[1]-.5-_t,lr=it.tileID?it.tileID:new i.aA(Ct,it.wrap,it.zoom,St,_t);n.calculateQuadrantVisibility&&(lr.visibleQuadrants=Pt),Ue.push({tileID:lr,distanceSq:xr*xr+Kt*Kt})}}if(this.fogCullDistSq){const it=this.fogCullDistSq,St=this.horizonLineFromTop();Ue=Ue.filter(_t=>{const Vt=[0,0,0,1],Ut=[i.ab,i.ab,0,1],Ct=this.calculateFogTileMatrix(_t.tileID.toUnwrapped());i.a6.vec4.transformMat4(Vt,Vt,Ct),i.a6.vec4.transformMat4(Ut,Ut,Ct);const Pt=i.a6.vec4.min([],Vt,Ut),xr=i.a6.vec4.max([],Vt,Ut),Kt=i.bS(Pt,xr);if(Kt===0)return!0;let lr=!1;const Lr=this._elevation;if(Lr&&Kt>it&&St!==0){const fr=this.calculateProjMatrix(_t.tileID.toUnwrapped());let kr;n.isTerrainDEM||(kr=Lr.getMinMaxForTile(_t.tileID)),kr||(kr={min:Me,max:Ee});const rn=i.c3(this.rotation),Jr=[rn[0]*i.ab,rn[1]*i.ab,kr.max];i.a6.vec3.transformMat4(Jr,Jr,fr),lr=(1-Jr[1])*this.height*.5<St}return Kt<it||lr})}return Ue.sort((it,St)=>it.distanceSq-St.distanceSq).map(it=>it.tileID)}resize(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const s=i.ap(n.lat,-i.bT,i.bT),p=this.projection.project(n.lng,s);return new i.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,s){let p,y;const v=this.centerPoint;if(this.projection.name==="globe"){const P=this.worldSize;p=(s.x-v.x)/P,y=(s.y-v.y)/P}else{const P=this.pointCoordinate(s),R=this.pointCoordinate(v);p=P.x-R.x,y=P.y-R.y}const w=this.locationCoordinate(n);this.setLocation(new i.a5(w.x-p,w.y-y))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,s){const p=s?i.bD(s,n.lat):void 0,y=this.projection.project(n.lng,n.lat);return new i.a5(y.x,y.y,p)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,s){const p=s??this._centerAltitude,y=[n.x,n.y,0,1],v=[n.x,n.y,1,1];i.a6.vec4.transformMat4(y,y,this.pixelMatrixInverse),i.a6.vec4.transformMat4(v,v,this.pixelMatrixInverse);const w=v[3];i.a6.vec4.scale(y,y,1/y[3]),i.a6.vec4.scale(v,v,1/w);const P=y[2],R=v[2];return{p0:y,p1:v,t:P===R?0:(p-P)/(R-P)}}screenPointToMercatorRay(n){const s=[n.x,n.y,0,1],p=[n.x,n.y,1,1];return i.a6.vec4.transformMat4(s,s,this.pixelMatrixInverse),i.a6.vec4.transformMat4(p,p,this.pixelMatrixInverse),i.a6.vec4.scale(s,s,1/s[3]),i.a6.vec4.scale(p,p,1/p[3]),s[2]=i.bD(s[2],this._center.lat)*this.worldSize,p[2]=i.bD(p[2],this._center.lat)*this.worldSize,i.a6.vec4.scale(s,s,1/this.worldSize),i.a6.vec4.scale(p,p,1/this.worldSize),new i.aj([s[0],s[1],s[2]],i.a6.vec3.normalize([],i.a6.vec3.sub([],p,s)))}rayIntersectionCoordinate(n){const{p0:s,p1:p,t:y}=n,v=i.bD(s[2],this._center.lat),w=i.bD(p[2],this._center.lat);return new i.a5(i.aa(s[0],p[0],y)/this.worldSize,i.aa(s[1],p[1],y)/this.worldSize,i.aa(v,w,y))}pointCoordinate(n,s=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,s)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let s=this.projection.pointCoordinate3D(this,n.x,n.y);if(s)return new i.a5(s[0],s[1],s[2]);let p=0,y=this.horizonLineFromTop();if(n.y>y)return this.pointCoordinate(n);const v=.02*y,w=n.clone();for(let P=0;P<10&&y-p>v;P++){w.y=i.aa(p,y,.66);const R=this.projection.pointCoordinate3D(this,w.x,w.y);R?(y=w.y,s=R):p=w.y}return s?new i.a5(s[0],s[1],s[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=i.bU)return!this.isPointAboveHorizon(n);const s=this.pointCoordinate(n);return s.y>=0&&s.y<=1}_coordinatePoint(n,s){const p=s&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,y=[n.x*this.worldSize,n.y*this.worldSize,p+n.toAltitude(),1];return i.a6.vec4.transformMat4(y,y,this.pixelMatrix),y[3]>0?new i.P(y[0]/y[3],y[1]/y[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:s}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,v=this.pointLocation3D(new i.P(s,n)),w=this.pointLocation3D(new i.P(y,n)),P=this.pointLocation3D(new i.P(y,p)),R=this.pointLocation3D(new i.P(s,p));let O=Math.min(v.lng,w.lng,P.lng,R.lng),F=Math.max(v.lng,w.lng,P.lng,R.lng),V=Math.min(v.lat,w.lat,P.lat,R.lat),$=Math.max(v.lat,w.lat,P.lat,R.lat);const W=Math.pow(2,-this.zoom)/16*270,ee=this.projection.name==="globe"?1:4,re=(ie,ae,_e,Se,ge)=>{const Ee=(ie+_e)/2,Me=(ae+Se)/2,Fe=new i.P(Ee,Me),{lng:Re,lat:Ne}=this.pointLocation3D(Fe),qe=Math.max(0,O-Re,V-Ne,Re-F,Ne-$);O=Math.min(O,Re),F=Math.max(F,Re),V=Math.min(V,Ne),$=Math.max($,Ne),(ge<ee||qe>W)&&(re(ie,ae,Ee,Me,ge+1),re(Ee,Me,_e,Se,ge+1))};if(re(s,n,y,n,1),re(y,n,y,p,1),re(y,p,s,p,1),re(s,p,s,n,1),this.projection.name==="globe"){const[ie,ae]=i.bV(this);ie?($=90,F=180,O=-180):ae&&(V=-90,F=180,O=-180)}return new i.as(new i.bK(O,V),new i.bK(F,$))}_getBoundsRectangular(n,s){const{top:p,left:y}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,P=new i.P(y,p),R=new i.P(w,p),O=new i.P(w,v),F=new i.P(y,v);let V=this.pointCoordinate(P,n),$=this.pointCoordinate(R,n);const W=this.pointCoordinate(O,s),ee=this.pointCoordinate(F,s),re=(ie,ae)=>(ae.y-ie.y)/(ae.x-ie.x);return V.y>1&&$.y>=0?V=new i.a5((1-ee.y)/re(ee,V)+ee.x,1):V.y<0&&$.y<=1&&(V=new i.a5(-ee.y/re(ee,V)+ee.x,0)),$.y>1&&V.y>=0?$=new i.a5((1-W.y)/re(W,$)+W.x,1):$.y<0&&V.y<=1&&($=new i.a5(-W.y/re(W,$)+W.x,0)),new i.as().extend(this.coordinateLocation(V)).extend(this.coordinateLocation($)).extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(W))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const s=n.visibleDemTiles.reduce((p,y)=>{if(y.dem){const v=y.dem.tree;p.min=Math.min(p.min,v.minimums[0]),p.max=Math.max(p.max,v.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(s.min*n.exaggeration(),s.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-s*(1-this._horizonShift);return n?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-i.bT,this.maxLat=i.bT,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.am(this.minLng)*this.tileSize,this.worldMaxX=i.am(this.maxLng)*this.tileSize,this.worldMinY=i.at(this.maxLat)*this.tileSize,this.worldMaxY=i.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,s){return this.projection.createTileMatrix(this,s,n)}calculateDistanceTileData(n){const s=n.key,p=this._distanceTileDataCache;if(p[s])return p[s];const y=n.canonical,v=1/this.height,w=this.cameraWorldSize,P=w/this.zoomScale(y.z),R=(y.x+Math.pow(2,y.z)*n.wrap)*P,O=y.y*P,F=this.point;F.x*=w/this.worldSize,F.y*=w/this.worldSize;const V=this.angle,$=Math.sin(-V),W=-Math.cos(-V);return p[s]={bearing:[$,W],center:[(F.x-R)*v,(F.y-O)*v],scale:P/i.ab*v},p[s]}calculateFogTileMatrix(n){const s=n.key,p=this._fogTileMatrixCache;if(p[s])return p[s];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return i.a6.mat4.multiply(y,this.worldToFogMatrix,y),p[s]=new Float32Array(y),p[s]}calculateProjMatrix(n,s=!1,p=!1){const y=n.key;let v;if(v=p?this._expandedProjMatrixCache:s?this._alignedProjMatrixCache:this._projMatrixCache,v[y])return v[y];const w=this.calculatePosMatrix(n,this.worldSize);let P;return P=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:s?this.alignedProjMatrix:this.projMatrix,i.a6.mat4.multiply(w,P,w),v[y]=new Float32Array(w),v[y]}calculatePixelsToTileUnitsMatrix(n){const s=n.tileID.key,p=this._pixelsToTileUnitsCache;if(p[s])return p[s];const y=i.bW(n,this);return p[s]=y,p[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,s=i.a6.mat4.fromScaling([],[n,n,n]);return i.a6.mat4.multiply(s,s,this.globeMatrix),s}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const s=i.bD(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(s),y=this._camera.forward(),v=i.bD(1,this._center.lat);p[2]/=v,y[2]/=v,i.a6.vec3.normalize(y,y);const w=n.raycast(p,y,n.exaggeration());if(w){const P=i.a6.vec3.scaleAndAdd([],p,y,w),R=new i.a5(P[0],P[1],i.bD(P[2],i.aM(P[1]))),O=(R.z+i.a6.vec3.length([R.x-p[0],R.y-p[1],R.z-p[2]*v]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=R.toAltitude(),this._center=this.coordinateLocation(R),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const s=this._elevation,p=i.bD(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(p),v=s.getAtPointOrZero(new i.a5(...y)),w=this.pixelsPerMeter/this.worldSize*v,P=this._minimumHeightOverTerrain(),R=y[2]-w;if(R<=P)if(R<0||n){const O=this.locationCoordinate(this._center,this._centerAltitude),F=[y[0],y[1],O.z-y[2]],V=i.a6.vec3.length(F);F[2]-=(P-R)/this._pixelsPerMercatorPixel;const $=i.a6.vec3.length(F);if($===0)return;i.a6.vec3.scale(F,F,V/$*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],O.z*this._pixelsPerMercatorPixel-F[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const $=this.center;return $.lat=i.ap($.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&($.lng=i.ap($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const s=this._unmodified,{x:p,y}=this.point;let v=0,w=p,P=y;const R=this.width/2,O=this.height/2,F=this.worldMinY*this.scale,V=this.worldMaxY*this.scale;if(y-O<F&&(P=F+O),y+O>V&&(P=V-O),V-F<this.height&&(v=Math.max(v,this.height/(V-F)),P=(V+F)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,W=this.worldMaxX*this.scale,ee=this.worldSize/2-($+W)/2;w=(p+ee+this.worldSize)%this.worldSize-ee,w-R<$&&(w=$+R),w+R>W&&(w=W-R),W-$<this.width&&(v=Math.max(v,this.width/(W-$)),w=(W+$)/2)}w===p&&P===y||(this.center=this.unproject(new i.P(w,P))),v&&(this.zoom+=this.scaleZoom(v)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,s=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bD(1,this.center.lat)/i.bD(1,i.c4));const y=i.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this.projection.zAxisUnit==="meters"?p:1,w=this._camera.getWorldToCamera(this.worldSize,v);let P;const R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(R[8]=2*-n.x/this.width,R[9]=2*n.y/this.height,this.isOrthographic){let Ne=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),qe=Ne*this.aspect,Ue=-qe,$e=-Ne;qe-=n.x,Ue-=n.x,Ne+=n.y,$e+=n.y,P=this._camera.getCameraToClipOrthographic(Ue,qe,$e,Ne,this._nearZ,this._farZ),((nt,pt,Mt,ht)=>{for(let Nt=0;Nt<16;Nt++)nt[Nt]=Ac(pt[Nt],Mt[Nt],ht)})(P,P,R,Dc(this.pitch>=15?1:this.pitch/15))}else P=R;const O=i.a6.mat4.mul([],R,w);let F=i.a6.mat4.mul([],P,w);if(this.projection.isReprojectedInTileSpace){const Ne=this.locationCoordinate(this.center),qe=i.a6.mat4.identity([]);i.a6.mat4.translate(qe,qe,[Ne.x*this.worldSize,Ne.y*this.worldSize,0]),i.a6.mat4.multiply(qe,qe,i.bY(this)),i.a6.mat4.translate(qe,qe,[-Ne.x*this.worldSize,-Ne.y*this.worldSize,0]),i.a6.mat4.multiply(F,F,qe),i.a6.mat4.multiply(O,O,qe),this.inverseAdjustmentMatrix=i.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.a6.mat4.scale([],F,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=F,this.invProjMatrix=i.a6.mat4.invert(new Float64Array(16),this.projMatrix),s){const Ne=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ne[8]=2*-n.x/this.width,Ne[9]=2*n.y/this.height,this.expandedFarZProjMatrix=i.a6.mat4.mul([],Ne,w)}else this.expandedFarZProjMatrix=this.projMatrix;const V=i.a6.mat4.invert([],P);this.frustumCorners=i.b_.fromInvProjectionMatrix(V,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!s);const $=new Float32Array(16);i.a6.mat4.identity($),i.a6.mat4.scale($,$,[1,-1,1]),i.a6.mat4.rotateX($,$,this._pitch),i.a6.mat4.rotateZ($,$,this.angle);const W=i.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.a6.mat4.clone(W);const ee=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-n.x/this.width,W[9]=2*(n.y+ee)/this.height,this.skyboxMatrix=i.a6.mat4.multiply($,W,$);const re=this.point,ie=re.x,ae=re.y,_e=this.width%2/2,Se=this.height%2/2,ge=Math.cos(this.angle),Ee=Math.sin(this.angle),Me=ie-Math.round(ie)+ge*_e+Ee*Se,Fe=ae-Math.round(ae)+ge*Se+Ee*_e,Re=new Float64Array(F);if(i.a6.mat4.translate(Re,Re,[Me>.5?Me-1:Me,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=Re,F=i.a6.mat4.create(),i.a6.mat4.scale(F,F,[this.width/2,-this.height/2,1]),i.a6.mat4.translate(F,F,[1,-1,0]),this.labelPlaneMatrix=F,F=i.a6.mat4.create(),i.a6.mat4.scale(F,F,[1,-1,1]),i.a6.mat4.translate(F,F,[-1,-1,0]),i.a6.mat4.scale(F,F,[2/this.width,2/this.height,1]),this.glCoordMatrix=F,this.pixelMatrix=i.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},F=i.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!F)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=F,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.b$(this);const Ne=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.a6.vec3.transformMat4(Ne,Ne,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=F;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,v=[n,n,s];i.a6.vec3.scale(v,v,y),i.a6.vec3.scale(p,p,-1),i.a6.vec3.multiply(p,p,v);const w=i.a6.mat4.create();i.a6.mat4.translate(w,w,p),i.a6.mat4.scale(w,w,v),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,s,y)}_computeCameraPosition(n){const s=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),y=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-n/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-p[0]*v,y.y/this.worldSize-p[1]*v,n/this.worldSize*this._centerAltitude-p[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],y=n[2];let v=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(v=Math.min((s-p)/y,1)),this._camera.position=i.a6.vec3.scaleAndAdd([],this._camera.position,n,v),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,s=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),v=i.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.bB(this._maxPitch)),P=Math.max((n[2]-v)/Math.cos(p),w),R=this._zoomFromMercatorZ(P);i.a6.vec3.scaleAndAdd(n,n,s,P),this._pitch=i.ap(p,i.bB(this.minPitch),i.bB(this.maxPitch)),this.angle=i.bA(y,-Math.PI,Math.PI),this._setZoom(i.ap(R,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.a5(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}zoomFromMercatorZAdjusted(n){let s=0,p=i.bU,y=0,v=1/0;for(;p-s>1e-6&&p>s;){const w=s+.5*(p-s),P=this.tileSize*Math.pow(2,w),R=this.getCameraToCenterDistance(this.projection,w,P),O=this.scaleZoom(R/(n*this.tileSize)),F=Math.abs(w-O);F<v&&(v=F,y=w),w<O?s=w:p=w}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,s){const p=Math.min(n.x,s.x),y=Math.max(n.x,s.x),v=Math.min(n.y,s.y),w=Math.max(n.y,s.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const P=[new i.P(p,v),new i.P(y,w),new i.P(p,w),new i.P(y,v)],R=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(const F of P){const V=this.pointRayIntersection(F);if(V.t<0)return!0;const $=this.rayIntersectionCoordinate(V);if($.x<R||$.y<0||$.x>O||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(n,s){const p=i.a6.vec3.length(i.a6.vec3.sub([],this._camera.position,n)),y=this._zoomFromMercatorZ(p)+s;return p-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([s,p,y],v){const w=[s,p,y,1];i.a6.vec4.transformMat4(w,w,v);const P=w[3]=Math.max(w[3],1e-6);return w[0]/=P,w[1]/=P,w[2]/=P,w}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,n))}}getCameraToCenterDistance(n,s=this.zoom,p=this.worldSize){const y=i.bX(n,s,this.width,this.height,1024),v=n.pixelSpaceConversion(this.center.lat,p,y);let w=.5/Math.tan(.5*this._fov)*this.height*v;return this.isOrthographic&&(w=Ac(1,w,Dc(this.pitch>=15?1:this.pitch/15))),w}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.a6.mat4.multiply(n,n,this.globeMatrix),n}getFrustum(n){return i.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const Pa=(h,n)=>{if(n>0&&h.terrain&&i.w("Cutoff is currently disabled on terrain"),n<=0||h.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const s=h.transform,p=Math.max(Math.abs(s._zoom-(h.minCutoffZoom-1)),1),y=s.isLODDisabled(!1)?i.a7(60,45,s.pitch):i.a7(30,15,s.pitch),v=s._farZ-s._nearZ,w=n*s.height,P=((1-(R=y))*s.cameraToCenterDistance+R*(s._farZ+w))*p;var R;return{shouldRenderCutoff:y<1,uniformValues:{u_cutoff_params:[s._nearZ,s._farZ,(P-s._nearZ)/v,(P-w-s._nearZ)/v]}}},pi={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Lf{constructor(n,s){this.aabb=n,this.lastCascade=s}}class er{add(n,s){const p=this.receivers[n.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],s.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],s.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],s.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],s.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],s.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],s.max[2])):this.receivers[n.key]=new Lf(s,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,s,p){const y=i.c9.fromPoints(n.points);let v=0;for(const w in this.receivers){const P=this.receivers[w];if(!P||!y.intersectsAabb(P.aabb))continue;P.aabb.min=y.closestPoint(P.aabb.min),P.aabb.max=y.closestPoint(P.aabb.max);const R=P.aabb.getCorners();for(let O=0;O<p.length;O++){let F=!0;for(const V of R){const $=[V[0]*s,V[1]*s,V[2]];if(i.a6.vec3.transformMat4($,$,p[O].matrix),$[0]<-1||$[0]>1||$[1]<-1||$[1]>1){F=!1;break}}if(P.lastCascade=O,v=Math.max(v,O),F)break}}return v+1}}class Xy{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new er,this._depthMode=new Tr(n.context.gl.LEQUAL,Tr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),n.tp.registerParameter(pi,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(pi,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(pi,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,s){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!s||!s.properties)return;const y=s.properties.get("shadow-intensity");if(!s.shadowsEnabled()||y<=0||(this._shadowLayerCount=p.style.order.reduce((ee,re)=>{const ie=p.style._mergedLayers[re];return ee+(ie.hasShadowPass()&&!ie.isHidden(n.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const v=p.context,w=pi.shadowMapResolution,P=pi.shadowMapResolution;if(this._cascades.length===0||pi.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ee=0;ee<pi.cascadeCount;++ee){const re=p._shadowMapDebug,ie=v.gl,ae=v.createFramebuffer(w,P,re,"texture"),_e=new i.T(v,{width:w,height:P,data:null},ie.DEPTH_COMPONENT16);if(ae.depthAttachment.set(_e.texture),re){const Se=new i.T(v,{width:w,height:P,data:null},ie.RGBA8);ae.colorAttachment.set(Se.texture)}this._cascades.push({framebuffer:ae,texture:_e,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bN,scale:0})}}this.shadowDirection=ph(s);let R=0;if(n.elevation){const ee=n.elevation,re=[1e4,-1e4];ee.visibleDemTiles.filter(ie=>ie.dem).forEach(ie=>{const ae=ie.dem.tree;re[0]=Math.min(re[0],ae.minimums[0]),re[1]=Math.max(re[1],ae.maximums[0])}),re[0]!==1e4&&(R=(re[1]-re[0])*ee.exaggeration())}const O=1.5*n.cameraToCenterDistance,F=3*O,V=new Float64Array(16);for(let ee=0;ee<this._cascades.length;++ee){const re=this._cascades[ee];let ie=n.height/50,ae=1;pi.cascadeCount===1?ae=F:ee===0?ae=O:(ie=O,ae=F);const[_e,Se]=mh(n,this.shadowDirection,ie,ae,pi.shadowMapResolution,R);re.scale=n.scale,re.matrix=_e,re.boundingSphereRadius=Se,i.a6.mat4.invert(V,re.matrix),re.frustum=i.bN.fromInvProjectionMatrix(V,1,0,!0),re.far=ae}const $=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[$].far,this._cascades[$].far],this._uniformValues.u_shadow_intensity=y,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/pi.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=pi.shadowMapResolution,this._uniformValues.u_shadowmap_0=ho.ShadowMap0,this._uniformValues.u_shadowmap_1=ho.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const W=p.transform.elevation;for(const ee of this._groundShadowTiles){let re={min:0,max:0};if(W){const ie=W.getMinMaxForTile(ee);ie&&(re=ie)}this.addShadowReceiver(ee.toUnwrapped(),re.min,re.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,s){if(!this.enabled)return;const p=this.painter,y=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),y.viewport.set([0,0,pi.shadowMapResolution,pi.shadowMapResolution]);for(let v=0;v<this._numCascadesToRender;++v){p.currentShadowCascade=v,y.bindFramebuffer.set(this._cascades[v].framebuffer.framebuffer),y.clear({color:i.bz.white,depth:1});for(const w of n.order){const P=n._mergedLayers[w];if(!P.hasShadowPass()||P.isHidden(p.transform.zoom))continue;const R=n.getLayerSourceCache(P),O=R?s[R.id]:void 0;(P.type==="model"||O&&O.length)&&p.renderLayer(p,R,P,O)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,s=n.style,p=n.context,y=s.directionalLight,v=s.ambientLight;if(!y||!v)return;const w=[],P=Pa(n,n.longestCutoffRange);P.shouldRenderCutoff&&w.push("RENDER_CUTOFF");const R=fh(s,y,v),O=new Tr(p.gl.LEQUAL,Tr.ReadOnly,n.depthRangeFor3D);for(const F of this._groundShadowTiles){const V=F.toUnwrapped(),$=n.isTileAffectedByFog(F),W=n.getOrCreateProgram("groundShadow",{defines:w,overrideFog:$});this.setupShadows(V,W),n.uploadCommonUniforms(p,W,V,null,P);const ee={u_matrix:n.transform.calculateProjMatrix(V),u_ground_shadow_factor:R};W.draw(n,p.gl.TRIANGLES,O,qr.disabled,cn.multiply,Nr.disabled,ee,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,{},n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?cn.unblended:cn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const s=this.painter.transform,p=s.calculatePosMatrix(n,s.worldSize);return i.a6.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(n){return i.a6.mat4.multiply(n,this._cascades[this.painter.currentShadowCascade].matrix,n),Float32Array.from(n)}setupShadows(n,s,p,y=0){if(!this.enabled)return;const v=this.painter.transform,w=this.painter.context,P=w.gl,R=this._uniformValues,O=new Float64Array(16),F=v.calculatePosMatrix(n,v.worldSize);for(let V=0;V<this._cascades.length;V++)i.a6.mat4.multiply(O,this._cascades[V].matrix,F),R[V===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),w.activeTexture.set(P.TEXTURE0+ho.ShadowMap0+V),this._cascades[V].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const V=i.c8(n.canonical),$=2/v.tileSize*i.ab/pi.shadowMapResolution,W=$*this._cascades[0].boundingSphereRadius,ee=$*this._cascades[this._cascades.length-1].boundingSphereRadius,re=(p==="vector-tile"?1:3)/Math.pow(2,y-n.canonical.z-(1-v.zoom+Math.floor(v.zoom)));R.u_shadow_normal_offset=[V,W*re,ee*re],R.u_shadow_bias=[6e-5,.0012,.012]}else R.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(w,R)}setupShadowsFromMatrix(n,s,p=!1){if(!this.enabled)return;const y=this.painter.context,v=y.gl,w=this._uniformValues,P=new Float64Array(16);for(let R=0;R<pi.cascadeCount;R++)i.a6.mat4.multiply(P,this._cascades[R].matrix,n),w[R===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(P),y.activeTexture.set(v.TEXTURE0+ho.ShadowMap0+R),this._cascades[R].texture.bind(v.NEAREST,v.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const R=pi.normalOffset;w.u_shadow_normal_offset=[1,R,R],w.u_shadow_bias=[6e-5,.0012,.012]}else w.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(y,w)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,s,p,y){if(y[2]>=0)return{};const v=function(R,O,F){const V=F/(1<<R.canonical.z);return new i.c9([R.canonical.x*V+R.wrap*F,R.canonical.y*V+R.wrap*F,0],[(R.canonical.x+1)*V+R.wrap*F,(R.canonical.y+1)*V+R.wrap*F,O])}(n,s,p).getCorners(),w=s/-y[2];y[0]<0?(i.a6.vec3.add(v[0],v[0],[y[0]*w,0,0]),i.a6.vec3.add(v[3],v[3],[y[0]*w,0,0])):y[0]>0&&(i.a6.vec3.add(v[1],v[1],[y[0]*w,0,0]),i.a6.vec3.add(v[2],v[2],[y[0]*w,0,0])),y[1]<0?(i.a6.vec3.add(v[0],v[0],[0,y[1]*w,0]),i.a6.vec3.add(v[1],v[1],[0,y[1]*w,0])):y[1]>0&&(i.a6.vec3.add(v[2],v[2],[0,y[1]*w,0]),i.a6.vec3.add(v[3],v[3],[0,y[1]*w,0]));const P={};return P.vertices=v,P.planes=[Rc(v[1],v[0],v[4]),Rc(v[2],v[1],v[5]),Rc(v[3],v[2],v[6]),Rc(v[0],v[3],v[7])],P}addShadowReceiver(n,s,p){this._receivers.add(n,i.c9.fromTileIdAndHeight(n,s,p))}getMaxCascadeForTile(n){const s=this._receivers.get(n);return s&&s.lastCascade?s.lastCascade:0}}function Rc(h,n,s){const p=i.a6.vec3.sub([],s,n),y=i.a6.vec3.sub([],h,n),v=i.a6.vec3.cross([],p,y),w=i.a6.vec3.length(v);return w===0?[0,0,1,0]:(i.a6.vec3.scale(v,v,1/w),[v[0],v[1],v[2],-i.a6.vec3.dot(v,n)])}function ph(h){const n=h.properties.get("direction"),s=i.c7(n.x,n.y,n.z);s[2]=i.ap(s[2],0,75);const p=i.ca([s[0],s[1],s[2]]);return i.a6.vec3.fromValues(p.x,p.y,p.z)}function fh(h,n,s){const p=n.properties.get("color"),y=n.properties.get("intensity"),v=n.properties.get("direction"),w=[v.x,v.y,v.z],P=s.properties.get("color"),R=s.properties.get("intensity"),O=Math.max(i.a6.vec3.dot([0,0,1],w),0),F=[0,0,0];i.a6.vec3.scale(F,P.toRenderColor(h.getLut(n.scope)).toArray01Linear().slice(0,3),R);const V=[0,0,0];return i.a6.vec3.scale(V,p.toRenderColor(h.getLut(s.scope)).toArray01Linear().slice(0,3),O*y),i.cb([F[0]>0?F[0]/(F[0]+V[0]):0,F[1]>0?F[1]/(F[1]+V[1]):0,F[2]>0?F[2]/(F[2]+V[2]):0])}function mh(h,n,s,p,y,v){const w=h.zoom,P=h.scale,R=h.worldSize,O=1/R,F=h.aspect,V=Math.sqrt(1+F*F)*Math.tan(.5*h.fovX),$=V*V,W=p-s,ee=p+s;let re,ie;$>W/ee?(re=p,ie=p*V):(re=.5*ee*(1+$),ie=.5*Math.sqrt(W*W+2*(p*p+s*s)*$+ee*ee*$*$));const ae=h.projection.pixelsPerMeter(h.center.lat,R),_e=h._camera.getCameraToWorldMercator(),Se=[0,0,-re*O];i.a6.vec3.transformMat4(Se,Se,_e);let ge=ie*O;const Ee=h._edgeInsets;if(!(Ee.left===0&&Ee.top===0&&Ee.right===0&&Ee.bottom===0||Ee.left===Ee.right&&Ee.top===Ee.bottom)){const Vt=h._camera.getWorldToCamera(h.worldSize,h.projection.zAxisUnit==="meters"?ae:1),Ut=h._camera.getCameraToClipPerspective(h._fov,h.width/h.height,s,p);Ut[8]=2*-h.centerOffset.x/h.width,Ut[9]=2*h.centerOffset.y/h.height;const Ct=new Float64Array(16);i.a6.mat4.mul(Ct,Ut,Vt);const Pt=new Float64Array(16);i.a6.mat4.invert(Pt,Ct);const xr=i.bN.fromInvProjectionMatrix(Pt,R,w,!0);for(const Kt of xr.points){const lr=((Me=Kt)[0]/=P,Me[1]/=P,Me[2]=i.bD(Me[2],h._center.lat),Me);ge=Math.max(ge,i.a6.vec3.len(i.a6.vec3.subtract([],Se,lr)))}}var Me;ge*=y/(y-1);const Fe=Math.acos(n[2]),Re=Math.atan2(-n[0],-n[1]),Ne=new Hl;Ne.position=Se,Ne.setPitchBearing(Fe,Re);const qe=Ne.getWorldToCamera(R,ae),Ue=ge*R,$e=Math.min(h._mercatorZfromZoom(17)*R*-2,-2*Ue),nt=Ne.getCameraToClipOrthographic(-Ue,Ue,-Ue,Ue,$e,(Ue+v*ae)/n[2]),pt=new Float64Array(16);i.a6.mat4.multiply(pt,nt,qe);const Mt=i.a6.vec3.fromValues(Math.floor(1e6*Se[0])/1e6*R,Math.floor(1e6*Se[1])/1e6*R,0),ht=.5*y,Nt=[0,0,0];i.a6.vec3.transformMat4(Nt,Mt,pt),i.a6.vec3.scale(Nt,Nt,ht);const it=[Math.floor(Nt[0]),Math.floor(Nt[1]),Math.floor(Nt[2])],St=[0,0,0];i.a6.vec3.sub(St,Nt,it),i.a6.vec3.scale(St,St,-1/ht);const _t=new Float64Array(16);return i.a6.mat4.identity(_t),i.a6.mat4.translate(_t,_t,St),i.a6.mat4.multiply(pt,_t,pt),[pt,Ue]}class Aa extends i.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.numModelsLoading={}}loadModel(n,s){return i.aG(this.requestManager.transformRequest(s,i.R.Model).url).then(p=>{if(!p)return;const y=i.aH(p),v=new i.aI(n,void 0,void 0,y);return v.computeBoundsAndApplyParent(),v}).catch(p=>{if(p&&p.status===404)return null;this.fire(new i.t(new Error(`Could not load model ${n} from ${s}: ${p.message}`)))})}load(n,s){this.models[s]||(this.models[s]={});const p=Object.keys(n);this.numModelsLoading[s]=(this.numModelsLoading[s]||0)+p.length;const y=[];for(const v of p)y.push(this.loadModel(v,n[v]));Promise.allSettled(y).then(v=>{for(let w=0;w<v.length;w++){const{status:P,value:R}=v[w];P==="fulfilled"&&R&&(this.models[s][p[w]]={model:R,numReferences:1})}this.numModelsLoading[s]-=p.length,this.fire(new i.x("data",{dataType:"style"}))}).catch(v=>{this.fire(new i.t(new Error(`Could not load models: ${v.message}`)))})}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,s){return!!this.getModel(n,s)}getModel(n,s){return this.models[s]||(this.models[s]={}),this.models[s][n]?this.models[s][n].model:void 0}addModel(n,s,p){this.models[p]||(this.models[p]={}),this.hasModel(n,p)&&this.models[p][n].numReferences++,this.load({[n]:this.requestManager.normalizeModelURL(s)},p)}addModels(n,s){this.models[s]||(this.models[s]={});const p={};for(const y in n)this.models[s][y]={},p[y]=this.requestManager.normalizeModelURL(n[y]);this.load(p,s)}addModelsFromBucket(n,s){this.models[s]||(this.models[s]={});const p={};for(const y of n)this.hasModel(y,s)?this.models[s][y].numReferences++:p[y]=this.requestManager.normalizeModelURL(y);this.load(p,s)}removeModel(n,s){if(this.models[s]&&this.models[s][n]&&(this.models[s][n].numReferences--,this.models[s][n].numReferences===0)){const p=this.models[s][n].model;delete this.models[s][n],p.destroy()}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,s){this.models[s]||(this.models[s]={});for(const p in this.models[s])this.models[s][p].model&&this.models[s][p].model.upload(n.context)}}const zf=new i.a0({data:new i.a1(i._.colorTheme.data)}),rs=(h,n)=>Xe(h,n&&n.filter(s=>s.identifier!=="source.canvas")),gh=i.ar(vn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Lc=i.ar(vn,["setCenter","setZoom","setBearing","setPitch"]),Ky={version:8,layers:[],sources:{}},Jy={duration:300,delay:0};class ns extends i.E{constructor(n,s={}){super(),this.map=n,this.scope=s.scope||"",this.globalId=null,this.fragments=[],this.importDepth=s.importDepth||0,this.importsCache=s.importsCache||new Map,this.resolvedImports=s.resolvedImports||new Set,this.transition=i.l({},Jy),this._buildingIndex=new Mf(this),this.crossTileSymbolIndex=new ch,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=s.styleChanges||new Bt,this.dispatcher=s.dispatcher?s.dispatcher:new i.cd(i.ce(),this),s.imageManager?this.imageManager=s.imageManager:(this.imageManager=new qt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=s.glyphManager?s.glyphManager:new i.cf(n._requestManager,s.localFontFamily?i.cg.all:s.localIdeographFontFamily?i.cg.ideographs:i.cg.none,s.localFontFamily||s.localIdeographFontFamily),s.modelManager?this.modelManager=s.modelManager:(this.modelManager=new Aa(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=s.configOptions?s.configOptions:new Map,this._configDependentLayers=s.configDependentLayers?s.configDependentLayers:new Set,this._config=s.config,this._initialConfig=s.initialConfig,this.dispatcher.broadcast("setReferrer",i.ch());const p=this;this._rtlTextPluginCallback=ns.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(v,w)=>{if(i.ci(v),w&&w.every(P=>P))for(const P in p._sourceCaches){const R=p._sourceCaches[P],O=R.getSource().type;O!=="vector"&&O!=="geojson"||R.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const v=this.getOwnSource(y.sourceId);if(v&&v.vectorLayerIds)for(const w in this._layers){const P=this._layers[w];P.source===v.id&&this._validateLayer(P)}})}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(i.f(n))return n;const s=i.cj(n);if(!s.startsWith("http"))try{return new URL(s,location.href).toString()}catch{return s}return s}return`json://${i.ck(JSON.stringify(n))}`}_diffStyle(n,s,p){this.globalId=this._getGlobalId(n);const y=(v,w)=>{try{w(null,this.setState(v,p))}catch(P){w(P,!1)}};if(typeof n=="string"){const v=this.map._requestManager.normalizeStyleURL(n),w=this.map._requestManager.transformRequest(v,i.R.Style);i.n(w,(P,R)=>{P?this.fire(new i.t(P)):R&&y(R,s)})}else typeof n=="object"&&y(n,s)}loadURL(n,s={}){this.fire(new i.x("dataloading",{dataType:"style"}));const p=typeof s.validate=="boolean"?s.validate:!i.f(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,s.accessToken),this.resolvedImports.add(n);const y=this.importsCache.get(n);if(y)return this._load(y,p);const v=this.map._requestManager.transformRequest(n,i.R.Style);this._request=i.n(v,(w,P)=>{if(this._request=null,w)this.fire(new i.t(w));else if(P)return this.importsCache.set(n,P),this._load(P,p)})}loadJSON(n,s={}){this.fire(new i.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=i.q.frame(()=>{this._request=null,this._load(n,s.validate!==!1)})}loadEmpty(){this.fire(new i.x("dataloading",{dataType:"style"})),this._load(Ky,!1)}_loadImports(n,s,p){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const y=[];for(const v of n){const w=this._createFragmentStyle(v),P=new Promise(F=>{w.once("style.import.load",F),w.once("error",F)}).then(()=>this.mergeAll());if(y.push(P),this.resolvedImports.has(v.url)){w.loadEmpty();continue}const R=v.data||this.importsCache.get(v.url);R?(w.loadJSON(R,{validate:s}),this._isInternalStyle(R)&&(w.globalId=null)):v.url?w.loadURL(v.url,{validate:s}):w.loadEmpty();const O={style:w,id:v.id,config:v.config};if(p){const F=this.fragments.findIndex(({id:V})=>V===p);this.fragments=this.fragments.slice(0,F).concat(O).concat(this.fragments.slice(F))}else this.fragments.push(O)}return Promise.allSettled(y)}getImportGlobalIds(n=this,s=new Set){for(const p of n.fragments)p.style.globalId&&s.add(p.style.globalId),this.getImportGlobalIds(p.style,s);return[...s.values()]}_createFragmentStyle(n){const s=this.scope?i.av(n.id,this.scope):n.id;let p;const y=this._initialConfig&&this._initialConfig[s];(n.config||y)&&(p=i.l({},n.config,y));const v=new ns(this.map,{scope:s,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,configDependentLayers:this._configDependentLayers});return v.setEventedParent(this.map,{style:v}),v}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,s){const p=n.schema;if(this._isInternalStyle(n)){const w=i.l({},Ky,{imports:[{id:"basemap",data:n,url:""}]});return void this._load(w,s)}if(this.updateConfig(this._config,p),s&&rs(this,sn(n)))return;this._loaded=!0,this.stylesheet=i.cl(n);const y=()=>{for(const O in n.sources)this.addSource(O,n.sources[O],{validate:!1,isInitialLoad:!0});n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(n.glyphs,this.scope);const w=Ef(this.stylesheet.layers);if(this._order=w.map(O=>O.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const O=this.stylesheet.lights[0];this.light=new et(O.properties,O.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new et(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const O of w){const F=i.cq(O,this.scope,this._styleColorTheme.lut,this.options);F.configDependencies.size!==0&&this._configDependentLayers.add(F.fqid),F.setEventedParent(this,{layer:{id:F.id}}),this._layers[F.id]=F,this._serializedLayers[F.id]=F.serialize();const V=this.getOwnLayerSourceCache(F),$=!!this.directionalLight&&this.directionalLight.shadowsEnabled();V&&F.canCastShadows()&&$&&(V.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const P=this.stylesheet.terrain;P&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(P,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.x("data",{dataType:"style"}));const R=this.isRootStyle();n.imports?this._loadImports(n.imports,s).then(()=>{this._reloadImports(),this.fire(new i.x(R?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.x(R?"style.load":"style.import.load")))},v=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=v,v){const w=this._evaluateColorThemeData(v);this._loadColorTheme(w).then(()=>{y()}).catch(P=>{i.w(`Couldn't load color theme from the stylesheet: ${P}`),y()})}else this._styleColorTheme.lut=null,y()}isRootStyle(){return this.importDepth===0}mergeAll(){let n,s,p,y,v,w,P,R;const O={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(F=>{if(F.stylesheet){if(F.light!=null&&(n=F.light),F.stylesheet.lights)for(const V of F.stylesheet.lights)V.type==="ambient"&&F.ambientLight!=null&&(s=F.ambientLight),V.type==="directional"&&F.directionalLight!=null&&(p=F.directionalLight);y=this._prioritizeTerrain(y,F.terrain,F.stylesheet.terrain),F.stylesheet.fog&&F.fog!=null&&(v=F.fog),F.stylesheet.camera!=null&&(R=F.stylesheet.camera),F.stylesheet.projection!=null&&(w=F.stylesheet.projection),F.stylesheet.transition!=null&&(P=F.stylesheet.transition),O[F.scope]=F._styleColorTheme}}),this.light=n,this.ambientLight=s,this.directionalLight=p,this.fog=v,this._styleColorThemeForScope=O,y===null?delete this.terrain:this.terrain=y,this.camera=R||{"camera-projection":"perspective"},this.projection=w||{name:"mercator"},this.transition=i.l({},Jy,P),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(n){const s=p=>{for(const y of p.fragments)s(y.style);n(p)};s(this)}_prioritizeTerrain(n,s,p){const y=n&&n.drapeRenderMode===0;return p===null?s&&s.drapeRenderMode===0?s:y?n:null:s!=null&&(!n||y||s&&s.drapeRenderMode===1)?s:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(s=>{n=this._prioritizeTerrain(n,s.terrain,s.stylesheet.terrain)}),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle(s=>{s.stylesheet.projection!=null&&(n=s.stylesheet.projection)}),this.projection=n||{name:"mercator"}}mergeSources(){const n={},s={},p={};this.forEachFragmentStyle(y=>{for(const v in y._sourceCaches){const w=i.av(v,y.scope);n[w]=y._sourceCaches[v]}for(const v in y._otherSourceCaches){const w=i.av(v,y.scope);s[w]=y._otherSourceCaches[v]}for(const v in y._symbolSourceCaches){const w=i.av(v,y.scope);p[w]=y._symbolSourceCaches[v]}}),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=s,this._mergedSymbolSourceCaches=p}mergeLayers(){const n={},s=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(v=>{for(const w of v._order){const P=v._layers[w];if(P.type==="slot"){const R=i.cm(w);if(n[R])continue;n[R]=[]}P.slot&&n[P.slot]?n[P.slot].push(P):s.push(P)}}),this._mergedOrder=[];const y=(v=[])=>{for(const w of v)if(w.type==="slot"){const P=i.cm(w.id);n[P]&&y(n[P]),this._mergedSlots.push(P)}else{const P=i.av(w.id,w.scope);this._mergedOrder.push(P),p[P]=w,w.is3D()&&(this._has3DLayers=!0),w.type==="circle"&&(this._hasCircleLayers=!0),w.type==="symbol"&&(this._hasSymbolLayers=!0),w.type==="clip"&&(this._clipLayerPresent=!0)}};y(s),this._mergedOrder.sort((v,w)=>{const P=p[v],R=p[w];return P.hasInitialOcclusionOpacityProperties?R.is3D()?1:0:P.is3D()&&R.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=i.l({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?function(s,p,y){const v=i.l({},p);for(const P of Object.keys(i._.colorTheme))v[P]===void 0&&(v[P]=i._.colorTheme[P].default);const w=new i.$(zf,s,new Map(y));return w.setTransitionOrValue(v,y),w.untransitioned().possiblyEvaluate(new i.a3(0))}(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const s=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,y)=>{const v="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let w=n;w.startsWith(v)||(w=v+w);const P="mapbox-reserved-lut",R=new Image;R.src=w,R.onerror=()=>{this._styleColorTheme.lutLoading=!1,y(new Error("Failed to load image data"))},R.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==s)return void p();this._styleColorTheme.lutLoading=!1;const{width:O,height:F,data:V}=i.q.getImageData(R);if(F>32)return void y(new Error("The height of the image must be less than or equal to 32 pixels."));if(O!==F*F)return void y(new Error("The width of the image must be equal to the height squared."));this.getImage(P)&&this.removeImage(P),this.addImage(P,{data:new i.r({width:O,height:F},V),pixelRatio:1,sdf:!1,version:0});const $=this.imageManager.getImage(P,this.scope);$?(this._styleColorTheme.lut={image:$.data,data:n},p()):y(new Error("Missing LUT image."))}})}getLut(n){const s=this._styleColorThemeForScope[n];return s?s.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=function(s,p,y){let v,w,P;const R=i.q.devicePixelRatio>1?"@2x":"";let O=i.n(p.transformRequest(p.normalizeSpriteURL(s,R,".json"),i.R.SpriteJSON),($,W)=>{O=null,P||(P=$,v=W,V())}),F=i.o(p.transformRequest(p.normalizeSpriteURL(s,R,".png"),i.R.SpriteImage),($,W)=>{F=null,P||(P=$,w=W,V())});function V(){if(P)y(P);else if(v&&w){const $=i.q.getImageData(w),W={};for(const ee in v){const{width:re,height:ie,x:ae,y:_e,sdf:Se,pixelRatio:ge,stretchX:Ee,stretchY:Me,content:Fe}=v[ee],Re=new i.r({width:re,height:ie});i.r.copy($,Re,{x:ae,y:_e},{x:0,y:0},{width:re,height:ie},null),W[ee]={data:Re,pixelRatio:ge,sdf:Se,stretchX:Ee,stretchY:Me,content:Fe}}y(null,W)}}return{cancel(){O&&(O.cancel(),O=null),F&&(F.cancel(),F=null)}}}(n,this.map._requestManager,(s,p)=>{if(this._spriteRequest=null,s)this.fire(new i.t(s));else if(p)for(const y in p)this.imageManager.addImage(y,this.scope,p[y]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.x("data",{dataType:"style"}))})}_validateLayer(n){const s=this.getOwnSource(n.source);if(!s)return;const p=n.sourceLayer;p&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(p)===-1)&&this.fire(new i.t(new Error(`Source layer "${p}" does not exist on source "${s.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((n,s)=>{const p=this.fragments[s];return p&&p.style&&(n.data=p.style.serialize()),n})}_serializeSources(){const n={};for(const s in this._sourceCaches){const p=this._sourceCaches[s].getSource();n[p.id]||(n[p.id]=p.serialize())}return n}_serializeLayers(n){const s=[];for(const p of n){const y=this._layers[p];y&&y.type!=="custom"&&s.push(y.serialize())}return s}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const s=this.getOwnLayer(n);if(s)return s;this.fire(new i.t(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const s=this.getOwnSource(n);if(s)return s;this.fire(new i.t(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,s){const p=this.map.painter;if(p)for(let y=n.minzoom||0;y<(n.maxzoom||25.5);y++){const v=n.getProgramIds();if(v)for(const w of v){const P=n.getDefaultProgramParams(w,s.zoom,this._styleColorTheme.lut);P&&(p.style=this,this.fog&&(p._fogVisible=!0,P.overrideFog=!0,p.getOrCreateProgram(w,P)),p._fogVisible=!1,P.overrideFog=!1,p.getOrCreateProgram(w,P),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(P.overrideRtt=!0,p.getOrCreateProgram(w,P)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const s=this.calculateLightsBrightness();n.brightness=s||0,s!==this._brightness&&(this._brightness=s,this.dispatcher.broadcast("setBrightness",s));const p=this._changes.isDirty();let y=!1;if(this._changes.isDirty()){const w=this._changes.getLayerUpdatesByScope();for(const P in w){const{updatedIds:R,removedIds:O}=w[P];(R||O)&&(this._updateWorkerLayers(P,R,O),y=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._changes.reset()}const v={};for(const w in this._mergedSourceCaches){const P=this._mergedSourceCaches[w];v[w]=P.used,P.used=!1,P.tileCoverLift=0}for(const w of this._mergedOrder){const P=this._mergedLayers[w];if(P.recalculate(n,this._availableImages),!P.isHidden(n.zoom)){const R=this.getLayerSourceCache(P);R&&(R.used=!0,R.tileCoverLift=Math.max(R.tileCoverLift,P.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(P,n)}):this.precompilePrograms(P,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&y&&this.mergeLayers();for(const w in v){const P=this._mergedSourceCaches[w];v[w]!==P.used&&P.getSource().fire(new i.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new i.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=this._changes.getUpdatedImages();if(n.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],n);this._changes.resetUpdatedImages()}}_updateWorkerLayers(n,s,p){const y=this.getFragmentStyle(n);y&&this.dispatcher.broadcast("updateLayers",{layers:s?y._serializeLayers(s):[],scope:n,removedIds:p||[],options:y.options})}setState(n,s){if(this._checkLoaded(),rs(this,sn(n)))return!1;(n=i.cl(n)).layers=Ef(n.layers);const p=function(w,P){if(!w)return[{command:vn.setStyle,args:[P]}];let R=[];try{if(!i.bh(w.version,P.version))return[{command:vn.setStyle,args:[P]}];if(i.bh(w.center,P.center)||R.push({command:vn.setCenter,args:[P.center]}),i.bh(w.zoom,P.zoom)||R.push({command:vn.setZoom,args:[P.zoom]}),i.bh(w.bearing,P.bearing)||R.push({command:vn.setBearing,args:[P.bearing]}),i.bh(w.pitch,P.pitch)||R.push({command:vn.setPitch,args:[P.pitch]}),i.bh(w.sprite,P.sprite)||R.push({command:vn.setSprite,args:[P.sprite]}),i.bh(w.glyphs,P.glyphs)||R.push({command:vn.setGlyphs,args:[P.glyphs]}),i.bh(w.imports,P.imports)||function(W=[],ee=[],re){ee=ee||[];const ie=(W=W||[]).map($l),ae=ee.map($l),_e=W.reduce(wc,{}),Se=ee.reduce(wc,{}),ge=ie.slice();let Ee,Me,Fe,Re;for(Ee=0,Me=0;Ee<ie.length;Ee++)Fe=ie[Ee],Se.hasOwnProperty(Fe)?Me++:(re.push({command:vn.removeImport,args:[Fe]}),ge.splice(ge.indexOf(Fe,Me),1));for(Ee=0,Me=0;Ee<ae.length;Ee++)Fe=ae[ae.length-1-Ee],ge[ge.length-1-Ee]!==Fe&&(_e.hasOwnProperty(Fe)?(re.push({command:vn.removeImport,args:[Fe]}),ge.splice(ge.lastIndexOf(Fe,ge.length-Me),1)):Me++,Re=ge[ge.length-Ee],re.push({command:vn.addImport,args:[Se[Fe],Re]}),ge.splice(ge.length-Ee,0,Fe));for(const Ne of ee){const qe=_e[Ne.id];qe&&!i.bh(qe,Ne)&&re.push({command:vn.updateImport,args:[Ne.id,Ne]})}}(w.imports,P.imports,R),i.bh(w.transition,P.transition)||R.push({command:vn.setTransition,args:[P.transition]}),i.bh(w.light,P.light)||R.push({command:vn.setLight,args:[P.light]}),i.bh(w.fog,P.fog)||R.push({command:vn.setFog,args:[P.fog]}),i.bh(w.projection,P.projection)||R.push({command:vn.setProjection,args:[P.projection]}),i.bh(w.lights,P.lights)||R.push({command:vn.setLights,args:[P.lights]}),i.bh(w.camera,P.camera)||R.push({command:vn.setCamera,args:[P.camera]}),!i.bh(w["color-theme"],P["color-theme"]))return[{command:vn.setStyle,args:[P]}];const O={},F=[];(function(W,ee,re,ie){let ae;for(ae in ee=ee||{},W=W||{})W.hasOwnProperty(ae)&&(ee.hasOwnProperty(ae)||An(ae,re,ie));for(ae in ee){if(!ee.hasOwnProperty(ae))continue;const _e=ee[ae];W.hasOwnProperty(ae)?i.bh(W[ae],_e)||(W[ae].type==="geojson"&&_e.type==="geojson"&&Pr(W,ee,ae)?re.push({command:vn.setGeoJSONSourceData,args:[ae,_e.data]}):D1(ae,ee,re,ie)):If(ae,ee,re)}})(w.sources,P.sources,F,O);const V=[];w.layers&&w.layers.forEach(W=>{W.source&&O[W.source]?R.push({command:vn.removeLayer,args:[W.id]}):V.push(W)});let $=w.terrain;$&&O[$.source]&&(R.push({command:vn.setTerrain,args:[void 0]}),$=void 0),R=R.concat(F),i.bh($,P.terrain)||R.push({command:vn.setTerrain,args:[P.terrain]}),function(W,ee,re){ee=ee||[];const ie=(W=W||[]).map($l),ae=ee.map($l),_e=W.reduce(wc,{}),Se=ee.reduce(wc,{}),ge=ie.slice(),Ee=Object.create(null);let Me,Fe,Re,Ne,qe,Ue,$e;for(Me=0,Fe=0;Me<ie.length;Me++)Re=ie[Me],Se.hasOwnProperty(Re)?Fe++:(re.push({command:vn.removeLayer,args:[Re]}),ge.splice(ge.indexOf(Re,Fe),1));for(Me=0,Fe=0;Me<ae.length;Me++)Re=ae[ae.length-1-Me],ge[ge.length-1-Me]!==Re&&(_e.hasOwnProperty(Re)?(re.push({command:vn.removeLayer,args:[Re]}),ge.splice(ge.lastIndexOf(Re,ge.length-Fe),1)):Fe++,Ue=ge[ge.length-Me],re.push({command:vn.addLayer,args:[Se[Re],Ue]}),ge.splice(ge.length-Me,0,Re),Ee[Re]=!0);for(Me=0;Me<ae.length;Me++)if(Re=ae[Me],Ne=_e[Re],qe=Se[Re],!Ee[Re]&&!i.bh(Ne,qe))if(i.bh(Ne.source,qe.source)&&i.bh(Ne["source-layer"],qe["source-layer"])&&i.bh(Ne.type,qe.type)){for($e in Uu(Ne.layout,qe.layout,re,Re,null,vn.setLayoutProperty),Uu(Ne.paint,qe.paint,re,Re,null,vn.setPaintProperty),i.bh(Ne.slot,qe.slot)||re.push({command:vn.setSlot,args:[Re,qe.slot]}),i.bh(Ne.filter,qe.filter)||re.push({command:vn.setFilter,args:[Re,qe.filter]}),i.bh(Ne.minzoom,qe.minzoom)&&i.bh(Ne.maxzoom,qe.maxzoom)||re.push({command:vn.setLayerZoomRange,args:[Re,qe.minzoom,qe.maxzoom]}),Ne)Ne.hasOwnProperty($e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&$e!=="slot"&&($e.indexOf("paint.")===0?Uu(Ne[$e],qe[$e],re,Re,$e.slice(6),vn.setPaintProperty):i.bh(Ne[$e],qe[$e])||re.push({command:vn.setLayerProperty,args:[Re,$e,qe[$e]]}));for($e in qe)qe.hasOwnProperty($e)&&!Ne.hasOwnProperty($e)&&$e!=="layout"&&$e!=="paint"&&$e!=="filter"&&$e!=="metadata"&&$e!=="minzoom"&&$e!=="maxzoom"&&$e!=="slot"&&($e.indexOf("paint.")===0?Uu(Ne[$e],qe[$e],re,Re,$e.slice(6),vn.setPaintProperty):i.bh(Ne[$e],qe[$e])||re.push({command:vn.setLayerProperty,args:[Re,$e,qe[$e]]}))}else re.push({command:vn.removeLayer,args:[Re]}),Ue=ge[ge.lastIndexOf(Re)+1],re.push({command:vn.addLayer,args:[qe,Ue]})}(V,P.layers,R)}catch(O){console.warn("Unable to compute style diff:",O),R=[{command:vn.setStyle,args:[P]}]}return R}(this.serialize(),n).filter(w=>!(w.command in Lc));if(p.length===0)return!1;const y=p.filter(w=>!(w.command in gh));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);const v=[];return p.forEach(w=>{v.push(this[w.command].apply(this,w.args))}),s&&Promise.all(v).then(s),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(n,s){return this.getImage(n)?this.fire(new i.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,this.scope,s),this._afterImageUpdated(n),this)}updateImage(n,s){this.imageManager.updateImage(n,this.scope,s)}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._afterImageUpdated(n),this):this.fire(new i.t(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(n),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(n,s,p={}){return this._checkLoaded(),this._validate(Ve,`models.${n}`,s,null,p)||(this.modelManager.addModel(n,s,this.scope),this._changes.setDirty()),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope),this):this.fire(new i.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,s,p={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(qn,`sources.${n}`,s,null,p))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const y=ol(n,s,this.dispatcher,this);y.scope=this.scope,y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(y.id),source:y.serialize(),sourceId:y.id}));const v=w=>{const P=(w?"symbol:":"other:")+y.id,R=i.av(P,this.scope),O=this._sourceCaches[P]=new Vo(R,y,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[y.id]=O,O.onAdd(this.map)};v(!1),s.type!=="vector"&&s.type!=="geojson"||v(!0),y.onAdd&&y.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const s=this.getOwnSource(n);if(!s)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===n)return this.fire(new i.t(new Error(`Source "${n}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new i.t(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(n);for(const y of p){const v=i.cm(y.id);delete this._sourceCaches[v],this._changes.discardSourceCacheUpdate(y.id),y.fire(new i.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,s){this._checkLoaded(),this.getOwnSource(n).setData(s),this._changes.setDirty()}getOwnSource(n){const s=this.getOwnSourceCache(n);return s&&s.getSource()}getOwnSources(){const n=[];for(const s in this._otherSourceCaches){const p=this.getOwnSourceCache(s);p&&n.push(p.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const s in n){const p=n[s]._tiles;for(const y in p){const v=p[y];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const s=this._getTransitionParameters();for(const y of n){if(this._validate(_o,"lights",y))return;switch(y.type){case"ambient":if(this.ambientLight){const v=this.ambientLight;v.set(y),v.updateTransitions(s)}else this.ambientLight=new Pn(y,Yr||(Yr=new i.a0({color:new i.a1(i._.properties_light_ambient.color),intensity:new i.a1(i._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const v=this.directionalLight;v.set(y),v.updateTransitions(s)}else this.directionalLight=new Pn(y,En||(En=new i.a0({direction:new i.ad(i._.properties_light_directional.direction),color:new i.a1(i._.properties_light_directional.color),intensity:new i.a1(i._.properties_light_directional.intensity),"cast-shadows":new i.a1(i._.properties_light_directional["cast-shadows"]),"shadow-intensity":new i.a1(i._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new i.a3(this.z||0,s);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,s=this.ambientLight;if(!n||!s)return;const p=V=>.2126*(V[0]<=.03928?V[0]/12.92:Math.pow((V[0]+.055)/1.055,2.4))+.7152*(V[1]<=.03928?V[1]/12.92:Math.pow((V[1]+.055)/1.055,2.4))+.0722*(V[2]<=.03928?V[2]/12.92:Math.pow((V[2]+.055)/1.055,2.4)),y=n.properties.get("color").toRenderColor(null).toArray01(),v=n.properties.get("intensity"),w=n.properties.get("direction"),P=1-i.c7(w.x,w.y,w.z)[2]/90,R=p(y)*v*P,O=s.properties.get("color").toRenderColor(null).toArray01(),F=s.properties.get("intensity");return(R+p(O)*F)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(!n)return this;if(i.cn(n)){const s=i.co(n),p=this.fragments.find(({id:v})=>v===s);if(!p)throw new Error(`Style import not found: ${n}`);const y=i.cm(n);return p.style.getFragmentStyle(y)}{const s=this.fragments.find(({id:p})=>p===n);if(!s)throw new Error(`Style import not found: ${n}`);return s.style}}getConfigProperty(n,s){const p=this.getFragmentStyle(n);if(!p)return null;const y=i.av(s,p.scope),v=p.options.get(y),w=v?v.value||v.default:null;return w?w.serialize():null}setConfigProperty(n,s,p){const y=this.getFragmentStyle(n);if(!y)return;const v=y.stylesheet.schema;if(!v||!v[s])return;const w=i.M(p);if(w.result!=="success")return void rs(this,w.value);const P=w.value.expression,R=i.av(s,y.scope),O=y.options.get(R);if(!O)return;let F;const{minValue:V,maxValue:$,stepValue:W,type:ee,values:re}=v[s],ie=i.M(v[s].default);ie.result==="success"&&(F=ie.value.expression),F?(this.options.set(R,{...O,value:P,default:F,minValue:V,maxValue:$,stepValue:W,type:ee,values:re}),this.updateConfigDependencies(s)):this.fire(new i.t(new Error(`No schema defined for the config option "${s}" in the "${n}" fragment.`)))}getConfig(n){const s=this.getFragmentStyle(n);if(!s)return null;const p=s.stylesheet.schema;if(!p)return null;const y={};for(const v in p){const w=i.av(v,s.scope),P=s.options.get(w),R=P?P.value||P.default:null;y[v]=R?R.serialize():null}return y}setConfig(n,s){const p=this.getFragmentStyle(n);p&&(p.updateConfig(s,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const s=this.getFragmentStyle(n);return s?s.stylesheet.schema:null}setSchema(n,s){const p=this.getFragmentStyle(n);p&&(p.stylesheet.schema=s,p.updateConfig(p._config,s),this.updateConfigDependencies())}updateConfig(n,s){if(this._config=n,n||s)if(s)for(const p in s){let y,v;const w=i.M(s[p].default);if(w.result==="success"&&(y=w.value.expression),n&&n[p]!==void 0){const $=i.M(n[p]);$.result==="success"&&(v=$.value.expression)}const{minValue:P,maxValue:R,stepValue:O,type:F,values:V}=s[p];if(y){const $=i.av(p,this.scope);this.options.set($,{default:y,value:v,minValue:P,maxValue:R,stepValue:O,type:F,values:V})}else this.fire(new i.t(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new i.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(n){for(const s of this._configDependentLayers){const p=this.getLayer(s);if(p){if(n&&!p.configDependencies.has(n))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(s=>{if(s._styleColorTheme.colorTheme){const p=s._evaluateColorThemeData(s._styleColorTheme.colorTheme);(!s._styleColorTheme.lut&&p!==""||s._styleColorTheme.lut&&p!==s._styleColorTheme.lut.data)&&s.setColorTheme(s._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(n,s,p={}){this._checkLoaded();const y=n.id;if(this._layers[y])return void this.fire(new i.t(new Error(`Layer with id "${y}" already exists on this map`)));let v;if(n.type==="custom"){if(rs(this,i.cp(n)))return;v=i.cq(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(y,n.source),n=i.cl(n),n=i.l(n,{source:y})),this._validate(ut,`layers.${y}`,n,{arrayIndex:-1},p))return;v=i.cq(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(v),v.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[v.id]=v.serialize()}v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid);let w=this._order.length;if(s){const F=this._order.indexOf(s);if(F===-1)return void this.fire(new i.t(new Error(`Layer with id "${s}" does not exist on this map.`)));v.slot===this._layers[s].slot?w=F:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,y),this._layerOrderChanged=!0,this._layers[y]=v;const P=this.getOwnLayerSourceCache(v),R=!!this.directionalLight&&this.directionalLight.shadowsEnabled();P&&v.canCastShadows()&&R&&(P.castsShadows=!0);const O=this._changes.getRemovedLayer(v);if(O&&v.source&&P&&v.type!=="custom"){this._changes.discardLayerRemoval(v);const F=i.av(v.source,v.scope);O.type!==v.type?this._changes.updateSourceCache(F,"clear"):(this._changes.updateSourceCache(F,"reload"),P.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),v.scope=this.scope,this.mergeLayers()}moveLayer(n,s){this._checkLoaded();const p=this._checkLayer(n);if(!p||n===s)return;const y=this._order.indexOf(n);this._order.splice(y,1);let v=this._order.length;if(s){const w=this._order.indexOf(s);if(w===-1)return void this.fire(new i.t(new Error(`Layer with id "${s}" does not exist on this map.`)));p.slot===this._layers[s].slot?v=w:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(v,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const s=this._checkLayer(n);if(!s)return;s.setEventedParent(null);const p=this._order.indexOf(n);this._order.splice(p,1),delete this._layers[n],delete this._serializedLayers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(s.fqid),this._changes.removeLayer(s);const y=this.getOwnLayerSourceCache(s);if(y&&y.castsShadows){let v=!1;for(const w in this._layers)if(this._layers[w].source===s.source&&this._layers[w].canCastShadows()){v=!0;break}y.castsShadows=v}s.onRemove&&s.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const s in this._layers)if(this._layers[s].type===n)return!0;return!1}setLayerZoomRange(n,s,p){this._checkLoaded();const y=this._checkLayer(n);y&&(y.minzoom===s&&y.maxzoom===p||(s!=null&&(y.minzoom=s),p!=null&&(y.maxzoom=p),this._updateLayer(y)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,s){this._checkLoaded();const p=this._checkLayer(n);p&&p.slot!==s&&(p.slot=s,this._updateLayer(p))}setFilter(n,s,p={}){this._checkLoaded();const y=this._checkLayer(n);if(y&&!i.bh(y.filter,s))return s==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(ue,`layers.${y.id}.filter`,s,{layerType:y.type},p)||(y.filter=i.cl(s),this._updateLayer(y)))}getFilter(n){const s=this._checkLayer(n);if(s)return i.cl(s.filter)}setLayoutProperty(n,s,p,y={}){this._checkLoaded();const v=this._checkLayer(n);if(v&&!i.bh(v.getLayoutProperty(s),p)){if(p!=null&&(!y||y.validate!==!1)&&rs(v,ke.call(sn,{key:`layers.${n}.layout.${s}`,layerType:v.type,objectKey:s,value:p,styleSpec:i._,style:{glyphs:!0,sprite:!0}})))return;v.setLayoutProperty(s,p),v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),this._updateLayer(v)}}getLayoutProperty(n,s){const p=this._checkLayer(n);if(p)return p.getLayoutProperty(s)}setPaintProperty(n,s,p,y={}){this._checkLoaded();const v=this._checkLayer(n);if(!v||i.bh(v.getPaintProperty(s),p)||p!=null&&(!y||y.validate!==!1)&&rs(v,pe.call(sn,{key:`layers.${n}.paint.${s}`,layerType:v.type,objectKey:s,value:p,styleSpec:i._})))return;const w=v.setPaintProperty(s,p);v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),w&&this._updateLayer(v),this._changes.updatePaintProperties(v)}getPaintProperty(n,s){const p=this._checkLayer(n);if(p)return p.getPaintProperty(s)}setFeatureState(n,s){this._checkLoaded();const p=n.source,y=n.sourceLayer,v=this._checkSource(p);if(!v)return;const w=v.type;if(w==="geojson"&&y)return void this.fire(new i.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!y)return void this.fire(new i.t(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new i.t(new Error("The feature id parameter must be provided.")));const P=this.getOwnSourceCaches(p);for(const R of P)R.setFeatureState(y,n.id,s)}removeFeatureState(n,s){this._checkLoaded();const p=n.source,y=this._checkSource(p);if(!y)return;const v=y.type,w=v==="vector"?n.sourceLayer:void 0;if(v==="vector"&&!w)return void this.fire(new i.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new i.t(new Error("A feature id is required to remove its specific state property.")));const P=this.getOwnSourceCaches(p);for(const R of P)R.removeFeatureState(w,n.id,s)}getFeatureState(n){this._checkLoaded();const s=n.source,p=n.sourceLayer,y=this._checkSource(s);if(y){if(y.type!=="vector"||p)return n.id===void 0&&this.fire(new i.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(s)[0].getFeatureState(p,n.id);this.fire(new i.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=i.l({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),s=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return i.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:s,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateLayer(n){this._changes.updateLayer(n);const s=this.getLayerSourceCache(n),p=i.av(n.source,n.scope),y=this._changes.getUpdatedSourceCaches();n.source&&!y[p]&&s&&s.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),s.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const s=P=>this._mergedLayers[P].is3D(),p=this.order,y={},v=[];for(let P=p.length-1;P>=0;P--){const R=p[P];if(s(R)){y[R]=P;for(const O of n){const F=O[R];if(F)for(const V of F)v.push(V)}}}v.sort((P,R)=>R.intersectionZ-P.intersectionZ);const w=[];for(let P=p.length-1;P>=0;P--){const R=p[P];if(s(R))for(let O=v.length-1;O>=0;O--){const F=v[O].feature;if(F.layer&&y[F.layer.id]<P)break;w.push(F),v.pop()}else for(const O of n){const F=O[R];if(F)for(const V of F)w.push(V.feature)}}return w}queryRenderedFeatures(n,s,p){s&&s.filter&&this._validate(ue,"queryRenderedFeatures.filter",s.filter,null,s),s.scope=this.scope,s.availableImages=this._availableImages,s.serializedLayers=this._serializedLayers;const y={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new i.t(new Error("parameters.layers must be an Array."))),[];for(const O of s.layers){const F=this._mergedLayers[O];if(!F)return this.fire(new i.t(new Error(`The layer '${O}' does not exist in the map's style and cannot be queried for features.`))),[];y[F.source]=!0}}const v=[],w=s.serializedLayers||{},P=s&&s.layers?s.layers.some(O=>{const F=this.getLayer(O);return F&&F.is3D()}):this.has3DLayers(),R=ti.createFromScreenPoints(n,p);for(const O in this._mergedSourceCaches){const F=this._mergedSourceCaches[O].getSource();if(!F||F.scope!==s.scope)continue;const V=this._mergedSourceCaches[O].getSource().id;s.layers&&!y[V]||v.push(Nu(this._mergedSourceCaches[O],this._mergedLayers,w,R,s,p,P,!!this.map._showQueryGeometry))}return this.placement&&v.push(function(O,F,V,$,W,ee,re){const ie={},ae=ee.queryRenderedSymbols($),_e=[];for(const Se of Object.keys(ae).map(Number))_e.push(re[Se]);_e.sort(al);for(const Se of _e){const ge=Se.featureIndex.lookupSymbolFeatures(ae[Se.bucketInstanceId],F,Se.bucketIndex,Se.sourceLayerIndex,W.filter,W.layers,W.availableImages,O);for(const Ee in ge){const Me=ie[Ee]=ie[Ee]||[],Fe=ge[Ee];Fe.sort((Re,Ne)=>{const qe=Se.featureSortOrder;if(qe){const Ue=qe.indexOf(Re.featureIndex);return qe.indexOf(Ne.featureIndex)-Ue}return Ne.featureIndex-Re.featureIndex});for(const Re of Fe)Me.push(Re)}}for(const Se in ie)ie[Se].forEach(ge=>{const Ee=ge.feature,Me=V(O[Se]);if(!Me)return;const Fe=Me.getFeatureState(Ee.layer["source-layer"],Ee.id);Ee.source=Ee.layer.source,Ee.layer["source-layer"]&&(Ee.sourceLayer=Ee.layer["source-layer"]),Ee.state=Fe});return ie}(this._mergedLayers,w,this.getLayerSourceCache.bind(this),R.screenGeometry,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(n,s){s&&s.filter&&this._validate(ue,"querySourceFeatures.filter",s.filter,null,s);const p=this.getOwnSourceCaches(n);let y=[];for(const v of p)y=y.concat(sl(v,s));return y}addSourceType(n,s,p){return ns.getSourceType(n)?p(new Error(`A source type called "${n}" already exists.`)):(ns.setSourceType(n,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:s.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,s,p={}){this._checkLoaded();const y=this.light.getLight();let v=!1;for(const P in n)if(!i.bh(n[P],y[P])){v=!0;break}if(!v)return;const w=this._getTransitionParameters();this.light.setLight(n,s,p),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,s=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),s===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=n;const y=n.source==null;if(s===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const P="terrain-dem-src";this.addSource(P,p.source),p=i.cl(p),p=i.l(p,{source:P})}const v=i.l({},p),w={};if(this.terrain&&y){v.source=this.terrain.get().source;const P=this.terrain?this.getFragmentStyle(this.terrain.scope):null;P&&(w.style=P.serialize())}if(this._validate(eo,"terrain",v,w))return}if(!this.terrain||this.terrain.scope!==this.scope&&!y||this.terrain&&s!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,s),this.fire(new i.x("data",{dataType:"style"}))}else{const v=this.terrain,w=v.get();for(const P of Object.keys(i._.terrain))!p.hasOwnProperty(P)&&i._.terrain[P].default&&(p[P]=i._.terrain[P].default);for(const P in n)if(!i.bh(n[P],w[P])){v.set(n,this.options),this.stylesheet.terrain=n;const R=this._getTransitionParameters({duration:0});v.updateTransitions(R),this.fire(new i.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const s=this.fog=new Tn(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog;if(!i.bh(s.get(),n)){s.set(n,this.options),this.stylesheet.fog=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createFog(n);this._markersNeedUpdate=!0}setColorTheme(n){this._checkLoaded();const s=()=>{for(const y in this._layers)this._layers[y].lut=this._styleColorTheme.lut;for(const y in this._sourceCaches)this._sourceCaches[y].clearTiles()};if(this._styleColorTheme.colorTheme=n,!n)return this._styleColorTheme.lut=null,void s();const p=this._evaluateColorThemeData(n);this._loadColorTheme(p).then(()=>{this.fire(new i.x("colorthemeset")),s()}).catch(y=>{i.w(`Couldn't set color theme: ${y}`)})}_getTransitionParameters(n){return{now:i.q.now(),transition:i.l(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],s=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?n.push(p):s.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...s)}_createTerrain(n,s){const p=this.terrain=new yt(n,s,this.scope,this.options);s===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const y=this._getTransitionParameters({duration:0});p.updateTransitions(y)}_force3DLayerUpdate(){for(const n in this._layers){const s=this._layers[n];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const s=this._layers[n];s.type==="symbol"&&this._updateLayer(s)}}_validate(n,s,p,y,v={}){if(v&&v.validate===!1)return!1;const w=i.l({},this.serialize());return rs(this,n.call(sn,i.l({key:s,style:w,value:p,styleSpec:i._},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(n){const s=this.getSourceCaches(n);for(const p of s)p.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}reloadSource(n){const s=this.getSourceCaches(n);for(const p of s)p.resume(),p.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}updateSources(n){let s;this.directionalLight&&(s=ph(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(n,void 0,void 0,s)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const s=this._sourceCaches[n];s.resume(),s.reload()}}_updatePlacement(n,s,p,y,v,w,P=!1){let R=!1,O=!1;const F={},V={};for(const $ of this._mergedOrder){const W=this._mergedLayers[$];if(W.type!=="symbol")continue;const ee=i.av(W.source,W.scope);let re=F[ee];if(!re){const ae=this.getLayerSourceCache(W);if(!ae)continue;const _e=ae.getRenderableIds(!0).map(Se=>ae.getTileByID(Se));V[ee]=_e.slice(),re=F[ee]=_e.sort((Se,ge)=>ge.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(ge.tileID)?-1:1))}const ie=this.crossTileSymbolIndex.addLayer(W,re,s.center.lng,s.projection);R=R||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),P=P||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new i.x("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),s.zoom))&&(this.pauseablePlacement=new Wu(s,this._mergedOrder,P,p,y,v,this.placement,this.fog&&s.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,F,V),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),O=!0),R&&this.pauseablePlacement.placement.setStale()),O||R){this._buildingIndex.onNewFrame(s.zoom);for(let $=0;$<this._mergedOrder.length;$++){const W=this._mergedLayers[this._mergedOrder[$]];if(W.type!=="symbol")continue;const ee=this.isLayerClipped(W);this.placement.updateLayerOpacities(W,F[i.av(W.source,W.scope)],$,ee?w:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,s){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:v})=>v===n.id)!==-1)return void this.fire(new i.t(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!s)return p.push(n),this._loadImports([n],!0);const y=p.findIndex(({id:v})=>v===s);return y===-1&&this.fire(new i.t(new Error(`Import with id "${s}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,y).concat(n).concat(p.slice(y)),this._loadImports([n],!0,s)}updateImport(n,s){this._checkLoaded();const p=this.stylesheet.imports||[],y=this.getImportIndex(n);return y===-1?this:typeof s=="string"?(this.setImportUrl(n,s),this):(s.url&&s.url!==p[y].url&&this.setImportUrl(n,s.url),i.bh(s.config,p[y].config)||this.setImportConfig(n,s.config),i.bh(s.data,p[y].data)||this.setImportData(n,s.data),this)}moveImport(n,s){this._checkLoaded();let p=this.stylesheet.imports||[];const y=this.getImportIndex(n);if(y===-1)return this;const v=this.getImportIndex(s);if(v===-1)return this;const w=p[y],P=this.fragments[y];return p=p.filter(({id:R})=>R!==n),this.fragments=this.fragments.filter(({id:R})=>R!==n),this.stylesheet.imports=p.slice(0,v).concat(w).concat(p.slice(v)),this.fragments=this.fragments.slice(0,v).concat(P).concat(this.fragments.slice(v)),this.mergeLayers(),this}setImportUrl(n,s){this._checkLoaded();const p=this.stylesheet.imports||[],y=this.getImportIndex(n);if(y===-1)return this;p[y].url=s;const v=this.fragments[y];return v.style=this._createFragmentStyle(p[y]),v.style.on("style.import.load",()=>this.mergeAll()),v.style.loadURL(s),this}setImportData(n,s){this._checkLoaded();const p=this.getImportIndex(n),y=this.stylesheet.imports||[];return p===-1?this:s?(this.fragments[p].style.setState(s),this._reloadImports(),this):(delete y[p].data,this.setImportUrl(n,y[p].url))}setImportConfig(n,s){this._checkLoaded();const p=this.getImportIndex(n),y=this.stylesheet.imports||[];if(p===-1)return this;s?y[p].config=s:delete y[p].config;const v=this.fragments[p],w=v.style.stylesheet&&v.style.stylesheet.schema;return v.config=s,v.style.updateConfig(s,w),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const s=this.stylesheet.imports||[],p=this.getImportIndex(n);p!==-1&&(s.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(n){const s=(this.stylesheet.imports||[]).findIndex(p=>p.id===n);return s===-1&&this.fire(new i.t(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),s}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const s in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[s];p&&n.push(p.getSource())}return n}getSource(n,s){const p=this.getSourceCache(n,s);return p&&p.getSource()}getLayerSource(n){const s=this.getLayerSourceCache(n);return s&&s.getSource()}getSourceCache(n,s){const p=i.av(n,s);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(n){const s=i.av(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[s]:this._mergedOtherSourceCaches[s]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const s=[];return this._mergedOtherSourceCaches[n]&&s.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&s.push(this._mergedSymbolSourceCaches[n]),s}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const s in n){const p=n[s];p==="reload"?this.reloadSource(s):p==="clear"&&this.clearSource(s)}}updateLayers(n){const s=this._changes.getUpdatedPaintProperties();for(const p of s){const y=this.getLayer(p);y&&y.updateTransitions(n)}}getImages(n,s,p){this.imageManager.getImages(s.icons,s.scope,p),this._updateTilesForChangedImages();const y=v=>{v&&v.setDependencies(s.tileID.key,s.type,s.icons)};y(this._otherSourceCaches[s.source]),y(this._symbolSourceCaches[s.source])}getGlyphs(n,s,p){this.glyphManager.getGlyphs(s.stacks,s.scope,p)}getResource(n,s,p){return i.ct(s,p)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const s=[];return this._otherSourceCaches[n]&&s.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&s.push(this._symbolSourceCaches[n]),s}_isSourceCacheLoaded(n){const s=this.getOwnSourceCaches(n);return s.length===0?(this.fire(new i.t(new Error(`There is no source with ID '${n}'`))),!1):s.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,s){if(!this._clipLayerPresent&&n.type!=="fill-extrusion")return!1;const p=n.type==="fill-extrusion"&&n.sourceLayer==="building";if(n.is3D()){if(p||s&&s.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(n=>{n.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ns.getSourceType=function(h){return xc[h]},ns.setSourceType=function(h,n){xc[h]=n},ns.registerForPluginStateChange=i.cc;var Qy=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Of=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Ff=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,yh="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",e_=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,t_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,r_=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,n_=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Bf=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,i_=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Hu=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const _h=[];hl(Qy,_h),hl(Ff,_h),hl(Of,_h);const qu={"_prelude_fog.vertex.glsl":t_,"_prelude_terrain.vertex.glsl":e_,"_prelude_shadow.vertex.glsl":i_,"_prelude_fog.fragment.glsl":r_,"_prelude_shadow.fragment.glsl":Hu,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":n_,"_prelude_raster_particle.glsl":Bf},zc={};gn("",e_),gn(r_,t_),gn(Hu,i_),gn(n_,""),gn(Bf,"");const Zu=gn(Of,Ff),xh=Qy;var dl={background:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:gn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:gn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:gn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:gn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:gn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:gn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:gn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:gn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:gn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,yh),skyboxGradient:gn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,yh),skyboxCapture:gn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:gn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:gn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:gn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:gn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function hl(h,n){const s=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of s)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=p.split(" ");for(const v of y)n.includes(v)||n.push(v)}}function gn(h,n){const s=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let y=n.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);y&&(y=y.map(O=>{const F=O.split(" ");return F[F.length-1]}),y=[...new Set(y)]);const v={},w=[],P=[];if(h=h.replace(s,(O,F)=>(P.push(F),"")),(n=n.replace(s,(O,F)=>(w.push(F),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let R=[..._h];hl(h,R),hl(n,R);for(const O of[...w,...P])qu[O]||console.error(`Undefined include: ${O}`),zc[O]||(zc[O]=[],hl(qu[O],zc[O])),R=[...R,...zc[O]];return{fragmentSource:h=h.replace(p,(O,F,V,$,W)=>(v[W]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${W}
in ${V} ${$} ${W};
#else
uniform ${V} ${$} u_${W};
#endif
`:F==="initialize"?`
#ifdef HAS_UNIFORM_u_${W}
    ${V} ${$} ${W} = u_${W};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${V} ${$} ${W};
#endif
`:F==="initialize-attribute"?"":void 0)),vertexSource:n=n.replace(p,(O,F,V,$,W)=>{const ee=$==="float"?"vec2":$,re=W.match(/color/)?"color":ee;return F==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${W}
in ${V} ${$} a_${W};
#endif
`:v[W]?F==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${V} ${ee} a_${W};
out ${V} ${$} ${W};
#else
uniform ${V} ${$} u_${W};
#endif
`:F==="initialize"?re==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${V} ${$} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${re}(a_${W}, u_${W}_t);
#else
    ${V} ${$} ${W} = u_${W};
#endif
`:F==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${V} ${$} a_${W};
    out ${V} ${$} ${W};
#endif
`:F==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${W} = a_${W};
#endif
`:void 0:F==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${V} ${ee} a_${W};
#else
uniform ${V} ${$} u_${W};
#endif
`:F==="define-instanced"?re==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${W}0;
in vec4 a_${W}1;
in vec4 a_${W}2;
in vec4 a_${W}3;
#else
uniform ${V} ${$} u_${W};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${V} ${ee} a_${W};
#else
uniform ${V} ${$} u_${W};
#endif
`:F==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${V} ${$} ${W} = a_${W};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${V} ${$} ${W} = a_${W};
#else
    ${V} ${$} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${V} ${$} ${W} = unpack_mix_${re}(a_${W}, u_${W}_t);
#else
    ${V} ${$} ${W} = u_${W};
#endif
`}),staticAttributes:y,usedDefines:R,vertexIncludes:w,fragmentIncludes:P}}class Oc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,s,p,y,v,w,P,R){this.context=n;let O=this.boundPaintVertexBuffers.length!==y.length;for(let V=0;!O&&V<y.length;V++)this.boundPaintVertexBuffers[V]!==y[V]&&(O=!0);let F=this.boundDynamicVertexBuffers.length!==P.length;for(let V=0;!F&&V<P.length;V++)this.boundDynamicVertexBuffers[V]!==P[V]&&(F=!0);if(!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==p||O||F||this.boundIndexBuffer!==v||this.boundVertexOffset!==w)this.freshBind(s,p,y,v,w,P,R);else{n.bindVertexArrayOES.set(this.vao);for(const V of P)V&&(V.bind(),R&&V.instanceCount&&V.setVertexAttribDivisor(n.gl,s,R));v&&v.dynamicDraw&&v.bind()}}freshBind(n,s,p,y,v,w,P){const R=n.numAttributes,O=this.context,F=O.gl;this.vao&&this.destroy(),this.vao=O.gl.createVertexArray(),O.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=v,this.boundDynamicVertexBuffers=w,s.enableAttributes(F,n),s.bind(),s.setVertexAttribPointers(F,n,v);for(const V of p)V.enableAttributes(F,n),V.bind(),V.setVertexAttribPointers(F,n,v);for(const V of w)V&&(V.enableAttributes(F,n),V.bind(),V.setVertexAttribPointers(F,n,v),P&&V.instanceCount&&V.setVertexAttribDivisor(F,n,P));y&&y.bind(),O.currentNumAttributes=R}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Yu(h,n){const s=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new i.a5(0,p/s).toLngLat().lat,new i.a5(0,(p+1)/s).toLngLat().lat]}function vh(h,n,s,p,y,v,w){const P=h.context,R=P.gl,O=s.hillshadeFBO;if(!O)return;h.prepareDrawTile();const F=h.isTileAffectedByFog(n),V=h.getOrCreateProgram("hillshade",{overrideFog:F});P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,O.colorAttachment.get());const $=((ie,ae,_e,Se)=>{const ge=_e.paint.get("hillshade-shadow-color"),Ee=_e.paint.get("hillshade-highlight-color"),Me=_e.paint.get("hillshade-accent-color"),Fe=_e.paint.get("hillshade-emissive-strength");let Re=i.bB(_e.paint.get("hillshade-illumination-direction"));if(_e.paint.get("hillshade-illumination-anchor")==="viewport")Re-=ie.transform.angle;else if(ie.style&&ie.style.enable3dLights()&&ie.style.directionalLight){const qe=ie.style.directionalLight.properties.get("direction"),Ue=i.c7(qe.x,qe.y,qe.z);Re=i.bB(Ue[1])}const Ne=!ie.options.moving;return{u_matrix:Se||ie.transform.calculateProjMatrix(ae.tileID.toUnwrapped(),Ne),u_image:0,u_latrange:Yu(0,ae.tileID),u_light:[_e.paint.get("hillshade-exaggeration"),Re],u_shadow:ge.toRenderColor(_e.lut),u_highlight:Ee.toRenderColor(_e.lut),u_emissive_strength:Fe,u_accent:Me.toRenderColor(_e.lut)}})(h,s,p,h.terrain?n.projMatrix:null);h.uploadCommonUniforms(P,V,n.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:ee,tileBoundsSegments:re}=h.getTileBoundsBuffers(s);V.draw(h,R.TRIANGLES,y,v,w,Nr.disabled,$,p.id,W,ee,re)}function bh(h,n,s){if(!n.needsDEMTextureUpload)return;const p=h.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||h.getTileTexture(s.stride);const v=s.getPixels();n.demTexture?n.demTexture.update(v,{premultiply:!1}):n.demTexture=new i.T(p,v,y.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Xu(h,n,s){const p=h.context,y=p.gl;if(!n.dem)return;const v=n.dem;if(p.activeTexture.set(y.TEXTURE1),bh(h,n,v),!n.demTexture)return;n.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE);const w=v.dim;p.activeTexture.set(y.TEXTURE0);let P=n.hillshadeFBO;if(!P){const $=new i.T(p,{width:w,height:w,data:null},y.RGBA8);$.bind(y.LINEAR,y.CLAMP_TO_EDGE),P=n.hillshadeFBO=p.createFramebuffer(w,w,!0,"renderbuffer"),P.colorAttachment.set($.texture)}p.bindFramebuffer.set(P.framebuffer),p.viewport.set([0,0,w,w]);const{tileBoundsBuffer:R,tileBoundsIndexBuffer:O,tileBoundsSegments:F}=h.getMercatorTileBoundsBuffers(),V=[];h.linearFloatFilteringSupported()&&V.push("TERRAIN_DEM_FLOAT_FORMAT"),h.getOrCreateProgram("hillshadePrepare",{defines:V}).draw(h,y.TRIANGLES,Tr.disabled,qr.disabled,cn.unblended,Nr.disabled,(($,W)=>{const ee=W.stride,re=i.a6.mat4.create();return i.a6.mat4.ortho(re,0,i.ab,-i.ab,0,0,1),i.a6.mat4.translate(re,re,[0,-i.ab,0]),{u_matrix:re,u_image:1,u_dimension:[ee,ee],u_zoom:$.overscaledZ}})(n.tileID,v),s.id,R,O,F),n.needsHillshadePrepare=!1}class $n{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jf extends $n{getDefault(){return i.bz.transparent}set(n){const s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class o_ extends $n{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Nf extends $n{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class wh extends $n{getDefault(){return[!0,!0,!0,!0]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ku extends $n{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class s_ extends $n{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class a_ extends $n{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const s=this.current;(n.func!==s.func||n.ref!==s.ref||n.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class l_ extends $n{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Fc extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=n,this.dirty=!1}}class c_ extends $n{getDefault(){return[0,1]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class F1 extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=n,this.dirty=!1}}class B1 extends $n{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class j1 extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.BLEND):s.disable(s.BLEND),this.current=n,this.dirty=!1}}class Vf extends $n{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class $f extends $n{getDefault(){return i.bz.transparent}set(n){const s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Uf extends $n{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class Wf extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=n,this.dirty=!1}}class u_ extends $n{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class d_ extends $n{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let N1=class extends $n{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class Ju extends $n{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Qu extends $n{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class h_ extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class is extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Gf extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Sh extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Th extends $n{getDefault(){return null}set(n){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Hf extends $n{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class qf extends $n{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Ch extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Zf extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class ed extends $n{constructor(n,s){super(n),this.context=n,this.parent=s}getDefault(){return null}}class Mh extends ed{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Yf extends ed{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class p_ extends ed{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,this.attachment(),s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Bc extends Yf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const V1=(h,n,s)=>({u_matrix:h,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:s}),f_=(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:s,u_zoom_transition:y,u_merc_center:v,u_image0:0,u_frustum_tl:w,u_frustum_tr:P,u_frustum_br:R,u_frustum_bl:O,u_globe_pos:F,u_globe_radius:V,u_viewport:$,u_grid_matrix:re?Float32Array.from(re):new Float32Array(9),u_skirt_height:W,u_far_z_cutoff:ee});function m_(h,n){return h!=null&&n!=null&&!(!h.hasData()||!n.hasData())&&h.demTexture!=null&&n.demTexture!=null&&h.tileID.key!==n.tileID.key}const jc=new class{constructor(){this.operations={}}newMorphing(h,n,s,p,y){if(h in this.operations){const v=this.operations[h];v.to.tileID.key!==s.tileID.key&&(v.queued=s)}else this.operations[h]={startTime:p,phase:0,duration:y,from:n,to:s,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const n=this.operations[h];return{from:n.from,to:n.to,phase:n.phase}}update(h){for(const n in this.operations){const s=this.operations[n];for(s.phase=(h-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,h)){delete this.operations[n];break}}}_nextOp(h,n){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=n,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},g_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function y_(h,n,s){if(n===0)return 0;const p=n<1&&s===514?.25/n:1;return 6*Math.pow(1.5,22-h)*Math.max(n,1)*p}function Xf(h,n){const s=1<<h.z;return!n&&(h.x===0||h.x===s-1)||h.y===0||h.y===s-1}const td=h=>({u_matrix:h});function Eh(h,n,s,p,y){if(y>0){const v=i.q.now(),w=(v-h.timeAdded)/y,P=n?(v-n.timeAdded)/y:-1,R=s.getSource(),O=p.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),F=!n||Math.abs(n.tileID.overscaledZ-O)>Math.abs(h.tileID.overscaledZ-O),V=F&&h.refreshedUponExpiration?1:i.ap(F?w:1-P,0,1);return h.refreshedUponExpiration&&w>=1&&(h.refreshedUponExpiration=!1),n?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}class Nc extends Vo{constructor(n){const s={type:"raster-dem",maxzoom:n.transform.maxZoom},p=new i.cd(i.ce(),null),y=ol("mock-dem",s,p,n.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,s){n.state="loaded",s(null)}}class __ extends Vo{constructor(n){const s=ol("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new i.cd(i.ce(),null),n.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,s,p){if(n.freezeTileCoverage)return;this.transform=n;const y=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((v,w)=>{if(v[w.key]="",!this._tiles[w.key]){const P=new ea(w,this._source.tileSize*w.overscaleFactor(),n.tileZoom);P.state="loaded",this._tiles[w.key]=P}return v},{});for(const v in this._tiles)v in y||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(n){const s=this.proxyCachedFBO[n];if(s!==void 0){const p=Object.values(s);this.renderCachePool.push(...p),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Kf extends i.aA{constructor(n,s,p){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=s,this.projMatrix=p}}class Jf extends i.cE{constructor(n,s){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,v]=function(R){const O=new i.a_,F=new i.aO,V=131;O.reserve(17161),F.reserve(33800);const $=i.ab/128,W=i.ab+$/2,ee=W+$;for(let ie=-$;ie<ee;ie+=$)for(let ae=-$;ae<ee;ae+=$){const _e=ae<0||ae>W||ie<0||ie>W?24575:0,Se=i.ap(Math.round(ae),0,i.ab),ge=i.ap(Math.round(ie),0,i.ab);O.emplaceBack(Se+_e,ge)}const re=(ie,ae)=>{const _e=ae*V+ie;F.emplaceBack(_e+1,_e,_e+V),F.emplaceBack(_e+V,_e+V+1,_e+1)};for(let ie=1;ie<129;ie++)for(let ae=1;ae<129;ae++)re(ae,ie);return[0,129].forEach(ie=>{for(let ae=0;ae<130;ae++)re(ae,ie),re(ie,ae)}),[O,F,32768]}(),w=n.context;this.gridBuffer=w.createVertexBuffer(p,i.b0.members),this.gridIndexBuffer=w.createIndexBuffer(y),this.gridSegments=i.b1.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=i.b1.simpleSegment(0,0,p.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new __(s.map),this.orthoMatrix=i.a6.mat4.create(),i.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ab,0,i.ab,0,1);const P=w.gl;this._overlapStencilMode=new qr({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Nc(s.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,s,p){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const y=n.terrain.properties,v=n.terrain.drapeRenderMode===0,w=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const P=n.terrain&&n.terrain.scope,R=y.get("source"),O=v?this._mockSourceCache:n.getSourceCache(R,P);if(!O)return void i.w(`Couldn't find terrain source "${R}".`);if(this.sourceCache=O,this._exaggeration=w?this.calculateExaggeration(s):y.get("exaggeration"),!s.projection.requiresDraping&&w&&this._exaggeration===0)return void this._disable();this.enabled=!0;const F=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const V=this.getScaledDemTileSize();this.sourceCache.update(s,V,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,F(),this._initializing=!0),F(),s.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0,this._previousZoom=s.zoom}else this._disable()}calculateExaggeration(n){const s=this._previousCameraAltitude,p=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=p;const y=s!=null?p-s:Number.MAX_VALUE;if(Math.abs(y)<2)return this._exaggeration;const v=n.zoom,w=this._style.terrain;if(!this._previousUpdateTimestamp)return w.getExaggeration(v);let P=v-this._previousZoom;const R=this._previousUpdateTimestamp;let O=v;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(v-O)>.5&&(P=.5*(v-O+P)),P*y<0&&(O+=P)),this._evaluationZoom=O;const F=w.getExaggeration(O),V=F===w.getExaggeration(Math.max(0,O-.1));if(V&&Math.abs(F-this._exaggeration)<.01)return F;let $=Math.min(.1,.00375*(this._updateTimestamp-R));return(V||F<.1||Math.abs(P)<1e-4)&&($=Math.min(.2,4*$)),i.aa(this._exaggeration,F,$)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(i.a5.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=s.getIds().map(R=>{const O=s.getTileByID(R).tileID;return O.projMatrix=p.calculateProjMatrix(O.toUnwrapped()),O});(function(R,O){const F=O.transform.pointCoordinate(O.transform.getCameraPoint()),V=new i.P(F.x,F.y);R.sort(($,W)=>{if(W.overscaledZ-$.overscaledZ)return W.overscaledZ-$.overscaledZ;const ee=new i.P($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),re=new i.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),ie=V.mult(1<<$.canonical.z);return ie.x-=.5,ie.y-=.5,ie.distSqr(ee)-ie.distSqr(re)})})(y,this.painter);const v=this.proxyToSource||{};this.proxyToSource={},y.forEach(R=>{this.proxyToSource[R.key]={}}),this.terrainTileForTile={};const w=this._style._mergedSourceCaches;for(const R in w){const O=w[R];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,n[R],v),O.usedForTerrain))continue;const F=n[R];O.getSource().reparseOverscaled&&this._assignTerrainTiles(F)}this.proxiedCoords[s.id]=y.map(R=>new Kf(R,R.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1;const P={};this._visibleDemTiles=[];for(const R of this.proxyCoords){const O=this.terrainTileForTile[R.key];if(!O)continue;const F=O.tileID.key;F in P||(this._visibleDemTiles.push(O),P[F]=F)}}_assignTerrainTiles(n){this._initializing||n.forEach(s=>{if(this.terrainTileForTile[s.key])return;const p=this._findTileCoveringTileID(s,this.sourceCache);p&&(this.terrainTileForTile[s.key]=p)})}_prepareDEMTextures(){const n=this.painter.context,s=n.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],v=y.dem;!v||y.demTexture&&!y.needsDEMTextureUpload||(n.activeTexture.set(s.TEXTURE1),bh(this.painter,y,v))}}_prepareDemTileUniforms(n,s,p,y){if(!s||s.demTexture==null)return!1;const v=n.tileID.canonical,w=Math.pow(2,s.tileID.canonical.z-v.z),P=y||"";return p[`u_dem_tl${P}`]=[v.x*w%1,v.y*w%1],p[`u_dem_scale${P}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const s=this._visibleDemTiles.reduce((p,y)=>{if(!y.dem)return p;const v=y.dem.tree.minimums[0];return v>0&&n++,p+v},0);return n?s/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,s=n.gl;n.activeTexture.set(s.TEXTURE2);const p=this._getLoadedAreaMinimum(),y=new i.cF({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(y,{premultiply:!1}):v=this._emptyDEMTexture=new i.T(n,y,s.R32F,{premultiply:!1}),v}setupElevationDraw(n,s,p){const y=this.painter.context,v=y.gl,w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};w.u_exaggeration=this.exaggeration();let P=null,R=null,O=1;if(p&&p.morphing&&this._useVertexMorphing){const W=p.morphing.srcDemTile,ee=p.morphing.dstDemTile;O=p.morphing.phase,W&&ee&&(this._prepareDemTileUniforms(n,W,w,"_prev")&&(R=W),this._prepareDemTileUniforms(n,ee,w)&&(P=ee))}const F=W=>W&&W.demTexture&&this.painter.linearFloatFilteringSupported()?v.LINEAR:v.NEAREST;let V=null;var $;if(this.enabled?R&&P?(V=P.demTexture,y.activeTexture.set(v.TEXTURE4),R.demTexture.bind(F(R),v.CLAMP_TO_EDGE),w.u_dem_lerp=O):(P=this.terrainTileForTile[n.tileID.key],V=this._prepareDemTileUniforms(n,P,w)?P.demTexture:this.emptyDEMTexture):V=this.emptyDEMTexture,y.activeTexture.set(v.TEXTURE2),V&&(w.u_dem_size=($=V).size[0]===1?1:$.size[0]-2,V.bind(F(P),v.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,s,w),p&&p.useMeterToDem&&P){const W=(1<<P.tileID.canonical.z)*i.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=W}if(p&&p.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),s.setTerrainUniformValues(y,w),this.painter.transform.projection.name==="globe"){const W=this.globeUniformValues(this.painter.transform,n.tileID.canonical,p&&p.useDenormalizedUpVectorScale);s.setGlobeUniformValues(y,W)}}globeUniformValues(n,s,p){const y=n.projection;return{u_tile_tl_up:y.upVector(s,0,0),u_tile_tr_up:y.upVector(s,i.ab,0),u_tile_br_up:y.upVector(s,i.ab,i.ab),u_tile_bl_up:y.upVector(s,0,i.ab),u_tile_up_scale:p?i.cG(1):y.upVectorScale(s,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const s=this.painter,p=this.painter.context;n.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,v,w,P,R){if(y.transform.projection.name==="globe")(function(O,F,V,$,W){const ee=O.context,re=ee.gl;let ie,ae;const _e=O.transform,Se=i.cx(O,ee,_e),ge=(nt,pt)=>{if(ae===pt)return;const Mt=[g_[pt],"PROJECTION_GLOBE_VIEW"];Se&&Mt.push("CUSTOM_ANTIALIASING");const ht=O.isTileAffectedByFog(nt);ie=O.getOrCreateProgram("globeRaster",{defines:Mt,overrideFog:ht}),ae=pt},Ee=O.colorModeForRenderPass(),Me=new Tr(re.LEQUAL,Tr.ReadWrite,O.depthRangeFor3D);jc.update(W);const Fe=i.cy(_e),Re=[i.am(_e.center.lng),i.at(_e.center.lat)],Ne=O.globeSharedBuffers,qe=[_e.width*i.q.devicePixelRatio,_e.height*i.q.devicePixelRatio],Ue=Float32Array.from(_e.globeMatrix),$e={useDenormalizedUpVectorScale:!0};{const nt=O.transform,pt=y_(nt.zoom,F.exaggeration(),F.sourceCache._source.tileSize);ae=-1;const Mt=re.TRIANGLES;for(const ht of $){const Nt=V.getTile(ht),it=qr.disabled,St=F.prevTerrainTileForTile[ht.key],_t=F.terrainTileForTile[ht.key];m_(St,_t)&&jc.newMorphing(ht.key,St,_t,W,250),ee.activeTexture.set(re.TEXTURE0),Nt.texture&&Nt.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const Vt=jc.getMorphValuesForProxy(ht.key),Ut=Vt?1:0;Vt&&i.C($e,{morphing:{srcDemTile:Vt.from,dstDemTile:Vt.to,phase:i.cw(Vt.phase)}});const Ct=i.cz(ht.canonical),Pt=i.cA(Ct.getCenter().lat),xr=i.cB(ht.canonical,Ct,Pt,nt.worldSize/nt._pixelsPerMercatorPixel),Kt=i.b5(i.cC(ht.canonical)),lr=f_(nt.expandedFarZProjMatrix,Ue,Fe,Kt,i.a9(nt.zoom),Re,nt.frustumCorners.TL,nt.frustumCorners.TR,nt.frustumCorners.BR,nt.frustumCorners.BL,nt.globeCenterInViewSpace,nt.globeRadius,qe,pt,nt._farZ,xr);if(ge(ht,Ut),ie&&(F.setupElevationDraw(Nt,ie,$e),O.uploadCommonUniforms(ee,ie,ht.toUnwrapped()),Ne)){const[Lr,fr,kr]=Ne.getGridBuffers(Pt,pt!==0);ie.draw(O,Mt,Me,it,Ee,Nr.backCCW,lr,"globe_raster",Lr,fr,kr)}}}if(Ne&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){const nt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&nt.push("CUSTOM_ANTIALIASING"),ie=O.getOrCreateProgram("globeRaster",{defines:nt});for(const pt of $){const{x:Mt,y:ht,z:Nt}=pt.canonical,it=ht===0,St=ht===(1<<Nt)-1,[_t,Vt,Ut,Ct]=Ne.getPoleBuffers(Nt,!1);if(Ct&&(it||St)){const Pt=V.getTile(pt);ee.activeTexture.set(re.TEXTURE0),Pt.texture&&Pt.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE);let xr=i.cD(Nt,Mt,_e);const Kt=i.b5(i.cC(pt.canonical)),lr=(Lr,fr)=>Lr.draw(O,re.TRIANGLES,Me,qr.disabled,Ee,Nr.disabled,f_(_e.expandedFarZProjMatrix,xr,xr,Kt,0,Re,_e.frustumCorners.TL,_e.frustumCorners.TR,_e.frustumCorners.BR,_e.frustumCorners.BL,_e.globeCenterInViewSpace,_e.globeRadius,qe,0,_e._farZ),"globe_pole_raster",fr,Ut,Ct);F.setupElevationDraw(Pt,ie,$e),O.uploadCommonUniforms(ee,ie,pt.toUnwrapped()),it&&O.renderDefaultNorthPole&&lr(ie,_t),St&&O.renderDefaultSouthPole&&(xr=i.a6.mat4.scale(i.a6.mat4.create(),xr,[1,-1,1]),lr(ie,Vt))}}}})(y,v,w,P,R);else{const O=y.context,F=O.gl;let V,$;const W=y.shadowRenderer,ee=Pa(y,y.longestCutoffRange),re=Ee=>{if($===Ee)return;const Me=[];Me.push(g_[Ee]),ee.shouldRenderCutoff&&Me.push("RENDER_CUTOFF"),V=y.getOrCreateProgram("terrainRaster",{defines:Me}),$=Ee},ie=y.colorModeForRenderPass(),ae=new Tr(F.LEQUAL,Tr.ReadWrite,y.depthRangeFor3D);jc.update(R);const _e=y.transform,Se=y_(_e.zoom,v.exaggeration(),v.sourceCache._source.tileSize);let ge=[0,0,0];if(W){const Ee=y.style.directionalLight,Me=y.style.ambientLight;Ee&&Me&&(ge=fh(y.style,Ee,Me))}{$=-1;const Ee=F.TRIANGLES,[Me,Fe]=[v.gridIndexBuffer,v.gridSegments];for(const Re of P){const Ne=w.getTile(Re),qe=qr.disabled,Ue=v.prevTerrainTileForTile[Re.key],$e=v.terrainTileForTile[Re.key];m_(Ue,$e)&&jc.newMorphing(Re.key,Ue,$e,R,250),O.activeTexture.set(F.TEXTURE0),Ne.texture&&Ne.texture.bind(F.LINEAR,F.CLAMP_TO_EDGE);const nt=jc.getMorphValuesForProxy(Re.key),pt=nt?1:0;let Mt;nt&&(Mt={morphing:{srcDemTile:nt.from,dstDemTile:nt.to,phase:i.cw(nt.phase)}});const ht=V1(Re.projMatrix,Xf(Re.canonical,_e.renderWorldCopies)?Se/10:Se,ge);if(re(pt),!V)continue;v.setupElevationDraw(Ne,V,Mt);const Nt=Re.toUnwrapped();W&&W.setupShadows(Nt,V),y.uploadCommonUniforms(O,V,Nt,null,ee),V.draw(y,Ee,ae,qe,ie,Nr.backCCW,ht,"terrain_raster",v.gridBuffer,Me,Fe)}}}}(s,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const s=this.painter,p=this.painter.context,y=this.proxySourceCache,v=this.proxiedCoords[y.id],w=this._drapedRenderBatches.shift(),P=s.style.order,R=[];let O=0;for(const F of v){const V=y.getTileByID(F.proxyTileKey),$=y.proxyCachedFBO[F.key]?y.proxyCachedFBO[F.key][n]:void 0,W=$!==void 0?y.renderCache[$]:this.pool[O++],ee=$!==void 0;if(V.texture=W.tex,ee&&!W.dirty){R.push(V.tileID);continue}let re;p.bindFramebuffer.set(W.fb.framebuffer),this.renderedToTile=!1,W.dirty&&(p.clear({color:i.bz.transparent,stencil:0}),W.dirty=!1);for(let ie=w.start;ie<=w.end;++ie){const ae=s.style._mergedLayers[P[ie]];if(ae.isHidden(s.transform.zoom))continue;const _e=s.style.getLayerSourceCache(ae),Se=_e?this.proxyToSource[F.key][_e.id]:[F];if(!Se)continue;const ge=Se;p.viewport.set([0,0,W.fb.width,W.fb.height]),re!==(_e?_e.id:null)&&(this._setupStencil(W,Se,ae,_e),re=_e?_e.id:null),s.renderLayer(s,_e,ae,ge)}if(this._drapedRenderBatches.length===0)for(const ie of this._pendingGroundEffectLayers){const ae=s.style._mergedLayers[P[ie]];if(ae.isHidden(s.transform.zoom))continue;const _e=s.style.getLayerSourceCache(ae),Se=_e?this.proxyToSource[F.key][_e.id]:[F];if(!Se)continue;const ge=Se;p.viewport.set([0,0,W.fb.width,W.fb.height]),re!==(_e?_e.id:null)&&(this._setupStencil(W,Se,ae,_e),re=_e?_e.id:null),s.renderLayer(s,_e,ae,ge)}this.renderedToTile?(W.dirty=!0,R.push(V.tileID)):ee||--O,O===5&&(O=0,this.renderToBackBuffer(R))}return this.renderToBackBuffer(R),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),w.end+1}postRender(){}isLayerOrderingCorrect(n){const s=n.order.length;let p=-1,y=s;for(let v=0;v<s;++v)this._style.isLayerDraped(n._mergedLayers[n.order[v]])?p=Math.max(p,v):y=Math.min(y,v);return y>p}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{n=Math.min(n,s.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,s,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(v=>v.dem).map(v=>{const w=v.tileID,P=1<<w.overscaledZ,{x:R,y:O}=w.canonical,F=R/P,V=(R+1)/P,$=O/P,W=(O+1)/P;return{minx:F,miny:$,maxx:V,maxy:W,t:v.dem.tree.raycastRoot(F,$,V,W,n,s,p),tile:v}});y.sort((v,w)=>(v.t!==null?v.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const v of y){if(v.t==null)return null;const w=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,n,s,p);if(w!=null)return w}return null}_createFBO(){const n=this.painter.context,s=n.gl,p=this.drapeBufferSize;n.activeTexture.set(s.TEXTURE0);const y=new i.T(n,{width:p[0],height:p[1],data:null},s.RGBA8);y.bind(s.LINEAR,s.CLAMP_TO_EDGE);const v=n.createFramebuffer(p[0],p[1],!0,null);return v.colorAttachment.set(y.texture),v.depthAttachment=new Bc(n,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:v,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const s=this._style._mergedLayers[n],p=s.isHidden(this.painter.transform.zoom);return s.type==="hillshade"||s.type==="custom"?!p&&s.shouldRedrape():!p&&s.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const p of this._style.getSources())if(p instanceof Nl){n=!0;break}if(!n)return;const s={};for(let p=0;p<this._style.order.length;++p){const y=this._style._mergedLayers[this._style.order[p]],v=this._style.getLayerSourceCache(y);if(v&&!s[v.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof i.a4){s[v.id]=!0;for(const w of this.proxyCoords){const P=this.proxyToSource[w.key][v.id];if(P)for(const R of P)this._clearRenderCacheForTile(v.id,R)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof Vl){n=!0;break}if(!n)return;const s={};for(let p=0;p<this._style.order.length;++p){const y=this._style._mergedLayers[this._style.order[p]],v=this._style.getLayerSourceCache(y);if(!v||s[v.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;const w=y.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const R=this.proxyToSource[P.key][v.id];if(R)for(const O of R){const F=Eh(v.getTile(O),v.findLoadedParent(O,0),v,this.painter.transform,w);(F.opacity!==1||F.mix!==0)&&this._clearRenderCacheForTile(v.id,O)}}}}_setupDrapedRenderBatches(){const n=this._style.order,s=n.length;if(s===0)return;const p=[];this._pendingGroundEffectLayers=[];let y,v=0,w=this._style._mergedLayers[n[v]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++v<s;)w=this._style._mergedLayers[n[v]];for(;v<s;++v){const P=this._style._mergedLayers[n[v]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?y===void 0&&(y=v):(P.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(v),y!==void 0&&(p.push({start:y,end:v-1}),y=void 0)))}if(y!==void 0&&p.push({start:y,end:v-1}),p.length!==0){const P=p[p.length-1];this._pendingGroundEffectLayers.every(R=>R>P.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(n){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const w=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let P=0;P<w.length;++P){const R=Object.values(w[P]);s.renderCachePool.push(...R)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let w=p.length-1;w>=0;w--){const P=p[w];if(s.getTileByID(P.key),s.proxyCachedFBO[P.key]!==void 0){const R=n[P.key],O=this.proxyToSource[P.key];let F=0;for(const V in O){const $=O[V],W=R[V];if(!W||W.length!==$.length||$.some((ee,re)=>ee!==W[re]||y[V]&&y[V].hasOwnProperty(ee.key))){F=-1;break}++F}for(const V in s.proxyCachedFBO[P.key])s.renderCache[s.proxyCachedFBO[P.key][V]].dirty=F<0||F!==Object.values(R).length}}const v=[...this._drapedRenderBatches];v.sort((w,P)=>P.end-P.start-(w.end-w.start));for(const w of v)for(const P of p){if(s.proxyCachedFBO[P.key])continue;let R=s.renderCachePool.pop();R===void 0&&s.renderCache.length<50&&(R=s.renderCache.length,s.renderCache.push(this._createFBO())),R!==void 0&&(s.proxyCachedFBO[P.key]={},s.proxyCachedFBO[P.key][w.start]=R,s.renderCache[R].dirty=!0)}this._tilesDirty={}}_setupStencil(n,s,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,w=v.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let P;if(p.isTileClipped())P=s.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):qr.disabled}_renderTileClippingMasks(n,s){const p=this.painter,y=this.painter.context,v=y.gl;p._tileClippingMaskIDs={},y.setColorMode(cn.disabled),y.setDepthMode(Tr.disabled);const w=p.getOrCreateProgram("clippingMask");for(const P of n){const R=p._tileClippingMaskIDs[P.key]=--s;w.draw(p,v.TRIANGLES,Tr.disabled,new qr({func:v.ALWAYS,mask:0},R,255,v.KEEP,v.KEEP,v.REPLACE),cn.disabled,Nr.disabled,td(P.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(n){const s=this.painter.transform;if(n.x<0||n.x>s.width||n.y<0||n.y>s.height)return null;const p=[n.x,n.y,1,1];i.a6.vec4.transformMat4(p,p,s.pixelMatrixInverse),i.a6.vec4.scale(p,p,1/p[3]),p[0]/=s.worldSize,p[1]/=s.worldSize;const y=s._camera.position,v=i.bD(1,s.center.lat),w=[y[0],y[1],y[2]/v,0],P=i.a6.vec3.subtract([],p.slice(0,3),w);i.a6.vec3.normalize(P,P);const R=this.raycast(w,P,this._exaggeration);return R!==null&&R?(i.a6.vec3.scaleAndAdd(w,w,P,R),w[3]=w[2],w[2]*=v,w):null}_setupProxiedCoordsForOrtho(n,s,p){if(n.getSource()instanceof i.aD)return this._setupProxiedCoordsForImageSource(n,s,p);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const y=this.proxiedCoords[n.id]=[],v=this.proxyCoords;for(let R=0;R<v.length;R++){const O=v[R],F=this._findTileCoveringTileID(O,n);if(F){const V=this._createProxiedId(O,F,p[O.key]&&p[O.key][n.id]);y.push(V),this.proxyToSource[O.key][n.id]=[V]}}let w=!1;const P=new Set;for(let R=0;R<s.length;R++){const O=n.getTile(s[R]);if(!O||!O.hasData())continue;const F=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(F&&F.tileID.canonical.z!==O.tileID.canonical.z){const V=this.proxyToSource[F.tileID.key][n.id],$=this._createProxiedId(F.tileID,O,p[F.tileID.key]&&p[F.tileID.key][n.id]);V?V.splice(V.length-1,0,$):this.proxyToSource[F.tileID.key][n.id]=[$];const W=this.proxyToSource[F.tileID.key][n.id];P.has(W)||P.add(W),y.push($),w=!0}}if(this._sourceTilesOverlap[n.id]=w,w&&this._debugParams.sortTilesHiZFirst)for(const R of P)R.sort((O,F)=>F.overscaledZ-O.overscaledZ)}_setupProxiedCoordsForImageSource(n,s,p){if(!n.getSource().loaded())return;const y=this.proxiedCoords[n.id]=[],v=this.proxyCoords,w=n.getSource(),P=w.tileID;if(!P)return;const R=new i.P(P.x,P.y)._div(1<<P.z),O=w.coordinates.map(i.a5.fromLngLat).reduce((V,$)=>(V.min.x=Math.min(V.min.x,$.x-R.x),V.min.y=Math.min(V.min.y,$.y-R.y),V.max.x=Math.max(V.max.x,$.x-R.x),V.max.y=Math.max(V.max.y,$.y-R.y),V),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),F=(V,$)=>{const W=V.wrap+V.canonical.x/(1<<V.canonical.z),ee=V.canonical.y/(1<<V.canonical.z),re=i.ab/(1<<V.canonical.z),ie=$.wrap+$.canonical.x/(1<<$.canonical.z),ae=$.canonical.y/(1<<$.canonical.z);return W+re<ie+O.min.x||W>ie+O.max.x||ee+re<ae+O.min.y||ee>ae+O.max.y};for(let V=0;V<v.length;V++){const $=v[V];for(let W=0;W<s.length;W++){const ee=n.getTile(s[W]);if(!ee||!ee.hasData()||F($,ee.tileID))continue;const re=this._createProxiedId($,ee,p[$.key]&&p[$.key][n.id]),ie=this.proxyToSource[$.key][n.id];ie?ie.push(re):this.proxyToSource[$.key][n.id]=[re],y.push(re)}}}_createProxiedId(n,s,p){let y=this.orthoMatrix;if(p){const v=p.find(w=>w.key===s.tileID.key);if(v)return v}if(s.tileID.key!==n.key){const v=n.canonical.z-s.tileID.canonical.z;let w,P,R;y=i.a6.mat4.create();const O=s.tileID.wrap-n.wrap<<n.overscaledZ;v>0?(w=i.ab>>v,P=w*((s.tileID.canonical.x<<v)-n.canonical.x+O),R=w*((s.tileID.canonical.y<<v)-n.canonical.y)):(w=i.ab<<-v,P=i.ab*(s.tileID.canonical.x-(n.canonical.x+O<<-v)),R=i.ab*(s.tileID.canonical.y-(n.canonical.y<<-v))),i.a6.mat4.ortho(y,0,w,0,w,0,1),i.a6.mat4.translate(y,y,[P,R,0])}return new Kf(s.tileID,n.key,y)}_findTileCoveringTileID(n,s){let p=s.getTile(n);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[s.id],v=y[n.key];if(p=v?s.getTileByID(v):null,p&&p.hasData()||v===null)return p;let w=p?p.tileID:n,P=w.overscaledZ;const R=s.getSource().minzoom,O=[];if(!v){const V=s.getSource().maxzoom;if(n.canonical.z>=V){const $=n.canonical.z-V;s.getSource().reparseOverscaled?(P=Math.max(n.canonical.z+2,s.transform.tileZoom),w=new i.aA(P,n.wrap,V,n.canonical.x>>$,n.canonical.y>>$)):$!==0&&(P=V,w=new i.aA(P,n.wrap,V,n.canonical.x>>$,n.canonical.y>>$))}w.key!==n.key&&(O.push(w.key),p=s.getTile(w))}const F=V=>{O.forEach($=>{y[$]=V}),O.length=0};for(P-=1;P>=R&&(!p||!p.hasData());P--){p&&F(p.tileID.key);const V=w.calculateScaledKey(P);if(p=s.getTileByID(V),p&&p.hasData())break;const $=y[V];if($===null)break;$===void 0?O.push(V):p=s.getTileByID($)}return F(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,s){let p=this._tilesDirty[n];p||(p=this._tilesDirty[n]={}),p[s.key]=!0}}function Qf(h,n,s){const p=function(P,R,O){const F=i.a6.vec3.dot(R,P),V=i.a6.vec3.dot(O,[.2126,.7152,.0722]),$=(ee,re,ie)=>(1-ie)*ee+ie*re,W=$(1-.3*Math.min(V,1),1,Math.min(F+1,1));return $(.92,1,Math.asin(i.ap(R[2],-1,1))/Math.PI+.5)*W}(h,[0,0,1],n),y=[0,0,0];i.a6.vec3.scale(y,s.slice(0,3),p);const v=[0,0,0];i.a6.vec3.scale(v,n.slice(0,3),h[2]);const w=[0,0,0];return i.a6.vec3.add(w,y,v),i.cb(w)}const ql=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],x_=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class pl{static cacheKey(n,s,p,y){let v=`${s}${y?y.cacheKey:""}`;for(const w of p)n.usedDefines.includes(w)&&(v+=`/${w}`);return v}constructor(n,s,p,y,v,w){const P=n.gl;this.program=P.createProgram(),this.configuration=y,this.name=s,this.fixedDefines=[...w];const R=y?y.getBinderAttributes():[],O=(p.staticAttributes||[]).concat(R);let F=y?y.defines():[];F=F.concat(w.map(ie=>`#define ${ie}`));const V=`#version 300 es
`;let $=V+F.concat("precision mediump float;",xh,Zu.fragmentSource).join(`
`);for(const ie of p.fragmentIncludes)$+=`
${qu[ie]}`;$+=`
${p.fragmentSource}`;let W=V+F.concat("precision highp float;",xh,Zu.vertexSource).join(`
`);for(const ie of p.vertexIncludes)W+=`
${qu[ie]}`;W+=`
${p.vertexSource}`;const ee=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(ee,$),P.compileShader(ee),P.attachShader(this.program,ee);const re=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(re,W),P.compileShader(re),P.attachShader(this.program,re),this.attributes={},this.numAttributes=O.length;for(let ie=0;ie<this.numAttributes;ie++)if(O[ie]){const ae=O[ie].startsWith("a_")?O[ie]:`a_${O[ie]}`;P.bindAttribLocation(this.program,ie,ae),this.attributes[ae]=ie}P.linkProgram(this.program),P.deleteShader(re),P.deleteShader(ee),this.fixedUniforms=v(n),this.binderUniforms=y?y.getUniforms(n):[],(w.includes("TERRAIN")||s.indexOf("symbol")!==-1||s.indexOf("circle")!==-1)&&(this.terrainUniforms=(ie=>({u_dem:new i.bJ(ie),u_dem_prev:new i.bJ(ie),u_dem_tl:new i.bG(ie),u_dem_scale:new i.bI(ie),u_dem_tl_prev:new i.bG(ie),u_dem_scale_prev:new i.bI(ie),u_dem_size:new i.bI(ie),u_dem_lerp:new i.bI(ie),u_exaggeration:new i.bI(ie),u_depth:new i.bJ(ie),u_depth_size_inv:new i.bG(ie),u_depth_range_unpack:new i.bG(ie),u_occluder_half_size:new i.bI(ie),u_occlusion_depth_offset:new i.bI(ie),u_meter_to_dem:new i.bI(ie),u_label_plane_matrix_inv:new i.bF(ie)}))(n)),w.includes("GLOBE")&&(this.globeUniforms=(ie=>({u_tile_tl_up:new i.bH(ie),u_tile_tr_up:new i.bH(ie),u_tile_br_up:new i.bH(ie),u_tile_bl_up:new i.bH(ie),u_tile_up_scale:new i.bI(ie)}))(n)),w.includes("FOG")&&(this.fogUniforms=(ie=>({u_fog_matrix:new i.bF(ie),u_fog_range:new i.bG(ie),u_fog_color:new i.c6(ie),u_fog_horizon_blend:new i.bI(ie),u_fog_vertical_limit:new i.bG(ie),u_fog_temporal_offset:new i.bI(ie),u_frustum_tl:new i.bH(ie),u_frustum_tr:new i.bH(ie),u_frustum_br:new i.bH(ie),u_frustum_bl:new i.bH(ie),u_globe_pos:new i.bH(ie),u_globe_radius:new i.bI(ie),u_globe_transition:new i.bI(ie),u_is_globe:new i.bJ(ie),u_viewport:new i.bG(ie)}))(n)),w.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ie=>({u_cutoff_params:new i.c6(ie)}))(n)),w.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ie=>({u_lighting_ambient_color:new i.bH(ie),u_lighting_directional_dir:new i.bH(ie),u_lighting_directional_color:new i.bH(ie),u_ground_radiance:new i.bH(ie)}))(n)),w.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ie=>({u_light_matrix_0:new i.bF(ie),u_light_matrix_1:new i.bF(ie),u_fade_range:new i.bG(ie),u_shadow_normal_offset:new i.bH(ie),u_shadow_intensity:new i.bI(ie),u_shadow_texel_size:new i.bI(ie),u_shadow_map_resolution:new i.bI(ie),u_shadow_direction:new i.bH(ie),u_shadow_bias:new i.bH(ie),u_shadowmap_0:new i.bJ(ie),u_shadowmap_1:new i.bJ(ie)}))(n))}}setTerrainUniformValues(n,s){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in s)p[y]&&p[y].set(this.program,y,s[y])}}setGlobeUniformValues(n,s){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in s)p[y]&&p[y].set(this.program,y,s[y])}}setFogUniformValues(n,s){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in s)p[y].set(this.program,y,s[y])}}setCutoffUniformValues(n,s){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in s)p[y].set(this.program,y,s[y])}}setLightsUniformValues(n,s){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in s)p[y].set(this.program,y,s[y])}}setShadowUniformValues(n,s){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;n.program.set(this.program);for(const y in s)p[y].set(this.program,y,s[y])}_drawDebugWireframe(n,s,p,y,v,w,P,R,O,F){const V=n.options.wireframe;if(V.terrain===!1&&V.layers2D===!1&&V.layers3D===!1)return;const $=n.context;if(!(!(!V.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!V.layers2D||n._terrain&&n._terrain.renderingToTexture||!ql.includes(this.name))||!(!V.layers3D||!x_.includes(this.name))))return;const W=$.gl,ee=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,v,$);if(!ee)return;const re=[...this.fixedDefines];re.push("DEBUG_WIREFRAME");const ie=n.getOrCreateProgram(this.name,{config:this.configuration,defines:re});$.program.set(ie.program);const ae=(ge,Ee,Me)=>{if(Ee[ge]&&Me[ge])for(const Fe in Ee[ge])Me[ge][Fe]&&Me[ge][Fe].set(Me.program,Fe,Ee[ge][Fe].current)};O&&O.setUniforms(ie.program,$,ie.binderUniforms,P,{zoom:R}),ae("fixedUniforms",this,ie),ae("terrainUniforms",this,ie),ae("globeUniforms",this,ie),ae("fogUniforms",this,ie),ae("lightsUniforms",this,ie),ae("shadowUniforms",this,ie),ee.bind(),$.setColorMode(new cn([W.ONE,W.ONE_MINUS_SRC_ALPHA,W.ZERO,W.ONE],i.bz.transparent,[!0,!0,!0,!1])),$.setDepthMode(new Tr(s.func===W.LESS?W.LEQUAL:s.func,Tr.ReadOnly,s.range)),$.setStencilMode(qr.disabled);const _e=3*w.primitiveLength*2,Se=3*w.primitiveOffset*2*2;F&&F>1?W.drawElementsInstanced(W.LINES,_e,W.UNSIGNED_SHORT,Se,F):W.drawElements(W.LINES,_e,W.UNSIGNED_SHORT,Se),v.bind(),$.program.set(this.program),$.setDepthMode(s),$.setStencilMode(p),$.setColorMode(y)}draw(n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie){const ae=n.context,_e=ae.gl;if(this.failedToCreate)return;ae.program.set(this.program),ae.setDepthMode(p),ae.setStencilMode(y),ae.setColorMode(v),ae.setCullFace(w);for(const Ee of Object.keys(this.fixedUniforms))this.fixedUniforms[Ee].set(this.program,Ee,P[Ee]);ee&&ee.setUniforms(this.program,ae,this.binderUniforms,$,{zoom:W});const Se={[_e.POINTS]:1,[_e.LINES]:2,[_e.TRIANGLES]:3,[_e.LINE_STRIP]:1}[s],ge=ie&&ie>0?1:void 0;for(const Ee of V.get()){const Me=Ee.vaos||(Ee.vaos={});(Me[R]||(Me[R]=new Oc)).bind(ae,this,O,ee?ee.getPaintVertexBuffers():[],F,Ee.vertexOffset,re||[],ge),ie&&ie>1?_e.drawElementsInstanced(s,Ee.primitiveLength*Se,_e.UNSIGNED_SHORT,Ee.primitiveOffset*Se*2,ie):F?_e.drawElements(s,Ee.primitiveLength*Se,_e.UNSIGNED_SHORT,Ee.primitiveOffset*Se*2):_e.drawArrays(s,Ee.vertexOffset,Ee.vertexLength),s===_e.TRIANGLES&&F&&this._drawDebugWireframe(n,p,y,v,F,Ee,$,W,ee,ie)}}}function em(h,n){const s=Math.pow(2,n.tileID.overscaledZ),p=n.tileSize*Math.pow(2,h.transform.tileZoom)/s,y=p*(n.tileID.canonical.x+n.tileID.wrap*s),v=p*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ak(n,1,h.transform.tileZoom),u_pixel_coord_upper:[y>>16,v>>16],u_pixel_coord_lower:[65535&y,65535&v]}}const Ih=i.a6.mat4.create(),tm=(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re)=>{const ie=n.style.light,ae=ie.properties.get("position"),_e=[ae.x,ae.y,ae.z],Se=i.a6.mat3.create();ie.properties.get("anchor")==="viewport"&&(i.a6.mat3.fromRotation(Se,-n.transform.angle),i.a6.vec3.transformMat3(_e,_e,Se));const ge=ie.properties.get("color"),Ee=n.transform,Me={u_matrix:h,u_lightpos:_e,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[ge.r,ge.g,ge.b],u_vertical_gradient:+s,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ih,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:v,u_width_scale:w,u_flood_light_color:$,u_vertical_scale:W,u_flood_light_intensity:ee,u_ground_shadow_factor:re};return Ee.projection.name==="globe"&&(Me.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],Me.u_zoom_transition=O,Me.u_inv_rot_matrix=V,Me.u_merc_center=F,Me.u_up_dir=Ee.projection.upVector(new i.bP(0,0,0),F[0]*i.ab,F[1]*i.ab),Me.u_height_lift=R),Me},v_=(h,n,s,p)=>({u_matrix:h,u_edge_radius:n,u_width_scale:s,u_vertical_scale:p}),rm=(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee)=>{const re=tm(h,n,s,p,y,v,w,P,O,F,V,$,W,ee,1,[0,0,0]),ie={u_height_factor:-Math.pow(2,P.overscaledZ)/R.tileSize/8};return i.l(re,em(n,R),ie)},kh=(h,n)=>({u_matrix:h,u_emissive_strength:n}),b_=(h,n,s,p)=>i.l(kh(h,n),em(s,p)),w_=(h,n,s)=>({u_matrix:h,u_world:s,u_emissive_strength:n}),rd=(h,n,s,p,y)=>i.l(b_(h,n,s,p),{u_world:y}),$1=(h,n,s,p)=>{const y=i.ab/s.tileSize;return{u_matrix:h,u_camera_to_center_distance:n.getCameraToCenterDistance(p),u_extrude_scale:[n.pixelsToGLUnits[0]/y,n.pixelsToGLUnits[1]/y]}},S_=(h,n,s=1)=>({u_matrix:h,u_color:n.toRenderColor(null),u_overlay:0,u_overlay_scale:s}),T_=i.a6.mat4.create(),U1=(h,n,s,p,y,v,w)=>{const P=h.transform,R=P.projection.name==="globe",O=R?i.cI(P.zoom,n.canonical)*P._pixelsPerMercatorPixel:i.ak(s,1,v),F={u_matrix:n.projMatrix,u_extrude_scale:O,u_intensity:w,u_inv_rot_matrix:T_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){F.u_inv_rot_matrix=p,F.u_merc_center=y,F.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],F.u_zoom_transition=i.a9(P.zoom);const V=y[0]*i.ab,$=y[1]*i.ab;F.u_up_dir=P.projection.upVector(new i.bP(0,0,0),V,$)}return F};function Ph(h,[n,s,p,y],[v,w]){if(v===w)return[0,0,0,0];const P=255*(h-1)/(h*(w-v));return[n*P,s*P,p*P,y*P]}function Ah(h,n,[s,p]){return s===p?0:.5/h+(n-s)*(h-1)/(h*(p-s))}const nd=(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie,ae,_e,Se,ge)=>({u_matrix:h,u_normalize_matrix:n,u_globe_matrix:s,u_merc_matrix:p,u_grid_matrix:y,u_tl_parent:v,u_scale_parent:O,u_fade_t:F.mix,u_opacity:F.opacity*V.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:V.paint.get("raster-brightness-min"),u_brightness_high:V.paint.get("raster-brightness-max"),u_saturation_factor:i.cJ(V.paint.get("raster-saturation")),u_contrast_factor:i.cK(V.paint.get("raster-contrast")),u_spin_weights:nm(V.paint.get("raster-hue-rotate")),u_perspective_transform:$,u_raster_elevation:W,u_zoom_transition:w,u_merc_center:P,u_cutoff_params:R,u_colorization_mix:Ph(i.cL,re,ae),u_colorization_offset:Ah(i.cL,ie,ae),u_color_ramp:ee,u_texture_offset:[Se/(_e+2*Se),_e/(_e+2*Se)],u_texture_res:[_e+2*Se,_e+2*Se],u_emissive_strength:ge});function nm(h){h*=Math.PI/180;const n=Math.sin(h),s=Math.cos(h);return[(2*s+1)/3,(-Math.sqrt(3)*n-s+1)/3,(Math.sqrt(3)*n-s+1)/3]}const na=.05,C_=(h,n,s,p,y,v,w,P,R,O,F,V)=>({u_matrix:h,u_normalize_matrix:n,u_globe_matrix:s,u_merc_matrix:p,u_grid_matrix:y,u_tl_parent:v,u_scale_parent:O,u_fade_t:F.mix,u_opacity:F.opacity,u_image0:0,u_image1:1,u_raster_elevation:V,u_zoom_transition:w,u_merc_center:P,u_cutoff_params:R}),Dh=(h,n,s,p,y,v,w,P,R,O)=>({u_particle_texture:h,u_particle_texture_side_len:n,u_tile_offset:s,u_velocity:p,u_color_ramp:v,u_velocity_res:y,u_max_speed:w,u_uv_offset:P,u_data_scale:[255*R[0],255*R[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[na,na]}),Rh=(h,n,s,p,y,v,w,P,R,O)=>({u_particle_texture:h,u_particle_texture_side_len:n,u_velocity:s,u_velocity_res:p,u_max_speed:y,u_speed_factor:v,u_reset_rate:w,u_rand_seed:Math.random(),u_uv_offset:P,u_data_scale:[255*R[0],255*R[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[na,na]}),Lh=i.a6.mat4.create(),im=(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie,ae,_e,Se,ge)=>{const Ee=y.transform,Me={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Ee.getCameraToCenterDistance(_e),u_rotate_symbol:+s,u_aspect_ratio:Ee.width/Ee.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:w,u_coord_matrix:P,u_is_text:+O,u_elevation_from_sea:R?1:0,u_pitch_with_map:+p,u_texsize:F,u_texsize_icon:V,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Lh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Lh,u_up_vector:[0,-1,0],u_color_adj_mat:Se,u_icon_transition:ge||0,u_gamma_scale:p?y.transform.getCameraToCenterDistance(_e)*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+$};return _e.name==="globe"&&(Me.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],Me.u_zoom_transition=ee,Me.u_inv_rot_matrix=ie,Me.u_merc_center=re,Me.u_camera_forward=Ee._camera.forward(),Me.u_ecef_origin=i.cM(Ee.globeMatrix,W.toUnwrapped()),Me.u_tile_matrix=Float32Array.from(Ee.globeMatrix),Me.u_up_vector=ae),Me},M_=(h,n,s,p)=>({u_matrix:h,u_emissive_strength:n,u_opacity:s,u_color:p}),Zl=(h,n,s,p,y,v,w,P,R)=>i.l(function(O,F,V,$,W,ee){const{width:re,height:ie}=$.imageManager.getPixelSize(F),ae=Math.pow(2,ee.tileID.overscaledZ),_e=ee.tileSize*Math.pow(2,$.transform.tileZoom)/ae,Se=_e*(ee.tileID.canonical.x+ee.tileID.wrap*ae),ge=_e*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl:V.tl,u_pattern_br:V.br,u_texsize:[re,ie],u_pattern_size:V.displaySize,u_pattern_units_to_pixels:W?[$.transform.width,-1*$.transform.height]:[1/i.ak(ee,1,$.transform.tileZoom),1/i.ak(ee,1,$.transform.tileZoom)],u_pixel_coord_upper:[Se>>16,ge>>16],u_pixel_coord_lower:[65535&Se,65535&ge]}}(0,v,w,p,P,R),{u_matrix:h,u_emissive_strength:n,u_opacity:s}),Vc=new Float32Array(i.a6.mat4.identity([])),ur=(h,n,s,p,y,v,w,P,R,O,F,V,$,W=[0,0,0],ee)=>{const re=y.style.light,ie=re.properties.get("position"),ae=[-ie.x,-ie.y,ie.z],_e=i.a6.mat3.create();re.properties.get("anchor")==="viewport"&&(i.a6.mat3.fromRotation(_e,-y.transform.angle),i.a6.vec3.transformMat3(ae,ae,_e));const Se=F.alphaMode==="MASK",ge=re.properties.get("color").toRenderColor(null),Ee=$.paint.get("model-ambient-occlusion-intensity"),Me=$.paint.get("model-color").constantOr(i.bz.white).toRenderColor(null),Fe=$.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:h,u_lighting_matrix:n,u_normal_matrix:s,u_node_matrix:p||Vc,u_lightpos:ae,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[ge.r,ge.g,ge.b],u_camera_pos:W,u_opacity:v,u_baseTextureIsAlpha:0,u_alphaMask:+Se,u_alphaCutoff:F.alphaCutoff,u_baseColorFactor:[w.r,w.g,w.b,w.a],u_emissiveFactor:[P[0],P[1],P[2],1],u_metallicFactor:R,u_roughnessFactor:O,u_baseColorTexture:ho.BaseColor,u_metallicRoughnessTexture:ho.MetallicRoughness,u_normalTexture:ho.Normal,u_occlusionTexture:ho.Occlusion,u_emissionTexture:ho.Emission,u_lutTexture:ho.LUT,u_color_mix:[Me.r,Me.g,Me.b,Fe],u_aoIntensity:Ee,u_emissive_strength:V,u_occlusionTextureTransform:ee||[0,0,0,0]}},om=(h,n=Vc,s=Vc)=>({u_matrix:h,u_instance:n,u_node_matrix:s}),E_={fillExtrusion:h=>({u_matrix:new i.bF(h),u_lightpos:new i.bH(h),u_lightintensity:new i.bI(h),u_lightcolor:new i.bH(h),u_vertical_gradient:new i.bI(h),u_opacity:new i.bI(h),u_edge_radius:new i.bI(h),u_width_scale:new i.bI(h),u_ao:new i.bG(h),u_tile_id:new i.bH(h),u_zoom_transition:new i.bI(h),u_inv_rot_matrix:new i.bF(h),u_merc_center:new i.bG(h),u_up_dir:new i.bH(h),u_height_lift:new i.bI(h),u_flood_light_color:new i.bH(h),u_vertical_scale:new i.bI(h),u_flood_light_intensity:new i.bI(h),u_ground_shadow_factor:new i.bH(h)}),fillExtrusionDepth:h=>({u_matrix:new i.bF(h),u_edge_radius:new i.bI(h),u_width_scale:new i.bI(h),u_vertical_scale:new i.bI(h)}),fillExtrusionPattern:h=>({u_matrix:new i.bF(h),u_lightpos:new i.bH(h),u_lightintensity:new i.bI(h),u_lightcolor:new i.bH(h),u_vertical_gradient:new i.bI(h),u_height_factor:new i.bI(h),u_edge_radius:new i.bI(h),u_width_scale:new i.bI(h),u_ao:new i.bG(h),u_tile_id:new i.bH(h),u_zoom_transition:new i.bI(h),u_inv_rot_matrix:new i.bF(h),u_merc_center:new i.bG(h),u_up_dir:new i.bH(h),u_height_lift:new i.bI(h),u_image:new i.bJ(h),u_texsize:new i.bG(h),u_pixel_coord_upper:new i.bG(h),u_pixel_coord_lower:new i.bG(h),u_tile_units_to_pixels:new i.bI(h),u_opacity:new i.bI(h)}),fillExtrusionGroundEffect:h=>({u_matrix:new i.bF(h),u_opacity:new i.bI(h),u_ao_pass:new i.bI(h),u_meter_to_tile:new i.bI(h),u_ao:new i.bG(h),u_flood_light_intensity:new i.bI(h),u_flood_light_color:new i.bH(h),u_attenuation:new i.bI(h),u_edge_radius:new i.bI(h),u_fb:new i.bJ(h),u_fb_size:new i.bI(h),u_dynamic_offset:new i.bI(h)}),fill:h=>({u_matrix:new i.bF(h),u_emissive_strength:new i.bI(h)}),fillPattern:h=>({u_matrix:new i.bF(h),u_emissive_strength:new i.bI(h),u_image:new i.bJ(h),u_texsize:new i.bG(h),u_pixel_coord_upper:new i.bG(h),u_pixel_coord_lower:new i.bG(h),u_tile_units_to_pixels:new i.bI(h)}),fillOutline:h=>({u_matrix:new i.bF(h),u_emissive_strength:new i.bI(h),u_world:new i.bG(h)}),fillOutlinePattern:h=>({u_matrix:new i.bF(h),u_emissive_strength:new i.bI(h),u_world:new i.bG(h),u_image:new i.bJ(h),u_texsize:new i.bG(h),u_pixel_coord_upper:new i.bG(h),u_pixel_coord_lower:new i.bG(h),u_tile_units_to_pixels:new i.bI(h)}),circle:i.cN,collisionBox:h=>({u_matrix:new i.bF(h),u_camera_to_center_distance:new i.bI(h),u_extrude_scale:new i.bG(h)}),collisionCircle:h=>({u_matrix:new i.bF(h),u_inv_matrix:new i.bF(h),u_camera_to_center_distance:new i.bI(h),u_viewport_size:new i.bG(h)}),debug:h=>({u_color:new i.cu(h),u_matrix:new i.bF(h),u_overlay:new i.bJ(h),u_overlay_scale:new i.bI(h)}),clippingMask:h=>({u_matrix:new i.bF(h)}),heatmap:h=>({u_extrude_scale:new i.bI(h),u_intensity:new i.bI(h),u_matrix:new i.bF(h),u_inv_rot_matrix:new i.bF(h),u_merc_center:new i.bG(h),u_tile_id:new i.bH(h),u_zoom_transition:new i.bI(h),u_up_dir:new i.bH(h)}),heatmapTexture:h=>({u_image:new i.bJ(h),u_color_ramp:new i.bJ(h),u_opacity:new i.bI(h)}),hillshade:h=>({u_matrix:new i.bF(h),u_image:new i.bJ(h),u_latrange:new i.bG(h),u_light:new i.bG(h),u_shadow:new i.cu(h),u_highlight:new i.cu(h),u_emissive_strength:new i.bI(h),u_accent:new i.cu(h)}),hillshadePrepare:h=>({u_matrix:new i.bF(h),u_image:new i.bJ(h),u_dimension:new i.bG(h),u_zoom:new i.bI(h)}),line:i.cO,linePattern:i.cP,raster:h=>({u_matrix:new i.bF(h),u_normalize_matrix:new i.bF(h),u_globe_matrix:new i.bF(h),u_merc_matrix:new i.bF(h),u_grid_matrix:new i.cv(h),u_tl_parent:new i.bG(h),u_scale_parent:new i.bI(h),u_fade_t:new i.bI(h),u_opacity:new i.bI(h),u_image0:new i.bJ(h),u_image1:new i.bJ(h),u_brightness_low:new i.bI(h),u_brightness_high:new i.bI(h),u_saturation_factor:new i.bI(h),u_contrast_factor:new i.bI(h),u_spin_weights:new i.bH(h),u_perspective_transform:new i.bG(h),u_raster_elevation:new i.bI(h),u_zoom_transition:new i.bI(h),u_merc_center:new i.bG(h),u_cutoff_params:new i.c6(h),u_colorization_mix:new i.c6(h),u_colorization_offset:new i.bI(h),u_color_ramp:new i.bJ(h),u_texture_offset:new i.bG(h),u_texture_res:new i.bG(h),u_emissive_strength:new i.bI(h)}),rasterParticle:h=>({u_matrix:new i.bF(h),u_normalize_matrix:new i.bF(h),u_globe_matrix:new i.bF(h),u_merc_matrix:new i.bF(h),u_grid_matrix:new i.cv(h),u_tl_parent:new i.bG(h),u_scale_parent:new i.bI(h),u_fade_t:new i.bI(h),u_opacity:new i.bI(h),u_image0:new i.bJ(h),u_image1:new i.bJ(h),u_raster_elevation:new i.bI(h),u_zoom_transition:new i.bI(h),u_merc_center:new i.bG(h),u_cutoff_params:new i.c6(h)}),rasterParticleTexture:h=>({u_texture:new i.bJ(h),u_opacity:new i.bI(h)}),rasterParticleDraw:h=>({u_particle_texture:new i.bJ(h),u_particle_texture_side_len:new i.bI(h),u_tile_offset:new i.bG(h),u_velocity:new i.bJ(h),u_color_ramp:new i.bJ(h),u_velocity_res:new i.bG(h),u_max_speed:new i.bI(h),u_uv_offset:new i.bG(h),u_data_scale:new i.bG(h),u_data_offset:new i.bI(h),u_particle_pos_scale:new i.bI(h),u_particle_pos_offset:new i.bG(h)}),rasterParticleUpdate:h=>({u_particle_texture:new i.bJ(h),u_particle_texture_side_len:new i.bI(h),u_velocity:new i.bJ(h),u_velocity_res:new i.bG(h),u_max_speed:new i.bI(h),u_speed_factor:new i.bI(h),u_reset_rate:new i.bI(h),u_rand_seed:new i.bI(h),u_uv_offset:new i.bG(h),u_data_scale:new i.bG(h),u_data_offset:new i.bI(h),u_particle_pos_scale:new i.bI(h),u_particle_pos_offset:new i.bG(h)}),symbol:h=>({u_is_size_zoom_constant:new i.bJ(h),u_is_size_feature_constant:new i.bJ(h),u_size_t:new i.bI(h),u_size:new i.bI(h),u_camera_to_center_distance:new i.bI(h),u_rotate_symbol:new i.bJ(h),u_aspect_ratio:new i.bI(h),u_fade_change:new i.bI(h),u_matrix:new i.bF(h),u_label_plane_matrix:new i.bF(h),u_coord_matrix:new i.bF(h),u_is_text:new i.bJ(h),u_elevation_from_sea:new i.bJ(h),u_pitch_with_map:new i.bJ(h),u_texsize:new i.bG(h),u_texsize_icon:new i.bG(h),u_texture:new i.bJ(h),u_texture_icon:new i.bJ(h),u_gamma_scale:new i.bI(h),u_device_pixel_ratio:new i.bI(h),u_tile_id:new i.bH(h),u_zoom_transition:new i.bI(h),u_inv_rot_matrix:new i.bF(h),u_merc_center:new i.bG(h),u_camera_forward:new i.bH(h),u_tile_matrix:new i.bF(h),u_up_vector:new i.bH(h),u_ecef_origin:new i.bH(h),u_is_halo:new i.bJ(h),u_icon_transition:new i.bI(h),u_color_adj_mat:new i.bF(h)}),background:h=>({u_matrix:new i.bF(h),u_emissive_strength:new i.bI(h),u_opacity:new i.bI(h),u_color:new i.cu(h)}),backgroundPattern:h=>({u_matrix:new i.bF(h),u_emissive_strength:new i.bI(h),u_opacity:new i.bI(h),u_image:new i.bJ(h),u_pattern_tl:new i.bG(h),u_pattern_br:new i.bG(h),u_texsize:new i.bG(h),u_pattern_size:new i.bG(h),u_pixel_coord_upper:new i.bG(h),u_pixel_coord_lower:new i.bG(h),u_pattern_units_to_pixels:new i.bG(h)}),terrainRaster:h=>({u_matrix:new i.bF(h),u_image0:new i.bJ(h),u_skirt_height:new i.bI(h),u_ground_shadow_factor:new i.bH(h)}),skybox:h=>({u_matrix:new i.bF(h),u_sun_direction:new i.bH(h),u_cubemap:new i.bJ(h),u_opacity:new i.bI(h),u_temporal_offset:new i.bI(h)}),skyboxGradient:h=>({u_matrix:new i.bF(h),u_color_ramp:new i.bJ(h),u_center_direction:new i.bH(h),u_radius:new i.bI(h),u_opacity:new i.bI(h),u_temporal_offset:new i.bI(h)}),skyboxCapture:h=>({u_matrix_3f:new i.cv(h),u_sun_direction:new i.bH(h),u_sun_intensity:new i.bI(h),u_color_tint_r:new i.c6(h),u_color_tint_m:new i.c6(h),u_luminance:new i.bI(h)}),globeRaster:h=>({u_proj_matrix:new i.bF(h),u_globe_matrix:new i.bF(h),u_normalize_matrix:new i.bF(h),u_merc_matrix:new i.bF(h),u_zoom_transition:new i.bI(h),u_merc_center:new i.bG(h),u_image0:new i.bJ(h),u_grid_matrix:new i.cv(h),u_skirt_height:new i.bI(h),u_far_z_cutoff:new i.bI(h),u_frustum_tl:new i.bH(h),u_frustum_tr:new i.bH(h),u_frustum_br:new i.bH(h),u_frustum_bl:new i.bH(h),u_globe_pos:new i.bH(h),u_globe_radius:new i.bI(h),u_viewport:new i.bG(h)}),globeAtmosphere:h=>({u_frustum_tl:new i.bH(h),u_frustum_tr:new i.bH(h),u_frustum_br:new i.bH(h),u_frustum_bl:new i.bH(h),u_horizon:new i.bI(h),u_transition:new i.bI(h),u_fadeout_range:new i.bI(h),u_color:new i.c6(h),u_high_color:new i.c6(h),u_space_color:new i.c6(h),u_temporal_offset:new i.bI(h),u_horizon_angle:new i.bI(h)}),model:h=>({u_matrix:new i.bF(h),u_lighting_matrix:new i.bF(h),u_normal_matrix:new i.bF(h),u_node_matrix:new i.bF(h),u_lightpos:new i.bH(h),u_lightintensity:new i.bI(h),u_lightcolor:new i.bH(h),u_camera_pos:new i.bH(h),u_opacity:new i.bI(h),u_baseColorFactor:new i.c6(h),u_emissiveFactor:new i.c6(h),u_metallicFactor:new i.bI(h),u_roughnessFactor:new i.bI(h),u_baseTextureIsAlpha:new i.bJ(h),u_alphaMask:new i.bJ(h),u_alphaCutoff:new i.bI(h),u_baseColorTexture:new i.bJ(h),u_metallicRoughnessTexture:new i.bJ(h),u_normalTexture:new i.bJ(h),u_occlusionTexture:new i.bJ(h),u_emissionTexture:new i.bJ(h),u_lutTexture:new i.bJ(h),u_color_mix:new i.c6(h),u_aoIntensity:new i.bI(h),u_emissive_strength:new i.bI(h),u_occlusionTextureTransform:new i.c6(h)}),modelDepth:h=>({u_matrix:new i.bF(h),u_instance:new i.bF(h),u_node_matrix:new i.bF(h)}),groundShadow:h=>({u_matrix:new i.bF(h),u_ground_shadow_factor:new i.bH(h)}),stars:h=>({u_matrix:new i.bF(h),u_up:new i.bH(h),u_right:new i.bH(h),u_intensity_multiplier:new i.bI(h)}),occlusion:h=>({u_matrix:new i.bF(h),u_anchorPos:new i.bH(h),u_screenSizePx:new i.bG(h),u_occluderSizePx:new i.bG(h),u_color:new i.c6(h)})};class Wo{constructor(n,s,p,y){this.id=Wo.uniqueIdxCounter,Wo.uniqueIdxCounter++,this.context=n;const v=n.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||y||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=Wo.uniqueIdxCounter,Wo.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Wo.uniqueIdxCounter=0;const Yl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class yr{constructor(n,s,p,y,v,w){this.length=s.length,this.attributes=p,this.itemSize=s.bytesPerElement,this.dynamicDraw=y,this.instanceCount=w,this.context=n;const P=n.gl;this.buffer=P.createBuffer(),n.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||v||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,s){for(let p=0;p<this.attributes.length;p++){const y=s.attributes[this.attributes[p].name];y!==void 0&&n.enableVertexAttribArray(y)}}setVertexAttribPointers(n,s,p){for(let y=0;y<this.attributes.length;y++){const v=this.attributes[y],w=s.attributes[v.name];w!==void 0&&n.vertexAttribPointer(w,v.components,n[Yl[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(n,s,p){for(let y=0;y<this.attributes.length;y++){const v=s.attributes[this.attributes[y].name];v!==void 0&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(v,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class zh{constructor(n,s,p,y,v){this.context=n,this.width=s,this.height=p;const w=this.framebuffer=n.gl.createFramebuffer();y&&(this.colorAttachment=new Mh(n,w)),v&&(this.depthAttachmentType=v,this.depthAttachment=v==="renderbuffer"?new Yf(n,w):new p_(n,w))}destroy(){const n=this.context.gl;if(this.colorAttachment){const s=this.colorAttachment.get();s&&n.deleteTexture(s)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const s=this.depthAttachment.get();s&&n.deleteRenderbuffer(s)}else{const s=this.depthAttachment.get();s&&n.deleteTexture(s)}n.deleteFramebuffer(this.framebuffer)}}class W1{constructor(n,s){this.gl=n,this.clearColor=new jf(this),this.clearDepth=new o_(this),this.clearStencil=new Nf(this),this.colorMask=new wh(this),this.depthMask=new Ku(this),this.stencilMask=new s_(this),this.stencilFunc=new a_(this),this.stencilOp=new l_(this),this.stencilTest=new Fc(this),this.depthRange=new c_(this),this.depthTest=new F1(this),this.depthFunc=new B1(this),this.blend=new j1(this),this.blendFunc=new Vf(this),this.blendColor=new $f(this),this.blendEquation=new Uf(this),this.cullFace=new Wf(this),this.cullFaceSide=new u_(this),this.frontFace=new d_(this),this.program=new N1(this),this.activeTexture=new Ju(this),this.viewport=new Qu(this),this.bindFramebuffer=new h_(this),this.bindRenderbuffer=new is(this),this.bindTexture=new Gf(this),this.bindVertexBuffer=new Sh(this),this.bindElementBuffer=new Th(this),this.bindVertexArrayOES=new Hf(this),this.pixelStoreUnpack=new qf(this),this.pixelStoreUnpackPremultiplyAlpha=new Ch(this),this.pixelStoreUnpackFlipY=new Zf(this),this.options=s?{...s}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,s,p){return new Wo(this,n,s,p)}createVertexBuffer(n,s,p,y,v){return new yr(this,n,s,p,y,v)}createRenderbuffer(n,s,p){const y=this.gl,v=y.createRenderbuffer();return this.bindRenderbuffer.set(v),y.renderbufferStorage(y.RENDERBUFFER,n,s,p),this.bindRenderbuffer.set(null),v}createFramebuffer(n,s,p,y){return new zh(this,n,s,p,y)}clear({color:n,depth:s,stencil:p,colorMask:y}){const v=this.gl;let w=0;n&&(w|=v.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set(y||[!0,!0,!0,!0])),s!==void 0&&(w|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),p!==void 0&&(w|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),v.clear(w)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){i.bh(n.blendFunction,cn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Oh;function Fh(h,n,s,p,y,v,w){const P=h.context,R=P.gl,O=h.transform,F=h.getOrCreateProgram("collisionBox"),V=[];let $=0,W=0;for(let ge=0;ge<p.length;ge++){const Ee=p[ge],Me=n.getTile(Ee),Fe=Me.getBucket(s);if(!Fe)continue;const Re=Hy(Ee,Fe,O);let Ne=Re;y[0]===0&&y[1]===0||(Ne=h.translatePosMatrix(Re,Me,y,v));const qe=w?Fe.textCollisionBox:Fe.iconCollisionBox,Ue=Fe.collisionCircleArray;if(Ue.length>0){const $e=i.a6.mat4.create(),nt=Ne;i.a6.mat4.mul($e,Fe.placementInvProjMatrix,O.glCoordMatrix),i.a6.mat4.mul($e,$e,Fe.placementViewportMatrix),V.push({circleArray:Ue,circleOffset:W,transform:nt,invTransform:$e,projection:Fe.getProjection()}),$+=Ue.length/4,W=$}qe&&(h.terrain&&h.terrain.setupElevationDraw(Me,F),F.draw(h,R.LINES,Tr.disabled,qr.disabled,h.colorModeForRenderPass(),Nr.disabled,$1(Ne,O,Me,Fe.getProjection()),s.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,null,O.zoom,null,[qe.collisionVertexBuffer,qe.collisionVertexBufferExt]))}if(!w||!V.length)return;const ee=h.getOrCreateProgram("collisionCircle"),re=new i.cQ;re.resize(4*$),re._trim();let ie=0;for(const ge of V)for(let Ee=0;Ee<ge.circleArray.length/4;Ee++){const Me=4*Ee,Fe=ge.circleArray[Me+0],Re=ge.circleArray[Me+1],Ne=ge.circleArray[Me+2],qe=ge.circleArray[Me+3];re.emplace(ie++,Fe,Re,Ne,qe,0),re.emplace(ie++,Fe,Re,Ne,qe,1),re.emplace(ie++,Fe,Re,Ne,qe,2),re.emplace(ie++,Fe,Re,Ne,qe,3)}(!Oh||Oh.length<2*$)&&(Oh=function(ge){const Ee=2*ge,Me=new i.aO;Me.resize(Ee),Me._trim();for(let Fe=0;Fe<Ee;Fe++){const Re=6*Fe;Me.uint16[Re+0]=4*Fe+0,Me.uint16[Re+1]=4*Fe+1,Me.uint16[Re+2]=4*Fe+2,Me.uint16[Re+3]=4*Fe+2,Me.uint16[Re+4]=4*Fe+3,Me.uint16[Re+5]=4*Fe+0}return Me}($));const ae=P.createIndexBuffer(Oh,!0),_e=P.createVertexBuffer(re,i.cR.members,!0);for(const ge of V){const Ee={u_matrix:ge.transform,u_inv_matrix:ge.invTransform,u_camera_to_center_distance:(Se=O).getCameraToCenterDistance(ge.projection),u_viewport_size:[Se.width,Se.height]};ee.draw(h,R.TRIANGLES,Tr.disabled,qr.disabled,h.colorModeForRenderPass(),Nr.disabled,Ee,s.id,_e,ae,i.b1.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,O.zoom)}var Se;_e.destroy(),ae.destroy()}const id=i.a6.mat4.create();function sm(h){const n=h._camera.getWorldToCamera(h.worldSize,1),s=i.a6.mat4.multiply([],n,h.globeMatrix);i.a6.mat4.invert(s,s);const p=[0,0,0],y=[0,1,0,0];return i.a6.vec4.transformMat4(y,y,s),p[0]=y[0],p[1]=y[1],p[2]=y[2],i.a6.vec3.normalize(p,p),p}function G1({width:h,height:n,anchor:s,textOffset:p,textScale:y},v){const{horizontalAlign:w,verticalAlign:P}=i.bx(s),R=-(w-.5)*h,O=-(P-.5)*n,F=i.bw(s,p);return new i.P((R/y+F[0])*v,(O/y+F[1])*v)}function H1(h,n,s,p,y,v,w,P,R,O,F){const V=h.text.placedSymbolArray,$=h.text.dynamicLayoutVertexArray,W=h.icon.dynamicLayoutVertexArray,ee={},re=h.getProjection(),ie=cl(P,re,v),ae=v.elevation,_e=re.upVectorScale(P.canonical,v.center.lat,v.worldSize).metersToTile;$.clear();for(let Se=0;Se<V.length;Se++){const ge=V.get(Se),{tileAnchorX:Ee,tileAnchorY:Me,numGlyphs:Fe}=ge,Re=ge.hidden||!ge.crossTileID||h.allowVerticalPlacement&&!ge.placedOrientation?null:p[ge.crossTileID];if(Re){let Ne=0,qe=0,Ue=0;if(ae){const _t=ae?ae.getAtTileOffset(P,Ee,Me):0,[Vt,Ut,Ct]=re.upVector(P.canonical,Ee,Me);Ne=_t*Vt*_e,qe=_t*Ut*_e,Ue=_t*Ct*_e}let[$e,nt,pt,Mt]=xo(ge.projectedAnchorX+Ne,ge.projectedAnchorY+qe,ge.projectedAnchorZ+Ue,s?ie:w);const ht=xn(v.getCameraToCenterDistance(re),Mt);let Nt=y.evaluateSizeForFeature(h.textSizeData,O,ge)*ht/i.bq;s&&(Nt*=h.tilePixelRatio/R);const it=G1(Re,Nt);s?({x:$e,y:nt,z:pt}=re.projectTilePoint(Ee+it.x,Me+it.y,P.canonical),[$e,nt,pt]=xo($e+Ne,nt+qe,pt+Ue,w)):(n&&it._rotate(-v.angle),$e+=it.x,nt+=it.y,pt=0);const St=h.allowVerticalPlacement&&ge.placedOrientation===i.bk.vertical?Math.PI/2:0;for(let _t=0;_t<Fe;_t++)i.bn($,$e,nt,pt,St);F&&ge.associatedIconIndex>=0&&(ee[ge.associatedIconIndex]={x:$e,y:nt,z:pt,angle:St})}else ra(Fe,$)}if(F){W.clear();const Se=h.icon.placedSymbolArray;for(let ge=0;ge<Se.length;ge++){const Ee=Se.get(ge),{numGlyphs:Me}=Ee,Fe=ee[ge];if(Ee.hidden||!Fe)ra(Me,W);else{const{x:Re,y:Ne,z:qe,angle:Ue}=Fe;for(let $e=0;$e<Me;$e++)i.bn(W,Re,Ne,qe,Ue)}}h.icon.dynamicLayoutVertexBuffer.updateData(W)}h.text.dynamicLayoutVertexBuffer.updateData($)}function od(h,n,s,p,y,v,w={}){const P=s.paint.get("icon-translate"),R=s.paint.get("text-translate"),O=s.paint.get("icon-translate-anchor"),F=s.paint.get("text-translate-anchor"),V=s.layout.get("icon-rotation-alignment"),$=s.layout.get("text-rotation-alignment"),W=s.layout.get("icon-pitch-alignment"),ee=s.layout.get("text-pitch-alignment"),re=s.layout.get("icon-keep-upright"),ie=s.layout.get("text-keep-upright"),ae=s.paint.get("icon-color-saturation"),_e=s.paint.get("icon-color-contrast"),Se=s.paint.get("icon-color-brightness-min"),ge=s.paint.get("icon-color-brightness-max"),Ee=s.paint.get("symbol-elevation-reference")==="sea",Me=s.paint.get("text-occlusion-opacity").constantOr(0),Fe=h.context,Re=Fe.gl,Ne=h.transform,qe=V==="map",Ue=$==="map",$e=W==="map",nt=ee==="map",pt=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Mt=!1;const ht=h.depthModeForSublayer(0,Tr.ReadOnly),Nt=[i.am(Ne.center.lng),i.at(Ne.center.lat)],it=s.layout.get("text-variable-anchor"),St=Ne.projection.name==="globe",_t=[],Vt=[0,-1,0];for(const Ut of p){const Ct=n.getTile(Ut),Pt=Ct.getBucket(s);if(!Pt||Pt.projection.name==="mercator"&&St||Pt.fullyClipped)continue;const xr=Pt.projection.name==="globe",Kt=xr?i.a9(Ne.zoom):0,lr=cl(Ut,Pt.getProjection(),Ne),Lr=Ne.calculatePixelsToTileUnitsMatrix(Ct),fr=it&&Pt.hasTextData(),kr=Pt.hasIconTextFit()&&fr&&Pt.hasIconData(),rn=Pt.getProjection().createInversionMatrix(Ne,Ut.canonical),Jr=On=>{Ne.depthOcclusionForSymbolsAndCircles&&(s.hasInitialOcclusionOpacityProperties||h.terrain)&&(On.push("DEPTH_D24"),On.push("DEPTH_OCCLUSION"))},Ln=()=>{const On=qe&&s.layout.get("symbol-placement")!=="point",en=[];Jr(en);const wn=On||kr,Dn=s.paint.get("icon-image-cross-fade").constantOr(0);h.terrainRenderModeElevated()&&$e&&en.push("PITCH_WITH_MAP_TERRAIN"),xr&&(en.push("PROJECTION_GLOBE_VIEW"),wn&&en.push("PROJECTED_POS_ON_VIEWPORT")),Dn>0&&en.push("ICON_TRANSITION"),Pt.icon.zOffsetVertexBuffer&&en.push("Z_OFFSET"),ae===0&&_e===0&&Se===0&&ge===1||en.push("COLOR_ADJUSTMENT"),Pt.sdfIcons&&en.push("RENDER_SDF");const xi=Pt.icon.programConfigurations.get(s.id),Ai=h.getOrCreateProgram("symbol",{config:xi,defines:en}),yn=Ct.imageAtlasTexture?Ct.imageAtlasTexture.size:[0,0],$i=Pt.iconSizeData,Xi=i.bj($i,Ne.zoom),Ui=$e||Ne.pitch!==0,Zn=fn(lr,Ct.tileID.canonical,$e,qe,Ne,Pt.getProjection(),Lr),Ao=$o(lr,Ct.tileID.canonical,$e,qe,Ne,Pt.getProjection(),Lr),Do=h.translatePosMatrix(Ao,Ct,P,O,!0),ys=h.translatePosMatrix(lr,Ct,P,O),ss=wn?id:Zn,Ho=qe&&!$e&&!On;let _s=Vt;!St&&!Ne.mercatorFromTransition||qe||(_s=sm(Ne));const Oa=xr?_s:Vt,vl=s.getColorAdjustmentMatrix(ae,_e,Se,ge),aa=im($i.kind,Xi,Ho,$e,h,ys,ss,Do,Ee,!1,yn,[0,0],!0,Ut,Kt,Nt,rn,Oa,Pt.getProjection(),vl,Dn),Jc=Ct.imageAtlasTexture?Ct.imageAtlasTexture:null,Qc=s.layout.get("icon-size").constantOr(0)!==1||Pt.iconsNeedLinear,ep=Pt.sdfIcons||h.options.rotating||h.options.zooming||Qc||Ui?Re.LINEAR:Re.NEAREST,eu=Pt.sdfIcons&&s.paint.get("icon-halo-width").constantOr(1)!==0,Yn=h.terrain&&$e&&On?i.a6.mat4.invert(i.a6.mat4.create(),Zn):id;if(On&&Pt.icon){const tc=Ne.elevation,ab=tc?tc.getAtTileOffsetFunc(Ut,Ne.center.lat,Ne.worldSize,Pt.getProjection()):null,H_=mn(lr,Ct.tileID.canonical,$e,qe,Ne,Pt.getProjection(),Lr);Sc(Pt,lr,h,!1,H_,Ao,$e,re,ab,Ut)}return{program:Ai,buffers:Pt.icon,uniformValues:aa,atlasTexture:Jc,atlasTextureIcon:null,atlasInterpolation:ep,atlasInterpolationIcon:null,isSDF:Pt.sdfIcons,hasHalo:eu,tile:Ct,labelPlaneMatrixInv:Yn}},Un=()=>{const On=Ue&&s.layout.get("symbol-placement")!=="point",en=[],wn=On||it||kr;h.terrainRenderModeElevated()&&nt&&en.push("PITCH_WITH_MAP_TERRAIN"),xr&&(en.push("PROJECTION_GLOBE_VIEW"),wn&&en.push("PROJECTED_POS_ON_VIEWPORT")),Pt.text.zOffsetVertexBuffer&&en.push("Z_OFFSET"),Pt.iconsInText&&en.push("RENDER_TEXT_AND_SYMBOL"),en.push("RENDER_SDF"),Jr(en);const Dn=Pt.text.programConfigurations.get(s.id),xi=h.getOrCreateProgram("symbol",{config:Dn,defines:en});let Ai,yn=[0,0],$i=null;const Xi=Pt.textSizeData;Pt.iconsInText&&(yn=Ct.imageAtlasTexture?Ct.imageAtlasTexture.size:[0,0],$i=Ct.imageAtlasTexture?Ct.imageAtlasTexture:null,Ai=nt||Ne.pitch!==0||h.options.rotating||h.options.zooming||Xi.kind==="composite"||Xi.kind==="camera"?Re.LINEAR:Re.NEAREST);const Ui=Ct.glyphAtlasTexture?Ct.glyphAtlasTexture.size:[0,0],Zn=i.bj(Xi,Ne.zoom),Ao=fn(lr,Ct.tileID.canonical,nt,Ue,Ne,Pt.getProjection(),Lr),Do=$o(lr,Ct.tileID.canonical,nt,Ue,Ne,Pt.getProjection(),Lr),ys=h.translatePosMatrix(Do,Ct,R,F,!0),ss=h.translatePosMatrix(lr,Ct,R,F),Ho=wn?id:Ao,_s=Ue&&!nt&&!On;let Oa=Vt;!St&&!Ne.mercatorFromTransition||Ue||(Oa=sm(Ne));const vl=im(Xi.kind,Zn,_s,nt,h,ss,Ho,ys,Ee,!0,Ui,yn,!0,Ut,Kt,Nt,rn,xr?Oa:Vt,Pt.getProjection(),Me),aa=Ct.glyphAtlasTexture?Ct.glyphAtlasTexture:null,Jc=Re.LINEAR,Qc=s.paint.get("text-halo-width").constantOr(1)!==0,ep=h.terrain&&nt&&On?i.a6.mat4.invert(i.a6.mat4.create(),Ao):id;if(On&&Pt.text){const eu=Ne.elevation,Yn=eu?eu.getAtTileOffsetFunc(Ut,Ne.center.lat,Ne.worldSize,Pt.getProjection()):null,tc=mn(lr,Ct.tileID.canonical,nt,Ue,Ne,Pt.getProjection(),Lr);Sc(Pt,lr,h,!0,tc,Do,nt,ie,Yn,Ut)}return{program:xi,buffers:Pt.text,uniformValues:vl,atlasTexture:aa,atlasTextureIcon:$i,atlasInterpolation:Jc,atlasInterpolationIcon:Ai,isSDF:!0,hasHalo:Qc,tile:Ct,labelPlaneMatrixInv:ep}},Qn=Pt.icon.segments.get().length,gs=Pt.text.segments.get().length,Pi=Qn&&!w.onlyText?Ln():null,un=gs&&!w.onlyIcons?Un():null,Nn=s.paint.get("icon-opacity").constantOr(1),ui=s.paint.get("text-opacity").constantOr(1);if(pt&&Pt.canOverlap){Mt=!0;const On=Nn&&!w.onlyText?Pt.icon.segments.get():[],en=ui&&!w.onlyIcons?Pt.text.segments.get():[];for(const wn of On)_t.push({segments:new i.b1([wn]),sortKey:wn.sortKey,state:Pi});for(const wn of en)_t.push({segments:new i.b1([wn]),sortKey:wn.sortKey,state:un})}else w.onlyText||_t.push({segments:Nn?Pt.icon.segments:new i.b1([]),sortKey:0,state:Pi}),w.onlyIcons||_t.push({segments:ui?Pt.text.segments:new i.b1([]),sortKey:0,state:un})}Mt&&_t.sort((Ut,Ct)=>Ut.sortKey-Ct.sortKey);for(const Ut of _t){const Ct=Ut.state;if(Ct)if(h.terrain?h.terrain.setupElevationDraw(Ct.tile,Ct.program,{useDepthForOcclusion:Ne.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ct.labelPlaneMatrixInv}):h.setupDepthForOcclusion(Ne.depthOcclusionForSymbolsAndCircles,Ct.program),Fe.activeTexture.set(Re.TEXTURE0),Ct.atlasTexture&&Ct.atlasTexture.bind(Ct.atlasInterpolation,Re.CLAMP_TO_EDGE,!0),Ct.atlasTextureIcon&&(Fe.activeTexture.set(Re.TEXTURE1),Ct.atlasTextureIcon&&Ct.atlasTextureIcon.bind(Ct.atlasInterpolationIcon,Re.CLAMP_TO_EDGE,!0)),h.uploadCommonLightUniforms(h.context,Ct.program),Ct.hasHalo){const Pt=Ct.uniformValues;Pt.u_is_halo=1,sd(Ct.buffers,Ut.segments,s,h,Ct.program,ht,y,v,Pt,2),Pt.u_is_halo=0}else{if(Ct.isSDF){const Pt=Ct.uniformValues;Ct.hasHalo&&(Pt.u_is_halo=1,sd(Ct.buffers,Ut.segments,s,h,Ct.program,ht,y,v,Pt,1)),Pt.u_is_halo=0}sd(Ct.buffers,Ut.segments,s,h,Ct.program,ht,y,v,Ct.uniformValues,1)}}}function sd(h,n,s,p,y,v,w,P,R,O){const F=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.iconTransitioningVertexBuffer,h.globeExtVertexBuffer,h.zOffsetVertexBuffer];y.draw(p,p.context.gl.TRIANGLES,v,w,P,Nr.disabled,R,s.id,h.layoutVertexBuffer,h.indexBuffer,n,s.paint,p.transform.zoom,h.programConfigurations.get(s.id),F,O)}function Bh(h,n,s,p,y,v,w){const P=h.context.gl,R=s.paint.get("fill-pattern"),O=s.is3D(),F=O?h.stencilModeFor3D():qr.disabled,V=R&&R.constantOr(1);let $,W,ee,re,ie;w?(W=V&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=P.LINES):(W=V?"fillPattern":"fill",$=P.TRIANGLES);for(const ae of p){const _e=n.getTile(ae);if(V&&!_e.patternsLoaded())continue;const Se=_e.getBucket(s);if(!Se)continue;h.prepareDrawTile();const ge=Se.programConfigurations.get(s.id),Ee=h.isTileAffectedByFog(ae),Me=h.getOrCreateProgram(W,{config:ge,overrideFog:Ee});V&&(h.context.activeTexture.set(P.TEXTURE0),_e.imageAtlasTexture&&_e.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),ge.updatePaintBuffers());const Fe=R.constantOr(null);if(Fe&&_e.imageAtlas){const qe=_e.imageAtlas.patternPositions[Fe.toString()];qe&&ge.setConstantPatternPositions(qe)}const Re=h.translatePosMatrix(ae.projMatrix,_e,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor")),Ne=s.paint.get("fill-emissive-strength");if(w){re=Se.indexBuffer2,ie=Se.segments2;const qe=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[P.drawingBufferWidth,P.drawingBufferHeight];ee=W==="fillOutlinePattern"&&V?rd(Re,Ne,h,_e,qe):w_(Re,Ne,qe)}else re=Se.indexBuffer,ie=Se.segments,ee=V?b_(Re,Ne,h,_e):kh(Re,Ne);h.uploadCommonUniforms(h.context,Me,ae.toUnwrapped()),Me.draw(h,$,y,O?F:h.stencilModeForClipping(ae),v,Nr.disabled,ee,s.id,Se.layoutVertexBuffer,re,ie,s.paint,h.transform.zoom,ge,void 0)}}function $c(h,n,s,p,y,v,w,P){s.resetLayerRenderingStats(h);const R=h.context,O=R.gl,F=h.transform,V=s.paint.get("fill-extrusion-pattern"),$=V.constantOr(1),W=s.paint.get("fill-extrusion-opacity"),ee=h.style.enable3dLights(),re=s.paint.get(ee&&!$?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ie=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),re],ae=s.layout.get("fill-extrusion-edge-radius"),_e=ae>0&&!s.paint.get("fill-extrusion-rounded-roof"),Se=_e?0:ae,ge=F.projection.name==="globe"?i.c_():0,Ee=F.projection.name==="globe",Me=Ee?i.a9(F.zoom):0,Fe=[i.am(F.center.lng),i.at(F.center.lat)],Re=s.paint.get("fill-extrusion-flood-light-color").toRenderColor(s.lut).toArray01().slice(0,3),Ne=s.paint.get("fill-extrusion-flood-light-intensity"),qe=s.paint.get("fill-extrusion-vertical-scale"),Ue=s.paint.get("fill-extrusion-line-width").constantOr(1)!==0,$e=Pa(h,s.paint.get("fill-extrusion-cutoff-fade-range")),nt=[];let pt;Ee&&nt.push("PROJECTION_GLOBE_VIEW"),ie[0]>0&&nt.push("FAUX_AO"),_e&&nt.push("ZERO_ROOF_RADIUS"),P&&nt.push("HAS_CENTROID"),Ne>0&&nt.push("FLOOD_LIGHT"),$e.shouldRenderCutoff&&nt.push("RENDER_CUTOFF"),Ue&&nt.push("RENDER_WALL_MODE");const Mt=h.renderPass==="shadow",ht=h.shadowRenderer,Nt=Mt&&!!ht;h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!0);let it=[0,0,0];if(ht){const Vt=h.style.directionalLight,Ut=h.style.ambientLight;Vt&&Ut&&(it=fh(h.style,Vt,Ut)),pt=nt.concat(["SHADOWS_SINGLE_CASCADE"])}const St=Nt?"fillExtrusionDepth":$?"fillExtrusionPattern":"fillExtrusion",_t=s.getLayerRenderingStats();for(const Vt of p){const Ut=n.getTile(Vt),Ct=Ut.getBucket(s);if(!Ct||Ct.projection.name!==F.projection.name)continue;let Pt=!1;ht&&(Pt=ht.getMaxCascadeForTile(Vt.toUnwrapped())===0);const xr=h.isTileAffectedByFog(Vt),Kt=Ct.programConfigurations.get(s.id),lr=h.getOrCreateProgram(St,{config:Kt,defines:Pt?pt:nt,overrideFog:xr});if(h.terrain&&h.terrain.setupElevationDraw(Ut,lr,{useMeterToDem:!0}),!Ct.centroidVertexBuffer){const Un=lr.attributes.a_centroid_pos;Un!==void 0&&O.vertexAttrib2f(Un,0,0)}!Mt&&ht&&ht.setupShadows(Ut.tileID.toUnwrapped(),lr,"vector-tile",Ut.tileID.overscaledZ),$&&(h.context.activeTexture.set(O.TEXTURE0),Ut.imageAtlasTexture&&Ut.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Kt.updatePaintBuffers());const Lr=V.constantOr(null);if(Lr&&Ut.imageAtlas){const Un=Ut.imageAtlas.patternPositions[Lr.toString()];Un&&Kt.setConstantPatternPositions(Un)}const fr=s.paint.get("fill-extrusion-vertical-gradient"),kr=1/Ct.tileToMeter;let rn;if(Mt&&ht){if(cm(Ut.tileID,Ct,h))continue;const Un=ht.calculateShadowPassMatrixFromTile(Ut.tileID.toUnwrapped());rn=v_(Un,Se,kr,qe)}else{const Un=h.translatePosMatrix(Vt.expandedProjMatrix,Ut,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Qn=F.projection.createInversionMatrix(F,Vt.canonical);rn=$?rm(Un,h,fr,W,ie,Se,kr,Vt,Ut,ge,Me,Fe,Qn,Re,qe):tm(Un,h,fr,W,ie,Se,kr,Vt,ge,Me,Fe,Qn,Re,qe,Ne,it)}h.uploadCommonUniforms(R,lr,Vt.toUnwrapped(),null,$e);let Jr=Ct.segments;if(F.projection.name==="mercator"&&!Mt&&(Jr=Ct.getVisibleSegments(Ut.tileID,h.terrain,h.transform.getFrustum(0)),!Jr.get().length))continue;if(_t)if(Mt)for(const Un of Jr.get())_t.numRenderedVerticesInShadowPass+=Un.primitiveLength;else for(const Un of Jr.get())_t.numRenderedVerticesInTransparentPass+=Un.primitiveLength;const Ln=[];(h.terrain||P)&&Ln.push(Ct.centroidVertexBuffer),Ee&&Ln.push(Ct.layoutVertexExtBuffer),Ue&&Ln.push(Ct.wallVertexBuffer),lr.draw(h,R.gl.TRIANGLES,y,v,w,Nr.backCCW,rn,s.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Jr,s.paint,h.transform.zoom,Kt,Ln)}h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!1)}function to(h,n,s,p,y,v,w,P,R,O,F,V,$,W,ee,re,ie,ae,_e){const Se=h.context,ge=Se.gl,Ee=h.transform,Me=h.transform.zoom,Fe=[],Re=Pa(h,s.paint.get("fill-extrusion-cutoff-fade-range"));O==="clear"?(Fe.push("CLEAR_SUBPASS"),_e&&(Fe.push("CLEAR_FROM_TEXTURE"),Se.activeTexture.set(ge.TEXTURE0),_e.bind(ge.LINEAR,ge.CLAMP_TO_EDGE))):O==="sdf"&&Fe.push("SDF_SUBPASS"),ie&&Fe.push("HAS_CENTROID"),Re.shouldRenderCutoff&&Fe.push("RENDER_CUTOFF");const Ne=s.layout.get("fill-extrusion-edge-radius"),qe=(Ue,$e,nt,pt,Mt)=>{const ht=$e.programConfigurations.get(s.id),Nt=h.isTileAffectedByFog(Ue),it=h.getOrCreateProgram("fillExtrusionGroundEffect",{config:ht,defines:Fe,overrideFog:Nt}),St=((Vt,Ut,Ct,Pt,xr,Kt,lr,Lr,fr,kr,rn)=>({u_matrix:Ut,u_opacity:Ct,u_ao_pass:Pt?1:0,u_meter_to_tile:xr,u_ao:Kt,u_flood_light_intensity:lr,u_flood_light_color:Lr,u_attenuation:fr,u_edge_radius:kr,u_fb:0,u_fb_size:rn,u_dynamic_offset:1}))(0,pt,F,R,Mt,[V,$*Mt],W,ee,re,Me>=17?0:Ne*Mt,_e?_e.size[0]:0),_t=[];ie&&_t.push($e.hiddenByLandmarkVertexBuffer),h.uploadCommonUniforms(Se,it,Ue.toUnwrapped(),null,Re),it.draw(h,Se.gl.TRIANGLES,y,v,w,P,St,s.id,$e.vertexBuffer,$e.indexBuffer,nt,s.paint,Me,ht,_t)};for(const Ue of p){const $e=n.getTile(Ue),nt=$e.getBucket(s);if(!nt||nt.projection.name!==Ee.projection.name||!nt.groundEffect||nt.groundEffect&&!nt.groundEffect.hasData())continue;const pt=nt.groundEffect,Mt=1/nt.tileToMeter;{const ht=h.translatePosMatrix(Ue.projMatrix,$e,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Nt=pt.getDefaultSegment();qe(Ue,pt,Nt,ht,Mt)}if(ae)for(let ht=0;ht<4;ht++){const Nt=i.c$[ht](Ue),it=n.getTile(Nt);if(!it)continue;const St=it.getBucket(s);if(!St||St.projection.name!==Ee.projection.name||!St.groundEffect||St.groundEffect&&!St.groundEffect.hasData())continue;const _t=St.groundEffect;let Vt,Ut;ht===0?(Vt=[-i.ab,0,0],Ut=1):ht===1?(Vt=[i.ab,0,0],Ut=0):ht===2?(Vt=[0,-i.ab,0],Ut=3):(Vt=[0,i.ab,0],Ut=2);const Ct=_t.regionSegments[Ut];if(!Ct)continue;const Pt=new Float32Array(16);i.a6.mat4.translate(Pt,Ue.projMatrix,Vt),qe(Ue,_t,Ct,h.translatePosMatrix(Pt,$e,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Mt)}}}function fl(h,n,s,p,y,v,w){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const P=v?v.findDEMTileFor(s):null;if(!(P&&P.dem||w))return;const R=ae=>new i.P(Math.ceil((ae+i.d2)*i.d3),0),O=ae=>{const _e=n.getSource().minzoom,Se=Ee=>{const Me=n.getTileByID(Ee);if(Me&&Me.hasData())return Me.getBucket(y)},ge=[0,-1,1];for(const Ee of ge){if(ae.overscaledZ+Ee<_e)continue;const Me=Se(ae.calculateScaledKey(ae.overscaledZ+Ee));if(Me)return Me}},F=[0,0,0],V=(ae,_e)=>(F[0]=Math.min(ae.min.y,_e.min.y),F[1]=Math.max(ae.max.y,_e.max.y),F[2]=i.ab-_e.min.x>ae.max.x?_e.min.x-i.ab:ae.max.x,F),$=(ae,_e)=>(F[0]=Math.min(ae.min.x,_e.min.x),F[1]=Math.max(ae.max.x,_e.max.x),F[2]=i.ab-_e.min.y>ae.max.y?_e.min.y-i.ab:ae.max.y,F),W=[(ae,_e)=>V(ae,_e),(ae,_e)=>V(_e,ae),(ae,_e)=>$(ae,_e),(ae,_e)=>$(_e,ae)],ee=(ae,_e,Se,ge,Ee,Me,Fe)=>{if(!v)return 0;const Re=[[Me?Se:ae,Me?ae:Se,0],[Me?Se:_e,Me?_e:Se,0]],Ne=Fe<0?i.ab+Fe:Fe,qe=[Me?Ne:(ae+_e)/2,Me?(ae+_e)/2:Ne,0];return Se===0&&Fe<0||Se!==0&&Fe>0?v.getForTilePoints(Ee,[qe],!0,ge):Re.push(qe),v.getForTilePoints(s,Re,!0,P),Math.max(Re[0][2],Re[1][2],qe[2])/v.exaggeration()};for(let ae=0;ae<4;ae++){const _e=p.borderFeatureIndices[ae];if(_e.length===0)continue;const Se=i.c$[ae](s),ge=O(Se);if(!(ge&&ge instanceof i.d0)||p.borderDoneWithNeighborZ[ae]===ge.canonical.z)continue;ge.centroidVertexArray.length===0&&ge.createCentroidsBuffer();const Ee=v?v.findDEMTileFor(Se):null;if(!(Ee&&Ee.dem||w))continue;const Me=(ae<2?1:5)-ae,Fe=ge.borderDoneWithNeighborZ[Me]!==p.canonical.z,Re=ge.borderFeatureIndices[Me];let Ne=0;if(p.canonical.z!==ge.canonical.z){for(const qe of _e)p.showCentroid(p.featuresOnBorder[qe]);if(Fe)for(const qe of Re)ge.showCentroid(ge.featuresOnBorder[qe]);p.borderDoneWithNeighborZ[ae]=ge.canonical.z,ge.borderDoneWithNeighborZ[Me]=p.canonical.z}for(const qe of _e){const Ue=p.featuresOnBorder[qe],$e=p.centroidData[Ue.centroidDataIndex],nt=Ue.borders[ae];let pt;for(;Ne<Re.length;){pt=ge.featuresOnBorder[Re[Ne]];const Mt=pt.borders[Me];if(Mt[1]>nt[0]+3||Mt[0]>nt[0]-3)break;ge.showCentroid(pt),Ne++}if(pt&&Ne<Re.length){const Mt=Ne;let ht=0;for(;!(pt.borders[Me][0]>nt[1]-3)&&(ht++,++Ne!==Re.length);)pt=ge.featuresOnBorder[Re[Ne]];pt=ge.featuresOnBorder[Re[Mt]];let Nt=!1;if(ht>=1){const _t=pt.borders[Me];Math.abs(nt[0]-_t[0])<3&&Math.abs(nt[1]-_t[1])<3&&(ht=1,Nt=!0,Ne=Mt+1)}else if(ht===0){p.showCentroid(Ue);continue}const it=ge.centroidData[pt.centroidDataIndex];w&&Nt&&(((re=$e).flags|(ie=it).flags)&i.d1?(re.flags|=i.d1,ie.flags|=i.d1):(re.flags&=~i.d1,ie.flags&=~i.d1));const St=Ue.intersectsCount()>1||pt.intersectsCount()>1;if(ht>1)Ne=Mt,$e.centroidXY=it.centroidXY=new i.P(0,0);else if(Ee&&Ee.dem&&!St){const _t=W[ae]($e,it),Vt=ae%2?i.ab-1:0,Ut=ee(_t[0],Math.min(i.ab-1,_t[1]),Vt,Ee,Se,ae<2,_t[2]);$e.centroidXY=it.centroidXY=R(Ut)}else St?$e.centroidXY=it.centroidXY=new i.P(0,0):($e.centroidXY=p.encodeBorderCentroid(Ue),it.centroidXY=ge.encodeBorderCentroid(pt));p.writeCentroidToBuffer($e),ge.writeCentroidToBuffer(it)}else p.showCentroid(Ue)}p.borderDoneWithNeighborZ[ae]=ge.canonical.z,ge.borderDoneWithNeighborZ[Me]=p.canonical.z}var re,ie;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(h)}const I_=[1,0,0],am=[0,1,0],lm=[0,0,1];function cm(h,n,s){const p=s.transform,y=s.shadowRenderer;if(!y)return!0;const v=h.toUnwrapped(),w=p.tileSize*y._cascades[s.currentShadowCascade].scale;let P=n.maxHeight;if(p.elevation){const re=p.elevation.getMinMaxForTile(h);re&&(P+=re.max)}const R=[...y.shadowDirection];R[2]=-R[2];const O=y.computeSimplifiedTileShadowVolume(v,P,w,R);if(!O)return!1;const F=[I_,am,lm,R,[R[0],0,R[2]],[0,R[1],R[2]]],V=p.projection.name==="globe",$=p.scaleZoom(w),W=i.bN.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,$,!V),ee=y.getCurrentCascadeFrustum();return W.intersectsPrecise(O.vertices,O.planes,F)===0||ee.intersectsPrecise(O.vertices,O.planes,F)===0}function um(h){return[h[0]*i.d4,h[1]*i.d4,h[2]*i.d4,0]}function Go(h,n,s,p,y,v,w,P,R){const O=p.getSource(),F=s.globeSharedBuffers;if(!F)return;let V,$,W;if(n&&(V=p.getTile(n)),O instanceof i.aD?($=O.texture,W=i.cD(0,0,s.transform)):V&&n&&($=V.texture,W=i.cD(n.canonical.z,n.canonical.x,s.transform)),!$||!W)return;h||(W=i.a6.mat4.scale(i.a6.mat4.create(),W,[1,-1,1]));const ee=s.context,re=ee.gl,ie=y.paint.get("raster-resampling")==="nearest"?re.NEAREST:re.LINEAR,ae=s.colorModeForDrapableLayerRenderPass(v),_e=w.defines;_e.push("GLOBE_POLES");const Se=new Tr(re.LEQUAL,Tr.ReadWrite,s.depthRangeFor3D),ge=Float32Array.from(s.transform.expandedFarZProjMatrix),Ee=Float32Array.from(i.b5(i.cC(new i.bP(0,0,0))));s.terrain&&s.terrain.prepareDrawTile(),ee.activeTexture.set(re.TEXTURE0),$.bind(ie,re.CLAMP_TO_EDGE),ee.activeTexture.set(re.TEXTURE1),$.bind(ie,re.CLAMP_TO_EDGE),$.useMipmap&&ee.extTextureFilterAnisotropic&&s.transform.pitch>20&&re.texParameterf(re.TEXTURE_2D,ee.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ee.extTextureFilterAnisotropicMax);const[Me,Fe,Re,Ne]=n?F.getPoleBuffers(n.canonical.z,!1):F.getPoleBuffers(0,!0),qe=y.paint.get("raster-elevation");let Ue;h?(Ue=Me,s.renderDefaultNorthPole=qe!==0):(Ue=Fe,s.renderDefaultSouthPole=qe!==0);const $e=um(w.mix),nt=((Mt,ht,Nt,it,St,_t,Vt,Ut,Ct,Pt,xr,Kt,lr)=>nd(Mt,ht,Nt,new Float32Array(16),new Float32Array(9),[0,0],it,[0,0],[0,0,0,0],1,{opacity:1,mix:0},_t,[0,0],Ut,2,Pt,xr,Kt,1,0,lr))(ge,Ee,W,i.a9(s.transform.zoom),0,y,0,qe,0,$e,w.offset,w.range,v),pt=s.getOrCreateProgram("raster",{defines:_e});s.uploadCommonUniforms(ee,pt,null),pt.draw(s,re.TRIANGLES,Se,R,ae,P,nt,y.id,Ue,Re,Ne)}function yi(h){const n=h._nearZ,s=h.projection.farthestPixelDistance(h),p=s-n,y=.2*h.height,v=n+y;return[n,s,(v-y-n)/p,(v-n)/p]}function jh(h,n,s,p){if(h)return n instanceof il&&h instanceof nh?n.getTextureDescriptor(h,s,!0):{texture:h.texture,mix:um(p.mix),offset:p.offset,buffer:0,tileSize:1}}var dm=i.d5([{name:"a_index",type:"Int16",components:1}]);class k_{constructor(n,s,p,y){const v={width:p[0],height:p[1],data:null},w=n.gl;this.targetColorTexture=new i.T(n,v,w.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(n,v,w.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(s,y),this.lastInvalidatedAt=0}updateParticleTexture(n,s){if(this.particleTextureDimension===s.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,y=s.width*s.height;this.particleTexture0=new i.T(this.context,s,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,s,p.RGBA8,{premultiply:!1,useMipmap:!1});const v=new i.d6;v.reserve(y);for(let w=0;w<y;w++)v.emplaceBack(w);this.particleIndexBuffer=this.context.createVertexBuffer(v,dm.members,!0),this.particleSegment=i.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=s.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function P_(h,n,s){if(!h)return null;const p=n.getTextureDescriptor(h,s,!0);if(!p)return null;let{texture:y,mix:v,offset:w,tileSize:P,buffer:R,format:O}=p;if(!y||!O)return null;let F=!1;return O==="uint32"&&(F=!0,v[3]=0,v=Ph(i.d7,v,[0,s.paint.get("raster-particle-max-speed")]),w=Ah(i.d7,w,[0,s.paint.get("raster-particle-max-speed")])),{texture:y,textureOffset:[R/(P+2*R),P/(P+2*R)],tileSize:P,scalarData:F,scale:v,offset:w,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[O]]}}function A_(h){const n=h._nearZ,s=h.projection.farthestPixelDistance(h),p=s-n,y=.2*h.height,v=n+y;return[n,s,(v-y-n)/p,(v-n)/p]}const q1=new i.bz(1,0,0,1),Uc=new i.bz(0,1,0,1),Wc=new i.bz(0,0,1,1),Zt=new i.bz(1,0,1,1),_r=new i.bz(0,1,1,1);function Rs(h,n,s,p,y,v,w){const P=h.context,R=h.transform,O=P.gl,F=R.projection.name==="globe",V=F?["PROJECTION_GLOBE_VIEW"]:[];let $=i.a6.mat4.clone(s.projMatrix);if(F&&i.a9(R.zoom)>0){const $e=i.b4(s.canonical,R),nt=i.d8($e);$=i.a6.mat4.multiply(new Float32Array(16),R.globeMatrix,nt),i.a6.mat4.multiply($,R.projMatrix,$)}const W=i.a6.mat4.create();W[12]+=2*y/(i.q.devicePixelRatio*R.width),W[13]+=2*v/(i.q.devicePixelRatio*R.height),i.a6.mat4.multiply($,W,$);const ee=h.getOrCreateProgram("debug",{defines:V}),re=n.getTileByID(s.key);h.terrain&&h.terrain.setupElevationDraw(re,ee);const ie=Tr.disabled,ae=qr.disabled,_e=h.colorModeForRenderPass(),Se="$debug";P.activeTexture.set(O.TEXTURE0),h.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),F?re._makeGlobeTileDebugBuffers(h.context,R):re._makeDebugTileBoundsBuffers(h.context,R.projection);const ge=re._tileDebugBuffer||h.debugBuffer,Ee=re._tileDebugIndexBuffer||h.debugIndexBuffer,Me=re._tileDebugSegments||h.debugSegments;if(ee.draw(h,O.LINE_STRIP,ie,ae,_e,Nr.disabled,S_($,p),Se,ge,Ee,Me,null,null,null,[re._globeTileDebugBorderBuffer]),w){const $e=re.latestRawTileData,nt=Math.floor(($e&&$e.byteLength||0)/1024);let pt=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(pt+=` => ${s.overscaledZ}`),pt+=` ${re.state}`,pt+=` ${nt}kb`,function(Mt,ht){Mt.initDebugOverlayCanvas();const Nt=Mt.debugOverlayCanvas,it=Mt.context.gl,St=Mt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,Nt.width,Nt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(ht,5,5),St.strokeText(ht,5,5),Mt.debugOverlayTexture.update(Nt),Mt.debugOverlayTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE)}(h,pt)}const Fe=n.getTile(s).tileSize,Re=512/Math.min(Fe,512)*(s.overscaledZ/R.zoom)*.5,Ne=re._tileDebugTextBuffer||h.debugBuffer,qe=re._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Ue=re._tileDebugTextSegments||h.debugSegments;ee.draw(h,O.TRIANGLES,ie,ae,cn.alphaBlended,Nr.disabled,S_($,i.bz.transparent,Re),Se,Ne,qe,Ue,null,null,null,[re._globeTileDebugTextBuffer])}function ci(h,n,s,p){ad(h,0,n+s/2,h.transform.width,s,p)}function st(h,n,s,p){ad(h,n-s/2,0,s,h.transform.height,p)}function ad(h,n,s,p,y,v){const w=h.context,P=w.gl;P.enable(P.SCISSOR_TEST),P.scissor(n*i.q.devicePixelRatio,s*i.q.devicePixelRatio,p*i.q.devicePixelRatio,y*i.q.devicePixelRatio),w.clear({color:v}),P.disable(P.SCISSOR_TEST)}const Nh=i.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:hm}=Nh;function Ls(h,n,s,p){h.emplaceBack(n,s,p)}class pm{constructor(n){this.vertexArray=new i.d9,this.indices=new i.aO,Ls(this.vertexArray,-1,-1,1),Ls(this.vertexArray,1,-1,1),Ls(this.vertexArray,-1,1,1),Ls(this.vertexArray,1,1,1),Ls(this.vertexArray,-1,-1,-1),Ls(this.vertexArray,1,-1,-1),Ls(this.vertexArray,-1,1,-1),Ls(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,hm),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=i.b1.simpleSegment(0,0,36,12)}}function Xl(h,n,s,p,y,v){const w=h.context.gl,P=n.paint.get("sky-atmosphere-color"),R=n.paint.get("sky-atmosphere-halo-color"),O=n.paint.get("sky-atmosphere-sun-intensity"),F=((V,$,W,ee,re)=>({u_matrix_3f:V,u_sun_direction:$,u_sun_intensity:W,u_color_tint_r:[ee.r,ee.g,ee.b,ee.a],u_color_tint_m:[re.r,re.g,re.b,re.a],u_luminance:5e-5}))(i.a6.mat3.fromMat4(i.a6.mat3.create(),p),y,O,P,R);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+v,n.skyboxTexture,0),s.draw(h,w.TRIANGLES,Tr.disabled,qr.disabled,cn.unblended,Nr.frontCW,F,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Gc=i.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Z1{constructor(n){const s=new i.da;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const p=new i.aO;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(s,Gc.members),this.indexBuffer=n.createIndexBuffer(p),this.segments=i.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Y1=i.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class D_{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Vh{constructor(n){this.colorModeAlphaBlendedWriteRGB=new cn([1,ts,1,ts],i.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new cn([1,0,1,0],i.bz.transparent,[!1,!1,!1,!0]),this.params=new D_,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(n){const s=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Z1(s);const p=this.params.sizeRange,y=this.params.intensityRange,v=function(F){const V=i.dd(30),$=[];for(let W=0;W<F;++W){const ee=2*Math.PI*V(),re=Math.acos(1-2*V())-.5*Math.PI;$.push(i.a6.vec3.fromValues(Math.cos(re)*Math.cos(ee),Math.cos(re)*Math.sin(ee),Math.sin(re)))}return $}(this.params.starsCount),w=i.dd(300),P=new i.db,R=new i.aO;let O=0;for(let F=0;F<v.length;++F){const V=i.a6.vec3.scale([],v[F],200),$=Math.max(0,1+.01*p*(1*w()-.5)),W=Math.max(0,1+.01*y*(1*w()-.5));P.emplaceBack(V[0],V[1],V[2],-1,-1,$,W),P.emplaceBack(V[0],V[1],V[2],1,-1,$,W),P.emplaceBack(V[0],V[1],V[2],1,1,$,W),P.emplaceBack(V[0],V[1],V[2],-1,1,$,W),R.emplaceBack(O+0,O+1,O+2),R.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=s.createVertexBuffer(P,Y1.members),this.starsIdx=s.createIndexBuffer(R),this.starsSegments=i.b1.simpleSegment(0,0,P.length,R.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,s){const p=n.context,y=p.gl,v=n.transform,w=new Tr(y.LEQUAL,Tr.ReadOnly,[0,1]),P=i.a9(v.zoom),R=n.style.getLut(s.scope),O=s.properties.get("color").toRenderColor(R).toArray01(),F=s.properties.get("high-color").toRenderColor(R).toArray01(),V=s.properties.get("space-color").toRenderColor(R).toArray01PremultipliedAlpha(),$=5e-4,W=i.dc(s.properties.get("horizon-blend"),0,1,$,.25),ee=i.cx(n,p,v)&&W===$?v.worldSize/(2*Math.PI*1.025)-1:v.globeRadius,re=n.frameCounter/1e3%1,ie=i.a6.vec3.length(v.globeCenterInViewSpace),ae=Math.sqrt(Math.pow(ie,2)-Math.pow(ee,2)),_e=Math.acos(ae/ie),Se=ge=>{const Ee=v.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ge&&Ee.push("ALPHA_PASS");const Me=n.getOrCreateProgram("globeAtmosphere",{defines:Ee}),Fe=((Ne,qe,Ue,$e,nt,pt,Mt,ht,Nt,it,St,_t)=>({u_frustum_tl:Ne,u_frustum_tr:qe,u_frustum_br:Ue,u_frustum_bl:$e,u_horizon:nt,u_transition:pt,u_fadeout_range:Mt,u_color:ht,u_high_color:Nt,u_space_color:it,u_temporal_offset:St,u_horizon_angle:_t}))(v.frustumCorners.TL,v.frustumCorners.TR,v.frustumCorners.BR,v.frustumCorners.BL,v.frustumCorners.horizon,P,W,O,F,V,re,_e);n.uploadCommonUniforms(p,Me);const Re=this.atmosphereBuffer;Re&&Me.draw(n,y.TRIANGLES,w,qr.disabled,ge?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Nr.backCW,Fe,ge?"atmosphere_glow_alpha":"atmosphere_glow",Re.vertexBuffer,Re.indexBuffer,Re.segments)};Se(!1),Se(!0)}drawStars(n,s){const p=i.ap(s.properties.get("star-intensity"),0,1);if(p===0)return;const y=n.context,v=y.gl,w=n.transform,P=n.getOrCreateProgram("stars"),R=i.a6.quat.identity([]);i.a6.quat.rotateX(R,R,-w._pitch),i.a6.quat.rotateZ(R,R,-w.angle),i.a6.quat.rotateX(R,R,i.bB(w._center.lat)),i.a6.quat.rotateY(R,R,-i.bB(w._center.lng));const O=i.a6.mat4.fromQuat(new Float32Array(16),R),F=i.a6.mat4.multiply([],w.starsProjMatrix,O),V=i.a6.mat3.fromMat4([],O),$=i.a6.mat3.invert([],V),W=[0,1,0];i.a6.vec3.transformMat3(W,W,$),i.a6.vec3.scale(W,W,this.params.sizeMultiplier);const ee=[1,0,0];i.a6.vec3.transformMat3(ee,ee,$),i.a6.vec3.scale(ee,ee,this.params.sizeMultiplier);const re=(ie=W,ae=ee,_e=p,{u_matrix:Float32Array.from(F),u_up:ie,u_right:ae,u_intensity_multiplier:_e});var ie,ae,_e;n.uploadCommonUniforms(y,P),this.starsVx&&this.starsIdx&&P.draw(n,v.TRIANGLES,Tr.disabled,qr.disabled,this.colorModeAlphaBlendedWriteRGB,Nr.disabled,re,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function $h(h,n){const s=[...h],p=n.cameraWorldSizeForFog/n.worldSize,y=i.a6.mat4.identity([]);return i.a6.mat4.scale(y,y,[p,p,1]),i.a6.mat4.multiply(s,y,s),i.a6.mat4.multiply(s,n.worldToFogMatrix,s),s}function Uh(h,n,s,p,y){const v=s.material,w=p.context,{baseColorTexture:P,metallicRoughnessTexture:R}=v.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:F,emissionTexture:V}=v;function $(W,ee,re){if(W&&(h.push(ee),w.activeTexture.set(w.gl.TEXTURE0+re),W.gfxTexture)){const{minFilter:ie,magFilter:ae,wrapS:_e,wrapT:Se}=W.sampler;W.gfxTexture.bindExtraParam(ie,ae,_e,Se)}}$(P,"HAS_TEXTURE_u_baseColorTexture",ho.BaseColor),$(R,"HAS_TEXTURE_u_metallicRoughnessTexture",ho.MetallicRoughness),$(O,"HAS_TEXTURE_u_normalTexture",ho.Normal),$(F,"HAS_TEXTURE_u_occlusionTexture",ho.Occlusion),$(V,"HAS_TEXTURE_u_emissionTexture",ho.Emission),y&&(y.texture||(y.texture=new i.df(p.context,y.image,[y.image.height,y.image.height,y.image.height],w.gl.RGBA8)),w.activeTexture.set(w.gl.TEXTURE0+ho.LUT),y.texture&&y.texture.bind(w.gl.LINEAR,w.gl.CLAMP_TO_EDGE),h.push("APPLY_LUT_ON_GPU")),s.texcoordBuffer&&(h.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(s.texcoordBuffer)),s.colorBuffer&&(h.push(s.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(s.colorBuffer)),s.normalBuffer&&(h.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(s.normalBuffer)),s.pbrBuffer&&(h.push("HAS_ATTRIBUTE_a_pbr"),h.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(s.pbrBuffer)),v.alphaMode!=="OPAQUE"&&v.alphaMode!=="MASK"||h.push("UNPREMULT_TEXTURE_IN_SHADER"),v.defined||h.push("DIFFUSE_SHADED"),h.push("USE_STANDARD_DERIVATIVES")}function ld(h,n,s,p,y,v){const w=s.paint.get("model-opacity"),P=n.context,R=new Tr(n.context.gl.LEQUAL,Tr.ReadWrite,n.depthRangeFor3D),O=n.transform,F=h.mesh,V=F.material,$=V.pbrMetallicRoughness,W=n.style.fog;let ee;ee=n.transform.projection.zAxisUnit==="pixels"?[...h.nodeModelMatrix]:i.a6.mat4.multiply([],p.zScaleMatrix,h.nodeModelMatrix),i.a6.mat4.multiply(ee,p.negCameraPosMatrix,ee);const re=i.a6.mat4.invert([],ee);i.a6.mat4.transpose(re,re);const ie=s.paint.get("model-emissive-strength").constantOr(0),ae=ur(new Float32Array(h.worldViewProjection),new Float32Array(ee),new Float32Array(re),null,n,w,$.baseColorFactor.toRenderColor(null),V.emissiveFactor,$.metallicFactor,$.roughnessFactor,V,ie,s),_e={defines:[]},Se=[];Uh(_e.defines,Se,F,n,s.lut);const ge=n.shadowRenderer;ge&&(ge.useNormalOffset=!1);let Ee=null;if(W){const Re=$h(h.nodeModelMatrix,n.transform);if(Ee=new Float32Array(Re),O.projection.name!=="globe"){const Ne=F.aabb.min,qe=F.aabb.max,[Ue,$e]=W.getOpacityForBounds(Re,Ne[0],Ne[1],qe[0],qe[1]);_e.overrideFog=Ue>=nr||$e>=nr}}const Me=Pa(n,s.paint.get("model-cutoff-fade-range"));Me.shouldRenderCutoff&&_e.defines.push("RENDER_CUTOFF");const Fe=n.getOrCreateProgram("model",_e);n.uploadCommonUniforms(P,Fe,null,Ee,Me),n.renderPass!=="shadow"&&ge&&ge.setupShadowsFromMatrix(h.nodeModelMatrix,Fe),Fe.draw(n,P.gl.TRIANGLES,R,y,v,F.material.doubleSided?Nr.disabled:Nr.backCCW,ae,s.id,F.vertexBuffer,F.indexBuffer,F.segments,s.paint,n.transform.zoom,void 0,Se)}function cd(h,n,s,p,y,v,w){let P;P=h.projection.name==="globe"?i.dg(s,h):[...s],i.a6.mat4.multiply(P,P,n.matrix);const R=i.a6.mat4.multiply([],p,P);if(n.meshes)for(const O of n.meshes){if(O.material.alphaMode!=="BLEND"){w.push({mesh:O,depth:0,modelIndex:y,worldViewProjection:R,nodeModelMatrix:P});continue}const F=i.a6.vec3.transformMat4([],O.centroid,R);F[2]>0&&v.push({mesh:O,depth:F[2],modelIndex:y,worldViewProjection:R,nodeModelMatrix:P})}if(n.children)for(const O of n.children)cd(h,O,s,p,y,v,w)}function Hc(h,n,s,p){const y=s.shadowRenderer;if(!y)return;const v=y.getShadowPassDepthMode(),w=y.getShadowPassColorMode(),P=y.calculateShadowPassMatrixFromMatrix(n),R=om(P);s.getOrCreateProgram("modelDepth",{defines:s._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(s,s.context.gl.TRIANGLES,v,qr.disabled,w,Nr.backCCW,R,p.id,h.vertexBuffer,h.indexBuffer,h.segments,p.paint,s.transform.zoom,void 0,void 0)}function R_(h,n,s){const p=n.updateZoomBasedPaintProperties(),y=function(v,w,P){let R,O,F,V=v.terrain?v.terrain.exaggeration():0;if(v.terrain&&V>0){const $=v.terrain,W=$.findDEMTileFor(P);W&&W.dem?R=i.di.create($,P,W):V=0}if(V===0&&(w.terrainElevationMin=0,w.terrainElevationMax=0),V===w.validForExaggeration&&(V===0||R&&R._demTile&&R._demTile.tileID===w.validForDEMTile.id&&R._dem._timestamp===w.validForDEMTile.timestamp))return!1;for(const $ in w.instancesPerModel){const W=w.instancesPerModel[$];for(let ee=0;ee<W.instancedDataArray.length;++ee){const re=(R?V*R.getElevationAt(0|W.instancedDataArray.float32[16*ee],0|W.instancedDataArray.float32[16*ee+1],!0,!0):0)+W.instancesEvaluatedElevation[ee];W.instancedDataArray.float32[16*ee+6]=re,O=O?Math.min(w.terrainElevationMin,re):re,F=F?Math.max(w.terrainElevationMax,re):re}}return w.terrainElevationMin=O||0,w.terrainElevationMax=F||0,w.validForExaggeration=V,w.validForDEMTile=R&&R._demTile?{id:R._demTile.tileID,timestamp:R._dem._timestamp}:{id:void 0,timestamp:0},!0}(h,n,s);(p||y)&&(n.uploaded=!1,n.upload(h.context))}const zs={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.c9([0,0,0],[i.ab,i.ab,0])};function X1(h,n){const s=1<<h.canonical.z,p=n.getFreeCameraOptions().position,y=n.elevation,v=h.canonical.x/s,w=(h.canonical.x+1)/s,P=h.canonical.y/s,R=(h.canonical.y+1)/s;let O=n._centerAltitude;if(y){const W=y.getMinMaxForTile(h);W&&W.max>O&&(O=W.max)}const F=i.ap(p.x,v,w)-p.x,V=i.ap(p.y,P,R)-p.y,$=i.bD(O,n.center.lat)-p.z;return n._zoomFromMercatorZ(Math.sqrt(F*F+V*V+$*$))}function bo(h,n,s,p,y,v,w){const P=h.context,R=h.renderPass==="shadow",O=h.shadowRenderer,F=R&&O?O.getShadowPassDepthMode():new Tr(P.gl.LEQUAL,Tr.ReadWrite,h.depthRangeFor3D),V=h.isTileAffectedByFog(v);if(s.meshes)for(const $ of s.meshes){const W=["MODEL_POSITION_ON_GPU"],ee=[];let re,ie,ae;p.instancedDataArray.length>20&&W.push("INSTANCED_ARRAYS");const _e=Pa(h,n.paint.get("model-cutoff-fade-range"));if(_e.shouldRenderCutoff&&W.push("RENDER_CUTOFF"),R&&O)re=h.getOrCreateProgram("modelDepth",{defines:W}),ie=om(w.shadowTileMatrix,w.shadowTileMatrix,Float32Array.from(s.matrix)),ae=O.getShadowPassColorMode();else{Uh(W,ee,$,h,n.lut),re=h.getOrCreateProgram("model",{defines:W,overrideFog:V});const ge=$.material,Ee=ge.pbrMetallicRoughness,Me=n.paint.get("model-opacity"),Fe=n.paint.get("model-emissive-strength").constantOr(0);ie=ur(v.expandedProjMatrix,Float32Array.from(s.matrix),new Float32Array(16),null,h,Me,Ee.baseColorFactor.toRenderColor(null),ge.emissiveFactor,Ee.metallicFactor,Ee.roughnessFactor,ge,Fe,n,y),O&&(w.shadowUniformsInitialized?re.setShadowUniformValues(P,O.getShadowUniformValues()):(O.setupShadows(v.toUnwrapped(),re,"model-tile",v.overscaledZ),w.shadowUniformsInitialized=!0)),ae=_e.shouldRenderCutoff||Me<1||ge.alphaMode!=="OPAQUE"?cn.alphaBlended:cn.unblended}h.uploadCommonUniforms(P,re,v.toUnwrapped(),null,_e);const Se=$.material.doubleSided?Nr.disabled:Nr.backCCW;if(p.instancedDataArray.length>20)ee.push(p.instancedDataBuffer),re.draw(h,P.gl.TRIANGLES,F,qr.disabled,ae,Se,ie,n.id,$.vertexBuffer,$.indexBuffer,$.segments,n.paint,h.transform.zoom,void 0,ee,p.instancedDataArray.length);else{const ge=R?"u_instance":"u_normal_matrix";for(let Ee=0;Ee<p.instancedDataArray.length;++Ee)ie[ge]=new Float32Array(p.instancedDataArray.arrayBuffer,64*Ee,16),re.draw(h,P.gl.TRIANGLES,F,qr.disabled,ae,Se,ie,n.id,$.vertexBuffer,$.indexBuffer,$.segments,n.paint,h.transform.zoom,void 0,ee)}}if(s.children)for(const $ of s.children)bo(h,n,$,p,y,v,w)}const K1=[1,-1,1];function ud(h,n,s,p){if(!s.modelManager)return!0;const y=s.modelManager;if(!s.shadowRenderer)return!0;const v=s.shadowRenderer,w=n.aabb;let P=!0,R=h.maxHeight;if(R===0){let F=0;for(const V in h.instancesPerModel){const $=y.getModel(V,p);$?F=Math.max(F,Math.max(Math.max($.aabb.max[0],$.aabb.max[1]),$.aabb.max[2])):P=!1}R=h.maxScale*F*1.41+h.maxVerticalOffset,P&&(h.maxHeight=R)}w.max[2]=R,w.min[2]+=h.terrainElevationMin,w.max[2]+=h.terrainElevationMax,i.a6.vec3.transformMat4(w.min,w.min,n.tileMatrix),i.a6.vec3.transformMat4(w.max,w.max,n.tileMatrix);const O=w.intersects(v.getCurrentCascadeFrustum());return s.currentShadowCascade===0&&(h.isInsideFirstShadowMapFrustum=O===2),O===0}function ri(h,n){const s=h.uniformValues.u_cutoff_params[0],p=h.uniformValues.u_cutoff_params[1],y=h.uniformValues.u_cutoff_params[2],v=h.uniformValues.u_cutoff_params[3];return p===s||v===y?1:i.ap(((n-s)/(p-s)-y)/(v-y),0,1)}function bn(h,n,s,p){if(n.pitch<20)return 1;const y=n.getWorldToCameraMatrix();i.a6.mat4.multiply(y,y,h);const v=i.a6.vec4.fromValues(s.min[0],s.min[1],s.min[2],1);let w=i.a6.vec4.transformMat4(i.a6.vec4.create(),v,y),P=w,R=w;v[1]=s.max[1],w=i.a6.vec4.transformMat4(i.a6.vec4.create(),v,y),P=w[1]<P[1]?w:P,R=w[1]>R[1]?w:R,v[0]=s.max[0],w=i.a6.vec4.transformMat4(i.a6.vec4.create(),v,y),P=w[1]<P[1]?w:P,R=w[1]>R[1]?w:R,v[1]=s.min[1],w=i.a6.vec4.transformMat4(i.a6.vec4.create(),v,y),P=w[1]<P[1]?w:P,R=w[1]>R[1]?w:R;const O=i.ap(p[0],0,1),F=100*n.pixelsPerMeter*i.ap(p[1],0,1),V=i.ap(p[2],0,1),$=i.a6.vec4.lerp(i.a6.vec4.create(),P,R,O),W=Math.tan(.5*n.fovX),ee=-$[2]*W;if(F===0)return $[1]<-Math.abs(ee)?V:1;const re=(-Math.abs(ee)-$[1])/F,ie=(_e,Se,ge)=>(1-ge)*_e+ge*Se,ae=i.ap(ie(1,V,re),V,1);return ie(1,ae,i.ap((n.pitch-20)/20,0,1))}class L_{}class ml{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,s,p){{const V=this._storage.get(s.id);if(V)return V.lastUsedFrameIdx=n,V.buf}const y=p.gl,v=y.getBufferParameter(y.ELEMENT_ARRAY_BUFFER,y.BUFFER_SIZE),w=new ArrayBuffer(v),P=new Int16Array(w);y.getBufferSubData(y.ELEMENT_ARRAY_BUFFER,0,new Int16Array(w));const R=new i.dk;for(let V=0;V<v/2;V+=3){const $=P[V],W=P[V+1],ee=P[V+2];R.emplaceBack($,W),R.emplaceBack(W,ee),R.emplaceBack(ee,$)}const O=p.bindVertexArrayOES.current,F=new L_;return F.buf=new Wo(p,R),F.lastUsedFrameIdx=n,this._storage.set(s.id,F),p.bindVertexArrayOES.set(O),F.buf}update(n){for(const[s,p]of this._storage)n-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(s))}destroy(){for(const[n,s]of this._storage)s.buf.destroy(),this._storage.delete(n)}}class Wh{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const gl={symbol:function(h,n,s,p,y){if(h.renderPass!=="translucent")return;const v=qr.disabled,w=h.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(O,F,V,$,W,ee,re){const ie=F.transform,ae=W==="map",_e=ee==="map";for(const Se of O){const ge=$.getTile(Se),Ee=ge.getBucket(V);if(!Ee||!Ee.text||!Ee.text.segments.get().length)continue;const Me=i.bj(Ee.textSizeData,ie.zoom),Fe=cl(Se,Ee.getProjection(),ie),Re=ie.calculatePixelsToTileUnitsMatrix(ge),Ne=fn(Fe,ge.tileID.canonical,_e,ae,ie,Ee.getProjection(),Re),qe=Ee.hasIconTextFit()&&Ee.hasIconData();if(Me){const Ue=Math.pow(2,ie.zoom-ge.tileID.overscaledZ);H1(Ee,ae,_e,re,i.cS,ie,Ne,Se,Ue,Me,qe)}}}(p,h,s,n,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),y);const P=s.paint.get("icon-opacity").constantOr(1)!==0,R=s.paint.get("text-opacity").constantOr(1)!==0;s.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(P||R)?od(h,n,s,p,v,w):(P&&od(h,n,s,p,v,w,{onlyIcons:!0}),R&&od(h,n,s,p,v,w,{onlyText:!0})),n.map.showCollisionBoxes&&(Fh(h,n,s,p,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Fh(h,n,s,p,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(h,n,s,p){if(h.renderPass!=="translucent")return;const y=s.paint.get("circle-opacity"),v=s.paint.get("circle-stroke-width"),w=s.paint.get("circle-stroke-opacity"),P=s.layout.get("circle-sort-key").constantOr(1)!==void 0,R=s.paint.get("circle-emissive-strength");if(y.constantOr(1)===0&&(v.constantOr(1)===0||w.constantOr(1)===0))return;const O=h.context,F=O.gl,V=h.transform,$=h.depthModeForSublayer(0,Tr.ReadOnly),W=qr.disabled,ee=h.colorModeForDrapableLayerRenderPass(R),re=V.projection.name==="globe",ie=[i.am(V.center.lng),i.at(V.center.lat)],ae=[];for(let Se=0;Se<p.length;Se++){const ge=p[Se],Ee=n.getTile(ge),Me=Ee.getBucket(s);if(!Me||Me.projection.name!==V.projection.name)continue;const Fe=Me.programConfigurations.get(s.id),Re=i.cT(s),Ne=h.isTileAffectedByFog(ge);re&&Re.push("PROJECTION_GLOBE_VIEW"),Re.push("DEPTH_D24"),h.terrain&&V.depthOcclusionForSymbolsAndCircles&&Re.push("DEPTH_OCCLUSION");const qe=h.getOrCreateProgram("circle",{config:Fe,defines:Re,overrideFog:Ne}),Ue=Me.layoutVertexBuffer,$e=Me.globeExtVertexBuffer,nt=Me.indexBuffer,pt=V.projection.createInversionMatrix(V,ge.canonical),Mt={programConfiguration:Fe,program:qe,layoutVertexBuffer:Ue,globeExtVertexBuffer:$e,indexBuffer:nt,uniformValues:i.cU(h,ge,Ee,pt,ie,s),tile:Ee};if(P){const ht=Me.segments.get();for(const Nt of ht)ae.push({segments:new i.b1([Nt]),sortKey:Nt.sortKey,state:Mt})}else ae.push({segments:Me.segments,sortKey:0,state:Mt})}P&&ae.sort((Se,ge)=>Se.sortKey-ge.sortKey);const _e={useDepthForOcclusion:V.depthOcclusionForSymbolsAndCircles};for(const Se of ae){const{programConfiguration:ge,program:Ee,layoutVertexBuffer:Me,globeExtVertexBuffer:Fe,indexBuffer:Re,uniformValues:Ne,tile:qe}=Se.state,Ue=Se.segments;h.terrain&&h.terrain.setupElevationDraw(qe,Ee,_e),h.uploadCommonUniforms(O,Ee,qe.tileID.toUnwrapped()),Ee.draw(h,F.TRIANGLES,$,W,ee,Nr.disabled,Ne,s.id,Me,Re,Ue,s.paint,V.zoom,ge,[Fe])}},heatmap:function(h,n,s,p){if(s.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const y=h.context,v=y.gl,w=qr.disabled,P=new cn([v.ONE,v.ONE,v.ONE,v.ONE],i.bz.transparent,[!0,!0,!0,!0]);(function(W,ee,re,ie){const ae=W.gl,_e=ee.width*ie,Se=ee.height*ie;W.activeTexture.set(ae.TEXTURE1),W.viewport.set([0,0,_e,Se]);let ge=re.heatmapFbo;if(!ge||ge&&(ge.width!==_e||ge.height!==Se)){ge&&ge.destroy();const Ee=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,Ee),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),ge=re.heatmapFbo=W.createFramebuffer(_e,Se,!0,null),function(Me,Fe,Re,Ne,qe,Ue){const $e=Me.gl;$e.texImage2D($e.TEXTURE_2D,0,Me.extRenderToTextureHalfFloat?$e.RGBA16F:$e.RGBA,qe,Ue,0,$e.RGBA,Me.extRenderToTextureHalfFloat?$e.HALF_FLOAT:$e.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Re)}(W,0,Ee,ge,_e,Se)}else ae.bindTexture(ae.TEXTURE_2D,ge.colorAttachment.get()),W.bindFramebuffer.set(ge.framebuffer)})(y,h,s,h.transform.projection.name==="globe"?.5:.25),y.clear({color:i.bz.transparent});const R=h.transform,O=R.projection.name==="globe",F=O?["PROJECTION_GLOBE_VIEW"]:[],V=O?Nr.frontCCW:Nr.disabled,$=[i.am(R.center.lng),i.at(R.center.lat)];for(let W=0;W<p.length;W++){const ee=p[W];if(n.hasRenderableParent(ee))continue;const re=n.getTile(ee),ie=re.getBucket(s);if(!ie||ie.projection.name!==R.projection.name)continue;const ae=h.isTileAffectedByFog(ee),_e=ie.programConfigurations.get(s.id),Se=h.getOrCreateProgram("heatmap",{config:_e,defines:F,overrideFog:ae}),{zoom:ge}=h.transform;h.terrain&&h.terrain.setupElevationDraw(re,Se),h.uploadCommonUniforms(y,Se,ee.toUnwrapped());const Ee=R.projection.createInversionMatrix(R,ee.canonical);Se.draw(h,v.TRIANGLES,Tr.disabled,w,P,V,U1(h,ee,re,Ee,$,ge,s.paint.get("heatmap-intensity")),s.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,s.paint,h.transform.zoom,_e,O?[ie.globeExtVertexBuffer]:null)}y.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(y,v){const w=y.context,P=w.gl,R=v.heatmapFbo;if(!R)return;w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,R.colorAttachment.get()),w.activeTexture.set(P.TEXTURE1);let O=v.colorRampTexture;O||(O=v.colorRampTexture=new i.T(w,v.colorRamp,P.RGBA8)),O.bind(P.LINEAR,P.CLAMP_TO_EDGE),y.getOrCreateProgram("heatmapTexture").draw(y,P.TRIANGLES,Tr.disabled,qr.disabled,y.colorModeForRenderPass(),Nr.disabled,((F,V,$,W)=>({u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}))(0,v),v.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,v.paint,y.transform.zoom)}(h,s))},line:function(h,n,s,p){if(h.renderPass!=="translucent")return;const y=s.paint.get("line-opacity"),v=s.paint.get("line-width");if(y.constantOr(1)===0||v.constantOr(1)===0)return;const w=s.paint.get("line-emissive-strength"),P=s.paint.get("line-occlusion-opacity"),R=h.context,O=R.gl,F=s.layout.get("line-z-offset"),V=!F.isConstant()||!!F.constantOr(0),$=V?new Tr(h.depthOcclusion?O.GREATER:O.LEQUAL,Tr.ReadOnly,h.depthRangeFor3D):h.depthModeForSublayer(0,Tr.ReadOnly),W=h.colorModeForDrapableLayerRenderPass(w),ee=h.terrain&&h.terrain.renderingToTexture,re=ee?1:i.q.devicePixelRatio,ie=s.paint.get("line-dasharray"),ae=ie.constantOr(1),_e=s.layout.get("line-cap"),Se=ie.constantOr(null),ge=_e.constantOr(null),Ee=s.paint.get("line-pattern"),Me=Ee.constantOr(1),Fe=Ee.constantOr(null),Re=s.paint.get("line-opacity").constantOr(1);let Ne=!Me&&Re!==1||h.depthOcclusion&&P>0&&P<1;const qe=s.paint.get("line-gradient"),Ue=Me?"linePattern":"line",$e=i.cV(s);let nt;if(ee&&h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(Ne=!1),P!==0&&h.depthOcclusion){const Mt=s.paint._values["line-opacity"];Mt&&Mt.value&&Mt.value.kind==="constant"?nt=Mt.value:i.w(`Occlusion opacity for layer ${s.id} is supported only when line-opacity isn't data-driven.`)}if(V&&(h.forceTerrainMode=!0),!V&&P!==0&&h.terrain&&!ee)return void i.w(`Occlusion opacity for layer ${s.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const pt=Ne&&V?h.stencilModeFor3D():qr.disabled;for(const Mt of p){const ht=n.getTile(Mt);if(Me&&!ht.patternsLoaded())continue;const Nt=ht.getBucket(s);if(!Nt)continue;h.prepareDrawTile();const it=Nt.programConfigurations.get(s.id),St=h.isTileAffectedByFog(Mt),_t=h.getOrCreateProgram(Ue,{config:it,defines:V?[...$e,"ELEVATED"]:$e,overrideFog:St});if(Fe&&ht.imageAtlas){const Kt=ht.imageAtlas.patternPositions[Fe.toString()];Kt&&it.setConstantPatternPositions(Kt)}if(!Me&&Se&&ge&&ht.lineAtlas){const Kt=ht.lineAtlas.getDash(Se,ge);Kt&&it.setConstantPatternPositions(Kt)}let[Vt,Ut]=s.paint.get("line-trim-offset");(ge==="round"||ge==="square")&&Vt!==Ut&&(Vt===0&&(Vt-=1),Ut===1&&(Ut+=1));const Ct=ee?Mt.projMatrix:null,Pt=Me?i.cW(h,ht,s,Ct,re,[Vt,Ut]):i.cX(h,ht,s,Ct,Nt.lineClipsArray.length,re,[Vt,Ut]);if(qe){const Kt=Nt.gradients[s.id];let lr=Kt.texture;if(s.gradientVersion!==Kt.version){let Lr=256;if(s.stepInterpolant){const fr=n.getSource().maxzoom,kr=Mt.canonical.z===fr?Math.ceil(1<<h.transform.maxZoom-Mt.canonical.z):1;Lr=i.ap(i.cY(Nt.maxLineLength/i.ab*1024*kr),256,R.maxTextureSize)}Kt.gradient=i.cZ({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:Lr,image:Kt.gradient||void 0,clips:Nt.lineClipsArray}),Kt.texture?Kt.texture.update(Kt.gradient):Kt.texture=new i.T(R,Kt.gradient,O.RGBA8),Kt.version=s.gradientVersion,lr=Kt.texture}R.activeTexture.set(O.TEXTURE1),lr.bind(s.stepInterpolant?O.NEAREST:O.LINEAR,O.CLAMP_TO_EDGE)}ae&&(R.activeTexture.set(O.TEXTURE0),ht.lineAtlasTexture&&ht.lineAtlasTexture.bind(O.LINEAR,O.REPEAT),it.updatePaintBuffers()),Me&&(R.activeTexture.set(O.TEXTURE0),ht.imageAtlasTexture&&ht.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),it.updatePaintBuffers()),V&&h.terrain.setupElevationDraw(ht,_t),h.uploadCommonUniforms(R,_t,Mt.toUnwrapped());const xr=Kt=>{nt!=null&&(nt.value=Re*P),_t.draw(h,O.TRIANGLES,$,Kt,W,Nr.disabled,Pt,s.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nt.segments,s.paint,h.transform.zoom,it,[Nt.layoutVertexBuffer2,Nt.patternVertexBuffer,Nt.zOffsetVertexBuffer]),nt!=null&&(nt.value=Re)};if(Ne&&!V){const Kt=h.stencilModeForClipping(Mt).ref;Kt===0&&ee&&R.clear({stencil:0});const lr={func:O.EQUAL,mask:255};Pt.u_alpha_discard_threshold=.8,xr(new qr(lr,Kt,255,O.KEEP,O.KEEP,O.INVERT)),Pt.u_alpha_discard_threshold=0,xr(new qr(lr,Kt,255,O.KEEP,O.KEEP,O.KEEP))}else Ne&&V&&(Pt.u_alpha_discard_threshold=.001),xr(V?pt:h.stencilModeForClipping(Mt))}Ne&&(h.resetStencilClippingMasks(),ee&&R.clear({stencil:0})),P===0||h.depthOcclusion||ee||h.layersWithOcclusionOpacity.push(h.currentLayer),V&&(h.forceTerrainMode=!1)},fill:function(h,n,s,p){const y=s.paint.get("fill-color"),v=s.paint.get("fill-opacity"),w=s.is3D(),P=new Tr(h.context.gl.LEQUAL,Tr.ReadWrite,h.depthRangeFor3D);if(v.constantOr(1)===0)return;const R=s.paint.get("fill-emissive-strength"),O=h.colorModeForDrapableLayerRenderPass(R),F=s.paint.get("fill-pattern"),V=h.opaquePassEnabledForLayer()&&!F.constantOr(1)&&y.constantOr(i.bz.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===V){const $=w?P:h.depthModeForSublayer(1,h.renderPass==="opaque"?Tr.ReadWrite:Tr.ReadOnly);Bh(h,n,s,p,$,O,!1)}if(!w&&h.renderPass==="translucent"&&s.paint.get("fill-antialias")){const $=w?P:h.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,Tr.ReadOnly);Bh(h,n,s,p,$,O,!0)}},"fill-extrusion":function(h,n,s,p){const y=s.paint.get("fill-extrusion-opacity"),v=h.context,w=v.gl,P=h.terrain,R=P&&P.renderingToTexture;if(y===0)return;const O=h.conflationActive&&h.style.isLayerClipped(s,n.getSource()),F=h.style.order.indexOf(s.fqid);if(O&&function(V,$,W,ee,re){for(const ie of ee){const ae=$.getTile(ie).getBucket(W);ae&&(ae.updateReplacement(ie,V.replacementSource,re),ae.uploadCentroid(V.context))}}(h,n,s,p,F),P||O)for(const V of p){const $=n.getTile(V).getBucket(s);$&&fl(h.context,n,V,$,s,P,O)}if(h.renderPass==="shadow"&&h.shadowRenderer){const V=h.shadowRenderer;if(P&&y<.65&&s._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a4)return;const $=V.getShadowPassDepthMode(),W=V.getShadowPassColorMode();$c(h,n,s,p,$,qr.disabled,W,O)}else if(h.renderPass==="translucent"){const V=!s.paint.get("fill-extrusion-pattern").constantOr(1),$=s.paint.get("fill-extrusion-color").constantOr(i.bz.white);if(!R&&$.a!==0){const W=new Tr(h.context.gl.LEQUAL,Tr.ReadWrite,h.depthRangeFor3D);y===1&&V?$c(h,n,s,p,W,qr.disabled,cn.unblended,O):($c(h,n,s,p,W,qr.disabled,cn.disabled,O),$c(h,n,s,p,W,h.stencilModeFor3D(),h.colorModeForRenderPass(),O),h.resetStencilClippingMasks())}if(h.style.enable3dLights()&&V&&(!P&&h.transform.projection.name!=="globe"||R)){const W=s.paint.get("fill-extrusion-opacity"),ee=s.paint.get("fill-extrusion-ambient-occlusion-intensity"),re=s.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ie=s.paint.get("fill-extrusion-flood-light-intensity"),ae=s.paint.get("fill-extrusion-flood-light-color").toRenderColor(s.lut).toArray01().slice(0,3),_e=ee>0&&re>0,Se=ie>0,ge=(Me,Fe,Re)=>(1-Re)*Me+Re*Fe,Ee=Me=>{const Fe=h.depthModeForSublayer(1,Tr.ReadOnly,w.LEQUAL,!0),Re=s.paint.get(Me?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ne=ge(.1,3,Re),qe=h._showOverdrawInspector;if(!qe){const Ue=new qr({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),$e=new cn([w.ONE,w.ONE,w.ONE,w.ONE],i.bz.transparent,[!1,!1,!1,!0],w.MIN);to(h,n,s,p,Fe,Ue,$e,Nr.disabled,Me,"sdf",W,ee,re,ie,ae,Ne,O,!1)}{const Ue=qe?qr.disabled:new qr({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),$e=qe?h.colorModeForRenderPass():new cn([w.ONE_MINUS_DST_ALPHA,w.DST_ALPHA,w.ONE,w.ONE],i.bz.transparent,[!0,!0,!0,!0]);to(h,n,s,p,Fe,Ue,$e,Nr.disabled,Me,"color",W,ee,re,ie,ae,Ne,O,!1)}};if(R){const Me=(Fe,Re,Ne)=>{const qe=h.depthModeForSublayer(1,Tr.ReadOnly,w.LEQUAL,!1),Ue=s.paint.get(Fe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),$e=ge(.1,3,Ue);{const nt=new cn([w.ONE,w.ONE,w.ONE,w.ONE],i.bz.transparent,[!1,!1,!1,!0]);to(h,n,s,p,qe,qr.disabled,nt,Nr.disabled,Fe,"clear",W,ee,re,ie,ae,$e,O,Re)}{const nt=new qr({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),pt=new cn([w.ONE,w.ONE,w.ONE,w.ONE],i.bz.transparent,[!1,!1,!1,!0],w.MIN);to(h,n,s,p,qe,nt,pt,Nr.disabled,Fe,"sdf",W,ee,re,ie,ae,$e,O,Re)}{const nt=Fe?w.ZERO:w.ONE_MINUS_DST_ALPHA,pt=new qr({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),Mt=new cn([nt,w.DST_ALPHA,w.ONE_MINUS_DST_ALPHA,w.ZERO],i.bz.transparent,[!0,!0,!0,!0]);to(h,n,s,p,qe,pt,Mt,Nr.disabled,Fe,"color",W,ee,re,ie,ae,$e,O,Re)}{const nt=new cn([w.ONE,w.ONE,w.ONE,Fe?w.ZERO:w.ONE],i.bz.transparent,[!1,!1,!1,!0],Fe?w.FUNC_ADD:w.MAX);to(h,n,s,p,qe,qr.disabled,nt,Nr.disabled,Fe,"clear",W,ee,re,ie,ae,$e,O,Re,Ne)}};if(_e||Se){let Fe;if(h.prepareDrawTile(),P){const Re=P.drapeBufferSize[0],Ne=P.drapeBufferSize[1];Fe=P.framebufferCopyTexture,Fe&&(!Fe||Fe.size[0]===Re&&Fe.size[1]===Ne)||(Fe&&Fe.destroy(),Fe=P.framebufferCopyTexture=new i.T(v,new i.r({width:Re,height:Ne}),w.RGBA8)),Fe.bind(w.LINEAR,w.CLAMP_TO_EDGE),w.copyTexImage2D(w.TEXTURE_2D,0,w.RGBA,0,0,Re,Ne,0)}_e&&Me(!0,!1,Fe),Se&&Me(!1,!0,Fe)}}else _e&&Ee(!0),Se&&Ee(!1),(_e||Se)&&h.resetStencilClippingMasks()}}},hillshade:function(h,n,s,p){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent"||h.style.disableElevatedTerrain)return;const y=h.context,v=h.terrain&&h.terrain.renderingToTexture,[w,P]=h.renderPass!=="translucent"||v?[{},p]:h.stencilConfigForOverlap(p);for(const R of P){const O=n.getTile(R);if(O.needsHillshadePrepare&&h.renderPass==="offscreen")Xu(h,O,s);else if(h.renderPass==="translucent"){const F=h.depthModeForSublayer(0,Tr.ReadOnly),V=s.paint.get("hillshade-emissive-strength"),$=h.colorModeForDrapableLayerRenderPass(V),W=v&&h.terrain?h.terrain.stencilModeForRTTOverlap(R):w[R.overscaledZ];vh(h,R,O,s,F,W,$)}}y.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,n,s,p,y,v){if(h.renderPass!=="translucent"||s.paint.get("raster-opacity")===0)return;const w=h.transform.projection.name==="globe",P=s.paint.get("raster-elevation")!==0,R=P&&w;if(h.renderElevatedRasterBackface&&!R)return;const O=h.context,F=O.gl,V=n.getSource(),$=function(Me,Fe,Re,Ne){const qe=Fe.paint.get("raster-color"),Ue=Me.type==="raster-array",$e=[],nt=Fe.paint.get("raster-resampling"),pt=Fe.paint.get("raster-color-mix");let Mt=Fe.paint.get("raster-color-range");const ht=[pt[0],pt[1],pt[2],0],Nt=pt[3];let it=nt==="nearest"?Ne.NEAREST:Ne.LINEAR;if(Ue&&($e.push("RASTER_ARRAY"),qe||$e.push("RASTER_COLOR"),nt==="linear"&&$e.push("RASTER_ARRAY_LINEAR"),it=Ne.NEAREST,!Mt&&Me.rasterLayers)){const St=Me.rasterLayers.find(({id:_t})=>_t===Fe.sourceLayer);St&&St.fields&&St.fields.range&&(Mt=St.fields.range)}if(Mt=Mt||[0,1],qe){$e.push("RASTER_COLOR"),Re.activeTexture.set(Ne.TEXTURE2),Fe.updateColorRamp(Mt);let St=Fe.colorRampTexture;St||(St=Fe.colorRampTexture=new i.T(Re,Fe.colorRamp,Ne.RGBA8)),St.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}return{mix:ht,range:Mt,offset:Nt,defines:$e,resampling:it}}(V,s,O,F);if(V instanceof i.aD&&!p.length&&!w)return;const W=s.paint.get("raster-emissive-strength"),ee=h.colorModeForDrapableLayerRenderPass(W),re=h.terrain&&h.terrain.renderingToTexture,ie=!h.options.moving,ae=s.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;if(V instanceof i.aD&&!p.length&&(V.onNorthPole||V.onSouthPole)){const Me=P?h.stencilModeFor3D():qr.disabled;return void Go(!!V.onNorthPole,null,h,n,s,W,$,Nr.disabled,Me)}if(!p.length)return;const[_e,Se]=V instanceof i.aD||re?[{},p]:h.stencilConfigForOverlap(p),ge=Se[Se.length-1].overscaledZ;R&&$.defines.push("PROJECTION_GLOBE_VIEW"),P&&$.defines.push("RENDER_CUTOFF");const Ee=(Me,Fe,Re)=>{for(const Ne of Me){const qe=Ne.toUnwrapped(),Ue=n.getTile(Ne);if(re&&(!Ue||!Ue.hasData()))continue;O.activeTexture.set(F.TEXTURE0);const $e=jh(Ue,V,s,$);if(!$e||!$e.texture)continue;const{texture:nt,mix:pt,offset:Mt,tileSize:ht,buffer:Nt}=$e;let it,St;re?(it=Tr.disabled,St=Ne.projMatrix):P?(it=new Tr(F.LEQUAL,Tr.ReadWrite,h.depthRangeFor3D),St=w?Float32Array.from(h.transform.expandedFarZProjMatrix):h.transform.calculateProjMatrix(qe,ie)):(it=h.depthModeForSublayer(Ne.overscaledZ-ge,s.paint.get("raster-opacity")===1?Tr.ReadWrite:Tr.ReadOnly,F.LESS),St=h.transform.calculateProjMatrix(qe,ie));const _t=h.terrain&&re?h.terrain.stencilModeForRTTOverlap(Ne):_e[Ne.overscaledZ],Vt=v?0:s.paint.get("raster-fade-duration");Ue.registerFadeDuration(Vt);const Ut=n.findLoadedParent(Ne,0),Ct=Eh(Ue,Ut,n,h.transform,Vt);let Pt,xr;h.terrain&&h.terrain.prepareDrawTile(),O.activeTexture.set(F.TEXTURE0),nt.bind(ae,F.CLAMP_TO_EDGE),O.activeTexture.set(F.TEXTURE1),Ut?(Ut.texture&&Ut.texture.bind(ae,F.CLAMP_TO_EDGE),Pt=Math.pow(2,Ut.tileID.overscaledZ-Ue.tileID.overscaledZ),xr=[Ue.tileID.canonical.x*Pt%1,Ue.tileID.canonical.y*Pt%1]):nt.bind(ae,F.CLAMP_TO_EDGE),nt.useMipmap&&O.extTextureFilterAnisotropic&&h.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const Kt=h.transform;let lr;const Lr=P?yi(Kt):[0,0,0,0];let fr,kr,rn,Jr,Ln,Un=0;if(R&&V instanceof i.aD&&V.coordinates.length>3)fr=Float32Array.from(i.b5(i.cC(new i.bP(0,0,0)))),kr=Float32Array.from(Kt.globeMatrix),rn=Float32Array.from(i.cy(Kt)),Jr=[i.am(Kt.center.lng),i.at(Kt.center.lat)],lr=V.elevatedGlobePerspectiveTransform,Ln=V.elevatedGlobeGridMatrix||new Float32Array(9);else if(R){const un=i.cz(Ne.canonical);Un=i.cA(un.getCenter().lat),fr=Float32Array.from(i.b5(i.cC(Ne.canonical))),kr=Float32Array.from(Kt.globeMatrix),rn=Float32Array.from(i.cy(Kt)),Jr=[i.am(Kt.center.lng),i.at(Kt.center.lat)],lr=[0,0],Ln=Float32Array.from(i.cB(Ne.canonical,un,Un,Kt.worldSize/Kt._pixelsPerMercatorPixel))}else lr=V instanceof i.aD?V.perspectiveTransform:[0,0],fr=new Float32Array(16),kr=new Float32Array(9),rn=new Float32Array(16),Jr=[0,0],Ln=new Float32Array(9);const Qn=nd(St,fr,kr,rn,Ln,xr||[0,0],i.a9(h.transform.zoom),Jr,Lr,Pt||1,Ct,s,lr,P?s.paint.get("raster-elevation"):0,2,pt,Mt,$.range,ht,Nt,W),gs=h.isTileAffectedByFog(Ne),Pi=h.getOrCreateProgram("raster",{defines:$.defines,overrideFog:gs});if(h.uploadCommonUniforms(O,Pi,qe),V instanceof i.aD){const un=V.elevatedGlobeVertexBuffer,Nn=V.elevatedGlobeIndexBuffer;if(re||!w)V.boundsBuffer&&V.boundsSegments&&Pi.draw(h,F.TRIANGLES,it,qr.disabled,ee,Nr.disabled,Qn,s.id,V.boundsBuffer,h.quadTriangleIndexBuffer,V.boundsSegments);else if(un&&Nn){const ui=Kt.zoom<=i.c2?V.elevatedGlobeSegments:V.getSegmentsForLongitude(Kt.center.lng);ui&&Pi.draw(h,F.TRIANGLES,it,qr.disabled,ee,Fe,Qn,s.id,un,Nn,ui)}}else if(R){it=new Tr(F.LEQUAL,Tr.ReadOnly,h.depthRangeFor3D);const un=h.globeSharedBuffers;if(un){const[Nn,ui,On]=un.getGridBuffers(Un,!1);Pi.draw(h,F.TRIANGLES,it,Re||_t,h.colorModeForRenderPass(),Fe,Qn,s.id,Nn,ui,On)}}else{const{tileBoundsBuffer:un,tileBoundsIndexBuffer:Nn,tileBoundsSegments:ui}=h.getTileBoundsBuffers(Ue);Pi.draw(h,F.TRIANGLES,it,_t,ee,Nr.disabled,Qn,s.id,un,Nn,ui)}}if(!(V instanceof i.aD)&&R)for(const Ne of Me){const qe=Ne.canonical.y===(1<<Ne.canonical.z)-1;Ne.canonical.y===0&&Go(!0,Ne,h,n,s,W,$,Fe,Re||qr.disabled),qe&&Go(!1,Ne,h,n,s,W,$,Fe===Nr.frontCW?Nr.backCW:Nr.frontCW,Re||qr.disabled)}};R?Ee(Se,h.renderElevatedRasterBackface?Nr.backCW:Nr.frontCW,h.stencilModeFor3D()):Ee(Se,Nr.disabled,void 0),h.resetStencilClippingMasks()},"raster-particle":function(h,n,s,p,y,v){h.renderPass==="offscreen"&&function(w,P,R,O){if(!O.length)return;const F=w.context,V=F.gl,$=P.getSource();if(!($ instanceof il))return;const W=Math.ceil(Math.sqrt(R.paint.get("raster-particle-count")));let ee=R.particlePositionRGBAImage;if(!ee||ee.width!==W){const Se=function(ge){const Ee=ge*ge,Me=new Uint8Array(4*Ee),Fe=function(Ne){return Ne|=0,Ne=Math.imul(2747636419^Ne,2654435769),Ne=Math.imul(Ne^Ne>>>16,2654435769),((Ne=Math.imul(Ne^Ne>>>16,2654435769))>>>0)/4294967296},Re=1/1.1;for(let Ne=0;Ne<Ee;Ne++){const qe=Re*(Fe(2*Ne+0)+na),Ue=Re*(Fe(2*Ne+1)+na),$e=255*qe%1,nt=255*Ue%1,pt=$e,Mt=Ue-nt/255,ht=nt;Me[4*Ne+0]=255*(qe-$e/255),Me[4*Ne+1]=255*pt,Me[4*Ne+2]=255*Mt,Me[4*Ne+3]=255*ht}return Me}(W);ee=R.particlePositionRGBAImage=new i.r({width:W,height:W},Se)}let re=R.particleFramebuffer;re?re.width!==W&&(re.destroy(),re=R.particleFramebuffer=F.createFramebuffer(W,W,!0,null)):re=R.particleFramebuffer=F.createFramebuffer(W,W,!0,null);const ie=[];for(const Se of O){const ge=P.getTile(Se);if(!(ge instanceof nh))continue;const Ee=P_(ge,$,R);if(!Ee)continue;const Me=[ge.tileSize,ge.tileSize];let Fe=R.tileFramebuffer;Fe||(Fe=R.tileFramebuffer=F.createFramebuffer(Me[0],Me[1],!0,null));let Re=ge.rasterParticleState;Re||(Re=ge.rasterParticleState=new k_(F,Se,Me,ee));const Ne=Re.update(R.lastInvalidatedAt);Re.particleTextureDimension!==W&&Re.updateParticleTexture(Se,ee);const qe=Re.targetColorTexture;Re.targetColorTexture=Re.backgroundColorTexture,Re.backgroundColorTexture=qe;const Ue=Re.particleTexture0;Re.particleTexture0=Re.particleTexture1,Re.particleTexture1=Ue,ie.push([Se,Ee,Re,Ne])}if(ie.length===0)return;const ae=i.q.now(),_e=R.previousDrawTimestamp?.001*(ae-R.previousDrawTimestamp):.0167;if(R.previousDrawTimestamp=ae,R.hasColorMap()){F.activeTexture.set(V.TEXTURE0+2);let Se=R.colorRampTexture;Se||(Se=R.colorRampTexture=new i.T(F,R.colorRamp,V.RGBA8)),Se.bind(V.LINEAR,V.CLAMP_TO_EDGE)}F.bindFramebuffer.set(R.tileFramebuffer.framebuffer),function(Se,ge,Ee){const Me=Se.context,Fe=Me.gl,Re=ge.tileFramebuffer;Me.activeTexture.set(Fe.TEXTURE0);const Ne={u_texture:0,u_opacity:1.05*(Ue=ge.paint.get("raster-particle-fade-opacity-factor"))/(Ue+.05)},qe=Se.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Ue;for(const $e of Ee){const[,,nt,pt]=$e;Re.colorAttachment.set(nt.targetColorTexture.texture),Me.viewport.set([0,0,Re.width,Re.height]),Me.clear({color:i.bz.transparent}),pt&&(nt.backgroundColorTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE),qe.draw(Se,Fe.TRIANGLES,Tr.disabled,qr.disabled,cn.alphaBlended,Nr.disabled,Ne,ge.id,Se.viewportBuffer,Se.quadTriangleIndexBuffer,Se.viewportSegments))}}(w,R,ie),function(Se,ge,Ee,Me){const Fe=Se.context,Re=Fe.gl,Ne=Ee.tileFramebuffer,qe=Se.transform.projection.name==="globe",Ue=Ee.paint.get("raster-particle-max-speed");for(const $e of Me){const[nt,pt,Mt]=$e;Fe.activeTexture.set(Re.TEXTURE0+0),pt.texture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Ne.colorAttachment.set(Mt.targetColorTexture.texture);const ht=Se.getOrCreateProgram("rasterParticleDraw",{defines:pt.defines,overrideFog:!1});Fe.activeTexture.set(Re.TEXTURE0+1);const Nt=pt.scalarData?[]:[0,1,2,3].map(_t=>i.c$[_t](nt));Nt.push(nt);const it=nt.canonical.x,St=nt.canonical.y;for(const _t of Nt){const Vt=ge.getTile(qe?_t.wrapped():_t);if(!Vt)continue;const Ut=Vt.rasterParticleState;if(!Ut)continue;const Ct=_t.canonical.x+(1<<_t.canonical.z)*(_t.wrap-nt.wrap),Pt=_t.canonical.y;Ut.particleTexture0.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);const xr=Dh(1,Ut.particleTexture0.size[0],[Ct-it,Pt-St],0,pt.texture.size,2,Ue,pt.textureOffset,pt.scale,pt.offset);ht.draw(Se,Re.POINTS,Tr.disabled,qr.disabled,cn.alphaBlended,Nr.disabled,xr,Ee.id,Ut.particleIndexBuffer,void 0,Ut.particleSegment)}}}(w,P,R,ie),F.bindFramebuffer.set(R.particleFramebuffer.framebuffer),function(Se,ge,Ee,Me){const Fe=Se.context,Re=Fe.gl,Ne=ge.paint.get("raster-particle-max-speed"),qe=Me*ge.paint.get("raster-particle-speed-factor")*.15,Ue=function(nt){return Math.pow(nt,6)}(.01+1*ge.paint.get("raster-particle-reset-rate-factor")),$e=ge.particleFramebuffer;Fe.viewport.set([0,0,$e.width,$e.height]);for(const nt of Ee){const[,pt,Mt]=nt;Fe.activeTexture.set(Re.TEXTURE0+0),pt.texture.bind(Re.LINEAR,Re.CLAMP_TO_EDGE),Fe.activeTexture.set(Re.TEXTURE0+1);const ht=Mt.particleTexture0;ht.bind(Re.NEAREST,Re.CLAMP_TO_EDGE);const Nt=Rh(1,ht.size[0],0,pt.texture.size,Ne,qe,Ue,pt.textureOffset,pt.scale,pt.offset);$e.colorAttachment.set(Mt.particleTexture1.texture),Fe.clear({color:i.bz.transparent}),Se.getOrCreateProgram("rasterParticleUpdate",{defines:pt.defines}).draw(Se,Re.TRIANGLES,Tr.disabled,qr.disabled,cn.unblended,Nr.disabled,Nt,ge.id,Se.viewportBuffer,Se.quadTriangleIndexBuffer,Se.viewportSegments)}}(w,R,ie,_e)}(h,n,s,p),h.renderPass==="translucent"&&(function(w,P,R,O,F){const V=w.context,$=V.gl,W=P.getSource().tileSize,ee=5*(1-i.a7(i.bU,i.bU+1,w.transform.zoom))*W+R.paint.get("raster-particle-elevation"),re=!w.options.moving,ie=w.transform.projection.name==="globe";if(!O.length)return;const[ae,_e]=w.stencilConfigForOverlap(O),Se=[];ie&&Se.push("PROJECTION_GLOBE_VIEW");const ge=w.stencilModeFor3D();for(const Ee of _e){const Me=Ee.toUnwrapped(),Fe=P.getTile(Ee);if(!Fe.rasterParticleState)continue;const Re=Fe.rasterParticleState,Ne=100;Fe.registerFadeDuration(Ne);const qe=P.findLoadedParent(Ee,0),Ue=Eh(Fe,qe,P,w.transform,Ne);let $e,nt;w.terrain&&w.terrain.prepareDrawTile(),V.activeTexture.set($.TEXTURE0),Re.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),V.activeTexture.set($.TEXTURE1),qe&&qe.rasterParticleState?(qe.rasterParticleState.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),$e=Math.pow(2,qe.tileID.overscaledZ-Fe.tileID.overscaledZ),nt=[Fe.tileID.canonical.x*$e%1,Fe.tileID.canonical.y*$e%1]):Re.targetColorTexture.bind($.LINEAR,$.CLAMP_TO_EDGE);const pt=ie?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(Me,re),Mt=w.transform,ht=A_(Mt),Nt=i.cz(Ee.canonical),it=i.cA(Nt.getCenter().lat);let St,_t,Vt,Ut,Ct;ie?(St=Float32Array.from(i.b5(i.cC(Ee.canonical))),_t=Float32Array.from(Mt.globeMatrix),Vt=Float32Array.from(i.cy(Mt)),Ut=[i.am(Mt.center.lng),i.at(Mt.center.lat)],Ct=Float32Array.from(i.cB(Ee.canonical,Nt,it,Mt.worldSize/Mt._pixelsPerMercatorPixel))):(St=new Float32Array(16),_t=new Float32Array(9),Vt=new Float32Array(16),Ut=[0,0],Ct=new Float32Array(9));const Pt=C_(pt,St,_t,Vt,Ct,nt||[0,0],i.a9(w.transform.zoom),Ut,ht,$e||1,Ue,ee),xr=w.isTileAffectedByFog(Ee),Kt=w.getOrCreateProgram("rasterParticle",{defines:Se,overrideFog:xr});if(w.uploadCommonUniforms(V,Kt,Me),ie){const lr=new Tr($.LEQUAL,Tr.ReadOnly,w.depthRangeFor3D),Lr=0,fr=w.globeSharedBuffers;if(fr){const[kr,rn,Jr]=fr.getGridBuffers(it,Lr!==0);Kt.draw(w,$.TRIANGLES,lr,ge,cn.alphaBlended,w.renderElevatedRasterBackface?Nr.frontCCW:Nr.backCCW,Pt,R.id,kr,rn,Jr)}}else{const lr=w.depthModeForSublayer(0,Tr.ReadOnly),Lr=ae[Ee.overscaledZ],{tileBoundsBuffer:fr,tileBoundsIndexBuffer:kr,tileBoundsSegments:rn}=w.getTileBoundsBuffers(Fe);Kt.draw(w,$.TRIANGLES,lr,Lr,cn.alphaBlended,Nr.disabled,Pt,R.id,fr,kr,rn)}}w.resetStencilClippingMasks()}(h,n,s,p),h.style.map.triggerRepaint())},background:function(h,n,s,p){const y=s.paint.get("background-color"),v=s.paint.get("background-opacity"),w=s.paint.get("background-emissive-strength"),P=s.paint.get("background-pitch-alignment")==="viewport";if(v===0)return;const R=h.context,O=R.gl,F=h.transform,V=F.tileSize,$=s.paint.get("background-pattern");let W;if($!==void 0&&($===null||(W=h.imageManager.getPattern($.toString(),s.scope,h.style.getLut(s.scope)),!W)))return;const ee=!$&&y.a===1&&v===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==ee)return;const re=qr.disabled,ie=h.depthModeForSublayer(0,ee==="opaque"?Tr.ReadWrite:Tr.ReadOnly),ae=h.colorModeForDrapableLayerRenderPass(w),_e=$?"backgroundPattern":"background";let Se,ge=p;if(ge||(Se=h.getBackgroundTiles(),ge=Object.values(Se).map(Ee=>Ee.tileID)),$&&(R.activeTexture.set(O.TEXTURE0),h.imageManager.bind(h.context,s.scope)),P){const Ee=h.getOrCreateProgram(_e,{overrideFog:!1,overrideRtt:!0}),Me=new Float32Array(i.a6.mat4.identity([])),Fe=new i.aA(0,0,0,0,0),Re=$?Zl(Me,w,v,h,0,s.scope,W,P,{tileID:Fe,tileSize:V}):M_(Me,w,v,y.toRenderColor(s.lut));Ee.draw(h,O.TRIANGLES,ie,re,ae,Nr.disabled,Re,s.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments)}else for(const Ee of ge){const Me=h.isTileAffectedByFog(Ee),Fe=h.getOrCreateProgram(_e,{overrideFog:Me}),Re=Ee.toUnwrapped(),Ne=p?Ee.projMatrix:h.transform.calculateProjMatrix(Re);h.prepareDrawTile();const qe=n?n.getTile(Ee):Se?Se[Ee.key]:new ea(Ee,V,F.zoom,h),Ue=$?Zl(Ne,w,v,h,0,s.scope,W,P,{tileID:Ee,tileSize:V}):M_(Ne,w,v,y.toRenderColor(s.lut));h.uploadCommonUniforms(R,Fe,Re);const{tileBoundsBuffer:$e,tileBoundsIndexBuffer:nt,tileBoundsSegments:pt}=h.getTileBoundsBuffers(qe);Fe.draw(h,O.TRIANGLES,ie,re,ae,Nr.disabled,Ue,s.id,$e,nt,pt)}},sky:function(h,n,s){const p=h._atmosphere?i.a9(h.transform.zoom):1,y=s.paint.get("sky-opacity")*p;if(y===0)return;const v=h.context,w=s.paint.get("sky-type"),P=new Tr(v.gl.LEQUAL,Tr.ReadOnly,[0,1]),R=h.frameCounter/1e3%1;w==="atmosphere"?h.renderPass==="offscreen"?s.needsSkyboxCapture(h)&&(function(O,F,V,$){const W=O.context,ee=W.gl;let re=F.skyboxFbo;if(!re){re=F.skyboxFbo=W.createFramebuffer(32,32,!0,null),F.skyboxGeometry=new pm(W),F.skyboxTexture=W.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,F.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let Se=0;Se<6;++Se)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}W.bindFramebuffer.set(re.framebuffer),W.viewport.set([0,0,32,32]);const ie=F.getCenter(O,!0),ae=O.getOrCreateProgram("skyboxCapture"),_e=new Float64Array(16);i.a6.mat4.identity(_e),i.a6.mat4.rotateY(_e,_e,.5*-Math.PI),Xl(O,F,ae,_e,ie,0),i.a6.mat4.identity(_e),i.a6.mat4.rotateY(_e,_e,.5*Math.PI),Xl(O,F,ae,_e,ie,1),i.a6.mat4.identity(_e),i.a6.mat4.rotateX(_e,_e,.5*-Math.PI),Xl(O,F,ae,_e,ie,2),i.a6.mat4.identity(_e),i.a6.mat4.rotateX(_e,_e,.5*Math.PI),Xl(O,F,ae,_e,ie,3),i.a6.mat4.identity(_e),Xl(O,F,ae,_e,ie,4),i.a6.mat4.identity(_e),i.a6.mat4.rotateY(_e,_e,Math.PI),Xl(O,F,ae,_e,ie,5),W.viewport.set([0,0,O.width,O.height])}(h,s),s.markSkyboxValid(h)):h.renderPass==="sky"&&function(O,F,V,$,W){const ee=O.context,re=ee.gl,ie=O.transform,ae=O.getOrCreateProgram("skybox");ee.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_CUBE_MAP,F.skyboxTexture);const _e=((Se,ge,Ee,Me,Fe)=>({u_matrix:Se,u_sun_direction:ge,u_cubemap:0,u_opacity:Me,u_temporal_offset:Fe}))(ie.skyboxMatrix,F.getCenter(O,!1),0,$,W);O.uploadCommonUniforms(ee,ae),ae.draw(O,re.TRIANGLES,V,qr.disabled,O.colorModeForRenderPass(),Nr.backCW,_e,"skybox",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(h,s,P,y,R):w==="gradient"&&h.renderPass==="sky"&&function(O,F,V,$,W){const ee=O.context,re=ee.gl,ie=O.transform,ae=O.getOrCreateProgram("skyboxGradient");F.skyboxGeometry||(F.skyboxGeometry=new pm(ee)),ee.activeTexture.set(re.TEXTURE0);let _e=F.colorRampTexture;_e||(_e=F.colorRampTexture=new i.T(ee,F.colorRamp,re.RGBA8)),_e.bind(re.LINEAR,re.CLAMP_TO_EDGE);const Se=((ge,Ee,Me,Fe,Re)=>({u_matrix:ge,u_color_ramp:0,u_center_direction:Ee,u_radius:i.bB(Me),u_opacity:Fe,u_temporal_offset:Re}))(ie.skyboxMatrix,F.getCenter(O,!1),F.paint.get("sky-gradient-radius"),$,W);O.uploadCommonUniforms(ee,ae),ae.draw(O,re.TRIANGLES,V,qr.disabled,O.colorModeForRenderPass(),Nr.backCW,Se,"skyboxGradient",F.skyboxGeometry.vertexBuffer,F.skyboxGeometry.indexBuffer,F.skyboxGeometry.segment)}(h,s,P,y,R)},debug:function(h,n,s,p,y,v){for(let w=0;w<s.length;w++)if(y){const O=new i.bz(p.r*.8,p.g*.8,p.b*.8,1);Rs(h,n,s[w],p,-1,-1,v),Rs(h,n,s[w],p,-1,1,v),Rs(h,n,s[w],p,1,1,v),Rs(h,n,s[w],p,1,-1,v),Rs(h,n,s[w],O,0,0,v)}else Rs(h,n,s[w],p,0,0,v)},custom:function(h,n,s,p){const y=h.context,v=s.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||h.renderPass==="offscreen")&&s.isDraped(n)){if(h.renderPass==="offscreen"){const w=v.prerender;if(w){if(h.setCustomLayerDefaults(),y.setColorMode(h.colorModeForRenderPass()),h.transform.projection.name==="globe"){const P=h.transform.pointMerc;w.call(v,y.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),i.a9(h.transform.zoom),[P.x,P.y],h.transform.pixelsPerMeterRatio)}else w.call(v,y.gl,h.transform.customLayerMatrix());y.setDirty(),h.setBaseState()}}else if(h.renderPass==="translucent"){if(h.terrain&&h.terrain.renderingToTexture){const P=v.renderToTile;if(P){const R=p[0].canonical,O=new i.a5(R.x+p[0].wrap*(1<<R.z),R.y,R.z);y.setDepthMode(Tr.disabled),y.setStencilMode(qr.disabled),y.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),P.call(v,y.gl,O),y.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),y.setColorMode(h.colorModeForRenderPass()),y.setStencilMode(qr.disabled);const w=v.renderingMode==="3d"?new Tr(h.context.gl.LEQUAL,Tr.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,Tr.ReadOnly);if(y.setDepthMode(w),h.transform.projection.name==="globe"){const P=h.transform.pointMerc;v.render(y.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),i.a9(h.transform.zoom),[P.x,P.y],h.transform.pixelsPerMeterRatio)}else v.render(y.gl,h.transform.customLayerMatrix());y.setDirty(),h.setBaseState(),y.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(h,n,s,p){if(h.renderPass==="opaque")return;const y=s.paint.get("model-opacity");if(y===0)return;const v=s.paint.get("model-cast-shadows");if(h.renderPass==="shadow"&&(!v||h.terrain&&y<.65&&s._transitionablePaint._values["model-opacity"].value.expression instanceof i.a4))return;const w=h.shadowRenderer,P=s.paint.get("model-receive-shadows");w&&(w.useNormalOffset=!0,P||(w.enabled=!1));const R=()=>{w&&(w.useNormalOffset=!0,P||(w.enabled=!0))},O=n.getSource();if(h.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return function(ae,_e,Se,ge,Ee){const Me=ae.transform;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Me.projection.name} projection is not yet implemented`);const Fe=Me.getFreeCameraOptions().position;if(!ae.modelManager)return;const Re=ae.modelManager;Se.modelManager=Re;const Ne=ae.shadowRenderer;if(!Se._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const qe=Se._unevaluatedLayout._values["model-id"],Ue={...Se.layout.get("model-id").parameters},$e=ae.style.order.indexOf(Se.fqid);for(const nt of ge){const pt=_e.getTile(nt).getBucket(Se);if(!pt||pt.projection.name!==Me.projection.name)continue;const Mt=pt.getModelUris();Mt&&!pt.modelsRequested&&(Re.addModelsFromBucket(Mt,Ee),pt.modelsRequested=!0);const ht=X1(nt,Me);Ue.zoom=ht;const Nt=qe.possiblyEvaluate(Ue);if(R_(ae,pt,nt),zs.shadowUniformsInitialized=!1,zs.useSingleShadowCascade=!!Ne&&Ne.getMaxCascadeForTile(nt.toUnwrapped())===0,ae.renderPass==="shadow"&&Ne){if(ae.currentShadowCascade===1&&pt.isInsideFirstShadowMapFrustum)continue;const _t=Me.calculatePosMatrix(nt.toUnwrapped(),Me.worldSize);if(zs.tileMatrix.set(_t),zs.shadowTileMatrix=Float32Array.from(Ne.calculateShadowPassMatrixFromMatrix(_t)),zs.aabb.min.fill(0),zs.aabb.max[0]=zs.aabb.max[1]=i.ab,zs.aabb.max[2]=0,ud(pt,zs,ae,Se.scope))continue}const it=1<<nt.canonical.z,St=[((Fe.x-nt.wrap)*it-nt.canonical.x)*i.ab,(Fe.y*it-nt.canonical.y)*i.ab,Fe.z*it*i.ab];ae.conflationActive&&Object.keys(pt.instancesPerModel).length>0&&ae.style.isLayerClipped(Se,_e.getSource())&&pt.updateReplacement(nt,ae.replacementSource,$e,Ee)&&(pt.uploaded=!1,pt.upload(ae.context));for(let _t in pt.instancesPerModel){const Vt=pt.instancesPerModel[_t];Vt.features.length>0&&(_t=Nt.evaluate(Vt.features[0].feature,{}));const Ut=Re.getModel(_t,Ee);if(Ut&&Ut.uploaded)for(const Ct of Ut.nodes)bo(ae,Se,Ct,Vt,St,nt,zs)}}}(h,n,s,p,O.type==="vector"?s.scope:""),void R();if(!O.loaded())return;if(O.type==="batched-model")return function(ae,_e,Se,ge){Se.resetLayerRenderingStats(ae);const Ee=ae.context,Me=ae.transform,Fe=ae.style.fog,Re=ae.shadowRenderer;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Me.projection.name} projection is not yet implemented`);const Ne=ae.transform.getFreeCameraOptions().position,qe=i.a6.vec3.scale([],[Ne.x,Ne.y,Ne.z],ae.transform.worldSize),Ue=i.a6.vec3.negate([],qe),$e=i.a6.mat4.identity([]),nt=i.de(Me.center.lat,Me.zoom),pt=i.a6.mat4.fromScaling([],[1,1,1/nt]);i.a6.mat4.translate($e,$e,Ue);const Mt=Se.paint.get("model-opacity"),ht=new Tr(Ee.gl.LEQUAL,Tr.ReadWrite,ae.depthRangeFor3D),Nt=new Tr(Ee.gl.LEQUAL,Tr.ReadOnly,ae.depthRangeFor3D),it=new i.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),St=ae.renderPass==="shadow",_t=St&&Re?Re.getCurrentCascadeFrustum():Me.getFrustum(Me.scaleZoom(Me.worldSize)),Vt=Se.paint.get("model-front-cutoff"),Ut=Vt[2]<1,Ct=Pa(ae,Se.paint.get("model-cutoff-fade-range")),Pt=Se.getLayerRenderingStats();(function(xr,Kt,lr,Lr){const fr=xr.terrain?xr.terrain.exaggeration():0,kr=xr.transform.zoom;for(const rn of Lr){const Jr=Kt.getTile(rn).getBucket(lr);Jr&&(xr.conflationActive&&Jr.updateReplacement(rn,xr.replacementSource),Jr.evaluateScale(xr,lr),xr.terrain&&fr>0&&Jr.elevationUpdate(xr.terrain,fr,rn,lr.source),Jr.needsReEvaluation(xr,kr,lr)&&Jr.evaluate(lr))}})(ae,_e,Se,ge),function(){let xr,Kt,lr;Ut?(xr=ge.length-1,Kt=-1,lr=-1):(xr=0,Kt=ge.length,lr=1);const Lr=new Float64Array(16),fr=i.a6.vec3.create(),kr=new i.P(0,0);for(let rn=xr;rn!==Kt;rn+=lr){const Jr=ge[rn],Ln=_e.getTile(Jr).getBucket(Se);if(!Ln||!Ln.uploaded)continue;let Un=!1;Re&&(Un=Re.getMaxCascadeForTile(Jr.toUnwrapped())===0);const Qn=Me.calculatePosMatrix(Jr.toUnwrapped(),Me.worldSize),gs=Ln.modelTraits;!St&&Ut&&(i.a6.mat4.invert(Lr,Qn),i.a6.vec3.transformMat4(fr,qe,Lr),kr.x=fr[0],kr.y=fr[1]);const Pi=[];for(const un of Ln.getNodesInfo()){if(un.hiddenByReplacement||!un.node.meshes)continue;const Nn=un.node;let ui=0;ae.terrain&&Nn.elevation&&(ui=Nn.elevation*ae.terrain.exaggeration());const On=(()=>{const Zn=un.aabb;return it.min=[...Zn.min],it.max=[...Zn.max],it.min[2]+=ui,it.max[2]+=ui,i.a6.vec3.transformMat4(it.min,it.min,Qn),i.a6.vec3.transformMat4(it.max,it.max,Qn),it})(),en=un.evaluatedScale;if(en[0]<=1&&en[1]<=1&&en[2]<=1&&On.intersects(_t)===0)continue;if(!St&&Ut){const Zn=.16666666666666666;un.cameraCollisionOpacity=qe[0]>On.min[0]&&qe[0]<On.max[0]&&qe[1]>On.min[1]&&qe[1]<On.max[1]&&qe[2]*nt<On.max[2]&&Nn.footprint&&i.bu(kr,Nn.footprint)?Math.max(un.cameraCollisionOpacity-Zn,0):Math.min(1,un.cameraCollisionOpacity+Zn)}const wn=[...Qn],Dn=Nn.anchor?Nn.anchor[0]:0,xi=Nn.anchor?Nn.anchor[1]:0;i.a6.mat4.translate(wn,wn,[Dn*(en[0]-1),xi*(en[1]-1),ui]),i.a6.vec3.exactEquals(en,i.dh)||i.a6.mat4.scale(wn,wn,en);const Ai=i.a6.mat4.multiply([],wn,Nn.matrix),yn=i.a6.mat4.multiply([],Me.expandedFarZProjMatrix,Ai),$i=i.a6.mat4.multiply([],Me.expandedFarZProjMatrix,wn),Xi=i.a6.vec4.transformMat4([],[Dn,xi,ui,1],yn)[2];Nn.hidden=!1;let Ui=Mt;St||(Ut&&(Ui*=un.cameraCollisionOpacity,Ui*=bn(wn,Me,un.aabb,Vt)),Ui*=ri(Ct,Xi)),Ui!==0?Pi.push({nodeInfo:un,depth:Xi,opacity:Ui,wvpForNode:yn,wvpForTile:$i,nodeModelMatrix:Ai,tileModelMatrix:wn}):Nn.hidden=!0}St||Pi.sort((un,Nn)=>!Ut||un.opacity===1&&Nn.opacity===1?un.depth<Nn.depth?-1:1:un.opacity===1?-1:Nn.opacity===1?1:un.depth>Nn.depth?-1:1);for(const un of Pi){const Nn=un.nodeInfo,ui=Nn.node;let On=i.a6.mat4.multiply([],pt,un.tileModelMatrix);i.a6.mat4.multiply(On,$e,On);const en=i.a6.mat4.invert([],On);i.a6.mat4.transpose(en,en),i.a6.mat4.scale(en,en,K1),On=i.a6.mat4.multiply(On,On,ui.matrix);const wn=ae.renderPass==="light-beam",Dn=gs&i.dj.HasMapboxMeshFeatures,xi=Dn?0:Nn.evaluatedRMEA[0][2];for(let Ai=0;Ai<ui.meshes.length;++Ai){const yn=ui.meshes[Ai],$i=Ai===ui.lightMeshIndex;let Xi=un.wvpForNode;if($i){if(!wn&&!ae.terrain&&ae.shadowRenderer){ae.currentLayer<ae.firstLightBeamLayer&&(ae.firstLightBeamLayer=ae.currentLayer);continue}Xi=un.wvpForTile}else if(wn)continue;const Ui={defines:[]},Zn=[];if(Uh(Ui.defines,Zn,yn,ae,Se.lut),Dn||Ui.defines.push("DIFFUSE_SHADED"),Un&&Ui.defines.push("SHADOWS_SINGLE_CASCADE"),Pt&&(St?Pt.numRenderedVerticesInShadowPass+=yn.vertexArray.length:Pt.numRenderedVerticesInTransparentPass+=yn.vertexArray.length),St){Hc(yn,un.nodeModelMatrix,ae,Se);continue}let Ao=null;if(Fe){const Oa=$h(un.nodeModelMatrix,ae.transform);if(Ao=new Float32Array(Oa),Me.projection.name!=="globe"){const vl=yn.aabb.min,aa=yn.aabb.max,[Jc,Qc]=Fe.getOpacityForBounds(Oa,vl[0],vl[1],aa[0],aa[1]);Ui.overrideFog=Jc>=nr||Qc>=nr}}const Do=yn.material;let ys;Do.occlusionTexture&&Do.occlusionTexture.offsetScale&&(ys=Do.occlusionTexture.offsetScale,Ui.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!St&&Re&&(Re.useNormalOffset=!!yn.normalBuffer);const ss=ae.getOrCreateProgram("model",Ui);!St&&Re&&Re.setupShadowsFromMatrix(un.tileModelMatrix,ss,Re.useNormalOffset),ae.uploadCommonUniforms(Ee,ss,null,Ao);const Ho=Do.pbrMetallicRoughness;Ho.metallicFactor=.9,Ho.roughnessFactor=.5;const _s=ur(new Float32Array(Xi),new Float32Array(On),new Float32Array(en),new Float32Array(ui.matrix),ae,un.opacity,Ho.baseColorFactor.toRenderColor(null),Do.emissiveFactor,Ho.metallicFactor,Ho.roughnessFactor,Do,xi,Se,[0,0,0],ys);!$i&&(Nn.hasTranslucentParts||un.opacity<1)&&ss.draw(ae,Ee.gl.TRIANGLES,ht,qr.disabled,cn.disabled,Nr.backCCW,_s,Se.id,yn.vertexBuffer,yn.indexBuffer,yn.segments,Se.paint,ae.transform.zoom,void 0,Zn),ss.draw(ae,Ee.gl.TRIANGLES,$i?Nt:ht,qr.disabled,$i||un.opacity<1||Nn.hasTranslucentParts?cn.alphaBlended:cn.unblended,Nr.backCCW,_s,Se.id,yn.vertexBuffer,yn.indexBuffer,yn.segments,Se.paint,ae.transform.zoom,void 0,Zn)}}}}()}(h,n,s,p),void R();if(O.type!=="model")return;const F=O.getModels(),V=[],$=h.transform.getFreeCameraOptions().position,W=i.a6.vec3.scale([],[$.x,$.y,$.z],h.transform.worldSize);i.a6.vec3.negate(W,W);const ee=[],re=[];let ie=0;for(const ae of F){const _e=s.paint.get("model-rotation").constantOr(null),Se=s.paint.get("model-scale").constantOr(null),ge=s.paint.get("model-translation").constantOr(null);ae.computeModelMatrix(h,_e,Se,ge,!0,!0,!1);const Ee=i.a6.mat4.identity([]),Me=i.de(ae.position.lat,h.transform.zoom),Fe=i.a6.mat4.fromScaling([],[1,1,1/Me]);i.a6.mat4.translate(Ee,Ee,W),V.push({zScaleMatrix:Fe,negCameraPosMatrix:Ee});for(const Re of ae.nodes)cd(h.transform,Re,ae.matrix,h.transform.expandedFarZProjMatrix,ie,ee,re);ie++}if(ee.sort((ae,_e)=>_e.depth-ae.depth),h.renderPass!=="shadow"){if(y===1)for(const ae of re)ld(ae,h,s,V[ae.modelIndex],qr.disabled,h.colorModeForRenderPass());else{for(const ae of re)ld(ae,h,s,V[ae.modelIndex],qr.disabled,cn.disabled);for(const ae of re)ld(ae,h,s,V[ae.modelIndex],h.stencilModeFor3D(),h.colorModeForRenderPass());h.resetStencilClippingMasks()}for(const ae of ee)ld(ae,h,s,V[ae.modelIndex],qr.disabled,h.colorModeForRenderPass());R()}else{for(const ae of re)Hc(ae.mesh,ae.nodeModelMatrix,h,s);for(const ae of ee)Hc(ae.mesh,ae.nodeModelMatrix,h,s);R()}}},Gh={model:function(h,n,s){const p=n.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(s.modelManager&&s.modelManager.upload(s,p.type==="vector"?h.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const y=p.getModels();for(const v of y)v.upload(s.context)},raster:function(h,n,s){const p=n.getSource();if(!(p instanceof il&&p.loaded()))return;const y=h.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!y)return;const v=h.paint.get("raster-array-band")||p.getInitialBand(y);if(v==null)return;const w=n.getIds().map(P=>n.getTileByID(P));for(const P of w)P.updateNeeded(y,v)&&p.prepareTile(P,y,v)},"raster-particle":function(h,n,s){const p=n.getSource();if(!(p instanceof il&&p.loaded()))return;const y=h.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!y)return;const v=h.paint.get("raster-particle-array-band")||p.getInitialBand(y);if(v==null)return;const w=n.getIds().map(P=>n.getTileByID(P));for(const P of w)P.updateNeeded(y,v)&&p.prepareTile(P,y,v)}};class fm{constructor(n,s,p,y){this.context=new W1(n,s),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=y,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const v=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const P of v)this._debugParams.enabledLayers[P]=!0;y.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),y.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),y.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),y.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),y.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const P of v)y.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],P);this.occlusionParams=new Wh(y),this.setup(),this.numSublayers=Vo.maxUnderzooming+Vo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Xy(this),this._wireframeDebugCache=new ml,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const w=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,w,n.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(n,s){const p=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Jf(this,n));const y=this._terrain;this.transform.elevation=p?y:null,y.update(n,this.transform,s),this.transform.elevation&&!y.enabled&&(this.transform.elevation=null)}_updateFog(n){const s=n.fog;if(!s||this.transform.projection.name==="globe"||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=s.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const v=p+.78*(y-p);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new Jf(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,s){if(this.width=n*i.q.devicePixelRatio,this.height=s*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const n=this.context,s=new i.a_;s.emplaceBack(0,0),s.emplaceBack(i.ab,0),s.emplaceBack(0,i.ab),s.emplaceBack(i.ab,i.ab),this.tileExtentBuffer=n.createVertexBuffer(s,i.b0.members),this.tileExtentSegments=i.b1.simpleSegment(0,0,4,2);const p=new i.a_;p.emplaceBack(0,0),p.emplaceBack(i.ab,0),p.emplaceBack(0,i.ab),p.emplaceBack(i.ab,i.ab),this.debugBuffer=n.createVertexBuffer(p,i.b0.members),this.debugSegments=i.b1.simpleSegment(0,0,4,5);const y=new i.a_;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,i.b0.members),this.viewportSegments=i.b1.simpleSegment(0,0,4,2);const v=new i.aN;v.emplaceBack(0,0,0,0),v.emplaceBack(i.ab,0,i.ab,0),v.emplaceBack(0,i.ab,0,i.ab),v.emplaceBack(i.ab,i.ab,i.ab,i.ab),this.mercatorBoundsBuffer=n.createVertexBuffer(v,i.b3.members),this.mercatorBoundsSegments=i.b1.simpleSegment(0,0,4,2);const w=new i.aO;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(w);const P=new i.a$;for(const O of[0,1,3,2,0])P.emplaceBack(O);this.debugIndexBuffer=n.createIndexBuffer(P),this.emptyTexture=new i.T(n,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=i.a6.mat4.create();const R=this.context.gl;this.stencilClearMode=new qr({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,Tr.disabled,this.stencilClearMode,cn.disabled,Nr.disabled,td(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,s,p){if(!s||this.currentStencilSource===s.id||!n.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const R of p)if(this._tileClippingMaskIDs[R.key]===void 0){P=!0;break}if(!P)return}this.currentStencilSource=s.id;const y=this.context,v=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(cn.disabled),y.setDepthMode(Tr.disabled);const w=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of p){const R=s.getTile(P),O=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:F,tileBoundsIndexBuffer:V,tileBoundsSegments:$}=this.getTileBoundsBuffers(R);w.draw(this,v.TRIANGLES,Tr.disabled,new qr({func:v.ALWAYS,mask:0},O,255,v.KEEP,v.KEEP,v.REPLACE),cn.disabled,Nr.disabled,td(P.projMatrix),"$clipping",F,V,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,s=this.context.gl;return new qr({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const s=this.context.gl;return new qr({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(n){const s=this.context.gl,p=n.sort((w,P)=>P.overscaledZ-w.overscaledZ),y=p[p.length-1].overscaledZ,v=p[0].overscaledZ-y+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const w={};for(let P=0;P<v;P++)w[P+y]=new qr({func:s.GEQUAL,mask:255},P+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=v,[w,p]}return[{[y]:qr.disabled},p]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new cn([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new i.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?cn.unblended:cn.alphaBlended}colorModeForDrapableLayerRenderPass(n){const s=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new cn([s.ONE,s.ONE_MINUS_SRC_ALPHA,s.CONSTANT_ALPHA,s.ONE_MINUS_SRC_ALPHA],new i.bz(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,s,p,y=!1){if(this.depthOcclusion)return new Tr(this.context.gl.GREATER,Tr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!y)return Tr.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Tr(p||this.context.gl.LEQUAL,s,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,s=Math.ceil(this.width),p=Math.ceil(this.height),y=this.context.bindFramebuffer.get(),v=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===s&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),s!==0&&p!==0&&(this.depthFBO=new zh(this.context,s,p,!1,"texture"),this.depthTexture=new i.T(this.context,{width:s,height:p,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(y),n.bindTexture(n.TEXTURE_2D,v),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,s,p,0,0,s,p,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((n,s)=>n+s/this._fpsHistory.length,0))}render(n,s){const p=i.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=s;const y=this.style._mergedLayers,v=this.style.order.filter(Ue=>{const $e=y[Ue];return!($e.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[$e.type]});let w=!1,P=!1;for(const Ue of v){const $e=y[Ue];$e.type==="circle"&&(w=!0),$e.type==="symbol"&&($e.hasInitialOcclusionOpacityProperties?P=!0:w=!0)}const R=v.map(Ue=>y[Ue]),O=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let F=0,V=!1;for(const Ue in O){const $e=O[Ue];$e.used&&($e.prepare(this.context),$e.getSource().usedInConflation&&++F)}let $=!1;for(const Ue of R)Ue.isHidden(this.transform.zoom)||(Ue.type==="clip"&&($=!0),this.prepareLayer(Ue));const W={},ee={},re={},ie={},ae={};for(const Ue in O){const $e=O[Ue];W[Ue]=$e.getVisibleCoordinates(),ee[Ue]=W[Ue].slice().reverse(),re[Ue]=$e.getVisibleCoordinates(!0).reverse(),ie[Ue]=$e.getShadowCasterCoordinates(),ae[Ue]=$e.sortCoordinatesByDistance(W[Ue])}const _e=Ue=>{const $e=this.style.getLayerSourceCache(Ue);return $e&&$e.used?$e.getSource():null};if(F||$||this._clippingActiveLastFrame){const Ue=[],$e=[];let nt=0;for(const pt of R)this.isSourceForClippingOrConflation(pt,_e(pt))&&(Ue.push(pt),$e.push(nt)),nt++;if(Ue&&($||Ue.length>1)||this._clippingActiveLastFrame){$=!1;const pt=[];for(let Mt=0;Mt<Ue.length;Mt++){const ht=Ue[Mt],Nt=$e[Mt],it=this.style.getLayerSourceCache(ht);if(!it||!it.used||!it.getSource().usedInConflation&&ht.type!=="clip")continue;let St=i.dn,_t=i.bs.None;const Vt=[];let Ut=!0;if(ht.type==="clip"){St=Nt;for(const Ct of ht.layout.get("clip-layer-types"))_t|=Ct==="model"?i.bs.Model:Ct==="symbol"?i.bs.Symbol:i.bs.FillExtrusion;for(const Ct of ht.layout.get("clip-layer-scope"))Vt.push(Ct);ht.isHidden(this.transform.zoom)?Ut=!1:$=!0}Ut&&pt.push({layer:ht.fqid,cache:it,order:St,clipMask:_t,clipScope:Vt})}this.replacementSource.setSources(pt),V=!0}}this._clippingActiveLastFrame=$,V||this.replacementSource.clear(),this.conflationActive=V,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Ue=0;Ue<R.length;Ue++){const $e=R[Ue],nt=$e.cutoffRange();if(this.longestCutoffRange=Math.max(nt,this.longestCutoffRange),nt>0){const pt=_e($e);pt&&(this.minCutoffZoom=Math.max(pt.minzoom,this.minCutoffZoom)),$e.minzoom&&(this.minCutoffZoom=Math.max($e.minzoom,this.minCutoffZoom))}$e.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Ue),this._lastOcclusionLayer=Ue)}const Se=this.style&&this.style.fog;Se?(this._fogVisible=Se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(re),this.opaquePassCutoff=0);const ge=this._shadowRenderer;if(ge){ge.updateShadowParameters(this.transform,this.style.directionalLight);for(const Ue in O)for(const $e of W[Ue]){let nt={min:0,max:0};this.terrain&&(nt=this.terrain.getMinMaxForTile($e)||nt),ge.addShadowReceiver($e.toUnwrapped(),nt.min,nt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Vh(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!Ht.has(this.context.gl))return;this.renderPass="offscreen";for(const Ue of R){const $e=n.getLayerSourceCache(Ue);if(!Ue.hasOffscreenPass()||Ue.isHidden(this.transform.zoom))continue;const nt=$e?ee[$e.id]:void 0;(Ue.type==="custom"||Ue.type==="raster"||Ue.type==="raster-particle"||Ue.isSky()||nt&&nt.length)&&this.renderLayer(this,$e,Ue,nt)}this.depthRangeFor3D=[0,1-(R.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ie)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ee=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Me=(()=>{if(s.showOverdrawInspector)return i.bz.black;const Ue=this.style.fog;if(Ue&&this.transform.projection.supportsFog){const $e=this.style.getLut(Ue.scope);if(!Ee){const nt=Ue.properties.get("color").toRenderColor($e).toArray01();return new i.bz(...nt)}if(Ee){const nt=Ue.properties.get("space-color").toRenderColor($e).toArray01();return new i.bz(...nt)}}return i.bz.transparent})();if(this.context.clear({color:Me,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ee&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const Ue=R[this.currentLayer],$e=n.getLayerSourceCache(Ue);if(Ue.isSky())continue;const nt=$e?(Ue.is3D()?ae:ee)[$e.id]:void 0;this._renderTileClippingMasks(Ue,$e,nt),this.renderLayer(this,$e,Ue,nt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ee&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const Ue=R[this.currentLayer],$e=n.getLayerSourceCache(Ue);Ue.isSky()&&this.renderLayer(this,$e,Ue,$e?ee[$e.id]:void 0)}function Fe(Ue,$e){let nt;return $e&&(nt=(Ue.type==="symbol"?re:Ue.is3D()?ae:ee)[$e.id]),nt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<v.length;){const Ue=R[this.currentLayer];if(Ue.type==="raster"||Ue.type==="raster-particle"){const $e=n.getLayerSourceCache(Ue);this.renderLayer(this,$e,Ue,Fe(Ue,$e))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Re=0;ge&&(Re=ge.getShadowCastingLayerCount());let Ne=!1,qe=-1;for(let Ue=0;Ue<v.length;++Ue){const $e=R[Ue];$e.isHidden(this.transform.zoom)||$e.is3D()&&(qe=Ue)}for(P&&qe===-1&&(w=!0);this.currentLayer<v.length;){const Ue=R[this.currentLayer],$e=n.getLayerSourceCache(Ue);if(Ue.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Ue)){if(Ue.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(w&&!Ne&&this.terrain&&!this.transform.isOrthographic&&(Ne=!0,this.blitDepth()),P&&qe!==-1&&this.currentLayer===qe+1&&!this.transform.isOrthographic&&this.blitDepth(),Ue.is3D()||this.terrain||this._renderTileClippingMasks(Ue,$e,$e?W[$e.id]:void 0),this.renderLayer(this,$e,Ue,Fe(Ue,$e)),!this.terrain&&ge&&Re>0&&Ue.hasShadowPass()&&--Re==0&&(ge.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const nt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=nt;this.currentLayer++){const pt=R[this.currentLayer];if(!pt.hasLightBeamPass())continue;const Mt=n.getLayerSourceCache(pt);this.renderLayer(this,Mt,pt,Mt?ee[Mt.id]:void 0)}this.currentLayer=nt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const nt=this.currentLayer;this.depthOcclusion=!0;for(const pt of this.layersWithOcclusionOpacity){this.currentLayer=pt;const Mt=R[this.currentLayer],ht=n.getLayerSourceCache(Mt),Nt=ht?ee[ht.id]:void 0;Mt.is3D()||this.terrain||this._renderTileClippingMasks(Mt,ht,ht?W[ht.id]:void 0),this.renderLayer(this,ht,Mt,Nt)}this.depthOcclusion=!1,this.currentLayer=nt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Ue=null;R.forEach($e=>{const nt=n.getLayerSourceCache($e);nt&&!$e.isHidden(this.transform.zoom)&&nt.getVisibleCoordinates().length&&(!Ue||Ue.getSource().maxzoom<nt.getSource().maxzoom)&&(Ue=nt)}),Ue&&this.options.showTileBoundaries&&gl.debug(this,Ue,Ue.getVisibleCoordinates(),i.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&gl.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Ue){const $e=Ue.transform.padding;ci(Ue,Ue.transform.height-($e.top||0),3,q1),ci(Ue,$e.bottom||0,3,Uc),st(Ue,$e.left||0,3,Wc),st(Ue,Ue.transform.width-($e.right||0),3,Zt);const nt=Ue.transform.centerPoint;(function(pt,Mt,ht,Nt){ad(pt,Mt-1,ht-10,2,20,Nt),ad(pt,Mt-10,ht-1,20,2,Nt)})(Ue,nt.x,Ue.transform.height-nt.y,_r)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),V||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:s}=this.transform.projection,p=!s||!s.includes(n.type);if(Gh[n.type]&&(p||this.terrain&&n.type==="custom")){const y=this.style.getLayerSourceCache(n);Gh[n.type](n,y,this)}this.gpuTimingEnd()}renderLayer(n,s,p,y){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(p.type)&&(!n.terrain||p.type!=="custom")||p.type==="clip"||gl[p.type](n,s,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery,p=this.context.gl;let y=this.gpuTimers[n.id];y||(y=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:p.createQuery()}),y.calls++,p.beginQuery(s.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,s=this.context.gl,p=s.createQuery();this.deferredRenderGpuTimeQueries.push(p),s.beginQuery(n.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const s={};for(const p in n){const y=n[p],v=this.context.extTimerQuery,w=v.getQueryParameter(y.query,this.context.gl.QUERY_RESULT)/1e6;v.deleteQueryEXT(y.query),s[p]=w}return s}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.extTimerQuery,p=this.context.gl;let y=0;for(const v of n)y+=s.getQueryParameter(v,p.QUERY_RESULT)/1e6,s.deleteQueryEXT(v);return y}translatePosMatrix(n,s,p,y,v){if(!p[0]&&!p[1])return n;const w=v?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(w){const O=Math.sin(w),F=Math.cos(w);p=[p[0]*F-p[1]*O,p[0]*O+p[1]*F]}const P=[v?p[0]:i.ak(s,p[0],this.transform.zoom),v?p[1]:i.ak(s,p[1],this.transform.zoom),0],R=new Float32Array(16);return i.a6.mat4.translate(R,n,P),R}saveTileTexture(n){const s=n.size[0],p=this._tileTextures[s];p?p.push(n):this._tileTextures[s]=[n]}getTileTexture(n){const s=this._tileTextures[n];return s&&s.length>0?s.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,s,p){const y=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,v=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(v.push("LIGHTING_3D_MODE"),v.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):y||v.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||v.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?v.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):v.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(v.push("TERRAIN"),this.linearFloatFilteringSupported()&&v.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&v.push("GLOBE"),!this._fogVisible||y||s!==void 0&&!s||v.push("FOG","FOG_DITHERING"),y&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}getOrCreateProgram(n,s){this.cache=this.cache||{};const p=s&&s.defines||[],y=s&&s.config,v=this.currentGlobalDefines(n,s&&s.overrideFog,s&&s.overrideRtt).concat(p),w=pl.cacheKey(dl[n],n,v,y);return this.cache[w]||(this.cache[w]=new pl(this.context,n,dl[n],y,E_[n],v)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,s){if(this.style.enable3dLights()){const p=this.style.directionalLight,y=this.style.ambientLight;if(p&&y){const v=((w,P,R)=>{const O=w.properties.get("direction"),F=w.properties.get("color").toRenderColor(R.getLut(w.scope)).toArray01(),V=w.properties.get("intensity"),$=P.properties.get("color").toRenderColor(R.getLut(P.scope)).toArray01(),W=P.properties.get("intensity"),ee=[O.x,O.y,O.z],re=i.cH($,W),ie=i.cH(F,V);return{u_lighting_ambient_color:re,u_lighting_directional_dir:ee,u_lighting_directional_color:ie,u_ground_radiance:Qf(ee,ie,re)}})(p,y,this.style);s.setLightsUniformValues(n,v)}}}uploadCommonUniforms(n,s,p,y,v){if(this.uploadCommonLightUniforms(n,s),this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const P=w.getOpacity(this.transform.pitch),R=((O,F,V,$,W,ee,re,ie,ae,_e,Se,ge)=>{const Ee=O.transform,Me=F.properties.get("color").toRenderColor(O.style.getLut(F.scope)).toArray01();Me[3]=$;const Fe=O.frameCounter/1e3%1,[Re,Ne]=F.properties.get("vertical-range");return{u_fog_matrix:V?Ee.calculateFogTileMatrix(V):ge||O.identityMat,u_fog_range:F.getFovAdjustedRange(Ee._fov),u_fog_color:Me,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Re,Ne),Ne],u_fog_temporal_offset:Fe,u_frustum_tl:W,u_frustum_tr:ee,u_frustum_br:re,u_frustum_bl:ie,u_globe_pos:ae,u_globe_radius:_e,u_viewport:Se,u_globe_transition:i.a9(Ee.zoom),u_is_globe:+(Ee.projection.name==="globe")}})(this,w,p,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],y);s.setFogUniformValues(n,R)}v&&s.setCutoffUniformValues(n,v.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,s=n.createTexture();return n.bindTexture(n.TEXTURE_2D,s),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,s=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)s[y.key]=n[y.key]||new ea(y,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,s){return!(!n.is3D()||n.type!=="clip"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building")&&(!s||s.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let s=this._cachedTileFogOpacities[n.key];return s||(this._cachedTileFogOpacities[n.key]=s=this.style.fog.getOpacityForTile(n)),s[0]>=nr||s[1]>=nr}setupDepthForOcclusion(n,s,p){const y=this.context,v=y.gl,w=!!p;var P;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),y.activeTexture.set(v.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((P=this.depthRangeFor3D)[1]-P[0]),-1-2*P[0]/(P[1]-P[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),y.activeTexture.set(v.TEXTURE0),w||s.setTerrainUniformValues(y,p)}}function Da(h,n){let s=!1,p=null;const y=()=>{p=null,s&&(h(),p=setTimeout(y,n),s=!1)};return()=>(s=!0,p||y(),p)}class yl{constructor(n){this._hashName=n&&encodeURIComponent(n),i.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Da(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const s=Ra(n);if(this._hashName){const p=this._hashName;let y=!1;const v=location.hash.slice(1).split("&").map(w=>{const P=w.split("=")[0];return P===p?(y=!0,`${P}=${s}`):w}).filter(w=>w);return y||v.push(`${p}=${s}`),`#${v.join("&")}`}return`#${s}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let s;return n.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(s=p)}),(s&&s[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(p=>isNaN(p))){const p=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(s[3]||0):n.getBearing();return n.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:p,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Ra(h,n){const s=h.getCenter(),p=Math.round(100*h.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,y),w=Math.round(s.lng*v)/v,P=Math.round(s.lat*v)/v,R=h.getBearing(),O=h.getPitch();let F=n?`/${w}/${P}/${p}`:`${p}/${P}/${w}`;return(R||O)&&(F+="/"+Math.round(10*R)/10),O&&(F+=`/${Math.round(O)}`),F}const Kl={linearity:.3,easing:i.dp(0,0,.3,1)},Hh=i.l({deceleration:2500,maxSpeed:1400},Kl),mm=i.l({deceleration:20,maxSpeed:1400},Kl),gm=i.l({deceleration:1e3,maxSpeed:360},Kl),ym=i.l({deceleration:1e3,maxSpeed:90},Kl);class _l{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,s=i.q.now();for(;n.length>0&&s-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const s={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)s.zoom+=v.zoomDelta||0,s.bearing+=v.bearingDelta||0,s.pitch+=v.pitchDelta||0,v.panDelta&&s.pan._add(v.panDelta),v.around&&(s.around=v.around),v.pinchAround&&(s.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(s.pan.mag()){const v=Jl(s.pan.mag(),p,i.l({},Hh,n||{}));y.offset=s.pan.mult(v.amount/s.pan.mag()),y.center=this._map.transform.center,qc(y,v)}if(s.zoom){const v=Jl(s.zoom,p,mm);y.zoom=this._map.transform.zoom+v.amount,qc(y,v)}if(s.bearing){const v=Jl(s.bearing,p,gm);y.bearing=this._map.transform.bearing+i.ap(v.amount,-179,179),qc(y,v)}if(s.pitch){const v=Jl(s.pitch,p,ym);y.pitch=this._map.transform.pitch+v.amount,qc(y,v)}if(y.zoom||y.bearing){const v=s.pinchAround===void 0?s.around:s.pinchAround;y.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function qc(h,n){(!h.duration||h.duration<n.duration)&&(h.duration=n.duration,h.easing=n.easing)}function Jl(h,n,s){const{maxSpeed:p,linearity:y,deceleration:v}=s,w=i.ap(h*y/(n/1e3),-p,p),P=Math.abs(w)/(v*y);return{easing:s.easing,duration:1e3*P,amount:w*(P/2)}}class Po extends i.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,s,p,y={}){const v=ot(s.getCanvasContainer(),p),w=s.unproject(v);super(n,i.l({point:v,lngLat:w,originalEvent:p},y)),this._defaultPrevented=!1,this.target=s}}class Zc extends i.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,s,p){const y=n==="touchend"?p.changedTouches:p.touches,v=oe(s.getCanvasContainer(),y),w=v.map(R=>s.unproject(R)),P=v.reduce((R,O,F,V)=>R.add(O.div(V.length)),new i.P(0,0));super(n,{points:v,point:P,lngLats:w,lngLat:s.unproject(P),originalEvent:p}),this._defaultPrevented=!1}}class so extends i.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,s){super("wheel",{originalEvent:s}),this._defaultPrevented=!1}}class _m{constructor(n,s){this._map=n,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new so(this._map,n))}mousedown(n,s){return this._mousedownPos=s,this._firePreventable(new Po(n.type,this._map,n))}mouseup(n){this._map.fire(new Po(n.type,this._map,n))}preclick(n){const s=i.l({},n);s.type="preclick",this._map.fire(new Po(s.type,this._map,s))}click(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Po(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Po(n.type,this._map,n))}mouseover(n){this._map.fire(new Po(n.type,this._map,n))}mouseout(n){this._map.fire(new Po(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Zc(n.type,this._map,n))}touchmove(n){this._map.fire(new Zc(n.type,this._map,n))}touchend(n){this._map.fire(new Zc(n.type,this._map,n))}touchcancel(n){this._map.fire(new Zc(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xm{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new Po(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Po("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Po(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yc{constructor(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(fe(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(n,s){if(!this._active)return;const p=s,y=this._startPos,v=this._lastPos;if(!y||!v||v.equals(p)||!this._box&&p.dist(y)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=de("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const w=Math.min(y.x,p.x),P=Math.max(y.x,p.x),R=Math.min(y.y,p.y),O=Math.max(y.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${w}px,${R}px)`,this._box.style.width=P-w+"px",this._box.style.height=O-R+"px")})}mouseupWindow(n,s){if(!this._active)return;const p=this._startPos,y=s;if(p&&n.button===0){if(this.reset(),we(),p.x!==y.x||p.y!==y.y)return this._map.fire(new i.x("boxzoomend",{originalEvent:n})),{cameraAnimation:v=>v.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ie(),delete this._startPos,delete this._lastPos}_fireEvent(n,s){return this._map.fire(new i.x(n,{originalEvent:s}))}}function La(h,n){const s={};for(let p=0;p<h.length;p++)s[h[p].identifier]=n[p];return s}class vm{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,s,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const v=new i.P(0,0);for(const w of y)v._add(w);return v.div(y.length)}(s),this.touches=La(p,s)))}touchmove(n,s,p){if(this.aborted||!this.centroid)return;const y=La(p,s);for(const v in this.touches){const w=y[v];(!w||w.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(n,s,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class dd{constructor(n){this.singleTap=new vm(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,s,p){this.singleTap.touchstart(n,s,p)}touchmove(n,s,p){this.singleTap.touchmove(n,s,p)}touchend(n,s,p){const y=this.singleTap.touchend(n,s,p);if(y){const v=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(y)<30;if(v&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class bm{constructor(){this._zoomIn=new dd({numTouches:1,numTaps:2}),this._zoomOut=new dd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,s,p){this._zoomIn.touchstart(n,s,p),this._zoomOut.touchstart(n,s,p)}touchmove(n,s,p){this._zoomIn.touchmove(n,s,p),this._zoomOut.touchmove(n,s,p)}touchend(n,s,p){const y=this._zoomIn.touchend(n,s,p),v=this._zoomOut.touchend(n,s,p);return y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(y)},{originalEvent:n})}):v?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(v)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const hd={0:1,2:2};class pd{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,s){return!1}_move(n,s){return{}}mousedown(n,s){if(this._lastPoint)return;const p=ve(n);this._correctButton(n,p)&&(this._lastPoint=s,this._eventButton=p)}mousemoveWindow(n,s){const p=this._lastPoint;if(p){if(n.preventDefault(),this._eventButton!=null&&function(y,v){const w=hd[v];return y.buttons===void 0||(y.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(p,s)}}mouseupWindow(n){this._lastPoint&&ve(n)===this._eventButton&&(this._moved&&we(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qh extends pd{mousedown(n,s){super.mousedown(n,s),this._lastPoint&&(this._active=!0)}_correctButton(n,s){return s===0&&!n.ctrlKey}_move(n,s){return{around:s,panDelta:s.sub(n)}}}class Zh extends pd{_correctButton(n,s){return s===0&&n.ctrlKey||s===2}_move(n,s){const p=.8*(s.x-n.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(n){n.preventDefault()}}class Yh extends pd{_correctButton(n,s){return s===0&&n.ctrlKey||s===2}_move(n,s){const p=-.5*(s.y-n.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(n){n.preventDefault()}}class z_{constructor(n,s){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),i.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(n,s,p){return this._calculateTransform(n,s,p)}touchmove(n,s,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!i.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,s,p)}}touchend(n,s,p){this._calculateTransform(n,s,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,s,p){p.length>0&&(this._active=!0);const y=La(p,s),v=new i.P(0,0),w=new i.P(0,0);let P=0;for(const O in y){const F=y[O],V=this._touches[O];V&&(v._add(F),w._add(F.sub(V)),P++,y[O]=F)}if(this._touches=y,P<this._minTouches||!w.mag())return;const R=w.div(P);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(P),panDelta:R}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=de("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Xh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,s,p){return{}}touchstart(n,s,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([s[0],s[1]]))}touchmove(n,s,p){const y=this._firstTwoTouches;if(!y)return;n.preventDefault();const[v,w]=y,P=fd(p,s,v),R=fd(p,s,w);if(!P||!R)return;const O=this._aroundCenter?null:P.add(R).div(2);return this._move([P,R],O,n)}touchend(n,s,p){if(!this._firstTwoTouches)return;const[y,v]=this._firstTwoTouches,w=fd(p,s,y),P=fd(p,s,v);w&&P||(this._active&&we(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function fd(h,n,s){for(let p=0;p<h.length;p++)if(h[p].identifier===s)return n[p]}function wm(h,n){return Math.log(h/n)/Math.LN2}class O_ extends Xh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,s){const p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(wm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wm(this._distance,p),pinchAround:s}}}function Sm(h,n){return 180*h.angleWith(n)/Math.PI}class F_ extends Xh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,s){const p=this._vector;if(this._vector=n[0].sub(n[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Sm(this._vector,p),pinchAround:s}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const s=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const y=Sm(n,p);return Math.abs(y)<s}}function Kh(h){return Math.abs(h.y)>Math.abs(h.x)}class B_ extends Xh{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Kh(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,s,p){const y=this._lastPoints;if(!y)return;const v=n[0].sub(y[0]),w=n[1].sub(y[1]);return this._map._cooperativeGestures&&!i.dq()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(v,w,p.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(v.y+w.y)/2*-.5})}gestureBeginsVertically(n,s,p){if(this._valid!==void 0)return this._valid;const y=n.mag()>=2,v=s.mag()>=2;if(!y&&!v)return;if(!y||!v)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const w=n.y>0==s.y>0;return Kh(n)&&Kh(s)&&w}}const j_={panStep:100,bearingStep:15,pitchStep:10};class N_{constructor(){const n=j_;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let s=0,p=0,y=0,v=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),v=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),v=1);break;case 38:n.shiftKey?y=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?y=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:P=>{const R=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:V_,zoom:s?Math.round(R)+s*(n.shiftKey?2:1):R,bearing:P.getBearing()+p*this._bearingStep,pitch:P.getPitch()+y*this._pitchStep,offset:[-v*this._panStep,-w*this._panStep],center:P.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function V_(h){return h*(2-h)}const Tm=4.000244140625,J1=1/450;class Q1{constructor(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=J1,i.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||i.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const p=i.q.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,s!==0&&s%Tm==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=s,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(y*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=ot(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>Tm?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&F!==0&&(F=1/F);const V=s(),$=Math.pow(2,V),W=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(W*F))),this._type==="wheel"&&(this._startZoom=V,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:s(),y=this._startZoom,v=this._easing;let w,P=!1;if(this._type==="wheel"&&y&&v){const O=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),F=v(O);w=i.aa(y,p,F),O<1?this._frameId||(this._frameId=!0):P=!0}else w=p,P=!0;this._active=!0,P&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let R=w-s();return R*this._lastDelta<0&&(R=0),{noInertia:!0,needsRenderFrame:!P,zoomDelta:R,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let s=i.dr;if(this._prevEase){const p=this._prevEase,y=(i.q.now()-p.start)/p.duration,v=p.easing(y+.01)-p.easing(y),w=.27/Math.sqrt(v*v+1e-4)*.01,P=Math.sqrt(.0729-w*w);s=i.dp(w,P,.25,1)}return this._prevEase={start:i.q.now(),duration:n,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=de("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class _i{constructor(n,s){this._clickZoom=n,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class $_{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,s){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(n.shiftKey?-1:1),around:p.unproject(s)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eb{constructor(){this._tap=new dd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,s,p){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=s[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(n,s,p))}touchmove(n,s,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=s[0],v=y.y-this._swipePoint.y;return this._swipePoint=y,n.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(n,s,p)}touchend(n,s,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(n,s,p)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tb{constructor(n,s,p){this._el=n,this._mousePan=s,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class md{constructor(n,s,p){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class U_{constructor(n,s,p,y){this._el=n,this._touchZoom=s,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Xc=h=>h.zoom||h.drag||h.pitch||h.rotate;class Jh extends i.x{}class za{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,s){const p=i.a6.vec3.sub([],s,n);this.radius=i.a6.vec3.length(p[2]<0?i.a6.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(n){i.a6.vec3.div(n,n,this.constants),i.a6.vec3.normalize(n,n),i.a6.vec3.mul(n,n,this.constants);const s=i.a6.vec3.scale([],n,this.radius);if(s[2]>0){const p=i.a6.vec3.scale([],[0,0,1],i.a6.vec3.dot(s,[0,0,1])),y=i.a6.vec3.scale([],i.a6.vec3.normalize([],[s[0],s[1],0]),this.radius),v=i.a6.vec3.add([],s,i.a6.vec3.scale([],i.a6.vec3.sub([],i.a6.vec3.add([],y,p),s),2));s[0]=v[0],s[1]=v[1]}return s}}function Ql(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class wo{constructor(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _l(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new za,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),i.aJ(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,v,w]of this._listeners){const P=y===document?this.handleWindowEvent:this.handleEvent;y.addEventListener(v,P,w)}}destroy(){for(const[n,s,p]of this._listeners){const y=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(s,y,p)}}_addDefaultHandlers(n){const s=this._map,p=s.getCanvasContainer();this._add("mapEvent",new _m(s,n));const y=s.boxZoom=new Yc(s,n);this._add("boxZoom",y);const v=new bm,w=new $_;s.doubleClickZoom=new _i(w,v),this._add("tapZoom",v),this._add("clickZoom",w);const P=new eb;this._add("tapDragZoom",P);const R=s.touchPitch=new B_(s);this._add("touchPitch",R);const O=new Zh(n),F=new Yh(n);s.dragRotate=new md(n,O,F),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",F,["mouseRotate"]);const V=new qh(n),$=new z_(s,n);s.dragPan=new tb(p,V,$),this._add("mousePan",V),this._add("touchPan",$,["touchZoom","touchRotate"]);const W=new F_,ee=new O_;s.touchZoomRotate=new U_(p,ee,W,P),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",ee,["touchPan","touchRotate"]),this._add("blockableMapEvent",new xm(s));const re=s.scrollZoom=new Q1(s,this);this._add("scrollZoom",re,["mousePan"]);const ie=s.keyboard=new N_;this._add("keyboard",ie);for(const ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[ae]&&s[ae].enable(n[ae])}_add(n,s,p){this._handlers.push({handlerName:n,handler:s,allowed:p}),this._handlersById[n]=s}stop(n){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Xc(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,s,p){for(const y in n)if(y!==p&&(!s||s.indexOf(y)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const s=[];for(const p of n)this._el.contains(p.target)&&s.push(p);return s}handleEvent(n,s){this._updatingCamera=!0;const p=n.type==="renderFrame",y=p?void 0:n,v={needsRenderFrame:!1},w={},P={},R=n.touches?this._getMapTouches(n.touches):void 0,O=R?oe(this._el,R):p?void 0:ot(this._el,n);for(const{handlerName:$,handler:W,allowed:ee}of this._handlers){if(!W.isEnabled())continue;let re;this._blockedByActive(P,ee,$)?W.reset():W[s||n.type]&&(re=W[s||n.type](n,O,R),this.mergeHandlerResult(v,w,re,$,y),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||W.isActive())&&(P[$]=W)}const F={};for(const $ in this._previousActiveHandlers)P[$]||(F[$]=y);this._previousActiveHandlers=P,(Object.keys(F).length||Ql(v))&&(this._changes.push([v,w,F]),this._triggerRenderFrame()),(Object.keys(P).length||Ql(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=v;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(n,s,p,y,v){if(!p)return;i.l(n,p);const w={handlerName:y,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(s.zoom=w),p.panDelta!==void 0&&(s.drag=w),p.pitchDelta!==void 0&&(s.pitch=w),p.bearingDelta!==void 0&&(s.rotate=w)}_applyChanges(){const n={},s={},p={};for(const[y,v,w]of this._changes)y.panDelta&&(n.panDelta=(n.panDelta||new i.P(0,0))._add(y.panDelta)),y.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(n.around=y.around),y.aroundCoord!==void 0&&(n.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(n.pinchAround=y.pinchAround),y.noInertia&&(n.noInertia=y.noInertia),i.l(s,v),i.l(p,w);this._updateMapTransform(n,s,p),this._changes=[]}_updateMapTransform(n,s,p){const y=this._map,v=y.transform,w=_e=>[_e.x,_e.y,_e.z];if((_e=>{const Se=this._eventsInProgress.drag;return Se&&!this._handlersById[Se.handlerName].isActive()})()&&!Ql(n)){const _e=v.zoom;v.cameraElevationReference="sea",this._originalZoom!=null&&v._orthographicProjectionAtLowPitch&&v.projection.name!=="globe"&&v.pitch===0?(v.cameraElevationReference="ground",v.zoom=this._originalZoom):(v.recenterOnTerrain(),v.cameraElevationReference="ground"),_e!==v.zoom&&this._map._update(!0)}if(v._isCameraConstrained&&y._stop(!0),!Ql(n))return void this._fireEvents(s,p,!0);let{panDelta:P,zoomDelta:R,bearingDelta:O,pitchDelta:F,around:V,aroundCoord:$,pinchAround:W}=n;v._isCameraConstrained&&(R>0&&(R=0),v._isCameraConstrained=!1),W!==void 0&&(V=W),(R||(_e=>s[_e]&&!this._eventsInProgress[_e])("drag"))&&V&&(this._dragOrigin=w(v.pointCoordinate3D(V)),this._originalZoom=v.zoom,this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",y._stop(!0),V=V||y.transform.centerPoint,O&&(v.bearing+=O),F&&(v.pitch+=F),v._updateCameraState();const ee=[0,0,0];if(P)if(v.projection.name==="mercator"){const _e=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(V).dir),Se=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(V.sub(P)).dir);ee[0]=Se[0]-_e[0],ee[1]=Se[1]-_e[1]}else{const _e=v.pointCoordinate(V);if(v.projection.name==="globe"){P=P.rotate(-v.angle);const Se=v._pixelsPerMercatorPixel/v.worldSize;ee[0]=-P.x*i.ds(i.aM(_e.y))*Se,ee[1]=-P.y*i.ds(v.center.lat)*Se}else{const Se=v.pointCoordinate(V.sub(P));_e&&Se&&(ee[0]=Se.x-_e.x,ee[1]=Se.y-_e.y)}}const re=v.zoom,ie=[0,0,0];if(R){const _e=w($||v.pointCoordinate3D(V)),Se={dir:i.a6.vec3.normalize([],i.a6.vec3.sub([],_e,v._camera.position))};if(Se.dir[2]<0){const ge=v.zoomDeltaToMovement(_e,R);i.a6.vec3.scale(ie,Se.dir,ge)}}const ae=i.a6.vec3.add(ee,ee,ie);v._translateCameraConstrained(ae),R&&Math.abs(v.zoom-re)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,p,!0)}_fireEvents(n,s,p){const y=Xc(this._eventsInProgress),v=Xc(n),w={};for(const F in n){const{originalEvent:V}=n[F];this._eventsInProgress[F]||(w[`${F}start`]=V),this._eventsInProgress[F]=n[F]}!y&&v&&this._fireEvent("movestart",v.originalEvent);for(const F in w)this._fireEvent(F,w[F]);v&&this._fireEvent("move",v.originalEvent);for(const F in n){const{originalEvent:V}=n[F];this._fireEvent(F,V)}const P={};let R;for(const F in this._eventsInProgress){const{handlerName:V,originalEvent:$}=this._eventsInProgress[F];this._handlersById[V].isActive()||(delete this._eventsInProgress[F],R=s[V]||$,P[`${F}end`]=R)}for(const F in P)this._fireEvent(F,P[F]);const O=Xc(this._eventsInProgress);if(p&&(y||v)&&!O){this._updatingCamera=!0;const F=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;F?(V(F.bearing||this._map.getBearing())&&(F.bearing=0),this._map.easeTo(F,{originalEvent:R})):(this._map.fire(new i.x("moveend",{originalEvent:R})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,s){this._map.fire(new i.x(n,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Jh("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ia="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Cm extends i.E{constructor(n,s){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=s.bearingSnap,this._respectPrefersReducedMotion=s.respectPrefersReducedMotion!==!1,i.aJ(["_renderFrameCallback"],this)}getCenter(){return new i.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(n,s){return this.jumpTo({center:n},s)}panBy(n,s,p){return n=i.P.convert(n).mult(-1),this.panTo(this.transform.center,i.l({offset:n},s),p)}panTo(n,s,p){return this.easeTo(i.l({center:n},s),p)}getZoom(){return this.transform.zoom}setZoom(n,s){return this.jumpTo({zoom:n},s),this}zoomTo(n,s,p){return this.easeTo(i.l({zoom:n},s),p)}zoomIn(n,s){return this.zoomTo(this.getZoom()+1,n,s),this}zoomOut(n,s){return this.zoomTo(this.getZoom()-1,n,s),this}getBearing(){return this.transform.bearing}setBearing(n,s){return this.jumpTo({bearing:n},s),this}getPadding(){return this.transform.padding}setPadding(n,s){return this.jumpTo({padding:n},s),this}rotateTo(n,s,p){return this.easeTo(i.l({bearing:n},s),p)}resetNorth(n,s){return this.rotateTo(0,i.l({duration:1e3},n),s),this}resetNorthPitch(n,s){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},n),s),this}snapToNorth(n,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,s):this}getPitch(){return this.transform.pitch}setPitch(n,s){return this.jumpTo({pitch:n},s),this}cameraForBounds(n,s){n=i.as.convert(n);const p=s&&s.bearing||0,y=s&&s.pitch||0,v=n.getNorthWest(),w=n.getSouthEast();return this._cameraForBounds(this.transform,v,w,p,y,s)}_extendPadding(n){const s={top:0,right:0,bottom:0,left:0};return n==null?i.l({},s,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:i.l({},s,n)}_extendCameraOptions(n){return(n=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,s){const p=s.max[0]-s.min[0],y=s.max[1]-s.min[1];return p/y>n.aspect?p/(2*Math.tan(.5*n.fovX)*n.aspect):y/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,s,p,y,v,w){const P=n.clone(),R=this._extendCameraOptions(w);P.bearing=y,P.pitch=v;const O=i.bK.convert(s),F=i.bK.convert(p),V=.5*(O.lat+F.lat),$=.5*(O.lng+F.lng),W=i.dt(V,$),ee=i.a6.vec3.normalize([],W),re=i.a6.vec3.normalize([],i.a6.vec3.cross([],ee,[0,1,0])),ie=i.a6.vec3.cross([],re,ee),ae=[re[0],re[1],re[2],0,ie[0],ie[1],ie[2],0,ee[0],ee[1],ee[2],0,0,0,0,1],_e=[W,i.dt(O.lat,O.lng),i.dt(F.lat,O.lng),i.dt(F.lat,F.lng),i.dt(O.lat,F.lng),i.dt(V,O.lng),i.dt(V,F.lng),i.dt(O.lat,$),i.dt(F.lat,$)];let Se=i.c9.fromPoints(_e.map(_t=>[i.a6.vec3.dot(re,_t),i.a6.vec3.dot(ie,_t),i.a6.vec3.dot(ee,_t)]));const ge=i.a6.vec3.transformMat4([],Se.center,ae);i.a6.vec3.squaredLength(ge)===0&&i.a6.vec3.set(ge,0,0,1),i.a6.vec3.normalize(ge,ge),i.a6.vec3.scale(ge,ge,i.aq),P.center=i.du(ge);const Ee=P.getWorldToCameraMatrix(),Me=i.a6.mat4.invert(new Float64Array(16),Ee);Se=i.c9.applyTransform(Se,i.a6.mat4.multiply([],Ee,ae));const Fe=this._extendAABB(Se,P,R,y);if(!Fe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Se=Fe,i.a6.vec3.transformMat4(ge,ge,Ee);const Re=.5*(Se.max[2]-Se.min[2]),Ne=this._minimumAABBFrustumDistance(P,Se),qe=i.a6.vec3.scale([],[0,0,1],Re),Ue=i.a6.vec3.add(qe,ge,qe),$e=Ne+(P.pitch===0?0:i.a6.vec3.distance(ge,Ue)),nt=P.globeCenterInViewSpace,pt=i.a6.vec3.sub([],ge,[nt[0],nt[1],nt[2]]);i.a6.vec3.normalize(pt,pt),i.a6.vec3.scale(pt,pt,$e);const Mt=i.a6.vec3.add([],ge,pt);i.a6.vec3.transformMat4(Mt,Mt,Me);const ht=i.dw/i.aq,Nt=i.a6.vec3.length(Mt),it=i.bD(Math.max(Nt*ht-i.dw,Number.EPSILON),0),St=Math.min(P.zoomFromMercatorZAdjusted(it),R.maxZoom);return St>.5*(i.c2+i.bU)?(P.setProjection({name:"mercator"}),P.zoom=St,this._cameraForBounds(P,s,p,y,v,w)):{center:P.center,zoom:St,bearing:y,pitch:v}}_extendAABB(n,s,p,y){const v=.5*((p.padding.left||0)+(p.padding.right||0)),w=.5*((p.padding.top||0)+(p.padding.bottom||0)),P=w,R=v,O=v,F=w,V=s.width-(R+O),$=s.height-(P+F),W=i.a6.vec3.sub([],n.max,n.min),ee=Math.min(V/W[0],$/W[1]),re=Math.min(s.scaleZoom(s.scale*ee),p.maxZoom);if(isNaN(re))return null;const ie=s.scale/s.zoomScale(re),ae=new i.c9([n.min[0]-R*ie,n.min[1]-F*ie,n.min[2]],[n.max[0]+O*ie,n.max[1]+P*ie,n.max[2]]),_e=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new i.P(p.offset.x,p.offset.y):i.P.convert(p.offset)).rotate(-i.bB(y));return ae.center[0]-=_e.x*ie,ae.center[1]+=_e.y*ie,ae}queryTerrainElevation(n,s){const p=this.transform.elevation;return p?(s=i.l({},{exaggerated:!0},s),p.getAtPoint(i.a5.fromLngLat(n),null,s.exaggerated)):null}_cameraForBounds(n,s,p,y,v,w){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,s,p,y,v,w);const P=n.clone(),R=this._extendCameraOptions(w);P.bearing=y,P.pitch=v;const O=i.bK.convert(s),F=i.bK.convert(p),V=new i.bK(O.lng,F.lat),$=new i.bK(F.lng,O.lat),W=P.project(O),ee=P.project(F),re=this.queryTerrainElevation(O),ie=this.queryTerrainElevation(F),ae=this.queryTerrainElevation(V),_e=this.queryTerrainElevation($),Se=[[W.x,W.y,Math.min(re||0,ie||0,ae||0,_e||0)],[ee.x,ee.y,Math.max(re||0,ie||0,ae||0,_e||0)]];let ge=i.c9.fromPoints(Se);const Ee=P.getWorldToCameraMatrix(),Me=i.a6.mat4.invert(new Float64Array(16),Ee);ge=i.c9.applyTransform(ge,Ee);const Fe=this._extendAABB(ge,P,R,y);if(!Fe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ge=Fe;const Re=.5*i.a6.vec3.sub([],ge.max,ge.min)[2],Ne=this._minimumAABBFrustumDistance(P,ge),qe=[0,0,1,0];i.a6.vec4.transformMat4(qe,qe,Ee),i.a6.vec4.normalize(qe,qe);const Ue=i.a6.vec3.scale([],qe,Ne+Re),$e=i.a6.vec3.add([],ge.center,Ue);i.a6.vec3.transformMat4(ge.center,ge.center,Me),i.a6.vec3.transformMat4($e,$e,Me);const nt=P.unproject(new i.P(ge.center[0],ge.center[1])),pt=i.dv(P.projection,nt),Mt=Math.pow(2,pt),ht=Math.min(P._zoomFromMercatorZ($e[2]*P.pixelsPerMeter*Mt/P.worldSize),R.maxZoom);return P.mercatorFromTransition&&ht<.5*(i.c2+i.bU)?(P.setProjection({name:"globe"}),P.zoom=ht,this._cameraForBounds(P,s,p,y,v,w)):{center:nt,zoom:ht,bearing:y,pitch:v}}fitBounds(n,s,p){const y=this.cameraForBounds(n,s);return this._fitInternal(y,s,p)}fitScreenCoordinates(n,s,p,y,v){const w=i.P.convert(n),P=i.P.convert(s),R=new i.P(Math.min(w.x,P.x),Math.min(w.y,P.y)),O=new i.P(Math.max(w.x,P.x),Math.max(w.y,P.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(w,P))return this;const F=this.transform.pointLocation3D(R),V=this.transform.pointLocation3D(O),$=this.transform.pointLocation3D(new i.P(R.x,O.y)),W=this.transform.pointLocation3D(new i.P(O.x,R.y)),ee=[Math.min(F.lng,V.lng,$.lng,W.lng),Math.min(F.lat,V.lat,$.lat,W.lat)],re=[Math.max(F.lng,V.lng,$.lng,W.lng),Math.max(F.lat,V.lat,$.lat,W.lat)],ie=y&&y.pitch?y.pitch:this.getPitch(),ae=this._cameraForBounds(this.transform,ee,re,p,ie,y);return this._fitInternal(ae,y,v)}_fitInternal(n,s,p){return n?(s=i.l(n,s)).linear?this.easeTo(s,p):this.flyTo(s,p):this}jumpTo(n,s){this.stop();const p=n.preloadOnly?this.transform.clone():this.transform;let y=!1,v=!1,w=!1;"zoom"in n&&p.zoom!==+n.zoom&&(y=!0,p.zoom=+n.zoom),n.center!==void 0&&(p.center=i.bK.convert(n.center)),"bearing"in n&&p.bearing!==+n.bearing&&(v=!0,p.bearing=+n.bearing),"pitch"in n&&p.pitch!==+n.pitch&&(w=!0,p.pitch=+n.pitch);const P=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!p.isPaddingEqual(P))if(n.retainPadding===!1){const R=p.clone();R.padding=P,p.setLocationAtPoint(p.center,R.centerPoint)}else p.padding=P;return n.preloadOnly?(this._preloadTiles(p),this):(this.fire(new i.x("movestart",s)).fire(new i.x("move",s)),y&&this.fire(new i.x("zoomstart",s)).fire(new i.x("zoom",s)).fire(new i.x("zoomend",s)),v&&this.fire(new i.x("rotatestart",s)).fire(new i.x("rotate",s)).fire(new i.x("rotateend",s)),w&&this.fire(new i.x("pitchstart",s)).fire(new i.x("pitch",s)).fire(new i.x("pitchend",s)),this.fire(new i.x("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(ia),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,s){const p=this.transform;if(!p.projection.supportsFreeCamera)return i.w(ia),this;this.stop();const y=p.zoom,v=p.pitch,w=p.bearing;p.setFreeCameraOptions(n);const P=y!==p.zoom,R=v!==p.pitch,O=w!==p.bearing;return this.fire(new i.x("movestart",s)).fire(new i.x("move",s)),P&&this.fire(new i.x("zoomstart",s)).fire(new i.x("zoom",s)).fire(new i.x("zoomend",s)),O&&this.fire(new i.x("rotatestart",s)).fire(new i.x("rotate",s)).fire(new i.x("rotateend",s)),R&&this.fire(new i.x("pitchstart",s)).fire(new i.x("pitch",s)).fire(new i.x("pitchend",s)),this.fire(new i.x("moveend",s)),this}easeTo(n,s){this._stop(!1,n.easeId),((n=i.l({offset:[0,0],duration:500,easing:i.dr},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const p=this.transform,y=this.getZoom(),v=this.getBearing(),w=this.getPitch(),P=this.getPadding(),R="zoom"in n?+n.zoom:y,O="bearing"in n?this._normalizeBearing(n.bearing,v):v,F="pitch"in n?+n.pitch:w,V=this._extendPadding(n.padding),$=i.P.convert(n.offset);let W,ee,re;if(p.projection.name==="globe"){const qe=i.a5.fromLngLat(p.center),Ue=$.rotate(-p.angle);qe.x+=Ue.x/p.worldSize,qe.y+=Ue.y/p.worldSize;const $e=qe.toLngLat(),nt=i.bK.convert(n.center||$e);this._normalizeCenter(nt),W=p.centerPoint.add(Ue),ee=new i.P(qe.x,qe.y).mult(p.worldSize),re=new i.P(i.am(nt.lng),i.at(nt.lat)).mult(p.worldSize).sub(ee)}else{W=p.centerPoint.add($);const qe=p.pointLocation(W),Ue=i.bK.convert(n.center||qe);this._normalizeCenter(Ue),ee=p.project(qe),re=p.project(Ue).sub(ee)}const ie=p.zoomScale(R-y);let ae,_e;n.around&&(ae=i.bK.convert(n.around),_e=p.locationPoint(ae));const Se=this._zooming||R!==y,ge=this._rotating||v!==O,Ee=this._pitching||F!==w,Me=!p.isPaddingEqual(V),Fe=n.retainPadding===!1?p.clone():p,Re=qe=>Ue=>{if(Se&&(qe.zoom=i.aa(y,R,Ue)),ge&&(qe.bearing=i.aa(v,O,Ue)),Ee&&(qe.pitch=i.aa(w,F,Ue)),Me&&(Fe.interpolatePadding(P,V,Ue),W=Fe.centerPoint.add($)),ae)qe.setLocationAtPoint(ae,_e);else{const $e=qe.zoomScale(qe.zoom-y),nt=R>y?Math.min(2,ie):Math.max(.5,ie),pt=Math.pow(nt,1-Ue),Mt=qe.unproject(ee.add(re.mult(Ue*pt)).mult($e));qe.setLocationAtPoint(qe.renderWorldCopies?Mt.wrap():Mt,W)}return n.preloadOnly||this._fireMoveEvents(s),qe};if(n.preloadOnly){const qe=this._emulate(Re,n.duration,p);return this._preloadTiles(qe),this}const Ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Se,this._rotating=ge,this._pitching=Ee,this._padding=Me,this._easeId=n.easeId,this._prepareEase(s,n.noMoveStart,Ne),this._ease(Re(p),qe=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(s,qe)},n),this}_prepareEase(n,s,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),s||p.moving||this.fire(new i.x("movestart",n)),this._zooming&&!p.zooming&&this.fire(new i.x("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new i.x("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new i.x("pitchstart",n))}_fireMoveEvents(n){this.fire(new i.x("move",n)),this._zooming&&this.fire(new i.x("zoom",n)),this._rotating&&this.fire(new i.x("rotate",n)),this._pitching&&this.fire(new i.x("pitch",n))}_afterEase(n,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new i.x("zoomend",n)),y&&this.fire(new i.x("rotateend",n)),v&&this.fire(new i.x("pitchend",n)),this.fire(new i.x("moveend",n))}flyTo(n,s){if(this._prefersReducedMotion(n)){const _t=i.ar(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(_t,s)}this.stop(),n=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dr},n);const p=this.transform,y=this.getZoom(),v=this.getBearing(),w=this.getPitch(),P=this.getPadding(),R="zoom"in n?i.ap(+n.zoom,p.minZoom,p.maxZoom):y,O="bearing"in n?this._normalizeBearing(n.bearing,v):v,F="pitch"in n?+n.pitch:w,V=this._extendPadding(n.padding),$=p.zoomScale(R-y),W=i.P.convert(n.offset);let ee=p.centerPoint.add(W);const re=p.pointLocation(ee),ie=i.bK.convert(n.center||re);this._normalizeCenter(ie);const ae=p.project(re),_e=p.project(ie).sub(ae);let Se=n.curve;const ge=Math.max(p.width,p.height),Ee=ge/$,Me=_e.mag();if("minZoom"in n){const _t=i.ap(Math.min(n.minZoom,y,R),p.minZoom,p.maxZoom),Vt=ge/p.zoomScale(_t-y);Se=Math.sqrt(Vt/Me*2)}const Fe=Se*Se;function Re(_t){const Vt=(Ee*Ee-ge*ge+(_t?-1:1)*Fe*Fe*Me*Me)/(2*(_t?Ee:ge)*Fe*Me);return Math.log(Math.sqrt(Vt*Vt+1)-Vt)}function Ne(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function qe(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const Ue=Re(0);let $e=function(_t){return qe(Ue)/qe(Ue+Se*_t)},nt=function(_t){return ge*((qe(Ue)*(Ne(Vt=Ue+Se*_t)/qe(Vt))-Ne(Ue))/Fe)/Me;var Vt},pt=(Re(1)-Ue)/Se;if(Math.abs(Me)<1e-6||!isFinite(pt)){if(Math.abs(ge-Ee)<1e-6)return this.easeTo(n,s);const _t=Ee<ge?-1:1;pt=Math.abs(Math.log(Ee/ge))/Se,nt=function(){return 0},$e=function(Vt){return Math.exp(_t*Se*Vt)}}n.duration="duration"in n?+n.duration:1e3*pt/("screenSpeed"in n?+n.screenSpeed/Se:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const Mt=v!==O,ht=F!==w,Nt=!p.isPaddingEqual(V),it=n.retainPadding===!1?p.clone():p,St=_t=>Vt=>{const Ut=Vt*pt,Ct=1/$e(Ut);_t.zoom=Vt===1?R:y+_t.scaleZoom(Ct),Mt&&(_t.bearing=i.aa(v,O,Vt)),ht&&(_t.pitch=i.aa(w,F,Vt)),Nt&&(it.interpolatePadding(P,V,Vt),ee=it.centerPoint.add(W));const Pt=Vt===1?ie:_t.unproject(ae.add(_e.mult(nt(Ut))).mult(Ct));return _t.setLocationAtPoint(_t.renderWorldCopies?Pt.wrap():Pt,ee),_t._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(s),_t};if(n.preloadOnly){const _t=this._emulate(St,n.duration,p);return this._preloadTiles(_t),this}return this._zooming=!0,this._rotating=Mt,this._pitching=ht,this._padding=Nt,this._prepareEase(s,!1),this._ease(St(p),()=>this._afterEase(s),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,s)}if(!n){const p=this.handlers;p&&p.stop(!1)}return this}_ease(n,s,p){p.animate===!1||p.duration===0?(n(1),s()):(this._easeStart=i.q.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,s){n=i.bA(n,-180,180);const p=Math.abs(n-s);return Math.abs(n-360-s)<p&&(n-=360),Math.abs(n+360-s)<p&&(n+=360),n}_normalizeCenter(n){const s=this.transform;if(s.maxBounds||s.projection.name!=="globe"&&!s.renderWorldCopies)return;const p=n.lng-s.center.lng;n.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,s,p){const y=Math.ceil(15*s/1e3),v=[],w=n(p.clone());for(let P=0;P<=y;P++){const R=w(P/y);v.push(R.clone())}return v}_preloadTiles(n,s){}}class Qh{constructor(n={}){this.options=n,i.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const s=this.options&&this.options.compact,p=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=de("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const y=de("span","mapboxgl-ctrl-icon",this._compactButton);return y.setAttribute("aria-hidden","true"),y.setAttribute("title",p),this._innerContainer=de("div","mapboxgl-ctrl-attrib-inner",this._container),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(n){const p=s.reduce((y,v,w)=>(v.value&&(y+=`${v.key}=${v.value}${w<s.length-1?"&":""}`),y),"?");n.href=`${i.e.FEEDBACK_URL}/${p}#${Ra(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const s=this._map.style._mergedSourceCaches;for(const y in s){const v=s[y];if(v.used){const w=v.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort((y,v)=>y.length-v.length),n=n.filter((y,v)=>{for(let w=v+1;w<n.length;w++)if(n[w].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Mm{constructor(){i.aJ(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=de("div","mapboxgl-ctrl");const s=de("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const s in n){const p=n[s].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class W_{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s}remove(n){const s=this._currentlyRunning,p=s?this._queue.concat(s):this._queue;for(const y of p)if(y.id===n)return void(y.cancelled=!0)}run(n=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const p of s)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class gd{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const s=i.cw((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,s,p){this._start=this.getValue(s),this._end=n,this._startTime=s,this._endTime=s+p}}const rb={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class nb{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class Em{constructor(n){this.map=n,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(n,s){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const{type:p,filter:y}=s;if(y){const w=i.M(y,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(w.result==="error")throw new Error(w.value.map(P=>`${P.key}: ${P.message}`).join(", "));this.filters.set(n,w.value)}const v=this.interactionsByType.get(p)||new Map;v.size===0&&(this.map.on(p,this.handleType),this.interactionsByType.set(p,v)),v.set(n,s),this.typeById.set(n,p)}remove(n){const s=this.typeById.get(n);if(!s)return;this.typeById.delete(n),this.filters.delete(n);const p=this.interactionsByType.get(s);p&&(p.delete(n),p.size===0&&this.map.off(s,this.handleType))}handleType(n){const s=n.features||this.map.queryRenderedFeatures(n.point);if(!s)return;const p=this.interactionsByType.get(n.type),y={zoom:0};for(const[v,w]of p){const P=this.filters.get(v),{handler:R,layers:O}=w;for(const F of s)if((!O||O.includes(F.layer.id))&&(!P||P.evaluate(y,F))&&R({id:v,feature:F,interaction:w})!==!1)break}}}const Im={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},yd={showCompass:!0,showZoom:!0,visualizePitch:!1};class Kc{constructor(n,s,p=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new Zh({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,p&&(this.mousePitch=new Yh({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),i.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),fe()}move(n,s){const p=this.map,y=this.mouseRotate.mousemoveWindow(n,s),v=y&&y.bearingDelta;if(v&&p.setBearing(p.getBearing()+v),this.mousePitch){const w=this.mousePitch.mousemoveWindow(n,s),P=w&&w.pitchDelta;P&&p.setPitch(p.getPitch()+P)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ie(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(i.l({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),ot(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,ot(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=oe(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function oa(h,n,s){if(h=new i.bK(h.lng,h.lat),n){const p=new i.bK(h.lng-360,h.lat),y=new i.bK(h.lng+360,h.lat),v=360*Math.ceil(Math.abs(h.lng-s.center.lng)/360),w=s.locationPoint(h).distSqr(n),P=n.x<0||n.y<0||n.x>s.width||n.y>s.height;s.locationPoint(p).distSqr(n)<w&&(P||Math.abs(p.lng-s.center.lng)<v)?h=p:s.locationPoint(y).distSqr(n)<w&&(P||Math.abs(y.lng-s.center.lng)<v)&&(h=y)}for(;Math.abs(h.lng-s.center.lng)>180;){const p=s.locationPoint(h);if(p.x>=0&&p.y>=0&&p.x<=s.width&&p.y<=s.height)break;h.lng>s.center.lng?h.lng-=360:h.lng+=360}return h}const os={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class sa extends i.E{constructor(n,s){if(super(),(n instanceof HTMLElement||s)&&(n=i.l({element:n},s)),i.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=n&&n.occludedOpacity||.2,n&&n.element)this._element=n.element,this._offset=i.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=de("div");const v=41,w=27,P=te("svg",{display:"block",height:v*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${v}`},this._element),R=te("radialGradient",{id:"shadowGradient"},te("defs",{},P));te("stop",{offset:"10%","stop-opacity":.4},R),te("stop",{offset:"100%","stop-opacity":.05},R),te("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),te("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),te("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),te("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=i.P.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const p=this._element.classList;for(const v in os)p.remove(`mapboxgl-marker-anchor-${v}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const y=n&&n.className?n.className.trim().split(/\s+/):[];p.add(...y),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=i.bK.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const s=n.code,p=n.charCode||n.keyCode;s!=="Space"&&s!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(n){const s=n.originalEvent.target,p=this._element;this._popup&&(s===p||p.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,s=this._pos;if(!n||!s)return!1;const p=n.unproject(s),y=n.getFreeCameraOptions();if(!y.position)return!1;const v=y.position.toLngLat();return v.distanceTo(p)<.9*v.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const s=this._pos;if(!s||s.x<0||s.x>n.transform.width||s.y<0||s.y>n.transform.height)return void this._clearFadeTimer();const p=n.unproject(s);let y;n._showingGlobe()&&i.dz(n.transform,this._lngLat)?y=0:(y=1-n._queryFogOpacity(p),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${os[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${s.x}px,${s.y}px)
        `}_calculateXYTransform(){const n=this._pos,s=this._map,p=this.getPitchAlignment();if(!s||!n||p!=="map")return"";if(!s._showingGlobe()){const R=s.getPitch();return R?`rotateX(${R}deg)`:""}const y=i.c0(i.dA(s.transform,this._lngLat)),v=n.sub(i.dB(s.transform)),w=Math.abs(v.x)+Math.abs(v.y);if(w===0)return"";const P=y/w;return`rotateX(${-v.y*P}deg) rotateY(${v.x*P}deg)`}_calculateZTransform(){const n=this._pos,s=this._map;if(!s||!n)return"";let p=0;const y=this.getRotationAlignment();if(y==="map")if(s._showingGlobe()){const v=s.project(new i.bK(this._lngLat.lng,this._lngLat.lat+.001)),w=s.project(new i.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(v);p=i.c0(Math.atan2(w.y,w.x))-90}else p=-s.getBearing();else if(y==="horizon"){const v=i.a7(4,6,s.getZoom()),w=i.dB(s.transform);w.y+=v*s.transform.height;const P=n.sub(w),R=i.c0(Math.atan2(P.y,P.x));p=(R>90?R-270:R+90)*(1-v)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=oa(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),n===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=i.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const s=this._map;if(!s)return;const p=this._pointerdownPos,y=this._positionDelta;if(p&&y){if(!this._isDragging){const v=this._clickTolerance||s._clickTolerance;if(n.point.dist(p)<v)return;this._isDragging=!0}this._pos=n.point.sub(y),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.x("dragstart"))),this.fire(new i.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.x("dragend")),this._state="inactive"}_addDragHandler(n){const s=this._map,p=this._pos;s&&p&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(p),this._pointerdownPos=n.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const s=this._map;return s&&(n?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ec={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},xl={maxWidth:100,unit:"metric"},ib={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ob={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},sb=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function G_(h=new i.P(0,0),n="bottom"){if(typeof h=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(n){case"top":return new i.P(0,h);case"top-left":return new i.P(s,s);case"top-right":return new i.P(-s,s);case"bottom":return new i.P(0,-h);case"bottom-left":return new i.P(s,-s);case"bottom-right":return new i.P(-s,-s);case"left":return new i.P(h,0);case"right":return new i.P(-h,0)}return new i.P(0,0)}return h instanceof i.P||Array.isArray(h)?i.P.convert(h):i.P.convert(h[n]||[0,0])}return{version:j,supported:le.supported,setRTLTextPlugin:i.dC,getRTLTextPluginStatus:i.dD,Map:class extends Cm{constructor(h){q.mark(H.create);const n=h;if((h=i.l({},Im,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&i.dx(window)&&(h.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new hh(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._repaint=!!h.repaint,this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new W_,this._domRenderTaskQueue=new W_,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aP(),this._locale=i.l({},rb,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._tessellationStep=h.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=h.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new gd(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new ze(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,this._contextCreateOptions=h.contextCreateOptions?{...h.contextCreateOptions}:{},typeof h.container=="string"){const s=document.getElementById(h.container);if(!s)throw new Error(`Container '${h.container.toString()}' not found.`);this._container=s}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),i.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new nb),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new wo(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,(h.style||!h.testMode)&&this.setStyle(h.style||i.e.DEFAULT_STYLE,{config:h.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),h.hash&&(this._hash=new yl(typeof h.hash=="string"&&h.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch});const s=h.bounds;s&&(this.resize(),this.fitBounds(s,i.l({},h.fitBoundsOptions,{duration:0})))}this.resize(),h.attributionControl&&this.addControl(new Qh({customAttribution:h.customAttribution})),this._logoControl=new Mm,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new i.x(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new i.x(`${s.dataType}dataloading`,s))}),this._interactions=new Em(this)}_getMapId(){return this._mapId}addControl(h,n){if(n===void 0&&(n=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new i.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=h.onAdd(this);this._controls.push(h);const p=this._controlPositions[n];return n.indexOf("bottom")!==-1?p.insertBefore(s,p.firstChild):p.appendChild(s),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new i.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(h);return n>-1&&this._controls.splice(n,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new i.x("movestart",h)).fire(new i.x("move",h)),this.fire(new i.x("resize",h)),n&&this.fire(new i.x("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(i.as.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new i.x("zoomstart")).fire(new i.x("zoom")).fire(new i.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new i.x("zoomstart")).fire(new i.x("zoom")).fire(new i.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new i.x("pitchstart")).fire(new i.x("pitch")).fire(new i.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new i.x("pitchstart")).fire(new i.x("pitch")).fire(new i.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?navigator.language:Array.isArray(h)?h.length===0?void 0:h.map(n=>n==="auto"?navigator.language:n):h}setLanguage(h){const n=this._parseLanguage(h);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,n=h.projection.name;let s;n==="globe"&&h.zoom>=i.bU?(h.setMercatorFromTransition(),s=!0):n==="mercator"&&h.zoom<i.bU&&(h.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,n){return this._updateProjection(h||n||{name:"mercator"})}_updateProjection(h){let n;return n=h.name==="globe"&&this.transform.zoom>=i.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(h){return this.transform.locationPoint3D(i.bK.convert(h))}unproject(h){return this.transform.pointLocation3D(i.P.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,n,s){if(h==="mouseenter"||h==="mouseover"){let p=!1;const y=w=>{const P=n.filter(O=>this.getLayer(O)),R=P.length?this.queryRenderedFeatures(w.point,{layers:P}):[];R.length?p||(p=!0,s.call(this,new Po(h,this,w.originalEvent,{features:R}))):p=!1},v=()=>{p=!1};return{layers:new Set(n),listener:s,delegates:{mousemove:y,mouseout:v}}}if(h==="mouseleave"||h==="mouseout"){let p=!1;const y=w=>{const P=n.filter(R=>this.getLayer(R));(P.length?this.queryRenderedFeatures(w.point,{layers:P}):[]).length?p=!0:p&&(p=!1,s.call(this,new Po(h,this,w.originalEvent)))},v=w=>{p&&(p=!1,s.call(this,new Po(h,this,w.originalEvent)))};return{layers:new Set(n),listener:s,delegates:{mousemove:y,mouseout:v}}}{const p=y=>{const v=n.filter(P=>this.getLayer(P)),w=v.length?this.queryRenderedFeatures(y.point,{layers:v}):[];w.length&&(y.features=w,s.call(this,y),delete y.features)};return{layers:new Set(n),listener:s,delegates:{[h]:p}}}}on(h,n,s){if(typeof n=="function"||s===void 0)return super.on(h,n);if(Array.isArray(n)||(n=[n]),n){for(const y of n)if(!this._isValidId(y))return this}const p=this._createDelegatedListener(h,n,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(h,n,s){if(typeof n=="function"||s===void 0)return super.once(h,n);if(Array.isArray(n)||(n=[n]),n){for(const y of n)if(!this._isValidId(y))return this}const p=this._createDelegatedListener(h,n,s);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(h,n,s){if(typeof n=="function"||s===void 0)return super.off(h,n);const p=new Set(Array.isArray(n)?n:[n]);for(const w of p)if(!this._isValidId(w))return this;const y=(w,P)=>{if(w.size!==P.size)return!1;for(const R of w)if(!P.has(R))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[h]:void 0;return v&&(w=>{for(let P=0;P<w.length;P++){const R=w[P];if(R.listener===s&&y(R.layers,p)){for(const O in R.delegates)this.off(O,R.delegates[O]);return w.splice(P,1),this}}})(v),this}queryRenderedFeatures(h,n){if(!this.style)return[];if(n!==void 0||h===void 0||h instanceof i.P||Array.isArray(h)||(n=h,h=void 0),h=h||[[0,0],[this.transform.width,this.transform.height]],(n=n||{}).layers&&Array.isArray(n.layers)){for(const s of n.layers)if(!this._isValidId(s))return[]}return this.style.queryRenderedFeatures(h,n,this.transform)}querySourceFeatures(h,n){return this._isValidId(h)?this.style.querySourceFeatures(h,n):[]}isPointOnSurface(h){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&i.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(h))}addInteraction(h,n){return this._interactions.add(h,n),this}removeInteraction(h){return this._interactions.remove(h),this}setStyle(h,n){return n=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&h&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(h,(s,p)=>{s?(i.w(`Unable to perform style diff: ${String(s.message||s.error||s)}. Rebuilding the style from scratch.`),this._updateStyle(h,n)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(h,n))}_getUIString(h){const n=this._locale[h];if(n==null)throw new Error(`Missing UI string '${h}'`);return n}_updateStyle(h,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h){const s=i.l({},n);n&&n.config&&(s.initialConfig=n.config,delete s.config),this.style=new ns(this,s).load(h),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ns(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(h){return h==null?(this.fire(new i.t(new Error("IDs can't be empty."))),!1):!i.cn(h)||(this.fire(new i.t(new Error(`IDs can't contain special symbols: "${h}".`))),!1)}addSource(h,n){return this._isValidId(h)?(this._lazyInitEmptyStyle(),this.style.addSource(h,n),this._update(!0)):this}isSourceLoaded(h){return!!this._isValidId(h)&&!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(h,n,s){this._lazyInitEmptyStyle(),this.style.addSourceType(h,n,s)}removeSource(h){return this._isValidId(h)?(this.style.removeSource(h),this._updateTerrain(),this._update(!0)):this}getSource(h){return this._isValidId(h)?this.style.getOwnSource(h):null}addImage(h,n,{pixelRatio:s=1,sdf:p=!1,stretchX:y,stretchY:v,content:w}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:P,height:R,data:O}=i.q.getImageData(n);this.style.addImage(h,{data:new i.r({width:P,height:R},O),pixelRatio:s,stretchX:y,stretchY:v,content:w,sdf:p,version:0})}else if(n.width===void 0||n.height===void 0)this.fire(new i.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:R}=n,O=n;this.style.addImage(h,{data:new i.r({width:P,height:R},new Uint8Array(O.data)),pixelRatio:s,stretchX:y,stretchY:v,content:w,sdf:p,version:0,userImage:O}),O.onAdd&&O.onAdd(this,h)}}updateImage(h,n){this._lazyInitEmptyStyle();const s=this.style.getImage(h);if(!s)return void this.fire(new i.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?i.q.getImageData(n):n,{width:y,height:v,data:w}=p;if(y===void 0||v===void 0)return void this.fire(new i.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==s.data.width||v!==s.data.height)return void this.fire(new i.t(new Error(`The width and height of the updated image (${y}, ${v})
                must be that same as the previous version of the image
                (${s.data.width}, ${s.data.height})`)));const P=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);s.data.replace(w,P),this.style.updateImage(h,s)}hasImage(h){return h?!!this.style&&!!this.style.getImage(h):(this.fire(new i.t(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,n){i.o(this._requestManager.transformRequest(h,i.R.Image),(s,p)=>{n(s,p instanceof HTMLImageElement?i.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(h,n){this._lazyInitEmptyStyle(),this.style.addModel(h,n)}hasModel(h){return h?this.style.hasModel(h):(this.fire(new i.t(new Error("Missing required model id"))),!1)}removeModel(h){this.style.removeModel(h)}listModels(){return this.style.listModels()}addLayer(h,n){return this._isValidId(h.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(h,n),this._update(!0)):this}getSlot(h){const n=this.getLayer(h);return n&&n.slot||null}setSlot(h,n){return this.style.setSlot(h,n),this.style.mergeLayers(),this._update(!0)}addImport(h,n){return this.style.addImport(h,n),this}updateImport(h,n){return typeof n!="string"&&n.id!==h?(this.removeImport(h),this.addImport(n)):(this.style.updateImport(h,n),this._update(!0))}removeImport(h){return this.style.removeImport(h),this}moveImport(h,n){return this.style.moveImport(h,n),this._update(!0)}moveLayer(h,n){return this._isValidId(h)?(this.style.moveLayer(h,n),this._update(!0)):this}removeLayer(h){return this._isValidId(h)?(this.style.removeLayer(h),this._update(!0)):this}getLayer(h){if(!this._isValidId(h))return null;const n=this.style.getOwnLayer(h);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(h,n,s){return this._isValidId(h)?(this.style.setLayerZoomRange(h,n,s),this._update(!0)):this}setFilter(h,n,s={}){return this._isValidId(h)?(this.style.setFilter(h,n,s),this._update(!0)):this}getFilter(h){return this._isValidId(h)?this.style.getFilter(h):null}setPaintProperty(h,n,s,p={}){return this._isValidId(h)?(this.style.setPaintProperty(h,n,s,p),this._update(!0)):this}getPaintProperty(h,n){return this._isValidId(h)?this.style.getPaintProperty(h,n):null}setLayoutProperty(h,n,s,p={}){return this._isValidId(h)?(this.style.setLayoutProperty(h,n,s,p),this._update(!0)):this}getLayoutProperty(h,n){return this._isValidId(h)?this.style.getLayoutProperty(h,n):null}getSchema(h){return this.style.getSchema(h)}setSchema(h,n){return this.style.setSchema(h,n),this._update(!0)}getConfig(h){return this.style.getConfig(h)}setConfig(h,n){return this.style.setConfig(h,n),this._update(!0)}getConfigProperty(h,n){return this.style.getConfigProperty(h,n)}setConfigProperty(h,n,s){return this.style.setConfigProperty(h,n,s),this._update(!0)}setLights(h){if(this._lazyInitEmptyStyle(),h&&h.length===1&&h[0].type==="flat"){const n=h[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(h),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const h=this.style.getLights()||[];return h.length===0&&h.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),h}setLight(h,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:h}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(h){return this._lazyInitEmptyStyle(),this.style.setColorTheme(h),this._update(!0)}setCamera(h){return this.style.setCamera(h),this._triggerCameraUpdate(h)}_triggerCameraUpdate(h){return this._update(this.transform.setOrthographicProjectionAtLowPitch(h["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bK.convert(h),this.transform):0}setFeatureState(h,n){return this._isValidId(h.source)?(this.style.setFeatureState(h,n),this._update()):this}removeFeatureState(h,n){return this._isValidId(h.source)?(this.style.removeFeatureState(h,n),this._update()):this}getFeatureState(h){return this._isValidId(h.source)?this.style.getFeatureState(h):null}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let s,p,y,v=this._container;for(;v&&(!p||!y);){const w=window.getComputedStyle(v).transform;w&&w!=="none"&&(s=w.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(p=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(y=s[3])),v=v.parentElement}this._containerWidth=p?Math.abs(h/p):h,this._containerHeight=y?Math.abs(n/y):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=de("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=de("div","mapboxgl-canvas-container",h);this._canvas=de("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=de("div","mapboxgl-control-container",h),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(y=>{p[y]=de("div",`mapboxgl-ctrl-${y}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,n){const s=i.q.devicePixelRatio||1;this._canvas.width=s*Math.ceil(h),this._canvas.height=s*Math.ceil(n),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${n}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const n=this._markers.indexOf(h);n!==-1&&this._markers.splice(n,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const n=this._popups.indexOf(h);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const h=i.l({},le.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",h);n?(xt(n,!0),this.painter=new fm(n,this._contextCreateOptions,this.transform,this._tp),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(n)):this.fire(new i.t(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.x("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new i.x("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let n;this.fire(new i.x("renderstart")),++this._frameId;const s=this.painter.context.extTimerQuery,p=i.q.now(),y=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=y.createQuery(),y.beginQuery(s.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,F=this.transform.pitch,V=i.q.now(),$=new i.a3(O,{now:V,fadeDuration:v,pitch:F,transition:this.style.transition});this.style.update($)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(p);const P=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,this.painter.replacementSource);if(P&&(this._placementDirty=P.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,q.mark(H.load),this.fire(new i.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const O=i.q.now()-p;y.endQuery(s.TIME_ELAPSED_EXT),setTimeout(()=>{const F=y.getQueryParameter(n,y.QUERY_RESULT)/1e6;y.deleteQuery(n),this.fire(new i.x("gpu-timing-frame",{cpuTime:O,gpuTime:F}))},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(O);this.fire(new i.x("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(O);this.fire(new i.x("gpu-timing-deferred-render",{gpuTime:F}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(R||this._repaint)this.triggerRepaint();else{const O=this.idle();if(O&&(w=this._updateAverageElevation(p,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new i.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new i.x("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,q.mark(H.fullLoad),this._performanceMetricsCollection&&kt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const n of this._markers)h&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!h||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(h,n=!1){const s=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(n||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const y=this.transform.averageElevation;let v=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=h;const w=Math.abs(y-v);if(w>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(v),s(v);this._averageElevation.easeTo(v,h,300)}else if(w>1e-4)return this._averageElevation.jumpTo(v),s(v)}return!!this._averageElevation.isEasing(h)&&s(this._averageElevation.getValue(h))}_authenticate(){be(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===Le||h.status===401)){const n=this.painter.context.gl;xt(n,!1),this._logoControl instanceof Mm&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Rt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&zt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const s=this.painter.context.gl,p=s.createFramebuffer();function y(v){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,v,0);const w=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,w),w}return s.bindFramebuffer(s.FRAMEBUFFER,p),this._canvasPixelComparison(y(h),n.canvasCopies.map(y),n.timeStamps)}_canvasPixelComparison(h,n,s){let p=s[1]-s[0];const y=h.length/4;for(let v=0;v<n.length;v++){const w=n[v];let P=0;for(let R=0;R<w.length;R+=4)w[R]===h[R]&&w[R+1]===h[R+1]&&w[R+2]===h[R+2]&&w[R+3]===h[R+3]&&(P+=1);p+=(s[v+2]-s[v+1])*(1-P/y)}return p}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ht.delete(this.painter.context.gl),Ot.remove(),wt.remove(),this._removed=!0,this.fire(new i.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=i.q.frame(n=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(n)}))}_preloadTiles(h){const n=this.style?this.style.getSourceCaches():[];return i.bf(n,(s,p)=>s._preloadTiles(h,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(h){this._showParseStatus!==h&&(this._showParseStatus=h,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(h){this._showLayers2DWireframe!==h&&(this._showLayers2DWireframe=h,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(h){this._showLayers3DWireframe!==h&&(this._showLayers3DWireframe=h,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,this._tp.refreshUI(),h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,this._tp.refreshUI(),h&&this._update())}_setCacheLimits(h,n){i.dy(h,n)}get version(){return j}},NavigationControl:class{constructor(h={}){this.options=i.l({},yd,h),this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(i.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),de("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),de("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:n}):s.resetNorth({},{originalEvent:n}))}),this._compassIcon=de("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const n=h.getZoom(),s=n===h.getMaxZoom(),p=n===h.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Kc(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,n){const s=de("button",h,this._container);return s.type="button",s.addEventListener("click",n),s}_setButtonTitle(h,n){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${n}`);h.setAttribute("aria-label",s),h.firstElementChild&&h.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends i.E{constructor(h={}){super();const n=navigator.geolocation;this.options=i.l({geolocation:n},ec,h),i.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Da(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const n=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,h(s)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(s=>n(s.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(h){const n=this._map.getMaxBounds(),s=h.coords;return!!n&&(s.longitude<n.getWest()||s.longitude>n.getEast()||s.latitude<n.getSouth()||s.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new i.x("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.x("geolocate",h)),this._finish()}}_updateCamera(h){const n=new i.bK(h.coords.longitude,h.coords.latitude),s=h.coords.accuracy,p=this._map.getBearing(),y=i.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(s),y,{geolocateSource:!0})}_updateMarker(h){if(h){const n=new i.bK(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,n=i.bD(1,h._center.lat)*h.worldSize,s=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.x("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=de("button","mapboxgl-ctrl-geolocate",this._container),de("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=de("div","mapboxgl-user-location"),this._dotElement.appendChild(de("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(de("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new sa({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=de("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new sa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.x("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Qh,ScaleControl:class{constructor(h={}){this.options=i.l({},xl,h),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,n=this._map,s=n._containerHeight/2,p=n._containerWidth/2-h/2,y=n.unproject([p,s]),v=n.unproject([p+h,s]),w=y.distanceTo(v);if(this.options.unit==="imperial"){const P=3.2808*w;P>5280?this._setScale(h,P/5280,"mile"):this._setScale(h,P,"foot")}else this.options.unit==="nautical"?this._setScale(h,w/1852,"nautical-mile"):w>=1e3?this._setScale(h,w/1e3,"kilometer"):this._setScale(h,w,"meter")}_setScale(h,n,s){this._map._requestDomTask(()=>{const p=function(v){const w=Math.pow(10,`${Math.floor(v)}`.length-1);let P=v/w;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(R){const O=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*O)/O}(P),w*P}(n),y=p/n;this._container.innerHTML=this._isNumberFormatSupported&&s!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:s}).format(p):`${p}&nbsp;${ib[s]}`,this._container.style.width=h*y+"px"})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h={}){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:i.w("Full screen control 'container' must be a DOM element.")),i.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=de("button","mapboxgl-ctrl-fullscreen",this._controlContainer);de("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(h){super(),this.options=i.l(Object.create(ob),h),i.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new i.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new i.x("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=i.bK.convert(h),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const n=document.createDocumentFragment(),s=document.createElement("body");let p;for(s.innerHTML=h;p=s.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=de("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(h),this.options.closeButton){const s=this._closeButton=de("button","mapboxgl-popup-close-button",n);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let n;return this._classList.delete(h)?n=!1:(this._classList.add(h),n=!0),this._updateClassList(),n}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const n=this._map,s=this._container,p=this._pos;if(!n||!s||!p)return"bottom";const y=s.offsetWidth,v=s.offsetHeight,w=p.x<y/2,P=p.x>n.transform.width-y/2;if(p.y+h<v)return w?"top-left":P?"top-right":"top";if(p.y>n.transform.height-v){if(w)return"bottom-left";if(P)return"bottom-right"}return w?"left":P?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),h.className=n.join(" ")}_update(h){const n=this._map,s=this._content;if(!n||!this._lngLat&&!this._trackPointer||!s)return;let p=this._container;if(p||(p=this._container=de("div","mapboxgl-popup",n.getContainer()),this._tip=de("div","mapboxgl-popup-tip",p),p.appendChild(s)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=oa(this._lngLat,this._pos,n.transform)),!this._trackPointer||h){const y=this._pos=this._trackPointer&&h instanceof i.P?h:n.project(this._lngLat),v=G_(this.options.offset),w=this._anchor=this._getAnchor(v.y),P=G_(this.options.offset,w),R=y.add(P).round();n._requestDomTask(()=>{this._container&&w&&(this._container.style.transform=`${os[w]} translate(${R.x}px,${R.y}px)`)})}if(!this._marker&&n._showingGlobe()){const y=i.dz(n.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(sb);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:sa,Style:ns,LngLat:i.bK,LngLatBounds:i.as,Point:i.P,MercatorCoordinate:i.a5,FreeCameraOptions:ul,Evented:i.E,config:i.e,prewarm:i.dE,clearPrewarmedResources:i.dF,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(h){i.e.ACCESS_TOKEN=h},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(h){i.e.API_URL=h},get workerCount(){return i.dG.workerCount},set workerCount(h){i.dG.workerCount=h},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){i.e.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){i.dH(h)},get workerUrl(){return i.dI.workerUrl},set workerUrl(h){i.dI.workerUrl=h},get workerClass(){return i.dI.workerClass},set workerClass(h){i.dI.workerClass=h},get workerParams(){return i.dI.workerParams},set workerParams(h){i.dI.workerParams=h},get dracoUrl(){return i.dJ()},set dracoUrl(h){i.dK(h)},get meshoptUrl(){return i.dL()},set meshoptUrl(h){i.dM(h)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var D=_;return D})})(Gz);var DG=Gz.exports;const HA=Bl(DG),RG=si(L.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add"),LG=si(L.jsx("path",{d:"m14 7-5 5 5 5z"}),"ArrowLeft"),qz=si(L.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),zG=si(L.jsx("path",{d:"M14.5 2.5c0 1.5-1.5 6-1.5 6h-2S9.5 4 9.5 2.5C9.5 1.12 10.62 0 12 0s2.5 1.12 2.5 2.5M12 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m4.08-4.89c.18-.75.33-1.47.39-2.06C19.75 4.69 22 8.08 22 12c0 5.52-4.48 10-10 10S2 17.52 2 12c0-3.92 2.25-7.31 5.53-8.95.07.59.21 1.32.39 2.06C5.58 6.51 4 9.07 4 12c0 4.42 3.58 8 8 8s8-3.58 8-8c0-2.93-1.58-5.49-3.92-6.89M18 12c0 3.31-2.69 6-6 6s-6-2.69-6-6c0-2 .98-3.77 2.48-4.86.23.81.65 2.07.65 2.07C8.43 9.93 8 10.92 8 12c0 2.21 1.79 4 4 4s4-1.79 4-4c0-1.08-.43-2.07-1.13-2.79 0 0 .41-1.22.65-2.07C17.02 8.23 18 10 18 12"}),"CrisisAlert"),Vp=si(L.jsx("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess"),$p=si(L.jsx("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),OG=si(L.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help"),GC=si(L.jsx("path",{d:"M14.59 8 12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"HighlightOff"),FG=si(L.jsx("path",{d:"M8.4 18.2c.38.5.6 1.12.6 1.8 0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3c.44 0 .85.09 1.23.26l1.41-1.77c-.92-1.03-1.29-2.39-1.09-3.69l-2.03-.68c-.54.83-1.46 1.38-2.52 1.38-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3c0 .07 0 .14-.01.21l2.03.68c.64-1.21 1.82-2.09 3.22-2.32V5.91C9.96 5.57 9 4.4 9 3c0-1.66 1.34-3 3-3s3 1.34 3 3c0 1.4-.96 2.57-2.25 2.91v2.16c1.4.23 2.58 1.11 3.22 2.32L18 9.71V9.5c0-1.66 1.34-3 3-3s3 1.34 3 3-1.34 3-3 3c-1.06 0-1.98-.55-2.52-1.37l-2.03.68c.2 1.29-.16 2.65-1.09 3.69l1.41 1.77Q17.34 17 18 17c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3c0-.68.22-1.3.6-1.8l-1.41-1.77c-1.35.75-3.01.76-4.37 0z"}),"Hub"),BG=si(L.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info"),jG=si(L.jsx("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight"),NG=si(L.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"LocationOn"),VG=si(L.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),$G=si([L.jsx("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),L.jsx("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBook"),UG=si(L.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),WG=si(L.jsx("path",{d:"M15 16v1.26l-6-3v-3.17L11.7 8H16V2h-6v4.9L7.3 10H3v6h5l7 3.5V22h6v-6z"}),"Polyline"),GG=si(L.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings"),HG=si(L.jsx("path",{d:"M19.3 16.9c.4-.7.7-1.5.7-2.4 0-2.5-2-4.5-4.5-4.5S11 12 11 14.5s2 4.5 4.5 4.5c.9 0 1.7-.3 2.4-.7l3.2 3.2 1.4-1.4zm-3.8.1c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5M12 20v2C6.48 22 2 17.52 2 12S6.48 2 12 2c4.84 0 8.87 3.44 9.8 8h-2.07c-.64-2.46-2.4-4.47-4.73-5.41V5c0 1.1-.9 2-2 2h-2v2c0 .55-.45 1-1 1H8v2h2v3H9l-4.79-4.79C4.08 10.79 4 11.38 4 12c0 4.41 3.59 8 8 8"}),"TravelExplore"),qG=si(L.jsx("path",{d:"M12 2c3.86 0 7 3.14 7 7 0 5.25-7 13-7 13S5 14.25 5 9c0-3.86 3.14-7 7-7m-1.53 12L17 7.41 15.6 6l-5.13 5.18L8.4 9.09 7 10.5z"}),"WhereToVote");function pu({title:e,value:r,setValue:a,expandComp:u}){return L.jsxs(L.Fragment,{children:[L.jsxs(Vn,{disablePadding:!0,children:[L.jsxs(Kn,{onClick:()=>a(!r),children:[L.jsx(kn,{primary:e}),r?L.jsx(Vp,{}):L.jsx($p,{})]}),L.jsx(yc,{})]}),L.jsx(bu,{in:r,timeout:"auto",unmountOnExit:!0,children:u})]})}function us(){const[e,r]=Y.useState("Chime"),a=u=>{r(u.target.value)};return L.jsxs(UU,{style:{margin:"10px"},children:[L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch"},children:[L.jsx(Rr,{size:{xs:10},children:L.jsx(nn,{sx:{marginBottom:2},children:"Polygon Color"})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(ws,{label:"",type:"color",defaultValue:"#000000",fullWidth:!0})})]}),L.jsx(nn,{sx:{marginBottom:2},children:"Polygon Fill Opacity"}),L.jsx(zn,{paddingLeft:"30px",paddingRight:"30px",children:L.jsx(Vd,{defaultValue:50,"aria-label":"Default",valueLabelDisplay:"auto"})}),L.jsx(nn,{sx:{marginBottom:2},children:"Animation Speed"}),L.jsx(zn,{paddingLeft:"30px",paddingRight:"30px",children:L.jsx(Vd,{defaultValue:50,"aria-label":"Default",valueLabelDisplay:"auto"})}),L.jsx(nn,{sx:{marginBottom:2},children:"Dash Length"}),L.jsx(zn,{paddingLeft:"30px",paddingRight:"30px",children:L.jsx(Vd,{defaultValue:50,"aria-label":"Default",valueLabelDisplay:"auto"})}),L.jsx(nn,{sx:{marginBottom:2},children:"Gap Length"}),L.jsx(zn,{paddingLeft:"30px",paddingRight:"30px",children:L.jsx(Vd,{defaultValue:50,"aria-label":"Default",valueLabelDisplay:"auto"})}),L.jsxs(Rr,{container:!0,rowSpacing:2,direction:"row",columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,justifyContent:"center",alignItems:"center"},children:[L.jsx(Rr,{size:{xs:8},children:L.jsx(nn,{children:"Sound"})}),L.jsx(Rr,{size:{xs:4},children:L.jsx(jy,{fullWidth:!0,children:L.jsx(Ny,{sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},labelId:"demo-simple-select-label",id:"demo-simple-select",value:e,label:"",onChange:a,children:L.jsx(Ur,{value:"Chime",children:"Chime"})})})})]})]})}function ZG({setShowAlert:e}){const[r,a]=Y.useState(!1),[u,g]=Y.useState(!1),[_,M]=Y.useState(!1),[D,i]=Y.useState(!1),[j,H]=Y.useState(!1),[q,X]=Y.useState(!1),[se,ne]=Y.useState(!1),[le,de]=Y.useState(!1),te=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:te,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"505px"}}},children:L.jsxs(zn,{padding:"30px",children:[L.jsx(pu,{title:"Tornado Warning",value:r,setValue:a,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Severe Thunderstorm Warning",value:u,setValue:g,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Flash Flood Warning",value:_,setValue:M,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Special Marine Warning",value:D,setValue:i,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Special Weather Statement Warning",value:j,setValue:H,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Tornado Watch",value:q,setValue:X,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Severe Thunderstorm Watch",value:se,setValue:ne,expandComp:L.jsx(us,{})}),L.jsx(pu,{title:"Flash Flood Watch",value:le,setValue:de,expandComp:L.jsx(us,{})})]})})})}function C1({title:e,buttonClicked:r}){return L.jsx(L.Fragment,{children:L.jsx(Vn,{disablePadding:!0,children:L.jsx(Kn,{onClick:r,children:L.jsx(kn,{primary:e,style:{color:"#8080FF"}})})})})}function Tg({title:e,buttonClicked:r}){return L.jsx(L.Fragment,{children:L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{onClick:r,children:[L.jsx(kn,{primary:e}),L.jsx(jG,{})]})})})}function Vy({title:e,action:r}){return L.jsx(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch",marginLeft:"-10px",marginRight:"-10px"},children:L.jsx(Rr,{size:{xs:12},children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,children:[L.jsx(va,{color:"primary",onClick:r,children:L.jsx(UG,{})}),L.jsx(nn,{variant:"h6",display:"inline",children:e})]})})})}function YG({fontSize:e,setFontSize:r,font:a,setFont:u}){return L.jsx(L.Fragment,{children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,style:{marginLeft:"15px",marginRight:"15px",height:"56px"},children:[L.jsx(Rr,{size:{xs:4},children:L.jsx(kn,{primary:"Font"})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(ws,{label:"",type:"number",defaultValue:e,fullWidth:!0,onChange:g=>r(Number(g.target.value))})}),L.jsx(Rr,{size:{xs:6},children:L.jsxs(ws,{label:"",select:!0,fullWidth:!0,defaultValue:a,onChange:g=>u(g.target.value),children:[L.jsx(Ur,{value:"Arial Unicode MS",children:"Arial Unicode MS"}),L.jsx(Ur,{value:"Alegreya",children:"Alegreya"}),L.jsx(Ur,{value:"Alegreya SC",children:"Alegreya SC"}),L.jsx(Ur,{value:"Asap",children:"Asap"}),L.jsx(Ur,{value:"Barlow",children:"Barlow"}),L.jsx(Ur,{value:"DIN Pro",children:"DIN Pro"}),L.jsx(Ur,{value:"EB Garamond",children:"EB Garamond"}),L.jsx(Ur,{value:"Faustina",children:"Faustina"}),L.jsx(Ur,{value:"Frank Ruhl Libre",children:"Frank Ruhl Libre"}),L.jsx(Ur,{value:"Heebo",children:"Heebo"}),L.jsx(Ur,{value:"Inter",children:"Inter"}),L.jsx(Ur,{value:"Lato",children:"Lato"}),L.jsx(Ur,{value:"League Mono",children:"League Mono"}),L.jsx(Ur,{value:"Montserrat",children:"Montserrat"}),L.jsx(Ur,{value:"Manrope",children:"Manrope"}),L.jsx(Ur,{value:"Noto Sans CJK JP",children:"Noto Sans CJK JP"}),L.jsx(Ur,{value:"Open Sans",children:"Open Sans"}),L.jsx(Ur,{value:"Poppins",children:"Poppins"}),L.jsx(Ur,{value:"Raleway",children:"Raleway"}),L.jsx(Ur,{value:"Roboto",children:"Roboto"}),L.jsx(Ur,{value:"Roboto Mono",children:"Roboto Mono"}),L.jsx(Ur,{value:"Rubik",children:"Rubik"}),L.jsx(Ur,{value:"Source Code Pro",children:"Source Code Pro"}),L.jsx(Ur,{value:"Source Sans Pro",children:"Source Sans Pro"}),L.jsx(Ur,{value:"Spectral",children:"Spectral"}),L.jsx(Ur,{value:"Ubuntu",children:"Ubuntu"})]})})]})})}function wy({title:e,value:r,setValue:a}){return L.jsx(L.Fragment,{children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,style:{marginLeft:"15px",marginRight:"15px",height:"56px"},children:[L.jsx(Rr,{size:{xs:10},children:L.jsx(kn,{primary:e})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(yc,{checked:r,onChange:u=>a(u.target.checked)})})]})})}function qA({title:e,value:r,setValue:a,color:u,setColor:g}){return L.jsx(L.Fragment,{children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,style:{marginLeft:"15px",marginRight:"15px",height:"56px"},children:[L.jsx(Rr,{size:{xs:6},children:L.jsx(kn,{primary:e})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(ws,{label:"",type:"color",defaultValue:u,onChange:_=>g(_.target.value),style:{width:"100%"}})}),L.jsx(Rr,{size:{xs:2}}),L.jsx(Rr,{size:{xs:2},children:L.jsx(yc,{checked:r,onChange:_=>a(_.target.checked)})})]})})}function ZA({enabled:e,setEnabled:r,title:a,colorEnabled:u,setColorEnabled:g,color:_,setColor:M,haloColorEnabled:D,setHaloColorEnabled:i,haloColor:j,setHaloColor:H,font:q,setFont:X,isBold:se,setIsBold:ne,fontSize:le,setFontSize:de}){return L.jsxs(zn,{borderRadius:"12px",children:[L.jsx(wy,{title:a,value:e,setValue:r}),L.jsx(wy,{title:"Bold Font",value:se,setValue:ne}),L.jsx(qA,{title:"Color",value:u,setValue:g,color:_,setColor:M}),L.jsx(qA,{title:"Halo",value:D,setValue:i,color:j,setColor:H}),L.jsx(YG,{fontSize:le,setFontSize:de,font:q,setFont:X})]})}function XG({setShowAlert:e}){const[r,a]=Fn.useState(!1),[u,g]=Fn.useState(!1),[_,M]=Fn.useState("#FF0000"),[D,i]=Fn.useState(!1),[j,H]=Y.useState("#00FF00"),[q,X]=Fn.useState("Arial Unicode MS"),[se,ne]=Fn.useState(!1),[le,de]=Y.useState(18),[te,Q]=Fn.useState(!1),[K,ce]=Fn.useState(!1),[fe,Ie]=Fn.useState("#FF0000"),[Ce,we]=Fn.useState(!1),[ot,oe]=Y.useState("#00FF00"),[ve,je]=Fn.useState("Arial Unicode MS"),[He,Le]=Fn.useState(!1),[ze,Pe]=Y.useState(12),tt=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:tt,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(Vy,{title:"Cities",action:tt}),L.jsx(ZA,{enabled:r,setEnabled:a,title:"Major Cities",colorEnabled:u,setColorEnabled:g,color:_,setColor:M,haloColorEnabled:D,setHaloColorEnabled:i,haloColor:j,setHaloColor:H,font:q,setFont:X,isBold:se,setIsBold:ne,fontSize:le,setFontSize:de}),L.jsx(ZA,{enabled:te,setEnabled:Q,title:"Minor Cities",colorEnabled:K,setColorEnabled:ce,color:fe,setColor:Ie,haloColorEnabled:Ce,setHaloColorEnabled:we,haloColor:ot,setHaloColor:oe,font:ve,setFont:je,isBold:He,setIsBold:Le,fontSize:ze,setFontSize:Pe}),L.jsx(C1,{title:"Reset Cities Settings"})]})})})}function KG({title:e,action:r}){return L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},alignItems:"center",sx:{mb:1,paddingLeft:"15px",paddingRight:"5px"},children:[L.jsx(Rr,{size:{xs:10},children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,children:[L.jsx(nn,{variant:"h6",display:"inline",children:e}),L.jsx(BG,{})]})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(va,{color:"primary",onClick:r,children:L.jsx(qz,{})})})]})}function Zz({title:e,value:r,setValue:a}){return L.jsx(L.Fragment,{children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,style:{marginLeft:"15px",marginRight:"15px",height:"56px"},children:[L.jsx(Rr,{size:{xs:10},children:L.jsx(kn,{primary:e})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(ws,{label:"",type:"color",defaultValue:r,onChange:u=>a(u.target.value),style:{width:"100%"}})})]})})}function Mp({title:e}){return L.jsx(zn,{px:2,children:L.jsx(nn,{variant:"overline",color:"textSecondary",children:e})})}function Yz({title:e,value:r,setValue:a}){return L.jsx(L.Fragment,{children:L.jsxs(Rr,{container:!0,alignItems:"center",spacing:2,style:{marginLeft:"15px",marginRight:"15px",height:"56px"},children:[L.jsx(Rr,{size:{xs:5},children:L.jsx(kn,{primary:e})}),L.jsx(Rr,{size:{xs:7},children:L.jsx(Vd,{defaultValue:parseFloat(r),onChange:(u,g)=>a(g.toString()),step:.05,min:0,max:1,valueLabelDisplay:"auto",style:{width:"100%"}})})]})})}function ef({sectionTitle:e,value:r,setValue:a,switchTitle:u,colorPickerTitle:g,sliderTitle:_,color:M,setColor:D,width:i,setWidth:j}){return L.jsxs(zn,{marginLeft:"10px",marginRight:"10px",paddingLeft:"10px",paddingRight:"10px",paddingBottom:"10px",borderRadius:"12px",children:[L.jsx(Mp,{title:e}),L.jsx(wy,{title:u||"Show",value:r,setValue:a}),L.jsx(Zz,{title:g||"Color",value:M,setValue:D}),L.jsx(Yz,{title:_||"Width",value:i,setValue:j})]})}function JG({setShowAlert:e}){const[r,a]=Fn.useState(!1),[u,g]=Fn.useState("#FF0000"),[_,M]=Y.useState("1"),[D,i]=Fn.useState(!1),[j,H]=Fn.useState("#FF0000"),[q,X]=Y.useState("1"),[se,ne]=Fn.useState(!1),[le,de]=Fn.useState("#FF0000"),[te,Q]=Y.useState("1"),K=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:K,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{paddingBottom:"20px",children:[L.jsx(zn,{padding:"20px",children:L.jsx(Vy,{title:"Borders",action:K})}),L.jsx(ef,{sectionTitle:"County Borders",value:r,setValue:a,switchTitle:"Show",colorPickerTitle:"Color",sliderTitle:"Thickness",color:u,setColor:g,width:_,setWidth:M}),L.jsx(ef,{sectionTitle:"State Borders",value:D,setValue:i,switchTitle:"Show",colorPickerTitle:"Color",sliderTitle:"Thickness",color:j,setColor:H,width:q,setWidth:X}),L.jsx(ef,{sectionTitle:"Country Borders",value:se,setValue:ne,switchTitle:"Show",colorPickerTitle:"Color",sliderTitle:"Thickness",color:le,setColor:de,width:te,setWidth:Q})]})})})}function QG({setShowAlert:e}){const[r,a]=Fn.useState(!1),[u,g]=Fn.useState(!1),[_,M]=Y.useState("#000000"),[D,i]=Y.useState("1"),j=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:j,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(Vy,{title:"Layers",action:j}),L.jsx(Yz,{title:"Map Opacity",value:D,setValue:i}),L.jsx(Zz,{title:"Map Color",value:_,setValue:M}),L.jsx(wy,{title:"Satellite Layer",value:r,setValue:a}),L.jsx(wy,{title:"Terrain Contours",value:u,setValue:g}),L.jsx(C1,{title:"Reset Layers Settings",buttonClicked:()=>console.log("Reset Map Settings")})]})})})}function Xz({projection:e,setProjection:r}){return L.jsx(zn,{margin:"10px",padding:"10px",borderRadius:"12px",children:L.jsxs(jy,{fullWidth:!0,children:[L.jsx(T1,{id:"projection-label",children:"Projection"}),L.jsxs(Ny,{labelId:"projection-label",id:"projection",value:e,onChange:a=>r(a.target.value),children:[L.jsx(Ur,{value:"mercator",children:"Mercator"}),L.jsx(Ur,{value:"globe",children:"Globe"})]})]})})}function e9({setShowAlert:e}){const[r,a]=Fn.useState("globe"),u=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:u,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(Vy,{title:"Map Projection",action:u}),L.jsx(Xz,{projection:r,setProjection:a})]})})})}function t9({setShowAlert:e}){const[r,a]=Fn.useState(!1),[u,g]=Fn.useState("#FF0000"),[_,M]=Y.useState("1"),[D,i]=Fn.useState(!1),[j,H]=Fn.useState("#FF0000"),[q,X]=Y.useState("1"),[se,ne]=Fn.useState(!1),[le,de]=Fn.useState("#FF0000"),[te,Q]=Y.useState("1"),K=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:K,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{paddingBottom:"20px",children:[L.jsx(zn,{padding:"20px",children:L.jsx(Vy,{title:"Road Network",action:K})}),L.jsx(ef,{sectionTitle:"Interstates",value:r,setValue:a,switchTitle:"Show",colorPickerTitle:"Color",sliderTitle:"Thickness",color:u,setColor:g,width:_,setWidth:M}),L.jsx(ef,{sectionTitle:"Highways",value:D,setValue:i,switchTitle:"Show",colorPickerTitle:"Color",sliderTitle:"Thickness",color:j,setColor:H,width:q,setWidth:X}),L.jsx(ef,{sectionTitle:"Streets",value:se,setValue:ne,switchTitle:"Show",colorPickerTitle:"Color",sliderTitle:"Thickness",color:le,setColor:de,width:te,setWidth:Q}),L.jsx(zn,{paddingLeft:"20px",paddingRight:"20px",children:L.jsx(C1,{title:"Reset Road Network Settings"})})]})})})}function r9({setShowAlert:e}){const[r,a]=Y.useState(!1),[u,g]=Y.useState(!1),[_,M]=Y.useState(!1),[D,i]=Y.useState(!1),[j,H]=Y.useState(!1),q=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:q,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(KG,{title:"Map Settings",action:q}),L.jsx(Tg,{title:"Map Projection",buttonClicked:()=>{a(!0)}}),L.jsx(Tg,{title:"Layers",buttonClicked:()=>{g(!0)}}),L.jsx(Tg,{title:"Borders",buttonClicked:()=>M(!0)}),L.jsx(Tg,{title:"Cities",buttonClicked:()=>i(!0)}),L.jsx(Tg,{title:"Road Network",buttonClicked:()=>H(!0)}),L.jsx(C1,{title:"Reset Map Settings",buttonClicked:()=>console.log("Reset Map Settings")}),r&&L.jsx(e9,{setShowAlert:a}),u&&L.jsx(QG,{setShowAlert:g}),_&&L.jsx(JG,{setShowAlert:M}),D&&L.jsx(XG,{setShowAlert:i}),j&&L.jsx(t9,{setShowAlert:H})]})})})}function n9({title:e,action:r}){return L.jsx(Qp,{sx:{backgroundColor:"#2E2E2E",color:"white"},children:L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch",paddingLeft:"10px",backgroundColor:"#FF0000"},children:[L.jsx(Rr,{size:{xs:1},children:L.jsx(LG,{display:"inline"})}),L.jsx(Rr,{size:{xs:9},children:L.jsx(nn,{variant:"h5",children:e})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(va,{color:"primary",onClick:r,children:L.jsx(GC,{})})})]})})}function i9({setShowAlert:e}){const r=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:r,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(n9,{title:"Tornado Warning",action:r}),L.jsxs(Rr,{container:!0,rowSpacing:1,columnSpacing:{xs:1},sx:{mb:1,alignItems:"stretch",paddingLeft:"10px"},children:[L.jsxs(Rr,{size:{xs:7},children:[L.jsx(nn,{variant:"subtitle2",display:"inline",children:"Tornado: "}),L.jsx(nn,{variant:"subtitle2",display:"inline",color:"#FF6347",children:"RADAR INDICATED"})]}),L.jsxs(Rr,{size:{xs:5},children:[L.jsx(nn,{variant:"subtitle2",display:"inline",children:"Hail: "}),L.jsx(nn,{variant:"subtitle2",display:"inline",color:"#DB7093",children:'2.5" (Tennis-Ball Sized)'})]})]}),L.jsxs(Qp,{sx:{backgroundColor:"#444444",color:"white"},children:[L.jsx(nn,{variant:"subtitle2",display:"inline",children:"Expires: "}),L.jsx(nn,{variant:"subtitle2",display:"inline",children:L.jsx("strong",{children:"Sunday, January 19, 2025 at 08:00 PM EST"})})]}),L.jsxs(zn,{padding:"10px",children:[L.jsx(nn,{sx:{whiteSpace:"pre-line"},children:`459
WUUS52 KJAX 191232
SVRJAX
FLC035-083-107-109-191300-/O.NEW.KJAX.SV.W.0005.250119T1232Z-
250119T1300Z/

BULLETIN - IMMEDIATE BROADCAST REQUESTED
Severe Thunderstorm Warning
National Weather Service Jacksonville FL
732 AM EST Sun Jan 19 2025`}),L.jsx("br",{}),L.jsx(nn,{sx:{whiteSpace:"pre-line"},children:"The National Weather Service in Jacksonville has issues a warning."})]})]})})})}function oS({title:e,sectionTitle:r,tornado:a,hail:u,timestamp:g,state:_,isSevere:M=!1}){return L.jsxs(Qp,{sx:{backgroundColor:"#2E2E2E",color:"white"},children:[r&&r!==""?L.jsx(L.Fragment,{children:L.jsx(nn,{variant:"body2",children:r})}):null,L.jsxs(Rr,{container:!0,rowSpacing:1,columnSpacing:{xs:1},sx:{mb:1,alignItems:"stretch",paddingLeft:"10px"},children:[L.jsxs(Rr,{size:{xs:7},children:[L.jsx(nn,{variant:"h6",display:"inline",children:e}),L.jsx(NG,{}),L.jsx($G,{})]}),L.jsx(Rr,{size:{xs:5},children:L.jsx(nn,{variant:"subtitle2",display:"inline",children:"Expires in "+g})}),L.jsx(Rr,{size:{xs:7},children:L.jsx(nn,{variant:"subtitle2",display:"inline",children:"Tornado: "+a.toUpperCase()})}),L.jsx(Rr,{size:{xs:5},children:L.jsx(nn,{variant:"subtitle2",display:"inline",children:"States: "+_.toUpperCase()})}),L.jsx(Rr,{size:{xs:7},children:L.jsx(nn,{variant:"subtitle2",display:"inline",children:"Hail: "+u})}),L.jsx(Rr,{size:{xs:5}})]}),M?L.jsx(Qp,{sx:{backgroundColor:"#FFFFFF",color:"white",paddingLeft:"4px",marginTop:"8px",marginBottom:"8px"},children:L.jsx(nn,{variant:"caption",display:"inline",color:"black",children:"THIS IS A PARTICULARLY DANGEROUS SITUATION. TAKE COVER NOW!"})}):null,L.jsx(Qp,{sx:{backgroundColor:"#444444",color:"white",paddingLeft:"15px"},children:L.jsx(nn,{variant:"subtitle2",display:"inline",children:_.toUpperCase()})}),L.jsx("br",{})]})}function o9({title:e,action:r}){return L.jsx(Qp,{sx:{backgroundColor:"#2E2E2E",color:"white"},children:L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch",paddingLeft:"10px"},children:[L.jsx(Rr,{size:{xs:9},children:L.jsx(nn,{variant:"h5",children:e})}),L.jsxs(Rr,{size:{xs:3},children:[L.jsx(Dz,{color:"secondary",badgeContent:11,max:999,style:{marginRight:"20px"}}),L.jsx(va,{color:"primary",onClick:r,children:L.jsx(GC,{})})]})]})})}function s9({setShowAlert:e}){const r=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:r,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(o9,{title:"Tornado Warning",action:r}),L.jsxs(zn,{padding:"10px",children:[L.jsx(oS,{title:"Tornado Warning",sectionTitle:"Storm-Based",state:"AR, MO, IL",hail:'2.5" (Tennis-Ball Sized)',timestamp:"1 h, 33 mins.",tornado:"RADAR INDICATED"}),L.jsx(oS,{title:"Tornado Warning",state:"AR, MO, IL",hail:'2.5" (Tennis-Ball Sized)',timestamp:"1 h, 33 mins.",tornado:"RADAR INDICATED"}),L.jsx(oS,{title:"Tornado Warning",state:"AR, MO, IL",hail:'4.5" (Grapefruit-Sized)',timestamp:"1 h, 33 mins.",tornado:"OBSERVED",isSevere:!0})]})]})})})}function kd({title:e,badgeValue:r,value:a,setValue:u,expandComp:g}){const _={marginLeft:"30px"};return L.jsxs(L.Fragment,{children:[L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{onClick:()=>u(!a),children:[L.jsx(kn,{primary:e}),a?L.jsx(Vp,{}):L.jsx($p,{}),L.jsx(Dz,{color:"secondary",badgeContent:r,max:999,style:_})]})}),L.jsx(bu,{in:a,timeout:"auto",unmountOnExit:!0,children:g})]})}function a9({setShowAlert:e}){const[r,a]=Y.useState(!1),[u,g]=Y.useState(!1),[_,M]=Y.useState(!1),[D,i]=Y.useState(!1),[j,H]=Y.useState(!1),[q,X]=Y.useState(!1),[se,ne]=Y.useState(!1),le=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:le,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsxs("nav",{"aria-label":"Storm-Based",children:[L.jsx(Mp,{title:"Storm-Based"}),L.jsxs(Ns,{sx:{width:"100%"},component:"nav","aria-labelledby":"nested-list-subheader",children:[L.jsx(kd,{title:"Tornado Warning",badgeValue:"12",value:r,setValue:a,expandComp:L.jsx(us,{})}),L.jsx(kd,{title:"Severe Thunderstorm Warning",badgeValue:"121",value:u,setValue:g,expandComp:L.jsx(us,{})})]})]}),L.jsxs("nav",{"aria-label":"Winter Weather",children:[L.jsx(Mp,{title:"Winter Weather"}),L.jsx(Ns,{sx:{width:"100%"},component:"nav","aria-labelledby":"nested-list-subheader",children:L.jsx(kd,{title:"Winter Storm Warning",badgeValue:"12",value:_,setValue:M,expandComp:L.jsx(us,{})})})]}),L.jsxs("nav",{"aria-label":"Non-Precip",children:[L.jsx(Mp,{title:"Non-Precip"}),L.jsx(Ns,{sx:{width:"100%"},component:"nav","aria-labelledby":"nested-list-subheader",children:L.jsx(kd,{title:"Dense Fog Advisory",badgeValue:"12",value:D,setValue:i,expandComp:L.jsx(us,{})})})]}),L.jsxs("nav",{"aria-label":"Hydro",children:[L.jsx(Mp,{title:"Hydro"}),L.jsx(Ns,{sx:{width:"100%"},component:"nav","aria-labelledby":"nested-list-subheader",children:L.jsx(kd,{title:"Flood Advisory",badgeValue:"12",value:j,setValue:H,expandComp:L.jsx(us,{})})})]}),L.jsxs("nav",{"aria-label":"Fire Weather",children:[L.jsx(Mp,{title:"Fire Weather"}),L.jsxs(Ns,{sx:{width:"100%"},component:"nav","aria-labelledby":"nested-list-subheader",children:[L.jsx(kd,{title:"Red Flag Warning",badgeValue:"12",value:q,setValue:X,expandComp:L.jsx(us,{})}),L.jsx(kd,{title:"Fire Weather Watch",badgeValue:"12",value:se,setValue:ne,expandComp:L.jsx(us,{})})]})]})]})})})}const l9=({drawerWidth:e},r)=>L.jsx("div",{id:"mapcontainer",style:{position:"absolute",left:0,top:0,bottom:0,right:e,margin:0},children:L.jsx("div",{id:"map",ref:r,style:{position:"absolute",top:0,bottom:0,width:"100%",margin:0}})}),c9=Y.forwardRef(l9);function u9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="motorway_link",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function d9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="motorway",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function h9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="primary",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function p9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="secondary",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function f9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="street",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function m9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="tertiary",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function g9(e,r,a,u){Y.useEffect(()=>{var M,D;if(!((M=e.current)!=null&&M.isStyleLoaded()))return;const g="trunk",_=`${g}-road-network`;r?e.current.getLayer(_)?(console.log("layer present show"),e.current.setLayoutProperty(_,"visibility","visible")):e.current.addLayer({id:_,type:"line",source:"composite","source-layer":"road",layout:{visibility:r?"visible":"none"},filter:["==",["get","class"],g]}):e.current.getLayer(_)?(console.log("layer present hide"),e.current.setLayoutProperty(_,"visibility","none")):console.log("layer not present"),(D=e.current)!=null&&D.getLayer(_)&&(e.current.setPaintProperty(_,"line-color",a),e.current.setPaintProperty(_,"line-width",parseFloat(u)))},[e,r,a,u])}function y9(e,r,a){function u(g,_){const M=g.replace(/^#/,""),D=parseInt(M.substring(0,2),16),i=parseInt(M.substring(2,4),16),j=parseInt(M.substring(4,6),16);return`rgba(${D}, ${i}, ${j}, ${_})`}Y.useEffect(()=>{var _;if(!((_=e.current)!=null&&_.isStyleLoaded()))return;const g=u(r,parseFloat(a));e.current.setPaintProperty("background-1","background-color",g)},[e,r,a])}function _9(e,r){Y.useEffect(()=>{var g;if(!((g=e.current)!=null&&g.isStyleLoaded()))return;const a=e.current,u=r?"visible":"none";a.setLayoutProperty("contour-label","visibility",u),a.setLayoutProperty("contour-line","visibility",u),r&&(a.moveLayer("contour-line"),a.moveLayer("contour-label"))},[e,r])}function x9(e,r,a,u){Y.useEffect(()=>{var g,_;(g=e.current)!=null&&g.isStyleLoaded()&&(r?e.current.getLayer("admin-0-boundary")?e.current.setLayoutProperty("admin-0-boundary","visibility","visible"):e.current.addLayer({id:"admin-0-boundary",type:"line",source:"composite","source-layer":"admin",layout:{visibility:"visible"},filter:["all",["==",["get","admin_level"],2],["==",["get","maritime_boundary"],!1]]}):e.current.getLayer("admin-0-boundary")&&e.current.setLayoutProperty("admin-0-boundary","visibility","none"),(_=e.current)!=null&&_.getLayer("admin-0-boundary")&&(e.current.setPaintProperty("admin-0-boundary","line-color",a),e.current.setPaintProperty("admin-0-boundary","line-width",parseFloat(u))))},[e,r,a,u])}function v9(e,r,a,u){Y.useEffect(()=>{var g,_;(g=e.current)!=null&&g.isStyleLoaded()&&(r?e.current.getLayer("admin-2-boundary")?e.current.setLayoutProperty("admin-2-boundary","visibility","visible"):e.current.addLayer({id:"admin-2-boundary",type:"line",source:"composite","source-layer":"admin",layout:{visibility:"visible"},filter:["==",["get","admin_level"],2]}):e.current.getLayer("admin-2-boundary")&&e.current.setLayoutProperty("admin-2-boundary","visibility","none"),(_=e.current)!=null&&_.getLayer("admin-2-boundary")&&(e.current.setPaintProperty("admin-2-boundary","line-color",a),e.current.setPaintProperty("admin-2-boundary","line-width",parseFloat(u))))},[e,r,a,u])}function b9(e,r,a,u,g,_,M){Y.useEffect(()=>{var i;if(!((i=e.current)!=null&&i.isStyleLoaded()))return;const D="settlement-major-label";r?e.current.getLayer(D)?e.current.setLayoutProperty(D,"visibility","visible"):e.current.addLayer({id:D,type:"symbol",source:"composite","source-layer":"place",layout:{"text-field":["get","name"],visibility:"visible","text-size":M},filter:["==",["get","class"],r]}):e.current.getLayer(D)&&e.current.setLayoutProperty(D,"visibility","none"),e.current.getLayer(D)&&(e.current.setPaintProperty(D,"text-color",a),e.current.setPaintProperty(D,"text-halo-color",u),e.current.setLayoutProperty("settlement-major-label","text-size",M),e.current.setLayoutProperty("settlement-major-label","text-font",[`${g} ${_}`]))},[e,r,a,u,g,_,M])}function w9(e,r,a,u,g,_,M){Y.useEffect(()=>{var i;if(!((i=e.current)!=null&&i.isStyleLoaded()))return;const D="settlement-minor-label";r?e.current.getLayer(D)?e.current.setLayoutProperty(D,"visibility","visible"):e.current.addLayer({id:D,type:"symbol",source:"composite","source-layer":"place",layout:{"text-field":["get","name"],visibility:"visible","text-size":M},filter:["==",["get","class"],r]}):e.current.getLayer(D)&&e.current.setLayoutProperty(D,"visibility","none"),e.current.getLayer(D)&&(e.current.setPaintProperty(D,"text-color",a),e.current.setPaintProperty(D,"text-halo-color",u),e.current.setLayoutProperty("settlement-minor-label","text-size",M),e.current.setLayoutProperty("settlement-minor-label","text-font",[`${g} ${_}`]))},[e,r,a,u,g,_,M])}function S9(e,r){Y.useEffect(()=>{var a,u;(a=e.current)!=null&&a.isStyleLoaded()&&((u=e.current)==null||u.setProjection(r))},[e,r])}function T9(e,r){Y.useEffect(()=>{var a,u;(a=e.current)!=null&&a.isStyleLoaded()&&((u=e.current)==null||u.setLayoutProperty("mapbox-satellite","visibility",r?"visible":"none"))},[e,r])}function C9(e,r,a,u){Y.useEffect(()=>{var g,_;(g=e.current)!=null&&g.isStyleLoaded()&&(r?e.current.getLayer("admin-1-boundary")?e.current.setLayoutProperty("admin-1-boundary","visibility","visible"):e.current.addLayer({id:"admin-1-boundary",type:"line",source:"composite","source-layer":"admin",layout:{visibility:"visible"},filter:["all",["==",["get","admin_level"],2],["==",["get","maritime_boundary"],!1]]}):e.current.getLayer("admin-1-boundary")&&e.current.setLayoutProperty("admin-1-boundary","visibility","none"),(_=e.current)!=null&&_.getLayer("admin-1-boundary")&&(e.current.setPaintProperty("admin-1-boundary","line-color",a),e.current.setPaintProperty("admin-1-boundary","line-width",parseFloat(u))))},[e,r,a,u])}var Kz={exports:{}};(function(e,r){(function(a,u){e.exports=u()})(Jd,function(){var a=1e3,u=6e4,g=36e5,_="millisecond",M="second",D="minute",i="hour",j="day",H="week",q="month",X="quarter",se="year",ne="date",le="Invalid Date",de=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,te=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Le){var ze=["th","st","nd","rd"],Pe=Le%100;return"["+Le+(ze[(Pe-20)%10]||ze[Pe]||ze[0])+"]"}},K=function(Le,ze,Pe){var tt=String(Le);return!tt||tt.length>=ze?Le:""+Array(ze+1-tt.length).join(Pe)+Le},ce={s:K,z:function(Le){var ze=-Le.utcOffset(),Pe=Math.abs(ze),tt=Math.floor(Pe/60),De=Pe%60;return(ze<=0?"+":"-")+K(tt,2,"0")+":"+K(De,2,"0")},m:function Le(ze,Pe){if(ze.date()<Pe.date())return-Le(Pe,ze);var tt=12*(Pe.year()-ze.year())+(Pe.month()-ze.month()),De=ze.clone().add(tt,q),Ke=Pe-De<0,Ge=ze.clone().add(tt+(Ke?-1:1),q);return+(-(tt+(Pe-De)/(Ke?De-Ge:Ge-De))||0)},a:function(Le){return Le<0?Math.ceil(Le)||0:Math.floor(Le)},p:function(Le){return{M:q,y:se,w:H,d:j,D:ne,h:i,m:D,s:M,ms:_,Q:X}[Le]||String(Le||"").toLowerCase().replace(/s$/,"")},u:function(Le){return Le===void 0}},fe="en",Ie={};Ie[fe]=Q;var Ce="$isDayjsObject",we=function(Le){return Le instanceof je||!(!Le||!Le[Ce])},ot=function Le(ze,Pe,tt){var De;if(!ze)return fe;if(typeof ze=="string"){var Ke=ze.toLowerCase();Ie[Ke]&&(De=Ke),Pe&&(Ie[Ke]=Pe,De=Ke);var Ge=ze.split("-");if(!De&&Ge.length>1)return Le(Ge[0])}else{var ft=ze.name;Ie[ft]=ze,De=ft}return!tt&&De&&(fe=De),De||!tt&&fe},oe=function(Le,ze){if(we(Le))return Le.clone();var Pe=typeof ze=="object"?ze:{};return Pe.date=Le,Pe.args=arguments,new je(Pe)},ve=ce;ve.l=ot,ve.i=we,ve.w=function(Le,ze){return oe(Le,{locale:ze.$L,utc:ze.$u,x:ze.$x,$offset:ze.$offset})};var je=function(){function Le(Pe){this.$L=ot(Pe.locale,null,!0),this.parse(Pe),this.$x=this.$x||Pe.x||{},this[Ce]=!0}var ze=Le.prototype;return ze.parse=function(Pe){this.$d=function(tt){var De=tt.date,Ke=tt.utc;if(De===null)return new Date(NaN);if(ve.u(De))return new Date;if(De instanceof Date)return new Date(De);if(typeof De=="string"&&!/Z$/i.test(De)){var Ge=De.match(de);if(Ge){var ft=Ge[2]-1||0,Gt=(Ge[7]||"0").substring(0,3);return Ke?new Date(Date.UTC(Ge[1],ft,Ge[3]||1,Ge[4]||0,Ge[5]||0,Ge[6]||0,Gt)):new Date(Ge[1],ft,Ge[3]||1,Ge[4]||0,Ge[5]||0,Ge[6]||0,Gt)}}return new Date(De)}(Pe),this.init()},ze.init=function(){var Pe=this.$d;this.$y=Pe.getFullYear(),this.$M=Pe.getMonth(),this.$D=Pe.getDate(),this.$W=Pe.getDay(),this.$H=Pe.getHours(),this.$m=Pe.getMinutes(),this.$s=Pe.getSeconds(),this.$ms=Pe.getMilliseconds()},ze.$utils=function(){return ve},ze.isValid=function(){return this.$d.toString()!==le},ze.isSame=function(Pe,tt){var De=oe(Pe);return this.startOf(tt)<=De&&De<=this.endOf(tt)},ze.isAfter=function(Pe,tt){return oe(Pe)<this.startOf(tt)},ze.isBefore=function(Pe,tt){return this.endOf(tt)<oe(Pe)},ze.$g=function(Pe,tt,De){return ve.u(Pe)?this[tt]:this.set(De,Pe)},ze.unix=function(){return Math.floor(this.valueOf()/1e3)},ze.valueOf=function(){return this.$d.getTime()},ze.startOf=function(Pe,tt){var De=this,Ke=!!ve.u(tt)||tt,Ge=ve.p(Pe),ft=function(kt,Ot){var be=ve.w(De.$u?Date.UTC(De.$y,Ot,kt):new Date(De.$y,Ot,kt),De);return Ke?be:be.endOf(j)},Gt=function(kt,Ot){return ve.w(De.toDate()[kt].apply(De.toDate("s"),(Ke?[0,0,0,0]:[23,59,59,999]).slice(Ot)),De)},Ft=this.$W,wt=this.$M,Rt=this.$D,It="set"+(this.$u?"UTC":"");switch(Ge){case se:return Ke?ft(1,0):ft(31,11);case q:return Ke?ft(1,wt):ft(0,wt+1);case H:var zt=this.$locale().weekStart||0,At=(Ft<zt?Ft+7:Ft)-zt;return ft(Ke?Rt-At:Rt+(6-At),wt);case j:case ne:return Gt(It+"Hours",0);case i:return Gt(It+"Minutes",1);case D:return Gt(It+"Seconds",2);case M:return Gt(It+"Milliseconds",3);default:return this.clone()}},ze.endOf=function(Pe){return this.startOf(Pe,!1)},ze.$set=function(Pe,tt){var De,Ke=ve.p(Pe),Ge="set"+(this.$u?"UTC":""),ft=(De={},De[j]=Ge+"Date",De[ne]=Ge+"Date",De[q]=Ge+"Month",De[se]=Ge+"FullYear",De[i]=Ge+"Hours",De[D]=Ge+"Minutes",De[M]=Ge+"Seconds",De[_]=Ge+"Milliseconds",De)[Ke],Gt=Ke===j?this.$D+(tt-this.$W):tt;if(Ke===q||Ke===se){var Ft=this.clone().set(ne,1);Ft.$d[ft](Gt),Ft.init(),this.$d=Ft.set(ne,Math.min(this.$D,Ft.daysInMonth())).$d}else ft&&this.$d[ft](Gt);return this.init(),this},ze.set=function(Pe,tt){return this.clone().$set(Pe,tt)},ze.get=function(Pe){return this[ve.p(Pe)]()},ze.add=function(Pe,tt){var De,Ke=this;Pe=Number(Pe);var Ge=ve.p(tt),ft=function(wt){var Rt=oe(Ke);return ve.w(Rt.date(Rt.date()+Math.round(wt*Pe)),Ke)};if(Ge===q)return this.set(q,this.$M+Pe);if(Ge===se)return this.set(se,this.$y+Pe);if(Ge===j)return ft(1);if(Ge===H)return ft(7);var Gt=(De={},De[D]=u,De[i]=g,De[M]=a,De)[Ge]||1,Ft=this.$d.getTime()+Pe*Gt;return ve.w(Ft,this)},ze.subtract=function(Pe,tt){return this.add(-1*Pe,tt)},ze.format=function(Pe){var tt=this,De=this.$locale();if(!this.isValid())return De.invalidDate||le;var Ke=Pe||"YYYY-MM-DDTHH:mm:ssZ",Ge=ve.z(this),ft=this.$H,Gt=this.$m,Ft=this.$M,wt=De.weekdays,Rt=De.months,It=De.meridiem,zt=function(Ot,be,Ht,xt){return Ot&&(Ot[be]||Ot(tt,Ke))||Ht[be].slice(0,xt)},At=function(Ot){return ve.s(ft%12||12,Ot,"0")},kt=It||function(Ot,be,Ht){var xt=Ot<12?"AM":"PM";return Ht?xt.toLowerCase():xt};return Ke.replace(te,function(Ot,be){return be||function(Ht){switch(Ht){case"YY":return String(tt.$y).slice(-2);case"YYYY":return ve.s(tt.$y,4,"0");case"M":return Ft+1;case"MM":return ve.s(Ft+1,2,"0");case"MMM":return zt(De.monthsShort,Ft,Rt,3);case"MMMM":return zt(Rt,Ft);case"D":return tt.$D;case"DD":return ve.s(tt.$D,2,"0");case"d":return String(tt.$W);case"dd":return zt(De.weekdaysMin,tt.$W,wt,2);case"ddd":return zt(De.weekdaysShort,tt.$W,wt,3);case"dddd":return wt[tt.$W];case"H":return String(ft);case"HH":return ve.s(ft,2,"0");case"h":return At(1);case"hh":return At(2);case"a":return kt(ft,Gt,!0);case"A":return kt(ft,Gt,!1);case"m":return String(Gt);case"mm":return ve.s(Gt,2,"0");case"s":return String(tt.$s);case"ss":return ve.s(tt.$s,2,"0");case"SSS":return ve.s(tt.$ms,3,"0");case"Z":return Ge}return null}(Ot)||Ge.replace(":","")})},ze.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},ze.diff=function(Pe,tt,De){var Ke,Ge=this,ft=ve.p(tt),Gt=oe(Pe),Ft=(Gt.utcOffset()-this.utcOffset())*u,wt=this-Gt,Rt=function(){return ve.m(Ge,Gt)};switch(ft){case se:Ke=Rt()/12;break;case q:Ke=Rt();break;case X:Ke=Rt()/3;break;case H:Ke=(wt-Ft)/6048e5;break;case j:Ke=(wt-Ft)/864e5;break;case i:Ke=wt/g;break;case D:Ke=wt/u;break;case M:Ke=wt/a;break;default:Ke=wt}return De?Ke:ve.a(Ke)},ze.daysInMonth=function(){return this.endOf(q).$D},ze.$locale=function(){return Ie[this.$L]},ze.locale=function(Pe,tt){if(!Pe)return this.$L;var De=this.clone(),Ke=ot(Pe,tt,!0);return Ke&&(De.$L=Ke),De},ze.clone=function(){return ve.w(this.$d,this)},ze.toDate=function(){return new Date(this.valueOf())},ze.toJSON=function(){return this.isValid()?this.toISOString():null},ze.toISOString=function(){return this.$d.toISOString()},ze.toString=function(){return this.$d.toUTCString()},Le}(),He=je.prototype;return oe.prototype=He,[["$ms",_],["$s",M],["$m",D],["$H",i],["$W",j],["$M",q],["$y",se],["$D",ne]].forEach(function(Le){He[Le[1]]=function(ze){return this.$g(ze,Le[0],Le[1])}}),oe.extend=function(Le,ze){return Le.$i||(Le(ze,je,oe),Le.$i=!0),oe},oe.locale=ot,oe.isDayjs=we,oe.unix=function(Le){return oe(1e3*Le)},oe.en=Ie[fe],oe.Ls=Ie,oe.p={},oe})})(Kz);var M9=Kz.exports;const ao=Bl(M9);var Jz={exports:{}};(function(e,r){(function(a,u){e.exports=u()})(Jd,function(){var a="week",u="year";return function(g,_,M){var D=_.prototype;D.week=function(i){if(i===void 0&&(i=null),i!==null)return this.add(7*(i-this.week()),"day");var j=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var H=M(this).startOf(u).add(1,u).date(j),q=M(this).endOf(a);if(H.isBefore(q))return 1}var X=M(this).startOf(u).date(j).startOf(a).subtract(1,"millisecond"),se=this.diff(X,a,!0);return se<0?M(this).startOf("week").week():Math.ceil(se)},D.weeks=function(i){return i===void 0&&(i=null),this.week(i)}}})})(Jz);var E9=Jz.exports;const I9=Bl(E9);var Qz={exports:{}};(function(e,r){(function(a,u){e.exports=u()})(Jd,function(){var a={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},u=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,g=/\d/,_=/\d\d/,M=/\d\d?/,D=/\d*[^-_:/,()\s\d]+/,i={},j=function(de){return(de=+de)+(de>68?1900:2e3)},H=function(de){return function(te){this[de]=+te}},q=[/[+-]\d\d:?(\d\d)?|Z/,function(de){(this.zone||(this.zone={})).offset=function(te){if(!te||te==="Z")return 0;var Q=te.match(/([+-]|\d\d)/g),K=60*Q[1]+(+Q[2]||0);return K===0?0:Q[0]==="+"?-K:K}(de)}],X=function(de){var te=i[de];return te&&(te.indexOf?te:te.s.concat(te.f))},se=function(de,te){var Q,K=i.meridiem;if(K){for(var ce=1;ce<=24;ce+=1)if(de.indexOf(K(ce,0,te))>-1){Q=ce>12;break}}else Q=de===(te?"pm":"PM");return Q},ne={A:[D,function(de){this.afternoon=se(de,!1)}],a:[D,function(de){this.afternoon=se(de,!0)}],Q:[g,function(de){this.month=3*(de-1)+1}],S:[g,function(de){this.milliseconds=100*+de}],SS:[_,function(de){this.milliseconds=10*+de}],SSS:[/\d{3}/,function(de){this.milliseconds=+de}],s:[M,H("seconds")],ss:[M,H("seconds")],m:[M,H("minutes")],mm:[M,H("minutes")],H:[M,H("hours")],h:[M,H("hours")],HH:[M,H("hours")],hh:[M,H("hours")],D:[M,H("day")],DD:[_,H("day")],Do:[D,function(de){var te=i.ordinal,Q=de.match(/\d+/);if(this.day=Q[0],te)for(var K=1;K<=31;K+=1)te(K).replace(/\[|\]/g,"")===de&&(this.day=K)}],w:[M,H("week")],ww:[_,H("week")],M:[M,H("month")],MM:[_,H("month")],MMM:[D,function(de){var te=X("months"),Q=(X("monthsShort")||te.map(function(K){return K.slice(0,3)})).indexOf(de)+1;if(Q<1)throw new Error;this.month=Q%12||Q}],MMMM:[D,function(de){var te=X("months").indexOf(de)+1;if(te<1)throw new Error;this.month=te%12||te}],Y:[/[+-]?\d+/,H("year")],YY:[_,function(de){this.year=j(de)}],YYYY:[/\d{4}/,H("year")],Z:q,ZZ:q};function le(de){var te,Q;te=de,Q=i&&i.formats;for(var K=(de=te.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(oe,ve,je){var He=je&&je.toUpperCase();return ve||Q[je]||a[je]||Q[He].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Le,ze,Pe){return ze||Pe.slice(1)})})).match(u),ce=K.length,fe=0;fe<ce;fe+=1){var Ie=K[fe],Ce=ne[Ie],we=Ce&&Ce[0],ot=Ce&&Ce[1];K[fe]=ot?{regex:we,parser:ot}:Ie.replace(/^\[|\]$/g,"")}return function(oe){for(var ve={},je=0,He=0;je<ce;je+=1){var Le=K[je];if(typeof Le=="string")He+=Le.length;else{var ze=Le.regex,Pe=Le.parser,tt=oe.slice(He),De=ze.exec(tt)[0];Pe.call(ve,De),oe=oe.replace(De,"")}}return function(Ke){var Ge=Ke.afternoon;if(Ge!==void 0){var ft=Ke.hours;Ge?ft<12&&(Ke.hours+=12):ft===12&&(Ke.hours=0),delete Ke.afternoon}}(ve),ve}}return function(de,te,Q){Q.p.customParseFormat=!0,de&&de.parseTwoDigitYear&&(j=de.parseTwoDigitYear);var K=te.prototype,ce=K.parse;K.parse=function(fe){var Ie=fe.date,Ce=fe.utc,we=fe.args;this.$u=Ce;var ot=we[1];if(typeof ot=="string"){var oe=we[2]===!0,ve=we[3]===!0,je=oe||ve,He=we[2];ve&&(He=we[2]),i=this.$locale(),!oe&&He&&(i=Q.Ls[He]),this.$d=function(tt,De,Ke,Ge){try{if(["x","X"].indexOf(De)>-1)return new Date((De==="X"?1e3:1)*tt);var ft=le(De)(tt),Gt=ft.year,Ft=ft.month,wt=ft.day,Rt=ft.hours,It=ft.minutes,zt=ft.seconds,At=ft.milliseconds,kt=ft.zone,Ot=ft.week,be=new Date,Ht=wt||(Gt||Ft?1:be.getDate()),xt=Gt||be.getFullYear(),Bt=0;Gt&&!Ft||(Bt=Ft>0?Ft-1:be.getMonth());var rt,qt=Rt||0,Lt=It||0,Yt=zt||0,Wt=At||0;return kt?new Date(Date.UTC(xt,Bt,Ht,qt,Lt,Yt,Wt+60*kt.offset*1e3)):Ke?new Date(Date.UTC(xt,Bt,Ht,qt,Lt,Yt,Wt)):(rt=new Date(xt,Bt,Ht,qt,Lt,Yt,Wt),Ot&&(rt=Ge(rt).week(Ot).toDate()),rt)}catch{return new Date("")}}(Ie,ot,Ce,Q),this.init(),He&&He!==!0&&(this.$L=this.locale(He).$L),je&&Ie!=this.format(ot)&&(this.$d=new Date("")),i={}}else if(ot instanceof Array)for(var Le=ot.length,ze=1;ze<=Le;ze+=1){we[1]=ot[ze-1];var Pe=Q.apply(this,we);if(Pe.isValid()){this.$d=Pe.$d,this.$L=Pe.$L,this.init();break}ze===Le&&(this.$d=new Date(""))}else ce.call(this,fe)}}})})(Qz);var k9=Qz.exports;const P9=Bl(k9);var e4={exports:{}};(function(e,r){(function(a,u){e.exports=u()})(Jd,function(){var a={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(u,g,_){var M=g.prototype,D=M.format;_.en.formats=a,M.format=function(i){i===void 0&&(i="YYYY-MM-DDTHH:mm:ssZ");var j=this.$locale().formats,H=function(q,X){return q.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(se,ne,le){var de=le&&le.toUpperCase();return ne||X[le]||a[le]||X[de].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(te,Q,K){return Q||K.slice(1)})})}(i,j===void 0?{}:j);return D.call(this,H)}}})})(e4);var A9=e4.exports;const D9=Bl(A9);var t4={exports:{}};(function(e,r){(function(a,u){e.exports=u()})(Jd,function(){return function(a,u,g){u.prototype.isBetween=function(_,M,D,i){var j=g(_),H=g(M),q=(i=i||"()")[0]==="(",X=i[1]===")";return(q?this.isAfter(j,D):!this.isBefore(j,D))&&(X?this.isBefore(H,D):!this.isAfter(H,D))||(q?this.isBefore(j,D):!this.isAfter(j,D))&&(X?this.isAfter(H,D):!this.isBefore(H,D))}}})})(t4);var R9=t4.exports;const L9=Bl(R9);var r4={exports:{}};(function(e,r){(function(a,u){e.exports=u()})(Jd,function(){return function(a,u){var g=u.prototype,_=g.format;g.format=function(M){var D=this,i=this.$locale();if(!this.isValid())return _.bind(this)(M);var j=this.$utils(),H=(M||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(q){switch(q){case"Q":return Math.ceil((D.$M+1)/3);case"Do":return i.ordinal(D.$D);case"gggg":return D.weekYear();case"GGGG":return D.isoWeekYear();case"wo":return i.ordinal(D.week(),"W");case"w":case"ww":return j.s(D.week(),q==="w"?1:2,"0");case"W":case"WW":return j.s(D.isoWeek(),q==="W"?1:2,"0");case"k":case"kk":return j.s(String(D.$H===0?24:D.$H),q==="k"?1:2,"0");case"X":return Math.floor(D.$d.getTime()/1e3);case"x":return D.$d.getTime();case"z":return"["+D.offsetName()+"]";case"zzz":return"["+D.offsetName("long")+"]";default:return q}});return _.bind(this)(H)}}})})(r4);var z9=r4.exports;const O9=Bl(z9);ao.extend(D9);ao.extend(I9);ao.extend(L9);ao.extend(O9);const F9={YY:"year",YYYY:{sectionType:"year",contentType:"digit",maxLength:4},M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMM:{sectionType:"month",contentType:"letter"},MMMM:{sectionType:"month",contentType:"letter"},D:{sectionType:"day",contentType:"digit",maxLength:2},DD:"day",Do:{sectionType:"day",contentType:"digit-with-letter"},d:{sectionType:"weekDay",contentType:"digit",maxLength:2},dd:{sectionType:"weekDay",contentType:"letter"},ddd:{sectionType:"weekDay",contentType:"letter"},dddd:{sectionType:"weekDay",contentType:"letter"},A:"meridiem",a:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},B9={year:"YYYY",month:"MMMM",monthShort:"MMM",dayOfMonth:"D",dayOfMonthFull:"Do",weekday:"dddd",weekdayShort:"dd",hours24h:"HH",hours12h:"hh",meridiem:"A",minutes:"mm",seconds:"ss",fullDate:"ll",keyboardDate:"L",shortDate:"MMM D",normalDate:"D MMMM",normalDateWithWeekday:"ddd, MMM D",fullTime:"LT",fullTime12h:"hh:mm A",fullTime24h:"HH:mm",keyboardDateTime:"L LT",keyboardDateTime12h:"L hh:mm A",keyboardDateTime24h:"L HH:mm"},sS=["Missing UTC plugin","To be able to use UTC or timezones, you have to enable the `utc` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-utc"].join(`
`),YA=["Missing timezone plugin","To be able to use timezones, you have to enable both the `utc` and the `timezone` plugin","Find more information on https://mui.com/x/react-date-pickers/timezone/#day-js-and-timezone"].join(`
`),j9=(e,r)=>r?(...a)=>e(...a).locale(r):e;class N9{constructor({locale:r,formats:a}={}){this.isMUIAdapter=!0,this.isTimezoneCompatible=!0,this.lib="dayjs",this.dayjs=void 0,this.locale=void 0,this.formats=void 0,this.escapedCharacters={start:"[",end:"]"},this.formatTokenMap=F9,this.setLocaleToValue=u=>{const g=this.getCurrentLocaleCode();return g===u.locale()?u:u.locale(g)},this.hasUTCPlugin=()=>typeof ao.utc<"u",this.hasTimezonePlugin=()=>typeof ao.tz<"u",this.isSame=(u,g,_)=>{const M=this.setTimezone(g,this.getTimezone(u));return u.format(_)===M.format(_)},this.cleanTimezone=u=>{switch(u){case"default":return;case"system":return ao.tz.guess();default:return u}},this.createSystemDate=u=>{if(this.hasUTCPlugin()&&this.hasTimezonePlugin()){const g=ao.tz.guess();return g!=="UTC"?ao.tz(u,g):ao(u)}return ao(u)},this.createUTCDate=u=>{if(!this.hasUTCPlugin())throw new Error(sS);return ao.utc(u)},this.createTZDate=(u,g)=>{if(!this.hasUTCPlugin())throw new Error(sS);if(!this.hasTimezonePlugin())throw new Error(YA);const _=u!==void 0&&!u.endsWith("Z");return ao(u).tz(this.cleanTimezone(g),_)},this.getLocaleFormats=()=>{const u=ao.Ls,g=this.locale||"en";let _=u[g];return _===void 0&&(_=u.en),_.formats},this.adjustOffset=u=>{if(!this.hasTimezonePlugin())return u;const g=this.getTimezone(u);if(g!=="UTC"){const _=u.tz(this.cleanTimezone(g),!0);if(_.$offset===(u.$offset??0))return u;u.$offset=_.$offset}return u},this.date=(u,g="default")=>{if(u===null)return null;let _;return g==="UTC"?_=this.createUTCDate(u):g==="system"||g==="default"&&!this.hasTimezonePlugin()?_=this.createSystemDate(u):_=this.createTZDate(u,g),this.locale===void 0?_:_.locale(this.locale)},this.getInvalidDate=()=>ao(new Date("Invalid date")),this.getTimezone=u=>{var g;if(this.hasTimezonePlugin()){const _=(g=u.$x)==null?void 0:g.$timezone;if(_)return _}return this.hasUTCPlugin()&&u.isUTC()?"UTC":"system"},this.setTimezone=(u,g)=>{if(this.getTimezone(u)===g)return u;if(g==="UTC"){if(!this.hasUTCPlugin())throw new Error(sS);return u.utc()}if(g==="system")return u.local();if(!this.hasTimezonePlugin()){if(g==="default")return u;throw new Error(YA)}return ao.tz(u,this.cleanTimezone(g))},this.toJsDate=u=>u.toDate(),this.parse=(u,g)=>u===""?null:this.dayjs(u,g,this.locale,!0),this.getCurrentLocaleCode=()=>this.locale||"en",this.is12HourCycleInCurrentLocale=()=>/A|a/.test(this.getLocaleFormats().LT||""),this.expandFormat=u=>{const g=this.getLocaleFormats(),_=M=>M.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(D,i,j)=>i||j.slice(1));return u.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(M,D,i)=>{const j=i&&i.toUpperCase();return D||g[i]||_(g[j])})},this.isValid=u=>u==null?!1:u.isValid(),this.format=(u,g)=>this.formatByString(u,this.formats[g]),this.formatByString=(u,g)=>this.dayjs(u).format(g),this.formatNumber=u=>u,this.isEqual=(u,g)=>u===null&&g===null?!0:u===null||g===null?!1:u.toDate().getTime()===g.toDate().getTime(),this.isSameYear=(u,g)=>this.isSame(u,g,"YYYY"),this.isSameMonth=(u,g)=>this.isSame(u,g,"YYYY-MM"),this.isSameDay=(u,g)=>this.isSame(u,g,"YYYY-MM-DD"),this.isSameHour=(u,g)=>u.isSame(g,"hour"),this.isAfter=(u,g)=>u>g,this.isAfterYear=(u,g)=>this.hasUTCPlugin()?!this.isSameYear(u,g)&&u.utc()>g.utc():u.isAfter(g,"year"),this.isAfterDay=(u,g)=>this.hasUTCPlugin()?!this.isSameDay(u,g)&&u.utc()>g.utc():u.isAfter(g,"day"),this.isBefore=(u,g)=>u<g,this.isBeforeYear=(u,g)=>this.hasUTCPlugin()?!this.isSameYear(u,g)&&u.utc()<g.utc():u.isBefore(g,"year"),this.isBeforeDay=(u,g)=>this.hasUTCPlugin()?!this.isSameDay(u,g)&&u.utc()<g.utc():u.isBefore(g,"day"),this.isWithinRange=(u,[g,_])=>u>=g&&u<=_,this.startOfYear=u=>this.adjustOffset(u.startOf("year")),this.startOfMonth=u=>this.adjustOffset(u.startOf("month")),this.startOfWeek=u=>this.adjustOffset(this.setLocaleToValue(u).startOf("week")),this.startOfDay=u=>this.adjustOffset(u.startOf("day")),this.endOfYear=u=>this.adjustOffset(u.endOf("year")),this.endOfMonth=u=>this.adjustOffset(u.endOf("month")),this.endOfWeek=u=>this.adjustOffset(this.setLocaleToValue(u).endOf("week")),this.endOfDay=u=>this.adjustOffset(u.endOf("day")),this.addYears=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"year"):u.add(g,"year")),this.addMonths=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"month"):u.add(g,"month")),this.addWeeks=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"week"):u.add(g,"week")),this.addDays=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"day"):u.add(g,"day")),this.addHours=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"hour"):u.add(g,"hour")),this.addMinutes=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"minute"):u.add(g,"minute")),this.addSeconds=(u,g)=>this.adjustOffset(g<0?u.subtract(Math.abs(g),"second"):u.add(g,"second")),this.getYear=u=>u.year(),this.getMonth=u=>u.month(),this.getDate=u=>u.date(),this.getHours=u=>u.hour(),this.getMinutes=u=>u.minute(),this.getSeconds=u=>u.second(),this.getMilliseconds=u=>u.millisecond(),this.setYear=(u,g)=>this.adjustOffset(u.set("year",g)),this.setMonth=(u,g)=>this.adjustOffset(u.set("month",g)),this.setDate=(u,g)=>this.adjustOffset(u.set("date",g)),this.setHours=(u,g)=>this.adjustOffset(u.set("hour",g)),this.setMinutes=(u,g)=>this.adjustOffset(u.set("minute",g)),this.setSeconds=(u,g)=>this.adjustOffset(u.set("second",g)),this.setMilliseconds=(u,g)=>this.adjustOffset(u.set("millisecond",g)),this.getDaysInMonth=u=>u.daysInMonth(),this.getWeekArray=u=>{const g=this.startOfWeek(this.startOfMonth(u)),_=this.endOfWeek(this.endOfMonth(u));let M=0,D=g;const i=[];for(;D<_;){const j=Math.floor(M/7);i[j]=i[j]||[],i[j].push(D),D=this.addDays(D,1),M+=1}return i},this.getWeekNumber=u=>u.week(),this.getYearRange=([u,g])=>{const _=this.startOfYear(u),M=this.endOfYear(g),D=[];let i=_;for(;this.isBefore(i,M);)D.push(i),i=this.addYears(i,1);return D},this.dayjs=j9(ao,r),this.locale=r,this.formats=vt({},B9,a),ao.extend(P9)}getDayOfWeek(r){return r.day()+1}}function V9(e){return Ir("MuiPickersTextField",e)}const Cg=Mr("MuiPickersTextField",["root","focused","disabled","error","required"]);function $9(e){return Ir("MuiPickersInputBase",e)}const tf=Mr("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input"]);function U9(e){return Ir("MuiPickersSectionList",e)}const Mg=Mr("MuiPickersSectionList",["root","section","sectionContent"]),W9=["slots","slotProps","elements","sectionListRef"],n4=bt("div",{name:"MuiPickersSectionList",slot:"Root",overridesResolver:(e,r)=>r.root})({direction:"ltr /*! @noflip */",outline:"none"}),i4=bt("span",{name:"MuiPickersSectionList",slot:"Section",overridesResolver:(e,r)=>r.section})({}),o4=bt("span",{name:"MuiPickersSectionList",slot:"SectionSeparator",overridesResolver:(e,r)=>r.sectionSeparator})({whiteSpace:"pre"}),s4=bt("span",{name:"MuiPickersSectionList",slot:"SectionContent",overridesResolver:(e,r)=>r.sectionContent})({outline:"none"}),G9=e=>{const{classes:r}=e;return Er({root:["root"],section:["section"],sectionContent:["sectionContent"]},U9,r)};function H9(e){const{slots:r,slotProps:a,element:u,classes:g}=e,_=(r==null?void 0:r.section)??i4,M=jn({elementType:_,externalSlotProps:a==null?void 0:a.section,externalForwardedProps:u.container,className:g.section,ownerState:{}}),D=(r==null?void 0:r.sectionContent)??s4,i=jn({elementType:D,externalSlotProps:a==null?void 0:a.sectionContent,externalForwardedProps:u.content,additionalProps:{suppressContentEditableWarning:!0},className:g.sectionContent,ownerState:{}}),j=(r==null?void 0:r.sectionSeparator)??o4,H=jn({elementType:j,externalSlotProps:a==null?void 0:a.sectionSeparator,externalForwardedProps:u.before,ownerState:{position:"before"}}),q=jn({elementType:j,externalSlotProps:a==null?void 0:a.sectionSeparator,externalForwardedProps:u.after,ownerState:{position:"after"}});return L.jsxs(_,vt({},M,{children:[L.jsx(j,vt({},H)),L.jsx(D,vt({},i)),L.jsx(j,vt({},q))]}))}const q9=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersSectionList"}),{slots:g,slotProps:_,elements:M,sectionListRef:D}=u,i=Sn(u,W9),j=G9(u),H=Y.useRef(null),q=ai(a,H),X=le=>{if(!H.current)throw new Error(`MUI X: Cannot call sectionListRef.${le} before the mount of the component.`);return H.current};Y.useImperativeHandle(D,()=>({getRoot(){return X("getRoot")},getSectionContainer(le){return X("getSectionContainer").querySelector(`.${Mg.section}[data-sectionindex="${le}"]`)},getSectionContent(le){return X("getSectionContent").querySelector(`.${Mg.section}[data-sectionindex="${le}"] .${Mg.sectionContent}`)},getSectionIndexFromDOMElement(le){const de=X("getSectionIndexFromDOMElement");if(le==null||!de.contains(le))return null;let te=null;return le.classList.contains(Mg.section)?te=le:le.classList.contains(Mg.sectionContent)&&(te=le.parentElement),te==null?null:Number(te.dataset.sectionindex)}}));const se=(g==null?void 0:g.root)??n4,ne=jn({elementType:se,externalSlotProps:_==null?void 0:_.root,externalForwardedProps:i,additionalProps:{ref:q,suppressContentEditableWarning:!0},className:j.root,ownerState:{}});return L.jsx(se,vt({},ne,{children:ne.contentEditable?M.map(({content:le,before:de,after:te})=>`${de.children}${le.children}${te.children}`).join(""):L.jsx(Y.Fragment,{children:M.map((le,de)=>L.jsx(H9,{slots:g,slotProps:_,element:le,classes:j},de))})}))}),Z9=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef"],Y9=e=>Math.round(e*1e5)/1e5,M1=bt("div",{name:"MuiPickersInputBase",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>vt({},e.typography.body1,{color:(e.vars||e).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:`${Y9(.15/16)}em`,variants:[{props:{fullWidth:!0},style:{width:"100%"}}]})),HC=bt(n4,{name:"MuiPickersInputBase",slot:"SectionsContainer",overridesResolver:(e,r)=>r.sectionsContainer})(({theme:e})=>({padding:"4px 0 5px",fontFamily:e.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{isRtl:!0},style:{textAlign:"right /*! @noflip */"}},{props:{size:"small"},style:{paddingTop:1}},{props:{adornedStart:!1,focused:!1,filled:!1},style:{color:"currentColor",opacity:0}},{props:({adornedStart:r,focused:a,filled:u,label:g})=>!r&&!a&&!u&&g==null,style:e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:e.palette.mode==="light"?.42:.5}}]})),X9=bt(i4,{name:"MuiPickersInputBase",slot:"Section",overridesResolver:(e,r)=>r.section})(({theme:e})=>({fontFamily:e.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"inline-block",whiteSpace:"nowrap"})),K9=bt(s4,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(e,r)=>r.content})(({theme:e})=>({fontFamily:e.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"})),J9=bt(o4,{name:"MuiPickersInputBase",slot:"Separator",overridesResolver:(e,r)=>r.separator})(()=>({whiteSpace:"pre",letterSpacing:"inherit"})),Q9=bt("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(e,r)=>r.hiddenInput})(vt({},fz)),e7=e=>{const{focused:r,disabled:a,error:u,classes:g,fullWidth:_,readOnly:M,color:D,size:i,endAdornment:j,startAdornment:H}=e,q={root:["root",r&&!a&&"focused",a&&"disabled",M&&"readOnly",u&&"error",_&&"fullWidth",`color${tr(D)}`,i==="small"&&"inputSizeSmall",!!H&&"adornedStart",!!j&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"]};return Er(q,$9,g)},qC=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersInputBase"}),{elements:g,areAllSectionsEmpty:_,value:M,onChange:D,id:i,endAdornment:j,startAdornment:H,renderSuffix:q,slots:X,slotProps:se,contentEditable:ne,tabIndex:le,onInput:de,onPaste:te,onKeyDown:Q,name:K,readOnly:ce,inputProps:fe,inputRef:Ie,sectionListRef:Ce}=u,we=Sn(u,Z9),ot=Y.useRef(null),oe=ai(a,ot),ve=ai(fe==null?void 0:fe.ref,Ie),je=fs(),He=Js();if(!He)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");const Le=Ge=>{var ft;if(He.disabled){Ge.stopPropagation();return}(ft=He.onFocus)==null||ft.call(He,Ge)};Y.useEffect(()=>{He&&He.setAdornedStart(!!H)},[He,H]),Y.useEffect(()=>{He&&(_?He.onEmpty():He.onFilled())},[He,_]);const ze=vt({},u,He,{isRtl:je}),Pe=e7(ze),tt=(X==null?void 0:X.root)||M1,De=jn({elementType:tt,externalSlotProps:se==null?void 0:se.root,externalForwardedProps:we,additionalProps:{"aria-invalid":He.error,ref:oe},className:Pe.root,ownerState:ze}),Ke=(X==null?void 0:X.input)||HC;return L.jsxs(tt,vt({},De,{children:[H,L.jsx(q9,{sectionListRef:Ce,elements:g,contentEditable:ne,tabIndex:le,className:Pe.sectionsContainer,onFocus:Le,onBlur:He.onBlur,onInput:de,onPaste:te,onKeyDown:Q,slots:{root:Ke,section:X9,sectionContent:K9,sectionSeparator:J9},slotProps:{root:{ownerState:ze},sectionContent:{className:tf.sectionContent},sectionSeparator:({position:Ge})=>({className:Ge==="before"?tf.sectionBefore:tf.sectionAfter})}}),j,q?q(vt({},He)):null,L.jsx(Q9,vt({name:K,className:Pe.input,value:M,onChange:D,id:i,"aria-hidden":"true",tabIndex:-1,readOnly:ce,required:He.required,disabled:He.disabled},fe,{ref:ve}))]}))});function t7(e){return Ir("MuiPickersOutlinedInput",e)}const Wa=vt({},tf,Mr("MuiPickersOutlinedInput",["root","notchedOutline","input"])),r7=["children","className","label","notched","shrink"],n7=bt("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline",overridesResolver:(e,r)=>r.notchedOutline})(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}}),XA=bt("span")(({theme:e})=>({fontFamily:e.typography.fontFamily,fontSize:"inherit"})),i7=bt("legend")(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:{withLabel:!1},style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:{withLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{withLabel:!0,notched:!0},style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]}));function o7(e){const{className:r,label:a}=e,u=Sn(e,r7),g=a!=null&&a!=="",_=vt({},e,{withLabel:g});return L.jsx(n7,vt({"aria-hidden":!0,className:r},u,{ownerState:_,children:L.jsx(i7,{ownerState:_,children:g?L.jsx(XA,{children:a}):L.jsx(XA,{className:"notranslate",children:""})})}))}const s7=["label","autoFocus","ownerState","notched"],a7=bt(M1,{name:"MuiPickersOutlinedInput",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${Wa.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${Wa.notchedOutline}`]:{borderColor:e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.23)`:r}},[`&.${Wa.focused} .${Wa.notchedOutline}`]:{borderStyle:"solid",borderWidth:2},[`&.${Wa.disabled}`]:{[`& .${Wa.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled},"*":{color:(e.vars||e).palette.action.disabled}},[`&.${Wa.error} .${Wa.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},variants:Object.keys((e.vars??e).palette).filter(a=>{var u;return((u=(e.vars??e).palette[a])==null?void 0:u.main)??!1}).map(a=>({props:{color:a},style:{[`&.${Wa.focused}:not(.${Wa.error}) .${Wa.notchedOutline}`]:{borderColor:(e.vars||e).palette[a].main}}}))}}),l7=bt(HC,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer",overridesResolver:(e,r)=>r.sectionsContainer})({padding:"16.5px 0",variants:[{props:{size:"small"},style:{padding:"8.5px 0"}}]}),c7=e=>{const{classes:r}=e,u=Er({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},t7,r);return vt({},r,u)},a4=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersOutlinedInput"}),{label:g,ownerState:_,notched:M}=u,D=Sn(u,s7),i=Js(),j=vt({},u,_,i,{color:(i==null?void 0:i.color)||"primary"}),H=c7(j);return L.jsx(qC,vt({slots:{root:a7,input:l7},renderSuffix:q=>L.jsx(o7,{shrink:!!(M||q.adornedStart||q.focused||q.filled),notched:!!(M||q.adornedStart||q.focused||q.filled),className:H.notchedOutline,label:g!=null&&g!==""&&(i!=null&&i.required)?L.jsxs(Y.Fragment,{children:[g,"","*"]}):g,ownerState:j})},D,{label:g,classes:H,ref:a}))});a4.muiName="Input";function u7(e){return Ir("MuiPickersFilledInput",e)}const Pd=vt({},tf,Mr("MuiPickersFilledInput",["root","underline","input"])),d7=["label","autoFocus","disableUnderline","ownerState"],h7=bt(M1,{name:"MuiPickersFilledInput",slot:"Root",overridesResolver:(e,r)=>r.root,shouldForwardProp:e=>kx(e)&&e!=="disableUnderline"})(({theme:e})=>{const r=e.palette.mode==="light",a=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",u=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",g=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",_=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:u,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:g,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:u}},[`&.${Pd.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:u},[`&.${Pd.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:_},variants:[...Object.keys((e.vars??e).palette).filter(M=>(e.vars??e).palette[M].main).map(M=>{var D;return{props:{color:M,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(D=(e.vars||e).palette[M])==null?void 0:D.main}`}}}}),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Pd.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Pd.error}`]:{"&:before, &:after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`:a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Pd.disabled}, .${Pd.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Pd.disabled}:before`]:{borderBottomStyle:"dotted"}}},{props:({startAdornment:M})=>!!M,style:{paddingLeft:12}},{props:({endAdornment:M})=>!!M,style:{paddingRight:12}}]}}),p7=bt(HC,{name:"MuiPickersFilledInput",slot:"sectionsContainer",overridesResolver:(e,r)=>r.sectionsContainer})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({startAdornment:e})=>!!e,style:{paddingLeft:0}},{props:({endAdornment:e})=>!!e,style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,size:"small"},style:{paddingTop:8,paddingBottom:9}}]}),f7=e=>{const{classes:r,disableUnderline:a}=e,g=Er({root:["root",!a&&"underline"],input:["input"]},u7,r);return vt({},r,g)},l4=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersFilledInput"}),{label:g,disableUnderline:_=!1,ownerState:M}=u,D=Sn(u,d7),i=Js(),j=vt({},u,M,i,{color:(i==null?void 0:i.color)||"primary"}),H=f7(j);return L.jsx(qC,vt({slots:{root:h7,input:p7},slotProps:{root:{disableUnderline:_}}},D,{label:g,classes:H,ref:a}))});l4.muiName="Input";function m7(e){return Ir("MuiPickersFilledInput",e)}const Eg=vt({},tf,Mr("MuiPickersInput",["root","input"])),g7=["label","autoFocus","disableUnderline","ownerState"],y7=bt(M1,{name:"MuiPickersInput",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>{let a=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(a=`rgba(${e.vars.palette.common.onBackgroundChannel} / ${e.vars.opacity.inputUnderline})`),{"label + &":{marginTop:16},variants:[...Object.keys((e.vars??e).palette).filter(u=>(e.vars??e).palette[u].main).map(u=>({props:{color:u},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[u].main}`}}})),{props:{disableUnderline:!1},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Eg.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Eg.error}`]:{"&:before, &:after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Eg.disabled}, .${Eg.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${a}`}},[`&.${Eg.disabled}:before`]:{borderBottomStyle:"dotted"}}}]}}),_7=e=>{const{classes:r,disableUnderline:a}=e,g=Er({root:["root",!a&&"underline"],input:["input"]},m7,r);return vt({},r,g)},c4=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersInput"}),{label:g,disableUnderline:_=!1,ownerState:M}=u,D=Sn(u,g7),i=Js(),j=vt({},u,M,i,{disableUnderline:_,color:(i==null?void 0:i.color)||"primary"}),H=_7(j);return L.jsx(qC,vt({slots:{root:y7}},D,{label:g,classes:H,ref:a}))});c4.muiName="Input";const x7=["onFocus","onBlur","className","color","disabled","error","variant","required","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps"],v7={standard:c4,filled:l4,outlined:a4},b7=bt(jy,{name:"MuiPickersTextField",slot:"Root",overridesResolver:(e,r)=>r.root})({}),w7=e=>{const{focused:r,disabled:a,classes:u,required:g}=e;return Er({root:["root",r&&!a&&"focused",a&&"disabled",g&&"required"]},V9,u)},S7=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersTextField"}),{onFocus:g,onBlur:_,className:M,color:D="primary",disabled:i=!1,error:j=!1,variant:H="outlined",required:q=!1,InputProps:X,inputProps:se,inputRef:ne,sectionListRef:le,elements:de,areAllSectionsEmpty:te,onClick:Q,onKeyDown:K,onKeyUp:ce,onPaste:fe,onInput:Ie,endAdornment:Ce,startAdornment:we,tabIndex:ot,contentEditable:oe,focused:ve,value:je,onChange:He,fullWidth:Le,id:ze,name:Pe,helperText:tt,FormHelperTextProps:De,label:Ke,InputLabelProps:Ge}=u,ft=Sn(u,x7),Gt=Y.useRef(null),Ft=ai(a,Gt),wt=Bu(ze),Rt=tt&&wt?`${wt}-helper-text`:void 0,It=Ke&&wt?`${wt}-label`:void 0,zt=vt({},u,{color:D,disabled:i,error:j,focused:ve,required:q,variant:H}),At=w7(zt),kt=v7[H];return L.jsxs(b7,vt({className:rr(At.root,M),ref:Ft,focused:ve,onFocus:g,onBlur:_,disabled:i,variant:H,error:j,color:D,fullWidth:Le,required:q,ownerState:zt},ft,{children:[L.jsx(T1,vt({htmlFor:wt,id:It},Ge,{children:Ke})),L.jsx(kt,vt({elements:de,areAllSectionsEmpty:te,onClick:Q,onKeyDown:K,onKeyUp:ce,onInput:Ie,onPaste:fe,endAdornment:Ce,startAdornment:we,tabIndex:ot,contentEditable:oe,value:je,onChange:He,id:wt,fullWidth:Le,inputProps:se,inputRef:ne,sectionListRef:le,label:Ke,name:Pe,role:"group","aria-labelledby":It,"aria-describedby":Rt,"aria-live":Rt?"polite":void 0},X)),tt&&L.jsx(Oz,vt({id:Rt},De,{children:tt}))]}))}),T7=e=>e.match(/^([A-Za-z]+)Range(Calendar|Clock)$/)?"multi-panel-UI-view":e.match(/^([A-Za-z]*)(DigitalClock)$/)?"Tall-UI-view":e.match(/^Static([A-Za-z]+)/)||e.match(/^([A-Za-z]+)(Calendar|Clock)$/)?"UI-view":e.match(/^MultiInput([A-Za-z]+)RangeField$/)||e.match(/^([A-Za-z]+)RangePicker$/)?"multi-input-range-field":e.match(/^SingleInput([A-Za-z]+)RangeField$/)?"single-input-range-field":"single-input-field",C7=e=>e.includes("DateTime")?"date-time":e.includes("Date")?"date":"time",M7=e=>Y.isValidElement(e)&&typeof e.type!="string"?e.type.displayName==="DemoItem":!1;function E7(e){const{children:r,components:a,sx:u}=e,g=new Set,_=new Set;a.forEach(se=>{g.add(T7(se)),_.add(C7(se))});const M=se=>se==="row"?g.has("UI-view")||g.has("Tall-UI-view")?3:2:g.has("UI-view")?4:3;let D,i,j={},H={};const q=vt({overflow:"auto",pt:1},u);a.length>2||g.has("multi-input-range-field")||g.has("single-input-range-field")||g.has("multi-panel-UI-view")||g.has("UI-view")||_.has("date-time")?(D="column",i=M("column")):(D={xs:"column",lg:"row"},i={xs:M("column"),lg:M("row")}),g.has("UI-view")||(g.has("single-input-range-field")?_.has("date-time")?j={[`& > .${Sg.root}, & > .${Cg.root}`]:{minWidth:{xs:300,md:g.has("multi-input-range-field")?460:400}}}:j={[`& > .${Sg.root}, & > .${Cg.root}`]:{minWidth:300}}:_.has("date-time")?(j={[`& > .${Sg.root}, & > .${Cg.root}`]:{minWidth:270}},g.has("multi-input-range-field")&&(H={[`& > .${VA.root} > .${Sg.root}, & > .${VA.root} > .${Cg.root}`]:{minWidth:210}})):j={[`& > .${Sg.root}, & > .${Cg.root}`]:{minWidth:200}});const X=vt({},q,j);return L.jsx(Wz,{direction:D,spacing:i,sx:X,children:Y.Children.map(r,se=>Y.isValidElement(se)&&M7(se)?Y.cloneElement(se,{sx:vt({},j,H)}):se)})}const I7=["localeText"],mT=Y.createContext(null),u4=function(r){const{localeText:a}=r,u=Sn(r,I7),{utils:g,localeText:_}=Y.useContext(mT)??{utils:void 0,localeText:void 0},M=oi({props:u,name:"MuiLocalizationProvider"}),{children:D,dateAdapter:i,dateFormats:j,dateLibInstance:H,adapterLocale:q,localeText:X}=M,se=Y.useMemo(()=>vt({},X,_,a),[X,_,a]),ne=Y.useMemo(()=>{if(!i)return g||null;const te=new i({locale:q,formats:j,instance:H});if(!te.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/getting-started/#installation"].join(`
`));return te},[i,q,j,H,g]),le=Y.useMemo(()=>ne?{minDate:ne.date("1900-01-01T00:00:00.000"),maxDate:ne.date("2099-12-31T00:00:00.000")}:null,[ne]),de=Y.useMemo(()=>({utils:ne,defaultDates:le,localeText:se}),[le,ne,se]);return L.jsx(mT.Provider,{value:de,children:D})},Ll=(e,r)=>e.length!==r.length?!1:r.every(a=>e.includes(a)),k7=({openTo:e,defaultOpenTo:r,views:a,defaultViews:u})=>{const g=a??u;let _;if(e!=null)_=e;else if(g.includes(r))_=r;else if(g.length>0)_=g[0];else throw new Error("MUI X: The `views` prop must contain at least one view.");return{views:g,openTo:_}},gv=(e,r,a)=>{let u=r;return u=e.setHours(u,e.getHours(a)),u=e.setMinutes(u,e.getMinutes(a)),u=e.setSeconds(u,e.getSeconds(a)),u=e.setMilliseconds(u,e.getMilliseconds(a)),u},Qg=({date:e,disableFuture:r,disablePast:a,maxDate:u,minDate:g,isDateDisabled:_,utils:M,timezone:D})=>{const i=gv(M,M.date(void 0,D),e);a&&M.isBefore(g,i)&&(g=i),r&&M.isAfter(u,i)&&(u=i);let j=e,H=e;for(M.isBefore(e,g)&&(j=g,H=null),M.isAfter(e,u)&&(H&&(H=u),j=null);j||H;){if(j&&M.isAfter(j,u)&&(j=null),H&&M.isBefore(H,g)&&(H=null),j){if(!_(j))return j;j=M.addDays(j,1)}if(H){if(!_(H))return H;H=M.addDays(H,-1)}}return null},P7=(e,r)=>r==null||!e.isValid(r)?null:r,Ca=(e,r,a)=>r==null||!e.isValid(r)?a:r,A7=(e,r,a)=>!e.isValid(r)&&r!=null&&!e.isValid(a)&&a!=null?!0:e.isEqual(r,a),ZC=(e,r)=>{const u=[e.startOfYear(r)];for(;u.length<12;){const g=u[u.length-1];u.push(e.addMonths(g,1))}return u},YC=(e,r,a)=>a==="date"?e.startOfDay(e.date(void 0,r)):e.date(void 0,r),$d=(e,r)=>{const a=e.setHours(e.date(),r==="am"?2:14);return e.format(a,"meridiem")},D7=["year","month","day"],yv=e=>D7.includes(e),KA=(e,{format:r,views:a},u)=>{if(r!=null)return r;const g=e.formats;return Ll(a,["year"])?g.year:Ll(a,["month"])?g.month:Ll(a,["day"])?g.dayOfMonth:Ll(a,["month","year"])?`${g.month} ${g.year}`:Ll(a,["day","month"])?`${g.month} ${g.dayOfMonth}`:g.keyboardDate},R7=(e,r)=>{const a=e.startOfWeek(r);return[0,1,2,3,4,5,6].map(u=>e.addDays(a,u))},L7=["hours","minutes","seconds"],_v=e=>L7.includes(e),z7=(e,r)=>e?r.getHours(e)>=12?"pm":"am":null,gT=(e,r,a)=>a&&(e>=12?"pm":"am")!==r?r==="am"?e-12:e+12:e,O7=(e,r,a,u)=>{const g=gT(u.getHours(e),r,a);return u.setHours(e,g)},JA=(e,r)=>r.getHours(e)*3600+r.getMinutes(e)*60+r.getSeconds(e),XC=(e,r)=>(a,u)=>e?r.isAfter(a,u):JA(a,r)>JA(u,r),QA=(e,{format:r,views:a,ampm:u})=>{if(r!=null)return r;const g=e.formats;return Ll(a,["hours"])?u?`${g.hours12h} ${g.meridiem}`:g.hours24h:Ll(a,["minutes"])?g.minutes:Ll(a,["seconds"])?g.seconds:Ll(a,["minutes","seconds"])?`${g.minutes}:${g.seconds}`:Ll(a,["hours","minutes","seconds"])?u?`${g.hours12h}:${g.minutes}:${g.seconds} ${g.meridiem}`:`${g.hours24h}:${g.minutes}:${g.seconds}`:u?`${g.hours12h}:${g.minutes} ${g.meridiem}`:`${g.hours24h}:${g.minutes}`},Za={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},F7=e=>Math.max(...e.map(r=>Za[r.type]??1)),Ig=(e,r,a)=>{if(r===Za.year)return e.startOfYear(a);if(r===Za.month)return e.startOfMonth(a);if(r===Za.day)return e.startOfDay(a);let u=a;return r<Za.minutes&&(u=e.setMinutes(u,0)),r<Za.seconds&&(u=e.setSeconds(u,0)),r<Za.milliseconds&&(u=e.setMilliseconds(u,0)),u},B7=({props:e,utils:r,granularity:a,timezone:u,getTodayDate:g})=>{let _=g?g():Ig(r,a,YC(r,u));e.minDate!=null&&r.isAfterDay(e.minDate,_)&&(_=Ig(r,a,e.minDate)),e.maxDate!=null&&r.isBeforeDay(e.maxDate,_)&&(_=Ig(r,a,e.maxDate));const M=XC(e.disableIgnoringDatePartForTimeValidation??!1,r);return e.minTime!=null&&M(e.minTime,_)&&(_=Ig(r,a,e.disableIgnoringDatePartForTimeValidation?e.minTime:gv(r,_,e.minTime))),e.maxTime!=null&&M(_,e.maxTime)&&(_=Ig(r,a,e.disableIgnoringDatePartForTimeValidation?e.maxTime:gv(r,_,e.maxTime))),_},d4=(e,r)=>{const a=e.formatTokenMap[r];if(a==null)throw new Error([`MUI X: The token "${r}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof a=="string"?{type:a,contentType:a==="meridiem"?"letter":"digit",maxLength:void 0}:{type:a.sectionType,contentType:a.contentType,maxLength:a.maxLength}},j7=e=>{switch(e){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}},E1=(e,r)=>{const a=[],u=e.date(void 0,"default"),g=e.startOfWeek(u),_=e.endOfWeek(u);let M=g;for(;e.isBefore(M,_);)a.push(M),M=e.addDays(M,1);return a.map(D=>e.formatByString(D,r))},h4=(e,r,a,u)=>{switch(a){case"month":return ZC(e,e.date(void 0,r)).map(g=>e.formatByString(g,u));case"weekDay":return E1(e,u);case"meridiem":{const g=e.date(void 0,r);return[e.startOfDay(g),e.endOfDay(g)].map(_=>e.formatByString(_,u))}default:return[]}},eD="s",N7=["0","1","2","3","4","5","6","7","8","9"],V7=e=>{const r=e.date(void 0);return e.formatByString(e.setSeconds(r,0),eD)==="0"?N7:Array.from({length:10}).map((u,g)=>e.formatByString(e.setSeconds(r,g),eD))},Kd=(e,r)=>{if(r[0]==="0")return e;const a=[];let u="";for(let g=0;g<e.length;g+=1){u+=e[g];const _=r.indexOf(u);_>-1&&(a.push(_.toString()),u="")}return a.join("")},KC=(e,r)=>r[0]==="0"?e:e.split("").map(a=>r[Number(a)]).join(""),tD=(e,r)=>{const a=Kd(e,r);return a!==" "&&!Number.isNaN(Number(a))},p4=(e,r)=>{let a=e;for(a=Number(a).toString();a.length<r;)a=`0${a}`;return a},f4=(e,r,a,u,g)=>{if(g.type==="day"&&g.contentType==="digit-with-letter"){const M=e.setDate(a.longestMonth,r);return e.formatByString(M,g.format)}let _=r.toString();return g.hasLeadingZerosInInput&&(_=p4(_,g.maxLength)),KC(_,u)},$7=(e,r,a,u,g,_,M,D)=>{const i=j7(u),j=u==="Home",H=u==="End",q=a.value===""||j||H,X=()=>{const ne=g[a.type]({currentDate:M,format:a.format,contentType:a.contentType}),le=K=>f4(e,K,ne,_,a),de=a.type==="minutes"&&(D!=null&&D.minutesStep)?D.minutesStep:1;let Q=parseInt(Kd(a.value,_),10)+i*de;if(q){if(a.type==="year"&&!H&&!j)return e.formatByString(e.date(void 0,r),a.format);i>0||j?Q=ne.minimum:Q=ne.maximum}return Q%de!==0&&((i<0||j)&&(Q+=de-(de+Q)%de),(i>0||H)&&(Q-=Q%de)),Q>ne.maximum?le(ne.minimum+(Q-ne.maximum-1)%(ne.maximum-ne.minimum+1)):Q<ne.minimum?le(ne.maximum-(ne.minimum-Q-1)%(ne.maximum-ne.minimum+1)):le(Q)},se=()=>{const ne=h4(e,r,a.type,a.format);if(ne.length===0)return a.value;if(q)return i>0||j?ne[0]:ne[ne.length-1];const te=((ne.indexOf(a.value)+i)%ne.length+ne.length)%ne.length;return ne[te]};return a.contentType==="digit"||a.contentType==="digit-with-letter"?X():se()},JC=(e,r,a)=>{let u=e.value||e.placeholder;const g=r==="non-input"?e.hasLeadingZerosInFormat:e.hasLeadingZerosInInput;return r==="non-input"&&e.hasLeadingZerosInInput&&!e.hasLeadingZerosInFormat&&(u=Number(Kd(u,a)).toString()),["input-rtl","input-ltr"].includes(r)&&e.contentType==="digit"&&!g&&u.length===1&&(u=`${u}`),r==="input-rtl"&&(u=`${u}`),u},rD=(e,r,a,u)=>e.formatByString(e.parse(r,a),u),m4=(e,r)=>e.formatByString(e.date(void 0,"system"),r).length===4,g4=(e,r,a,u)=>{if(r!=="digit")return!1;const g=e.date(void 0,"default");switch(a){case"year":return m4(e,u)?e.formatByString(e.setYear(g,1),u)==="0001":e.formatByString(e.setYear(g,2001),u)==="01";case"month":return e.formatByString(e.startOfYear(g),u).length>1;case"day":return e.formatByString(e.startOfMonth(g),u).length>1;case"weekDay":return e.formatByString(e.startOfWeek(g),u).length>1;case"hours":return e.formatByString(e.setHours(g,1),u).length>1;case"minutes":return e.formatByString(e.setMinutes(g,1),u).length>1;case"seconds":return e.formatByString(e.setSeconds(g,1),u).length>1;default:throw new Error("Invalid section type")}},U7=(e,r,a)=>{const u=r.some(i=>i.type==="day"),g=[],_=[];for(let i=0;i<r.length;i+=1){const j=r[i];u&&j.type==="weekDay"||(g.push(j.format),_.push(JC(j,"non-input",a)))}const M=g.join(" "),D=_.join(" ");return e.parse(D,M)},W7=e=>e.map(r=>`${r.startSeparator}${r.value||r.placeholder}${r.endSeparator}`).join(""),G7=(e,r,a)=>{const g=e.map(_=>{const M=JC(_,a?"input-rtl":"input-ltr",r);return`${_.startSeparator}${M}${_.endSeparator}`}).join("");return a?`${g}`:g},H7=(e,r,a)=>{const u=e.date(void 0,a),g=e.endOfYear(u),_=e.endOfDay(u),{maxDaysInMonth:M,longestMonth:D}=ZC(e,u).reduce((i,j)=>{const H=e.getDaysInMonth(j);return H>i.maxDaysInMonth?{maxDaysInMonth:H,longestMonth:j}:i},{maxDaysInMonth:0,longestMonth:null});return{year:({format:i})=>({minimum:0,maximum:m4(e,i)?9999:99}),month:()=>({minimum:1,maximum:e.getMonth(g)+1}),day:({currentDate:i})=>({minimum:1,maximum:i!=null&&e.isValid(i)?e.getDaysInMonth(i):M,longestMonth:D}),weekDay:({format:i,contentType:j})=>{if(j==="digit"){const H=E1(e,i).map(Number);return{minimum:Math.min(...H),maximum:Math.max(...H)}}return{minimum:1,maximum:7}},hours:({format:i})=>{const j=e.getHours(_);return Kd(e.formatByString(e.endOfDay(u),i),r)!==j.toString()?{minimum:1,maximum:Number(Kd(e.formatByString(e.startOfDay(u),i),r))}:{minimum:0,maximum:j}},minutes:()=>({minimum:0,maximum:e.getMinutes(_)}),seconds:()=>({minimum:0,maximum:e.getSeconds(_)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}},q7=(e,r,a,u)=>{switch(r.type){case"year":return e.setYear(u,e.getYear(a));case"month":return e.setMonth(u,e.getMonth(a));case"weekDay":{const g=E1(e,r.format),_=e.formatByString(a,r.format),M=g.indexOf(_),i=g.indexOf(r.value)-M;return e.addDays(a,i)}case"day":return e.setDate(u,e.getDate(a));case"meridiem":{const g=e.getHours(a)<12,_=e.getHours(u);return g&&_>=12?e.addHours(u,-12):!g&&_<12?e.addHours(u,12):u}case"hours":return e.setHours(u,e.getHours(a));case"minutes":return e.setMinutes(u,e.getMinutes(a));case"seconds":return e.setSeconds(u,e.getSeconds(a));default:return u}},nD={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},iD=(e,r,a,u,g)=>[...a].sort((_,M)=>nD[_.type]-nD[M.type]).reduce((_,M)=>!g||M.modified?q7(e,M,r,_):_,u),Z7=()=>navigator.userAgent.toLowerCase().includes("android"),Y7=(e,r)=>{const a={};if(!r)return e.forEach((i,j)=>{const H=j===0?null:j-1,q=j===e.length-1?null:j+1;a[j]={leftIndex:H,rightIndex:q}}),{neighbors:a,startIndex:0,endIndex:e.length-1};const u={},g={};let _=0,M=0,D=e.length-1;for(;D>=0;){M=e.findIndex((i,j)=>{var H;return j>=_&&((H=i.endSeparator)==null?void 0:H.includes(" "))&&i.endSeparator!==" / "}),M===-1&&(M=e.length-1);for(let i=M;i>=_;i-=1)g[i]=D,u[D]=i,D-=1;_=M+1}return e.forEach((i,j)=>{const H=g[j],q=H===0?null:u[H-1],X=H===e.length-1?null:u[H+1];a[j]={leftIndex:q,rightIndex:X}}),{neighbors:a,startIndex:u[0],endIndex:u[e.length-1]}},yT=(e,r)=>{if(e==null)return null;if(e==="all")return"all";if(typeof e=="string"){const a=r.findIndex(u=>u.type===e);return a===-1?null:a}return e},X7=(e,r)=>{if(e.value)switch(e.type){case"month":{if(e.contentType==="digit")return r.format(r.setMonth(r.date(),Number(e.value)-1),"month");const a=r.parse(e.value,e.format);return a?r.format(a,"month"):void 0}case"day":return e.contentType==="digit"?r.format(r.setDate(r.startOfYear(r.date()),Number(e.value)),"dayOfMonthFull"):e.value;case"weekDay":return;default:return}},K7=(e,r)=>{if(e.value)switch(e.type){case"weekDay":return e.contentType==="letter"?void 0:Number(e.value);case"meridiem":{const a=r.parse(`01:00 ${e.value}`,`${r.formats.hours12h}:${r.formats.minutes} ${e.format}`);return a?r.getHours(a)>=12?1:0:void 0}case"day":return e.contentType==="digit-with-letter"?parseInt(e.value,10):Number(e.value);case"month":{if(e.contentType==="digit")return Number(e.value);const a=r.parse(e.value,e.format);return a?r.getMonth(a)+1:void 0}default:return e.contentType!=="letter"?Number(e.value):void 0}},J7=["value","referenceDate"],qs={emptyValue:null,getTodayValue:YC,getInitialReferenceValue:e=>{let{value:r,referenceDate:a}=e,u=Sn(e,J7);return r!=null&&u.utils.isValid(r)?r:a??B7(u)},cleanValue:P7,areValuesEqual:A7,isSameError:(e,r)=>e===r,hasError:e=>e!=null,defaultErrorState:null,getTimezone:(e,r)=>r==null||!e.isValid(r)?null:e.getTimezone(r),setTimezone:(e,r,a)=>a==null?null:e.setTimezone(a,r)},Q7={updateReferenceValue:(e,r,a)=>r==null||!e.isValid(r)?a:r,getSectionsFromValue:(e,r,a,u)=>!e.isValid(r)&&!!a?a:u(r),getV7HiddenInputValueFromSections:W7,getV6InputValueFromSections:G7,getActiveDateManager:(e,r)=>({date:r.value,referenceDate:r.referenceValue,getSections:a=>a,getNewValuesFromNewActiveDate:a=>({value:a,referenceValue:a==null||!e.isValid(a)?r.referenceValue:a})}),parseValueStr:(e,r,a)=>a(e.trim(),r)},QC=({props:e,value:r,timezone:a,adapter:u})=>{if(r===null)return null;const{shouldDisableDate:g,shouldDisableMonth:_,shouldDisableYear:M,disablePast:D,disableFuture:i}=e,j=u.utils.date(void 0,a),H=Ca(u.utils,e.minDate,u.defaultDates.minDate),q=Ca(u.utils,e.maxDate,u.defaultDates.maxDate);switch(!0){case!u.utils.isValid(r):return"invalidDate";case!!(g&&g(r)):return"shouldDisableDate";case!!(_&&_(r)):return"shouldDisableMonth";case!!(M&&M(r)):return"shouldDisableYear";case!!(i&&u.utils.isAfterDay(r,j)):return"disableFuture";case!!(D&&u.utils.isBeforeDay(r,j)):return"disablePast";case!!(H&&u.utils.isBeforeDay(r,H)):return"minDate";case!!(q&&u.utils.isAfterDay(r,q)):return"maxDate";default:return null}};QC.valueManager=qs;const y4=({adapter:e,value:r,timezone:a,props:u})=>{if(r===null)return null;const{minTime:g,maxTime:_,minutesStep:M,shouldDisableTime:D,disableIgnoringDatePartForTimeValidation:i=!1,disablePast:j,disableFuture:H}=u,q=e.utils.date(void 0,a),X=XC(i,e.utils);switch(!0){case!e.utils.isValid(r):return"invalidDate";case!!(g&&X(g,r)):return"minTime";case!!(_&&X(r,_)):return"maxTime";case!!(H&&e.utils.isAfter(r,q)):return"disableFuture";case!!(j&&e.utils.isBefore(r,q)):return"disablePast";case!!(D&&D(r,"hours")):return"shouldDisableTime-hours";case!!(D&&D(r,"minutes")):return"shouldDisableTime-minutes";case!!(D&&D(r,"seconds")):return"shouldDisableTime-seconds";case!!(M&&e.utils.getMinutes(r)%M!==0):return"minutesStep";default:return null}};y4.valueManager=qs;const eM=({adapter:e,value:r,timezone:a,props:u})=>{const g=QC({adapter:e,value:r,timezone:a,props:u});return g!==null?g:y4({adapter:e,value:r,timezone:a,props:u})};eM.valueManager=qs;const _4=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],x4=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],v4=["minDateTime","maxDateTime"],eH=[..._4,...x4,...v4],tH=e=>eH.reduce((r,a)=>(e.hasOwnProperty(a)&&(r[a]=e[a]),r),{}),rH=e=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:vt({},e)}}}}),nH=e=>{const{utils:r,formatKey:a,contextTranslation:u,propsTranslation:g}=e;return _=>{const M=_!==null&&r.isValid(_)?r.format(_,a):null;return(g??u)(_,r,M)}},b4={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:e=>e==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",clockLabelText:(e,r,a,u)=>`Select ${e}. ${!u&&(r===null||!a.isValid(r))?"No time selected":`Selected time is ${u??a.format(r,"fullTime")}`}`,hoursClockNumberText:e=>`${e} hours`,minutesClockNumberText:e=>`${e} minutes`,secondsClockNumberText:e=>`${e} seconds`,selectViewText:e=>`Select ${e}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:e=>`Week ${e}`,calendarWeekNumberText:e=>`${e}`,openDatePickerDialogue:(e,r,a)=>a||e!==null&&r.isValid(e)?`Choose date, selected date is ${a??r.format(e,"fullDate")}`:"Choose date",openTimePickerDialogue:(e,r,a)=>a||e!==null&&r.isValid(e)?`Choose time, selected time is ${a??r.format(e,"fullTime")}`:"Choose time",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:e=>"Y".repeat(e.digitAmount),fieldMonthPlaceholder:e=>e.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:e=>e.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},iH=b4;rH(b4);const rh=()=>{const e=Y.useContext(mT);if(e===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(e.utils===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const r=Y.useMemo(()=>vt({},iH,e.localeText),[e.localeText]);return Y.useMemo(()=>vt({},e,{localeText:r}),[e,r])},Ei=()=>rh().utils,$y=()=>rh().defaultDates,Uy=e=>{const r=Ei(),a=Y.useRef(void 0);return a.current===void 0&&(a.current=r.date(void 0,e)),a.current};function w4(e){const{props:r,validator:a,value:u,timezone:g,onError:_}=e,M=rh(),D=Y.useRef(a.valueManager.defaultErrorState),i=a({adapter:M,value:u,timezone:g,props:r}),j=a.valueManager.hasError(i);Y.useEffect(()=>{_&&!a.valueManager.isSameError(i,D.current)&&_(i,u),D.current=i},[a,_,i,u]);const H=Ar(q=>a({adapter:M,value:q,timezone:g,props:r}));return{validationError:i,hasValidationError:j,getValidationErrorForNewValue:H}}const nl=()=>rh().localeText,oH=({utils:e,format:r})=>{let a=10,u=r,g=e.expandFormat(r);for(;g!==u;)if(u=g,g=e.expandFormat(u),a-=1,a<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the picker component.");return g},sH=({utils:e,expandedFormat:r})=>{const a=[],{start:u,end:g}=e.escapedCharacters,_=new RegExp(`(\\${u}[^\\${g}]*\\${g})+`,"g");let M=null;for(;M=_.exec(r);)a.push({start:M.index,end:_.lastIndex-1});return a},aH=(e,r,a,u)=>{switch(a.type){case"year":return r.fieldYearPlaceholder({digitAmount:e.formatByString(e.date(void 0,"default"),u).length,format:u});case"month":return r.fieldMonthPlaceholder({contentType:a.contentType,format:u});case"day":return r.fieldDayPlaceholder({format:u});case"weekDay":return r.fieldWeekDayPlaceholder({contentType:a.contentType,format:u});case"hours":return r.fieldHoursPlaceholder({format:u});case"minutes":return r.fieldMinutesPlaceholder({format:u});case"seconds":return r.fieldSecondsPlaceholder({format:u});case"meridiem":return r.fieldMeridiemPlaceholder({format:u});default:return u}},lH=({utils:e,date:r,shouldRespectLeadingZeros:a,localeText:u,localizedDigits:g,now:_,token:M,startSeparator:D})=>{if(M==="")throw new Error("MUI X: Should not call `commitToken` with an empty token");const i=d4(e,M),j=g4(e,i.contentType,i.type,M),H=a?j:i.contentType==="digit",q=r!=null&&e.isValid(r);let X=q?e.formatByString(r,M):"",se=null;if(H)if(j)se=X===""?e.formatByString(_,M).length:X.length;else{if(i.maxLength==null)throw new Error(`MUI X: The token ${M} should have a 'maxDigitNumber' property on it's adapter`);se=i.maxLength,q&&(X=KC(p4(Kd(X,g),se),g))}return vt({},i,{format:M,maxLength:se,value:X,placeholder:aH(e,u,i,M),hasLeadingZerosInFormat:j,hasLeadingZerosInInput:H,startSeparator:D,endSeparator:"",modified:!1})},cH=e=>{var se;const{utils:r,expandedFormat:a,escapedParts:u}=e,g=r.date(void 0),_=[];let M="";const D=Object.keys(r.formatTokenMap).sort((ne,le)=>le.length-ne.length),i=/^([a-zA-Z]+)/,j=new RegExp(`^(${D.join("|")})*$`),H=new RegExp(`^(${D.join("|")})`),q=ne=>u.find(le=>le.start<=ne&&le.end>=ne);let X=0;for(;X<a.length;){const ne=q(X),le=ne!=null,de=(se=i.exec(a.slice(X)))==null?void 0:se[1];if(!le&&de!=null&&j.test(de)){let te=de;for(;te.length>0;){const Q=H.exec(te)[1];te=te.slice(Q.length),_.push(lH(vt({},e,{now:g,token:Q,startSeparator:M}))),M=""}X+=de.length}else{const te=a[X];le&&(ne==null?void 0:ne.start)===X||(ne==null?void 0:ne.end)===X||(_.length===0?M+=te:_[_.length-1].endSeparator+=te),X+=1}}return _.length===0&&M.length>0&&_.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:M,endSeparator:"",modified:!1}),_},uH=({isRtl:e,formatDensity:r,sections:a})=>a.map(u=>{const g=_=>{let M=_;return e&&M!==null&&M.includes(" ")&&(M=`${M}`),r==="spacious"&&["/",".","-"].includes(M)&&(M=` ${M} `),M};return u.startSeparator=g(u.startSeparator),u.endSeparator=g(u.endSeparator),u}),oD=e=>{let r=oH(e);e.isRtl&&e.enableAccessibleFieldDOMStructure&&(r=r.split(" ").reverse().join(" "));const a=sH(vt({},e,{expandedFormat:r})),u=cH(vt({},e,{expandedFormat:r,escapedParts:a}));return uH(vt({},e,{sections:u}))},tM=({timezone:e,value:r,defaultValue:a,referenceDate:u,onChange:g,valueManager:_})=>{const M=Ei(),D=Y.useRef(a),i=r??D.current??_.emptyValue,j=Y.useMemo(()=>_.getTimezone(M,i),[M,_,i]),H=Ar(ne=>j==null?ne:_.setTimezone(M,j,ne));let q;e?q=e:j?q=j:u?q=M.getTimezone(u):q="default";const X=Y.useMemo(()=>_.setTimezone(M,q,i),[_,M,q,i]),se=Ar((ne,...le)=>{const de=H(ne);g==null||g(de,...le)});return{value:X,handleValueChange:se,timezone:q}},I1=({name:e,timezone:r,value:a,defaultValue:u,referenceDate:g,onChange:_,valueManager:M})=>{const[D,i]=tl({name:e,state:"value",controlled:a,default:u??M.emptyValue}),j=Ar((H,...q)=>{i(H),_==null||_(H,...q)});return tM({timezone:r,value:D,defaultValue:void 0,referenceDate:g,onChange:j,valueManager:M})},dH=e=>{const r=Ei(),a=nl(),u=rh(),g=fs(),{valueManager:_,fieldValueManager:M,valueType:D,validator:i,internalProps:j,internalProps:{value:H,defaultValue:q,referenceDate:X,onChange:se,format:ne,formatDensity:le="dense",selectedSections:de,onSelectedSectionsChange:te,shouldRespectLeadingZeros:Q=!1,timezone:K,enableAccessibleFieldDOMStructure:ce=!1}}=e,{timezone:fe,value:Ie,handleValueChange:Ce}=tM({timezone:K,value:H,defaultValue:q,referenceDate:X,onChange:se,valueManager:_}),we=Y.useMemo(()=>V7(r),[r]),ot=Y.useMemo(()=>H7(r,we,fe),[r,we,fe]),oe=Y.useCallback((Rt,It=null)=>M.getSectionsFromValue(r,Rt,It,zt=>oD({utils:r,localeText:a,localizedDigits:we,format:ne,date:zt,formatDensity:le,shouldRespectLeadingZeros:Q,enableAccessibleFieldDOMStructure:ce,isRtl:g})),[M,ne,a,we,g,Q,r,le,ce]),[ve,je]=Y.useState(()=>{const Rt=oe(Ie),It={sections:Rt,value:Ie,referenceValue:_.emptyValue,tempValueStrAndroid:null},zt=F7(Rt),At=_.getInitialReferenceValue({referenceDate:X,value:Ie,utils:r,props:j,granularity:zt,timezone:fe});return vt({},It,{referenceValue:At})}),[He,Le]=tl({controlled:de,default:null,name:"useField",state:"selectedSections"}),ze=Rt=>{Le(Rt),te==null||te(Rt)},Pe=Y.useMemo(()=>yT(He,ve.sections),[He,ve.sections]),tt=Pe==="all"?0:Pe,De=({value:Rt,referenceValue:It,sections:zt})=>{if(je(kt=>vt({},kt,{sections:zt,value:Rt,referenceValue:It,tempValueStrAndroid:null})),_.areValuesEqual(r,ve.value,Rt))return;const At={validationError:i({adapter:u,value:Rt,timezone:fe,props:j})};Ce(Rt,At)},Ke=(Rt,It)=>{const zt=[...ve.sections];return zt[Rt]=vt({},zt[Rt],{value:It,modified:!0}),zt},Ge=()=>{De({value:_.emptyValue,referenceValue:ve.referenceValue,sections:oe(_.emptyValue)})},ft=()=>{if(tt==null)return;const Rt=ve.sections[tt],It=M.getActiveDateManager(r,ve,Rt),At=It.getSections(ve.sections).filter(Ht=>Ht.value!=="").length===(Rt.value===""?0:1),kt=Ke(tt,""),Ot=At?null:r.getInvalidDate(),be=It.getNewValuesFromNewActiveDate(Ot);De(vt({},be,{sections:kt}))},Gt=Rt=>{const It=(kt,Ot)=>{const be=r.parse(kt,ne);if(be==null||!r.isValid(be))return null;const Ht=oD({utils:r,localeText:a,localizedDigits:we,format:ne,date:be,formatDensity:le,shouldRespectLeadingZeros:Q,enableAccessibleFieldDOMStructure:ce,isRtl:g});return iD(r,be,Ht,Ot,!1)},zt=M.parseValueStr(Rt,ve.referenceValue,It),At=M.updateReferenceValue(r,zt,ve.referenceValue);De({value:zt,referenceValue:At,sections:oe(zt,ve.sections)})},Ft=({activeSection:Rt,newSectionValue:It,shouldGoToNextSection:zt})=>{zt&&tt<ve.sections.length-1&&ze(tt+1);const At=M.getActiveDateManager(r,ve,Rt),kt=Ke(tt,It),Ot=At.getSections(kt),be=U7(r,Ot,we);let Ht,xt;if(be!=null&&r.isValid(be)){const Bt=iD(r,be,Ot,At.referenceDate,!0);Ht=At.getNewValuesFromNewActiveDate(Bt),xt=!0}else Ht=At.getNewValuesFromNewActiveDate(be),xt=(be!=null&&!r.isValid(be))!=(At.date!=null&&!r.isValid(At.date));return xt?De(vt({},Ht,{sections:kt})):je(Bt=>vt({},Bt,Ht,{sections:kt,tempValueStrAndroid:null}))},wt=Rt=>je(It=>vt({},It,{tempValueStrAndroid:Rt}));return Y.useEffect(()=>{const Rt=oe(ve.value);je(It=>vt({},It,{sections:Rt}))},[ne,r.locale,g]),Y.useEffect(()=>{let Rt;_.areValuesEqual(r,ve.value,Ie)?Rt=_.getTimezone(r,ve.value)!==_.getTimezone(r,Ie):Rt=!0,Rt&&je(It=>vt({},It,{value:Ie,referenceValue:M.updateReferenceValue(r,Ie,It.referenceValue),sections:oe(Ie)}))},[Ie]),{state:ve,activeSectionIndex:tt,parsedSelectedSections:Pe,setSelectedSections:ze,clearValue:Ge,clearActiveSection:ft,updateSectionValue:Ft,updateValueFromValueStr:Gt,setTempAndroidValueStr:wt,getSectionsFromValue:oe,sectionsValueBoundaries:ot,localizedDigits:we,timezone:fe}},hH=5e3,wp=e=>e.saveQuery!=null,pH=({sections:e,updateSectionValue:r,sectionsValueBoundaries:a,localizedDigits:u,setTempAndroidValueStr:g,timezone:_})=>{const M=Ei(),[D,i]=Y.useState(null),j=Ar(()=>i(null));Y.useEffect(()=>{var ne;D!=null&&((ne=e[D.sectionIndex])==null?void 0:ne.type)!==D.sectionType&&j()},[e,D,j]),Y.useEffect(()=>{if(D!=null){const ne=setTimeout(()=>j(),hH);return()=>{clearTimeout(ne)}}return()=>{}},[D,j]);const H=({keyPressed:ne,sectionIndex:le},de,te)=>{const Q=ne.toLowerCase(),K=e[le];if(D!=null&&(!te||te(D.value))&&D.sectionIndex===le){const fe=`${D.value}${Q}`,Ie=de(fe,K);if(!wp(Ie))return i({sectionIndex:le,value:fe,sectionType:K.type}),Ie}const ce=de(Q,K);return wp(ce)&&!ce.saveQuery?(j(),null):(i({sectionIndex:le,value:Q,sectionType:K.type}),wp(ce)?null:ce)},q=ne=>{const le=(Q,K,ce)=>{const fe=K.filter(Ie=>Ie.toLowerCase().startsWith(ce));return fe.length===0?{saveQuery:!1}:{sectionValue:fe[0],shouldGoToNextSection:fe.length===1}},de=(Q,K,ce,fe)=>{const Ie=Ce=>h4(M,_,K.type,Ce);if(K.contentType==="letter")return le(K.format,Ie(K.format),Q);if(ce&&fe!=null&&d4(M,ce).contentType==="letter"){const Ce=Ie(ce),we=le(ce,Ce,Q);return wp(we)?{saveQuery:!1}:vt({},we,{sectionValue:fe(we.sectionValue,Ce)})}return{saveQuery:!1}};return H(ne,(Q,K)=>{switch(K.type){case"month":{const ce=fe=>rD(M,fe,M.formats.month,K.format);return de(Q,K,M.formats.month,ce)}case"weekDay":{const ce=(fe,Ie)=>Ie.indexOf(fe).toString();return de(Q,K,M.formats.weekday,ce)}case"meridiem":return de(Q,K);default:return{saveQuery:!1}}})},X=ne=>{const le=(te,Q)=>{const K=Kd(te,u),ce=Number(K),fe=a[Q.type]({currentDate:null,format:Q.format,contentType:Q.contentType});if(ce>fe.maximum)return{saveQuery:!1};if(ce<fe.minimum)return{saveQuery:!0};const Ie=ce*10>fe.maximum||K.length===fe.maximum.toString().length;return{sectionValue:f4(M,ce,fe,u,Q),shouldGoToNextSection:Ie}};return H(ne,(te,Q)=>{if(Q.contentType==="digit"||Q.contentType==="digit-with-letter")return le(te,Q);if(Q.type==="month"){const K=g4(M,"digit","month","MM"),ce=le(te,{type:Q.type,format:"MM",hasLeadingZerosInFormat:K,hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(wp(ce))return ce;const fe=rD(M,ce.sectionValue,"MM",Q.format);return vt({},ce,{sectionValue:fe})}if(Q.type==="weekDay"){const K=le(te,Q);if(wp(K))return K;const ce=E1(M,Q.format)[Number(K.sectionValue)-1];return vt({},K,{sectionValue:ce})}return{saveQuery:!1}},te=>tD(te,u))};return{applyCharacterEditing:Ar(ne=>{const le=e[ne.sectionIndex],te=tD(ne.keyPressed,u)?X(vt({},ne,{keyPressed:KC(ne.keyPressed,u)})):q(ne);if(te==null){g(null);return}r({activeSection:le,newSectionValue:te.sectionValue,shouldGoToNextSection:te.shouldGoToNextSection})}),resetCharacterQuery:j}};function fH(e,r){return Array.isArray(r)?r.every(a=>e.indexOf(a)!==-1):e.indexOf(r)!==-1}const mH=(e,r)=>a=>{(a.key==="Enter"||a.key===" ")&&(e(a),a.preventDefault(),a.stopPropagation())},js=(e=document)=>{const r=e.activeElement;return r?r.shadowRoot?js(r.shadowRoot):r:null},gH=e=>{const{internalProps:{disabled:r,readOnly:a=!1},forwardedProps:{sectionListRef:u,onBlur:g,onClick:_,onFocus:M,onInput:D,onPaste:i,focused:j,autoFocus:H=!1},fieldValueManager:q,applyCharacterEditing:X,resetCharacterQuery:se,setSelectedSections:ne,parsedSelectedSections:le,state:de,clearActiveSection:te,clearValue:Q,updateSectionValue:K,updateValueFromValueStr:ce,sectionOrder:fe,areAllSectionsEmpty:Ie,sectionsValueBoundaries:Ce}=e,we=Y.useRef(null),ot=ai(u,we),oe=nl(),ve=Ei(),je=Bu(),[He,Le]=Y.useState(!1),ze=Y.useMemo(()=>({syncSelectionToDOM:()=>{if(!we.current)return;const xt=document.getSelection();if(!xt)return;if(le==null){xt.rangeCount>0&&we.current.getRoot().contains(xt.getRangeAt(0).startContainer)&&xt.removeAllRanges(),He&&we.current.getRoot().blur();return}if(!we.current.getRoot().contains(js(document)))return;const Bt=new window.Range;let rt;le==="all"?rt=we.current.getRoot():de.sections[le].type==="empty"?rt=we.current.getSectionContainer(le):rt=we.current.getSectionContent(le),Bt.selectNodeContents(rt),rt.focus(),xt.removeAllRanges(),xt.addRange(Bt)},getActiveSectionIndexFromDOM:()=>{const xt=js(document);return!xt||!we.current||!we.current.getRoot().contains(xt)?null:we.current.getSectionIndexFromDOMElement(xt)},focusField:(xt=0)=>{if(!we.current||ze.getActiveSectionIndexFromDOM()!=null)return;const Bt=yT(xt,de.sections);Le(!0),we.current.getSectionContent(Bt).focus()},setSelectedSections:xt=>{if(!we.current)return;const Bt=yT(xt,de.sections);Le((Bt==="all"?0:Bt)!==null),ne(xt)},isFieldFocused:()=>{const xt=js(document);return!!we.current&&we.current.getRoot().contains(xt)}}),[le,ne,de.sections,He]),Pe=Ar(xt=>{if(!we.current)return;const Bt=de.sections[xt];we.current.getSectionContent(xt).innerHTML=Bt.value||Bt.placeholder,ze.syncSelectionToDOM()}),tt=Ar((xt,...Bt)=>{xt.isDefaultPrevented()||!we.current||(Le(!0),_==null||_(xt,...Bt),le==="all"?setTimeout(()=>{const rt=document.getSelection().getRangeAt(0).startOffset;if(rt===0){ne(fe.startIndex);return}let qt=0,Lt=0;for(;Lt<rt&&qt<de.sections.length;){const Yt=de.sections[qt];qt+=1,Lt+=`${Yt.startSeparator}${Yt.value||Yt.placeholder}${Yt.endSeparator}`.length}ne(qt-1)}):He?we.current.getRoot().contains(xt.target)||ne(fe.startIndex):(Le(!0),ne(fe.startIndex)))}),De=Ar(xt=>{if(D==null||D(xt),!we.current||le!=="all")return;const rt=xt.target.textContent??"";we.current.getRoot().innerHTML=de.sections.map(qt=>`${qt.startSeparator}${qt.value||qt.placeholder}${qt.endSeparator}`).join(""),ze.syncSelectionToDOM(),rt.length===0||rt.charCodeAt(0)===10?(se(),Q(),ne("all")):rt.length>1?ce(rt):(le==="all"&&ne(0),X({keyPressed:rt,sectionIndex:0}))}),Ke=Ar(xt=>{if(i==null||i(xt),a||le!=="all"){xt.preventDefault();return}const Bt=xt.clipboardData.getData("text");xt.preventDefault(),se(),ce(Bt)}),Ge=Ar((...xt)=>{if(M==null||M(...xt),He||!we.current)return;Le(!0),we.current.getSectionIndexFromDOMElement(js(document))!=null||ne(fe.startIndex)}),ft=Ar((...xt)=>{g==null||g(...xt),setTimeout(()=>{if(!we.current)return;const Bt=js(document);!we.current.getRoot().contains(Bt)&&(Le(!1),ne(null))})}),Gt=Ar(xt=>Bt=>{Bt.isDefaultPrevented()||ne(xt)}),Ft=Ar(xt=>{xt.preventDefault()}),wt=Ar(xt=>()=>{ne(xt)}),Rt=Ar(xt=>{if(xt.preventDefault(),a||r||typeof le!="number")return;const Bt=de.sections[le],rt=xt.clipboardData.getData("text"),qt=/^[a-zA-Z]+$/.test(rt),Lt=/^[0-9]+$/.test(rt),Yt=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(rt);Bt.contentType==="letter"&&qt||Bt.contentType==="digit"&&Lt||Bt.contentType==="digit-with-letter"&&Yt?(se(),K({activeSection:Bt,newSectionValue:rt,shouldGoToNextSection:!0})):!qt&&!Lt&&(se(),ce(rt))}),It=Ar(xt=>{xt.preventDefault(),xt.dataTransfer.dropEffect="none"}),zt=Ar(xt=>{if(!we.current)return;const Bt=xt.target,rt=Bt.textContent??"",qt=we.current.getSectionIndexFromDOMElement(Bt),Lt=de.sections[qt];if(a||!we.current){Pe(qt);return}if(rt.length===0){if(Lt.value===""){Pe(qt);return}const Yt=xt.nativeEvent.inputType;if(Yt==="insertParagraph"||Yt==="insertLineBreak"){Pe(qt);return}se(),te();return}X({keyPressed:rt,sectionIndex:qt}),Pe(qt)});io(()=>{if(!(!He||!we.current)){if(le==="all")we.current.getRoot().focus();else if(typeof le=="number"){const xt=we.current.getSectionContent(le);xt&&xt.focus()}}},[le,He]);const At=Y.useMemo(()=>de.sections.reduce((xt,Bt)=>(xt[Bt.type]=Ce[Bt.type]({currentDate:null,contentType:Bt.contentType,format:Bt.format}),xt),{}),[Ce,de.sections]),kt=le==="all",Ot=Y.useMemo(()=>de.sections.map((xt,Bt)=>{const rt=!kt&&!r&&!a;return{container:{"data-sectionindex":Bt,onClick:Gt(Bt)},content:{tabIndex:kt||Bt>0?-1:0,contentEditable:!kt&&!r&&!a,role:"spinbutton",id:`${je}-${xt.type}`,"aria-labelledby":`${je}-${xt.type}`,"aria-readonly":a,"aria-valuenow":K7(xt,ve),"aria-valuemin":At[xt.type].minimum,"aria-valuemax":At[xt.type].maximum,"aria-valuetext":xt.value?X7(xt,ve):oe.empty,"aria-label":oe[xt.type],"aria-disabled":r,spellCheck:rt?!1:void 0,autoCapitalize:rt?"off":void 0,autoCorrect:rt?"off":void 0,[parseInt(Y.version,10)>=17?"enterKeyHint":"enterkeyhint"]:rt?"next":void 0,children:xt.value||xt.placeholder,onInput:zt,onPaste:Rt,onFocus:wt(Bt),onDragOver:It,onMouseUp:Ft,inputMode:xt.contentType==="letter"?"text":"numeric"},before:{children:xt.startSeparator},after:{children:xt.endSeparator}}}),[de.sections,wt,Rt,It,zt,Gt,Ft,r,a,kt,oe,ve,At,je]),be=Ar(xt=>{ce(xt.target.value)}),Ht=Y.useMemo(()=>Ie?"":q.getV7HiddenInputValueFromSections(de.sections),[Ie,de.sections,q]);return Y.useEffect(()=>{if(we.current==null)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please remove the `enableAccessibleFieldDOMStructure` prop from your picker or field component:","","<DatePicker slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join(`
`));H&&we.current&&we.current.getSectionContent(fe.startIndex).focus()},[]),{interactions:ze,returnedValue:{autoFocus:H,readOnly:a,focused:j??He,sectionListRef:ot,onBlur:ft,onClick:tt,onFocus:Ge,onInput:De,onPaste:Ke,enableAccessibleFieldDOMStructure:!0,elements:Ot,tabIndex:le===0?-1:0,contentEditable:kt,value:Ht,onChange:be,areAllSectionsEmpty:Ie}}},Up=e=>e.replace(/[\u2066\u2067\u2068\u2069]/g,""),yH=(e,r,a)=>{let u=0,g=a?1:0;const _=[];for(let M=0;M<e.length;M+=1){const D=e[M],i=JC(D,a?"input-rtl":"input-ltr",r),j=`${D.startSeparator}${i}${D.endSeparator}`,H=Up(j).length,q=j.length,X=Up(i),se=g+(X===""?0:i.indexOf(X[0]))+D.startSeparator.length,ne=se+X.length;_.push(vt({},D,{start:u,end:u+H,startInInput:se,endInInput:ne})),u+=H,g+=q}return _},_H=e=>{const r=fs(),a=Y.useRef(void 0),u=Y.useRef(void 0),{forwardedProps:{onFocus:g,onClick:_,onPaste:M,onBlur:D,inputRef:i,placeholder:j},internalProps:{readOnly:H=!1,disabled:q=!1},parsedSelectedSections:X,activeSectionIndex:se,state:ne,fieldValueManager:le,valueManager:de,applyCharacterEditing:te,resetCharacterQuery:Q,updateSectionValue:K,updateValueFromValueStr:ce,clearActiveSection:fe,clearValue:Ie,setTempAndroidValueStr:Ce,setSelectedSections:we,getSectionsFromValue:ot,areAllSectionsEmpty:oe,localizedDigits:ve}=e,je=Y.useRef(null),He=ai(i,je),Le=Y.useMemo(()=>yH(ne.sections,ve,r),[ne.sections,ve,r]),ze=Y.useMemo(()=>({syncSelectionToDOM:()=>{if(!je.current)return;if(X==null){je.current.scrollLeft&&(je.current.scrollLeft=0);return}if(je.current!==js(document))return;const zt=je.current.scrollTop;if(X==="all")je.current.select();else{const At=Le[X],kt=At.type==="empty"?At.startInInput-At.startSeparator.length:At.startInInput,Ot=At.type==="empty"?At.endInInput+At.endSeparator.length:At.endInInput;(kt!==je.current.selectionStart||Ot!==je.current.selectionEnd)&&je.current===js(document)&&je.current.setSelectionRange(kt,Ot),clearTimeout(u.current),u.current=setTimeout(()=>{je.current&&je.current===js(document)&&je.current.selectionStart===je.current.selectionEnd&&(je.current.selectionStart!==kt||je.current.selectionEnd!==Ot)&&ze.syncSelectionToDOM()})}je.current.scrollTop=zt},getActiveSectionIndexFromDOM:()=>{const zt=je.current.selectionStart??0,At=je.current.selectionEnd??0;if(zt===0&&At===0)return null;const kt=zt<=Le[0].startInInput?1:Le.findIndex(Ot=>Ot.startInInput-Ot.startSeparator.length>zt);return kt===-1?Le.length-1:kt-1},focusField:(zt=0)=>{var At;js(document)!==je.current&&((At=je.current)==null||At.focus(),we(zt))},setSelectedSections:zt=>we(zt),isFieldFocused:()=>je.current===js(document)}),[je,X,Le,we]),Pe=()=>{const zt=je.current.selectionStart??0;let At;zt<=Le[0].startInInput||zt>=Le[Le.length-1].endInInput?At=1:At=Le.findIndex(Ot=>Ot.startInInput-Ot.startSeparator.length>zt);const kt=At===-1?Le.length-1:At-1;we(kt)},tt=Ar((...zt)=>{g==null||g(...zt);const At=je.current;clearTimeout(a.current),a.current=setTimeout(()=>{!At||At!==je.current||se==null&&(At.value.length&&Number(At.selectionEnd)-Number(At.selectionStart)===At.value.length?we("all"):Pe())})}),De=Ar((zt,...At)=>{zt.isDefaultPrevented()||(_==null||_(zt,...At),Pe())}),Ke=Ar(zt=>{if(M==null||M(zt),zt.preventDefault(),H||q)return;const At=zt.clipboardData.getData("text");if(typeof X=="number"){const kt=ne.sections[X],Ot=/^[a-zA-Z]+$/.test(At),be=/^[0-9]+$/.test(At),Ht=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(At);if(kt.contentType==="letter"&&Ot||kt.contentType==="digit"&&be||kt.contentType==="digit-with-letter"&&Ht){Q(),K({activeSection:kt,newSectionValue:At,shouldGoToNextSection:!0});return}if(Ot||be)return}Q(),ce(At)}),Ge=Ar((...zt)=>{D==null||D(...zt),we(null)}),ft=Ar(zt=>{if(H)return;const At=zt.target.value;if(At===""){Q(),Ie();return}const kt=zt.nativeEvent.data,Ot=kt&&kt.length>1,be=Ot?kt:At,Ht=Up(be);if(X==="all"&&we(se),se==null||Ot){ce(Ot?kt:Ht);return}let xt;if(X==="all"&&Ht.length===1)xt=Ht;else{const Bt=Up(le.getV6InputValueFromSections(Le,ve,r));let rt=-1,qt=-1;for(let wr=0;wr<Bt.length;wr+=1)rt===-1&&Bt[wr]!==Ht[wr]&&(rt=wr),qt===-1&&Bt[Bt.length-wr-1]!==Ht[Ht.length-wr-1]&&(qt=wr);const Lt=Le[se];if(rt<Lt.start||Bt.length-qt-1>Lt.end)return;const Wt=Ht.length-Bt.length+Lt.end-Up(Lt.endSeparator||"").length;xt=Ht.slice(Lt.start+Up(Lt.startSeparator||"").length,Wt)}if(xt.length===0){Z7()&&Ce(be),Q(),fe();return}te({keyPressed:xt,sectionIndex:se})}),Gt=Y.useMemo(()=>j!==void 0?j:le.getV6InputValueFromSections(ot(de.emptyValue),ve,r),[j,le,ot,de.emptyValue,ve,r]),Ft=Y.useMemo(()=>ne.tempValueStrAndroid??le.getV6InputValueFromSections(ne.sections,ve,r),[ne.sections,le,ne.tempValueStrAndroid,ve,r]);Y.useEffect(()=>(je.current&&je.current===js(document)&&we("all"),()=>{clearTimeout(a.current),clearTimeout(u.current)}),[]);const wt=Y.useMemo(()=>se==null||ne.sections[se].contentType==="letter"?"text":"numeric",[se,ne.sections]),It=!(je.current&&je.current===js(document))&&oe;return{interactions:ze,returnedValue:{readOnly:H,onBlur:Ge,onClick:De,onFocus:tt,onPaste:Ke,inputRef:He,enableAccessibleFieldDOMStructure:!1,placeholder:Gt,inputMode:wt,autoComplete:"off",value:It?"":Ft,onChange:ft}}},xH=e=>{const r=Ei(),{internalProps:a,internalProps:{unstableFieldRef:u,minutesStep:g,enableAccessibleFieldDOMStructure:_=!1,disabled:M=!1,readOnly:D=!1},forwardedProps:{onKeyDown:i,error:j,clearable:H,onClear:q},fieldValueManager:X,valueManager:se,validator:ne}=e,le=fs(),de=dH(e),{state:te,activeSectionIndex:Q,parsedSelectedSections:K,setSelectedSections:ce,clearValue:fe,clearActiveSection:Ie,updateSectionValue:Ce,setTempAndroidValueStr:we,sectionsValueBoundaries:ot,localizedDigits:oe,timezone:ve}=de,je=pH({sections:te.sections,updateSectionValue:Ce,sectionsValueBoundaries:ot,localizedDigits:oe,setTempAndroidValueStr:we,timezone:ve}),{resetCharacterQuery:He}=je,Le=se.areValuesEqual(r,te.value,se.emptyValue),ze=_?gH:_H,Pe=Y.useMemo(()=>Y7(te.sections,le&&!_),[te.sections,le,_]),{returnedValue:tt,interactions:De}=ze(vt({},e,de,je,{areAllSectionsEmpty:Le,sectionOrder:Pe})),Ke=Ar(Rt=>{if(i==null||i(Rt),!M)switch(!0){case((Rt.ctrlKey||Rt.metaKey)&&String.fromCharCode(Rt.keyCode)==="A"&&!Rt.shiftKey&&!Rt.altKey):{Rt.preventDefault(),ce("all");break}case Rt.key==="ArrowRight":{if(Rt.preventDefault(),K==null)ce(Pe.startIndex);else if(K==="all")ce(Pe.endIndex);else{const It=Pe.neighbors[K].rightIndex;It!==null&&ce(It)}break}case Rt.key==="ArrowLeft":{if(Rt.preventDefault(),K==null)ce(Pe.endIndex);else if(K==="all")ce(Pe.startIndex);else{const It=Pe.neighbors[K].leftIndex;It!==null&&ce(It)}break}case Rt.key==="Delete":{if(Rt.preventDefault(),D)break;K==null||K==="all"?fe():Ie(),He();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(Rt.key):{if(Rt.preventDefault(),D||Q==null)break;K==="all"&&ce(Q);const It=te.sections[Q],zt=X.getActiveDateManager(r,te,It),At=$7(r,ve,It,Rt.key,ot,oe,zt.date,{minutesStep:g});Ce({activeSection:It,newSectionValue:At,shouldGoToNextSection:!1});break}}});io(()=>{De.syncSelectionToDOM()});const{hasValidationError:Ge}=w4({props:a,validator:ne,timezone:ve,value:te.value,onError:a.onError}),ft=Y.useMemo(()=>j!==void 0?j:Ge,[Ge,j]);Y.useEffect(()=>{!ft&&Q==null&&He()},[te.referenceValue,Q,ft]),Y.useEffect(()=>{te.tempValueStrAndroid!=null&&Q!=null&&(He(),Ie())},[te.sections]),Y.useImperativeHandle(u,()=>({getSections:()=>te.sections,getActiveSectionIndex:De.getActiveSectionIndexFromDOM,setSelectedSections:De.setSelectedSections,focusField:De.focusField,isFieldFocused:De.isFieldFocused}));const Gt=Ar((Rt,...It)=>{Rt.preventDefault(),q==null||q(Rt,...It),fe(),De.isFieldFocused()?ce(Pe.startIndex):De.focusField(0)}),Ft={onKeyDown:Ke,onClear:Gt,error:ft,clearable:!!(H&&!Le&&!D&&!M)},wt={disabled:M,readOnly:D};return vt({},e.forwardedProps,Ft,wt,tt)},vH=si(L.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),bH=si(L.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),wH=si(L.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight");si(L.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");si(L.jsxs(Y.Fragment,{children:[L.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),L.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock");const SH=si(L.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange"),TH=si(L.jsxs(Y.Fragment,{children:[L.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),L.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time"),CH=si(L.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear"),MH=["clearable","onClear","InputProps","sx","slots","slotProps"],EH=["ownerState"],IH=e=>{const r=nl(),{clearable:a,onClear:u,InputProps:g,sx:_,slots:M,slotProps:D}=e,i=Sn(e,MH),j=(M==null?void 0:M.clearButton)??Sf,H=jn({elementType:j,externalSlotProps:D==null?void 0:D.clearButton,ownerState:{},className:"clearButton",additionalProps:{title:r.fieldClearLabel}}),q=Sn(H,EH),X=(M==null?void 0:M.clearIcon)??CH,se=jn({elementType:X,externalSlotProps:D==null?void 0:D.clearIcon,ownerState:{}});return vt({},i,{InputProps:vt({},g,{endAdornment:L.jsxs(Y.Fragment,{children:[a&&L.jsx(x8,{position:"end",sx:{marginRight:g!=null&&g.endAdornment?-1:-1.5},children:L.jsx(j,vt({},q,{onClick:u,children:L.jsx(X,vt({fontSize:"small"},se))}))}),g==null?void 0:g.endAdornment]})}),sx:[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(_)?_:[_]]})},kH=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator"],PH=(e,r)=>Y.useMemo(()=>{const a=vt({},e),u={},g=_=>{a.hasOwnProperty(_)&&(u[_]=a[_],delete a[_])};return kH.forEach(g),_4.forEach(g),x4.forEach(g),v4.forEach(g),{forwardedProps:a,internalProps:u}},[e,r]),AH=Y.createContext(null);function DH(e){const{contextValue:r,localeText:a,children:u}=e;return L.jsx(AH.Provider,{value:r,children:L.jsx(u4,{localeText:a,children:u})})}const RH=e=>{const r=Ei(),a=$y(),g=e.ampm??r.is12HourCycleInCurrentLocale()?r.formats.keyboardDateTime12h:r.formats.keyboardDateTime24h;return vt({},e,{disablePast:e.disablePast??!1,disableFuture:e.disableFuture??!1,format:e.format??g,disableIgnoringDatePartForTimeValidation:!!(e.minDateTime||e.maxDateTime),minDate:Ca(r,e.minDateTime??e.minDate,a.minDate),maxDate:Ca(r,e.maxDateTime??e.maxDate,a.maxDate),minTime:e.minDateTime??e.minTime,maxTime:e.maxDateTime??e.maxTime})},LH=e=>{const r=RH(e),{forwardedProps:a,internalProps:u}=PH(r,"date-time");return xH({forwardedProps:a,internalProps:u,valueManager:qs,fieldValueManager:Q7,validator:eM,valueType:"date-time"})},zH=["enableAccessibleFieldDOMStructure"],OH=["InputProps","readOnly"],FH=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef"],BH=e=>{let{enableAccessibleFieldDOMStructure:r}=e,a=Sn(e,zH);if(r){const{InputProps:q,readOnly:X}=a,se=Sn(a,OH);return vt({},se,{InputProps:vt({},q??{},{readOnly:X})})}const{onPaste:u,onKeyDown:g,inputMode:_,readOnly:M,InputProps:D,inputProps:i,inputRef:j}=a,H=Sn(a,FH);return vt({},H,{InputProps:vt({},D??{},{readOnly:M}),inputProps:vt({},i??{},{inputMode:_,onPaste:u,onKeyDown:g,ref:j})})},jH=["slots","slotProps","InputProps","inputProps"],NH=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiDateTimeField"}),{slots:g,slotProps:_,InputProps:M,inputProps:D}=u,i=Sn(u,jH),j=u,H=(g==null?void 0:g.textField)??(r.enableAccessibleFieldDOMStructure?S7:ws),q=jn({elementType:H,externalSlotProps:_==null?void 0:_.textField,externalForwardedProps:i,ownerState:j,additionalProps:{ref:a}});q.inputProps=vt({},D,q.inputProps),q.InputProps=vt({},M,q.InputProps);const X=LH(q),se=BH(X),ne=IH(vt({},se,{slots:g,slotProps:_}));return L.jsx(H,vt({},ne))});function VH(e){return Ir("MuiDateTimePickerTabs",e)}Mr("MuiDateTimePickerTabs",["root"]);const $H=e=>yv(e)?"date":"time",UH=e=>e==="date"?"day":"hours",WH=e=>{const{classes:r}=e;return Er({root:["root"]},VH,r)},GH=bt(EG,{name:"MuiDateTimePickerTabs",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>({boxShadow:`0 -1px 0 0 inset ${(e.vars||e).palette.divider}`,"&:last-child":{boxShadow:`0 1px 0 0 inset ${(e.vars||e).palette.divider}`,[`& .${Ax.indicator}`]:{bottom:"auto",top:0}}})),HH=function(r){const a=oi({props:r,name:"MuiDateTimePickerTabs"}),{dateIcon:u=L.jsx(SH,{}),onViewChange:g,timeIcon:_=L.jsx(TH,{}),view:M,hidden:D=typeof window>"u"||window.innerHeight<667,className:i,sx:j}=a,H=nl(),q=WH(a),X=(se,ne)=>{g(UH(ne))};return D?null:L.jsxs(GH,{ownerState:a,variant:"fullWidth",value:$H(M),onChange:X,className:rr(i,q.root),sx:j,children:[L.jsx($A,{value:"date","aria-label":H.dateTableLabel,icon:L.jsx(Y.Fragment,{children:u})}),L.jsx($A,{value:"time","aria-label":H.timeTableLabel,icon:L.jsx(Y.Fragment,{children:_})})]})};function qH(e){return Ir("MuiPickersToolbarText",e)}const _T=Mr("MuiPickersToolbarText",["root","selected"]),ZH=["className","selected","value"],YH=e=>{const{classes:r,selected:a}=e;return Er({root:["root",a&&"selected"]},qH,r)},XH=bt(nn,{name:"MuiPickersToolbarText",slot:"Root",overridesResolver:(e,r)=>[r.root,{[`&.${_T.selected}`]:r.selected}]})(({theme:e})=>({transition:e.transitions.create("color"),color:(e.vars||e).palette.text.secondary,[`&.${_T.selected}`]:{color:(e.vars||e).palette.text.primary}})),S4=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersToolbarText"}),{className:g,value:_}=u,M=Sn(u,ZH),D=YH(u);return L.jsx(XH,vt({ref:a,className:rr(D.root,g),component:"span"},M,{children:_}))});function T4(e){return Ir("MuiPickersToolbar",e)}const KH=Mr("MuiPickersToolbar",["root","content"]),JH=["children","className","toolbarTitle","hidden","titleId","isLandscape","classes","landscapeDirection"],QH=e=>{const{classes:r}=e;return Er({root:["root"],content:["content"]},T4,r)},eq=bt("div",{name:"MuiPickersToolbar",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:e.spacing(2,3),variants:[{props:{isLandscape:!0},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]})),tq=bt("div",{name:"MuiPickersToolbar",slot:"Content",overridesResolver:(e,r)=>r.content})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{isLandscape:!0},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{isLandscape:!0,landscapeDirection:"row"},style:{flexDirection:"row"}}]}),rq=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersToolbar"}),{children:g,className:_,toolbarTitle:M,hidden:D,titleId:i}=u,j=Sn(u,JH),H=u,q=QH(H);return D?null:L.jsxs(eq,vt({ref:a,className:rr(q.root,_),ownerState:H},j,{children:[L.jsx(nn,{color:"text.secondary",variant:"overline",id:i,children:M}),L.jsx(tq,{className:q.content,ownerState:H,children:g})]}))}),nq=["align","className","selected","typographyClassName","value","variant","width"],iq=e=>{const{classes:r}=e;return Er({root:["root"]},T4,r)},oq=bt(va,{name:"MuiPickersToolbarButton",slot:"Root",overridesResolver:(e,r)=>r.root})({padding:0,minWidth:16,textTransform:"none"}),fu=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersToolbarButton"}),{align:g,className:_,selected:M,typographyClassName:D,value:i,variant:j,width:H}=u,q=Sn(u,nq),X=iq(u);return L.jsx(oq,vt({variant:"text",ref:a,className:rr(X.root,_)},H?{sx:{width:H}}:{},q,{children:L.jsx(S4,{align:g,className:D,variant:j,value:i,selected:M})}))});function sq(e){return Ir("MuiDateTimePickerToolbar",e)}const aS=Mr("MuiDateTimePickerToolbar",["root","dateContainer","timeContainer","timeDigitsContainer","separator","timeLabelReverse","ampmSelection","ampmLandscape","ampmLabel"]);function aq(e,{disableFuture:r,maxDate:a,timezone:u}){const g=Ei();return Y.useMemo(()=>{const _=g.date(void 0,u),M=g.startOfMonth(r&&g.isBefore(_,a)?_:a);return!g.isAfter(M,e)},[r,a,e,g,u])}function lq(e,{disablePast:r,minDate:a,timezone:u}){const g=Ei();return Y.useMemo(()=>{const _=g.date(void 0,u),M=g.startOfMonth(r&&g.isAfter(_,a)?_:a);return!g.isBefore(M,e)},[r,a,e,g,u])}function C4(e,r,a,u){const g=Ei(),_=z7(e,g),M=Y.useCallback(D=>{const i=e==null?null:O7(e,D,!!r,g);a(i,"partial")},[r,e,a,u,g]);return{meridiemMode:_,handleMeridiemChange:M}}const Sy=36,k1=2,P1=320,cq=280,rM=336,ux=48,uq=["ampm","ampmInClock","value","onChange","view","isLandscape","onViewChange","toolbarFormat","toolbarPlaceholder","views","disabled","readOnly","toolbarVariant","toolbarTitle","className"],dq=e=>{const{classes:r,isLandscape:a,isRtl:u}=e;return Er({root:["root"],dateContainer:["dateContainer"],timeContainer:["timeContainer",u&&"timeLabelReverse"],timeDigitsContainer:["timeDigitsContainer",u&&"timeLabelReverse"],separator:["separator"],ampmSelection:["ampmSelection",a&&"ampmLandscape"],ampmLabel:["ampmLabel"]},sq,r)},hq=bt(rq,{name:"MuiDateTimePickerToolbar",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>({paddingLeft:16,paddingRight:16,justifyContent:"space-around",position:"relative",variants:[{props:{toolbarVariant:"desktop"},style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,[`& .${KH.content} .${_T.selected}`]:{color:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightBold}}},{props:{toolbarVariant:"desktop",isLandscape:!0},style:{borderRight:`1px solid ${(e.vars||e).palette.divider}`}},{props:{toolbarVariant:"desktop",isLandscape:!1},style:{paddingLeft:24,paddingRight:0}}]})),pq=bt("div",{name:"MuiDateTimePickerToolbar",slot:"DateContainer",overridesResolver:(e,r)=>r.dateContainer})({display:"flex",flexDirection:"column",alignItems:"flex-start"}),fq=bt("div",{name:"MuiDateTimePickerToolbar",slot:"TimeContainer",overridesResolver:(e,r)=>r.timeContainer})({display:"flex",flexDirection:"row",variants:[{props:{isRtl:!0},style:{flexDirection:"row-reverse"}},{props:{toolbarVariant:"desktop",isLandscape:!1},style:{gap:9,marginRight:4,alignSelf:"flex-end"}},{props:({isLandscape:e,toolbarVariant:r})=>e&&r!=="desktop",style:{flexDirection:"column"}},{props:({isLandscape:e,toolbarVariant:r,isRtl:a})=>e&&r!=="desktop"&&a,style:{flexDirection:"column-reverse"}}]}),mq=bt("div",{name:"MuiDateTimePickerToolbar",slot:"TimeDigitsContainer",overridesResolver:(e,r)=>r.timeDigitsContainer})({display:"flex",variants:[{props:{isRtl:!0},style:{flexDirection:"row-reverse"}},{props:{toolbarVariant:"desktop"},style:{gap:1.5}}]}),sD=bt(S4,{name:"MuiDateTimePickerToolbar",slot:"Separator",overridesResolver:(e,r)=>r.separator})({margin:"0 4px 0 2px",cursor:"default",variants:[{props:{toolbarVariant:"desktop"},style:{margin:0}}]}),gq=bt("div",{name:"MuiDateTimePickerToolbar",slot:"AmPmSelection",overridesResolver:(e,r)=>[{[`.${aS.ampmLabel}`]:r.ampmLabel},{[`&.${aS.ampmLandscape}`]:r.ampmLandscape},r.ampmSelection]})({display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:12,[`& .${aS.ampmLabel}`]:{fontSize:17},variants:[{props:{isLandscape:!0},style:{margin:"4px 0 auto",flexDirection:"row",justifyContent:"space-around",width:"100%"}}]});function yq(e){const r=oi({props:e,name:"MuiDateTimePickerToolbar"}),{ampm:a,ampmInClock:u,value:g,onChange:_,view:M,isLandscape:D,onViewChange:i,toolbarFormat:j,toolbarPlaceholder:H="",views:q,disabled:X,readOnly:se,toolbarVariant:ne="mobile",toolbarTitle:le,className:de}=r,te=Sn(r,uq),Q=fs(),K=vt({},r,{isRtl:Q}),ce=Ei(),{meridiemMode:fe,handleMeridiemChange:Ie}=C4(g,a,_),Ce=!!(a&&!u),we=ne==="desktop",ot=nl(),oe=dq(K),ve=le??ot.dateTimePickerToolbarTitle,je=Le=>a?ce.format(Le,"hours12h"):ce.format(Le,"hours24h"),He=Y.useMemo(()=>g?j?ce.formatByString(g,j):ce.format(g,"shortDate"):H,[g,j,H,ce]);return L.jsxs(hq,vt({isLandscape:D,className:rr(oe.root,de),toolbarTitle:ve},te,{ownerState:K,children:[L.jsxs(pq,{className:oe.dateContainer,ownerState:K,children:[q.includes("year")&&L.jsx(fu,{tabIndex:-1,variant:"subtitle1",onClick:()=>i("year"),selected:M==="year",value:g?ce.format(g,"year"):""}),q.includes("day")&&L.jsx(fu,{tabIndex:-1,variant:we?"h5":"h4",onClick:()=>i("day"),selected:M==="day",value:He})]}),L.jsxs(fq,{className:oe.timeContainer,ownerState:K,children:[L.jsxs(mq,{className:oe.timeDigitsContainer,ownerState:K,children:[q.includes("hours")&&L.jsxs(Y.Fragment,{children:[L.jsx(fu,{variant:we?"h5":"h3",width:we&&!D?ux:void 0,onClick:()=>i("hours"),selected:M==="hours",value:g?je(g):"--"}),L.jsx(sD,{variant:we?"h5":"h3",value:":",className:oe.separator,ownerState:K}),L.jsx(fu,{variant:we?"h5":"h3",width:we&&!D?ux:void 0,onClick:()=>i("minutes"),selected:M==="minutes"||!q.includes("minutes")&&M==="hours",value:g?ce.format(g,"minutes"):"--",disabled:!q.includes("minutes")})]}),q.includes("seconds")&&L.jsxs(Y.Fragment,{children:[L.jsx(sD,{variant:we?"h5":"h3",value:":",className:oe.separator,ownerState:K}),L.jsx(fu,{variant:we?"h5":"h3",width:we&&!D?ux:void 0,onClick:()=>i("seconds"),selected:M==="seconds",value:g?ce.format(g,"seconds"):"--"})]})]}),Ce&&!we&&L.jsxs(gq,{className:oe.ampmSelection,ownerState:K,children:[L.jsx(fu,{variant:"subtitle2",selected:fe==="am",typographyClassName:oe.ampmLabel,value:$d(ce,"am"),onClick:se?void 0:()=>Ie("am"),disabled:X}),L.jsx(fu,{variant:"subtitle2",selected:fe==="pm",typographyClassName:oe.ampmLabel,value:$d(ce,"pm"),onClick:se?void 0:()=>Ie("pm"),disabled:X})]}),a&&we&&L.jsx(fu,{variant:"h5",onClick:()=>i("meridiem"),selected:M==="meridiem",value:g&&fe?$d(ce,fe):"--",width:ux})]})]}))}function _q(e,r){var D;const a=Ei(),u=$y(),g=oi({props:e,name:r}),_=g.ampm??a.is12HourCycleInCurrentLocale(),M=Y.useMemo(()=>{var i;return((i=g.localeText)==null?void 0:i.toolbarTitle)==null?g.localeText:vt({},g.localeText,{dateTimePickerToolbarTitle:g.localeText.toolbarTitle})},[g.localeText]);return vt({},g,k7({views:g.views,openTo:g.openTo,defaultViews:["year","day","hours","minutes"],defaultOpenTo:"day"}),{ampm:_,localeText:M,orientation:g.orientation??"portrait",disableIgnoringDatePartForTimeValidation:g.disableIgnoringDatePartForTimeValidation??!!(g.minDateTime||g.maxDateTime||g.disablePast||g.disableFuture),disableFuture:g.disableFuture??!1,disablePast:g.disablePast??!1,minDate:Ca(a,g.minDateTime??g.minDate,u.minDate),maxDate:Ca(a,g.maxDateTime??g.maxDate,u.maxDate),minTime:g.minDateTime??g.minTime,maxTime:g.maxDateTime??g.maxTime,slots:vt({toolbar:yq,tabs:HH},g.slots),slotProps:vt({},g.slotProps,{toolbar:vt({ampm:_},(D=g.slotProps)==null?void 0:D.toolbar)})})}const xq=bt(Ia)({[`& .${Kg.container}`]:{outline:0},[`& .${Kg.paper}`]:{outline:0,minWidth:P1}}),vq=bt(k3)({"&:first-of-type":{padding:0}});function bq(e){const{children:r,onDismiss:a,open:u,slots:g,slotProps:_}=e,M=(g==null?void 0:g.dialog)??xq,D=(g==null?void 0:g.mobileTransition)??By;return L.jsx(M,vt({open:u,onClose:a},_==null?void 0:_.dialog,{TransitionComponent:D,TransitionProps:_==null?void 0:_.mobileTransition,PaperComponent:g==null?void 0:g.mobilePaper,PaperProps:_==null?void 0:_.mobilePaper,children:L.jsx(vq,{children:r})}))}const wq=({open:e,onOpen:r,onClose:a})=>{const u=Y.useRef(typeof e=="boolean").current,[g,_]=Y.useState(!1);Y.useEffect(()=>{if(u){if(typeof e!="boolean")throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");_(e)}},[u,e]);const M=Y.useCallback(D=>{u||_(D),D&&r&&r(),!D&&a&&a()},[u,r,a]);return{isOpen:g,setIsOpen:M}},Sq=e=>{const{action:r,hasChanged:a,dateState:u,isControlled:g}=e,_=!g&&!u.hasBeenModifiedSinceMount;return r.name==="setValueFromField"?!0:r.name==="setValueFromAction"?_&&["accept","today","clear"].includes(r.pickerAction)?!0:a(u.lastPublishedValue):r.name==="setValueFromView"&&r.selectionState!=="shallow"||r.name==="setValueFromShortcut"?_?!0:a(u.lastPublishedValue):!1},Tq=e=>{const{action:r,hasChanged:a,dateState:u,isControlled:g,closeOnSelect:_}=e,M=!g&&!u.hasBeenModifiedSinceMount;return r.name==="setValueFromAction"?M&&["accept","today","clear"].includes(r.pickerAction)?!0:a(u.lastCommittedValue):r.name==="setValueFromView"&&r.selectionState==="finish"&&_?M?!0:a(u.lastCommittedValue):r.name==="setValueFromShortcut"?r.changeImportance==="accept"&&a(u.lastCommittedValue):!1},Cq=e=>{const{action:r,closeOnSelect:a}=e;return r.name==="setValueFromAction"?!0:r.name==="setValueFromView"?r.selectionState==="finish"&&a:r.name==="setValueFromShortcut"?r.changeImportance==="accept":!1},Mq=({props:e,valueManager:r,valueType:a,wrapperVariant:u,validator:g})=>{const{onAccept:_,onChange:M,value:D,defaultValue:i,closeOnSelect:j=u==="desktop",timezone:H,referenceDate:q}=e,{current:X}=Y.useRef(i),{current:se}=Y.useRef(D!==void 0),[ne,le]=Y.useState(H),de=Ei(),te=rh(),{isOpen:Q,setIsOpen:K}=wq(e),{timezone:ce,value:fe,handleValueChange:Ie}=tM({timezone:H,value:D,defaultValue:X,referenceDate:q,onChange:M,valueManager:r}),[Ce,we]=Y.useState(()=>{let kt;return fe!==void 0?kt=fe:X!==void 0?kt=X:kt=r.emptyValue,{draft:kt,lastPublishedValue:kt,lastCommittedValue:kt,lastControlledValue:D,hasBeenModifiedSinceMount:!1}}),ot=r.getTimezone(de,Ce.draft);ne!==H&&(le(H),H&&ot&&H!==ot&&we(kt=>vt({},kt,{draft:r.setTimezone(de,H,kt.draft)})));const{getValidationErrorForNewValue:oe}=w4({props:e,validator:g,timezone:ce,value:Ce.draft,onError:e.onError}),ve=Ar(kt=>{const Ot={action:kt,dateState:Ce,hasChanged:qt=>!r.areValuesEqual(de,kt.value,qt),isControlled:se,closeOnSelect:j},be=Sq(Ot),Ht=Tq(Ot),xt=Cq(Ot);we(qt=>vt({},qt,{draft:kt.value,lastPublishedValue:be?kt.value:qt.lastPublishedValue,lastCommittedValue:Ht?kt.value:qt.lastCommittedValue,hasBeenModifiedSinceMount:!0}));let Bt=null;const rt=()=>(Bt||(Bt={validationError:kt.name==="setValueFromField"?kt.context.validationError:oe(kt.value)},kt.name==="setValueFromShortcut"&&(Bt.shortcut=kt.shortcut)),Bt);be&&Ie(kt.value,rt()),Ht&&_&&_(kt.value,rt()),xt&&K(!1)});if(Ce.lastControlledValue!==D){const kt=r.areValuesEqual(de,Ce.draft,fe);we(Ot=>vt({},Ot,{lastControlledValue:D},kt?{}:{lastCommittedValue:fe,lastPublishedValue:fe,draft:fe,hasBeenModifiedSinceMount:!0}))}const je=Ar(()=>{ve({value:r.emptyValue,name:"setValueFromAction",pickerAction:"clear"})}),He=Ar(()=>{ve({value:Ce.lastPublishedValue,name:"setValueFromAction",pickerAction:"accept"})}),Le=Ar(()=>{ve({value:Ce.lastPublishedValue,name:"setValueFromAction",pickerAction:"dismiss"})}),ze=Ar(()=>{ve({value:Ce.lastCommittedValue,name:"setValueFromAction",pickerAction:"cancel"})}),Pe=Ar(()=>{ve({value:r.getTodayValue(de,ce,a),name:"setValueFromAction",pickerAction:"today"})}),tt=Ar(kt=>{kt.preventDefault(),K(!0)}),De=Ar(kt=>{kt==null||kt.preventDefault(),K(!1)}),Ke=Ar((kt,Ot="partial")=>ve({name:"setValueFromView",value:kt,selectionState:Ot})),Ge=Ar((kt,Ot,be)=>ve({name:"setValueFromShortcut",value:kt,changeImportance:Ot,shortcut:be})),ft=Ar((kt,Ot)=>ve({name:"setValueFromField",value:kt,context:Ot})),Gt={onClear:je,onAccept:He,onDismiss:Le,onCancel:ze,onSetToday:Pe,onOpen:tt,onClose:De},Ft={value:Ce.draft,onChange:ft},wt=Y.useMemo(()=>r.cleanValue(de,Ce.draft),[de,r,Ce.draft]),Rt={value:wt,onChange:Ke,onClose:De,open:Q},zt=vt({},Gt,{value:wt,onChange:Ke,onSelectShortcut:Ge,isValid:kt=>{const Ot=g({adapter:te,value:kt,timezone:ce,props:e});return!r.hasError(Ot)}}),At=Y.useMemo(()=>({onOpen:tt,onClose:De,open:Q}),[Q,De,tt]);return{open:Q,fieldProps:Ft,viewProps:Rt,layoutProps:zt,actions:Gt,contextValue:At}};function nM({onChange:e,onViewChange:r,openTo:a,view:u,views:g,autoFocus:_,focusedView:M,onFocusedViewChange:D}){const i=Y.useRef(a),j=Y.useRef(g),H=Y.useRef(g.includes(a)?a:g[0]),[q,X]=tl({name:"useViews",state:"view",controlled:u,default:H.current}),se=Y.useRef(_?q:null),[ne,le]=tl({name:"useViews",state:"focusedView",controlled:M,default:se.current});Y.useEffect(()=>{(i.current&&i.current!==a||j.current&&j.current.some(Ce=>!g.includes(Ce)))&&(X(g.includes(a)?a:g[0]),j.current=g,i.current=a)},[a,X,q,g]);const de=g.indexOf(q),te=g[de-1]??null,Q=g[de+1]??null,K=Ar((Ce,we)=>{le(we?Ce:ot=>Ce===ot?null:ot),D==null||D(Ce,we)}),ce=Ar(Ce=>{K(Ce,!0),Ce!==q&&(X(Ce),r&&r(Ce))}),fe=Ar(()=>{Q&&ce(Q)}),Ie=Ar((Ce,we,ot)=>{const oe=we==="finish",ve=ot?g.indexOf(ot)<g.length-1:!!Q;if(e(Ce,oe&&ve?"partial":we,ot),ot&&ot!==q){const He=g[g.indexOf(ot)+1];He&&ce(He)}else oe&&fe()});return{view:q,setView:ce,focusedView:ne,setFocusedView:K,nextView:Q,previousView:te,defaultView:g.includes(a)?a:g[0],goToNextView:fe,setValueAndGoToNextView:Ie}}const Eq=["className","sx"],Iq=({props:e,propsFromPickerValue:r,additionalViewProps:a,autoFocusView:u,rendererInterceptor:g,fieldRef:_})=>{const{onChange:M,open:D,onClose:i}=r,{view:j,views:H,openTo:q,onViewChange:X,viewRenderers:se,timezone:ne}=e,le=Sn(e,Eq),{view:de,setView:te,defaultView:Q,focusedView:K,setFocusedView:ce,setValueAndGoToNextView:fe}=nM({view:j,views:H,openTo:q,onChange:M,onViewChange:X,autoFocus:u}),{hasUIView:Ie,viewModeLookup:Ce}=Y.useMemo(()=>H.reduce((Le,ze)=>{let Pe;return se[ze]!=null?Pe="UI":Pe="field",Le.viewModeLookup[ze]=Pe,Pe==="UI"&&(Le.hasUIView=!0),Le},{hasUIView:!1,viewModeLookup:{}}),[se,H]),we=Y.useMemo(()=>H.reduce((Le,ze)=>se[ze]!=null&&_v(ze)?Le+1:Le,0),[se,H]),ot=Ce[de],oe=Ar(()=>ot==="UI"),[ve,je]=Y.useState(ot==="UI"?de:null);return ve!==de&&Ce[de]==="UI"&&je(de),io(()=>{ot==="field"&&D&&(i(),setTimeout(()=>{var Le,ze;(Le=_==null?void 0:_.current)==null||Le.setSelectedSections(de),(ze=_==null?void 0:_.current)==null||ze.focusField(de)}))},[de]),io(()=>{if(!D)return;let Le=de;ot==="field"&&ve!=null&&(Le=ve),Le!==Q&&Ce[Le]==="UI"&&Ce[Q]==="UI"&&(Le=Q),Le!==de&&te(Le),ce(Le,!0)},[D]),{hasUIView:Ie,shouldRestoreFocus:oe,layoutProps:{views:H,view:ve,onViewChange:te},renderCurrentView:()=>{if(ve==null)return null;const Le=se[ve];if(Le==null)return null;const ze=vt({},le,a,r,{views:H,timezone:ne,onChange:fe,view:ve,onViewChange:te,focusedView:K,onFocusedViewChange:ce,showViewSwitcher:we>1,timeViewsCount:we});return g?g(se,ve,ze):Le(ze)}}};function aD(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}const kq=(e,r)=>{const[a,u]=Y.useState(aD);return io(()=>{const _=()=>{u(aD())};return window.addEventListener("orientationchange",_),()=>{window.removeEventListener("orientationchange",_)}},[]),fH(e,["hours","minutes","seconds"])?!1:(r||a)==="landscape"},Pq=({props:e,propsFromPickerValue:r,propsFromPickerViews:a,wrapperVariant:u})=>{const{orientation:g}=e,_=kq(a.views,g),M=fs();return{layoutProps:vt({},a,r,{isLandscape:_,isRtl:M,wrapperVariant:u,disabled:e.disabled,readOnly:e.readOnly})}};function Aq(e){const{props:r,pickerValueResponse:a}=e;return Y.useMemo(()=>({value:a.viewProps.value,open:a.open,disabled:r.disabled??!1,readOnly:r.readOnly??!1}),[a.viewProps.value,a.open,r.disabled,r.readOnly])}const Dq=({props:e,valueManager:r,valueType:a,wrapperVariant:u,additionalViewProps:g,validator:_,autoFocusView:M,rendererInterceptor:D,fieldRef:i})=>{const j=Mq({props:e,valueManager:r,valueType:a,wrapperVariant:u,validator:_}),H=Iq({props:e,additionalViewProps:g,autoFocusView:M,fieldRef:i,propsFromPickerValue:j.viewProps,rendererInterceptor:D}),q=Pq({props:e,wrapperVariant:u,propsFromPickerValue:j.layoutProps,propsFromPickerViews:H.layoutProps}),X=Aq({props:e,pickerValueResponse:j});return{open:j.open,actions:j.actions,fieldProps:j.fieldProps,renderCurrentView:H.renderCurrentView,hasUIView:H.hasUIView,shouldRestoreFocus:H.shouldRestoreFocus,layoutProps:q.layoutProps,contextValue:j.contextValue,ownerState:X}};function M4(e){return Ir("MuiPickersLayout",e)}const Ad=Mr("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),Rq=["onAccept","onClear","onCancel","onSetToday","actions"];function Lq(e){const{onAccept:r,onClear:a,onCancel:u,onSetToday:g,actions:_}=e,M=Sn(e,Rq),D=nl();if(_==null||_.length===0)return null;const i=_==null?void 0:_.map(j=>{switch(j){case"clear":return L.jsx(va,{onClick:a,children:D.clearButtonLabel},j);case"cancel":return L.jsx(va,{onClick:u,children:D.cancelButtonLabel},j);case"accept":return L.jsx(va,{onClick:r,children:D.okButtonLabel},j);case"today":return L.jsx(va,{onClick:g,children:D.todayButtonLabel},j);default:return null}});return L.jsx(T3,vt({},M,{children:i}))}const zq=["items","changeImportance","isLandscape","onChange","isValid"],Oq=["getValue"];function Fq(e){const{items:r,changeImportance:a="accept",onChange:u,isValid:g}=e,_=Sn(e,zq);if(r==null||r.length===0)return null;const M=r.map(D=>{let{getValue:i}=D,j=Sn(D,Oq);const H=i({isValid:g});return vt({},j,{label:j.label,onClick:()=>{u(H,a,j)},disabled:!g(H)})});return L.jsx(Ns,vt({dense:!0,sx:[{maxHeight:rM,maxWidth:200,overflow:"auto"},...Array.isArray(_.sx)?_.sx:[_.sx]]},_,{children:M.map(D=>L.jsx(Vn,{children:L.jsx(aU,vt({},D))},D.id??D.label))}))}function Bq(e){return e.view!==null}const jq=e=>{const{classes:r,isLandscape:a}=e;return Er({root:["root",a&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},M4,r)},Nq=e=>{const{wrapperVariant:r,onAccept:a,onClear:u,onCancel:g,onSetToday:_,view:M,views:D,onViewChange:i,value:j,onChange:H,onSelectShortcut:q,isValid:X,isLandscape:se,disabled:ne,readOnly:le,children:de,slots:te,slotProps:Q}=e,K=jq(e),ce=(te==null?void 0:te.actionBar)??Lq,fe=jn({elementType:ce,externalSlotProps:Q==null?void 0:Q.actionBar,additionalProps:{onAccept:a,onClear:u,onCancel:g,onSetToday:_,actions:r==="desktop"?[]:["cancel","accept"]},className:K.actionBar,ownerState:vt({},e,{wrapperVariant:r})}),Ie=L.jsx(ce,vt({},fe)),Ce=te==null?void 0:te.toolbar,we=jn({elementType:Ce,externalSlotProps:Q==null?void 0:Q.toolbar,additionalProps:{isLandscape:se,onChange:H,value:j,view:M,onViewChange:i,views:D,disabled:ne,readOnly:le},className:K.toolbar,ownerState:vt({},e,{wrapperVariant:r})}),ot=Bq(we)&&Ce?L.jsx(Ce,vt({},we)):null,oe=de,ve=te==null?void 0:te.tabs,je=M&&ve?L.jsx(ve,vt({view:M,onViewChange:i,className:K.tabs},Q==null?void 0:Q.tabs)):null,He=(te==null?void 0:te.shortcuts)??Fq,Le=jn({elementType:He,externalSlotProps:Q==null?void 0:Q.shortcuts,additionalProps:{isValid:X,isLandscape:se,onChange:q},className:K.shortcuts,ownerState:{isValid:X,isLandscape:se,onChange:q,wrapperVariant:r}}),ze=M&&He?L.jsx(He,vt({},Le)):null;return{toolbar:ot,content:oe,tabs:je,actionBar:Ie,shortcuts:ze}},Vq=e=>{const{isLandscape:r,classes:a}=e;return Er({root:["root",r&&"landscape"],contentWrapper:["contentWrapper"]},M4,a)},$q=bt("div",{name:"MuiPickersLayout",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${Ad.actionBar}`]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{isLandscape:!0},style:{[`& .${Ad.toolbar}`]:{gridColumn:1,gridRow:"2 / 3"},[`.${Ad.shortcuts}`]:{gridColumn:"2 / 4",gridRow:1}}},{props:{isLandscape:!0,isRtl:!0},style:{[`& .${Ad.toolbar}`]:{gridColumn:3}}},{props:{isLandscape:!1},style:{[`& .${Ad.toolbar}`]:{gridColumn:"2 / 4",gridRow:1},[`& .${Ad.shortcuts}`]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{isLandscape:!1,isRtl:!0},style:{[`& .${Ad.shortcuts}`]:{gridColumn:3}}}]}),Uq=bt("div",{name:"MuiPickersLayout",slot:"ContentWrapper",overridesResolver:(e,r)=>r.contentWrapper})({gridColumn:2,gridRow:2,display:"flex",flexDirection:"column"}),Wq=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersLayout"}),{toolbar:g,content:_,tabs:M,actionBar:D,shortcuts:i}=Nq(u),{sx:j,className:H,isLandscape:q,wrapperVariant:X}=u,se=Vq(u);return L.jsxs($q,{ref:a,sx:j,className:rr(se.root,H),ownerState:u,children:[q?i:g,q?g:i,L.jsx(Uq,{className:se.contentWrapper,children:X==="desktop"?L.jsxs(Y.Fragment,{children:[_,M]}):L.jsxs(Y.Fragment,{children:[M,_]})}),D]})}),Gq=["props","getOpenDialogAriaText"],Hq=e=>{var ft;let{props:r,getOpenDialogAriaText:a}=e,u=Sn(e,Gq);const{slots:g,slotProps:_,className:M,sx:D,format:i,formatDensity:j,enableAccessibleFieldDOMStructure:H,selectedSections:q,onSelectedSectionsChange:X,timezone:se,name:ne,label:le,inputRef:de,readOnly:te,disabled:Q,localeText:K}=r,ce=Y.useRef(null),fe=Bu(),Ie=((ft=_==null?void 0:_.toolbar)==null?void 0:ft.hidden)??!1,{open:Ce,actions:we,layoutProps:ot,renderCurrentView:oe,fieldProps:ve,contextValue:je}=Dq(vt({},u,{props:r,fieldRef:ce,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"mobile"})),He=g.field,Le=jn({elementType:He,externalSlotProps:_==null?void 0:_.field,additionalProps:vt({},ve,Ie&&{id:fe},!(Q||te)&&{onClick:we.onOpen,onKeyDown:mH(we.onOpen)},{readOnly:te??!0,disabled:Q,className:M,sx:D,format:i,formatDensity:j,enableAccessibleFieldDOMStructure:H,selectedSections:q,onSelectedSectionsChange:X,timezone:se,label:le,name:ne},de?{inputRef:de}:{}),ownerState:r});Le.inputProps=vt({},Le.inputProps,{"aria-label":a(ve.value)});const ze=vt({textField:g.textField},Le.slots),Pe=g.layout??Wq;let tt=fe;Ie&&(le?tt=`${fe}-label`:tt=void 0);const De=vt({},_,{toolbar:vt({},_==null?void 0:_.toolbar,{titleId:fe}),mobilePaper:vt({"aria-labelledby":tt},_==null?void 0:_.mobilePaper)}),Ke=ai(ce,Le.unstableFieldRef);return{renderPicker:()=>L.jsxs(DH,{contextValue:je,localeText:K,children:[L.jsx(He,vt({},Le,{slots:ze,slotProps:De,unstableFieldRef:Ke})),L.jsx(bq,vt({},we,{open:Ce,slots:g,slotProps:De,children:L.jsx(Pe,vt({},ot,De==null?void 0:De.layout,{slots:g,slotProps:De,children:oe()}))}))]})}},E4=({shouldDisableDate:e,shouldDisableMonth:r,shouldDisableYear:a,minDate:u,maxDate:g,disableFuture:_,disablePast:M,timezone:D})=>{const i=rh();return Y.useCallback(j=>QC({adapter:i,value:j,timezone:D,props:{shouldDisableDate:e,shouldDisableMonth:r,shouldDisableYear:a,minDate:u,maxDate:g,disableFuture:_,disablePast:M}})!==null,[i,e,r,a,u,g,_,M,D])},qq=(e,r,a)=>(u,g)=>{switch(g.type){case"changeMonth":return vt({},u,{slideDirection:g.direction,currentMonth:g.newMonth,isMonthSwitchingAnimating:!e});case"changeMonthTimezone":{const _=g.newTimezone;if(a.getTimezone(u.currentMonth)===_)return u;let M=a.setTimezone(u.currentMonth,_);return a.getMonth(M)!==a.getMonth(u.currentMonth)&&(M=a.setMonth(M,a.getMonth(u.currentMonth))),vt({},u,{currentMonth:M})}case"finishMonthSwitchingAnimation":return vt({},u,{isMonthSwitchingAnimating:!1});case"changeFocusedDay":{if(u.focusedDay!=null&&g.focusedDay!=null&&a.isSameDay(g.focusedDay,u.focusedDay))return u;const _=g.focusedDay!=null&&!r&&!a.isSameMonth(u.currentMonth,g.focusedDay);return vt({},u,{focusedDay:g.focusedDay,isMonthSwitchingAnimating:_&&!e&&!g.withoutMonthSwitchingAnimation,currentMonth:_?a.startOfMonth(g.focusedDay):u.currentMonth,slideDirection:g.focusedDay!=null&&a.isAfterDay(g.focusedDay,u.currentMonth)?"left":"right"})}default:throw new Error("missing support")}},Zq=e=>{const{value:r,referenceDate:a,disableFuture:u,disablePast:g,disableSwitchToMonthOnDayFocus:_=!1,maxDate:M,minDate:D,onMonthChange:i,reduceAnimations:j,shouldDisableDate:H,timezone:q}=e,X=Ei(),se=Y.useRef(qq(!!j,_,X)).current,ne=Y.useMemo(()=>qs.getInitialReferenceValue({value:r,utils:X,timezone:q,props:e,referenceDate:a,granularity:Za.day}),[a,q]),[le,de]=Y.useReducer(se,{isMonthSwitchingAnimating:!1,focusedDay:ne,currentMonth:X.startOfMonth(ne),slideDirection:"left"});Y.useEffect(()=>{de({type:"changeMonthTimezone",newTimezone:X.getTimezone(ne)})},[ne,X]);const te=Y.useCallback(Ie=>{de(vt({type:"changeMonth"},Ie)),i&&i(Ie.newMonth)},[i]),Q=Y.useCallback(Ie=>{const Ce=Ie;X.isSameMonth(Ce,le.currentMonth)||te({newMonth:X.startOfMonth(Ce),direction:X.isAfterDay(Ce,le.currentMonth)?"left":"right"})},[le.currentMonth,te,X]),K=E4({shouldDisableDate:H,minDate:D,maxDate:M,disableFuture:u,disablePast:g,timezone:q}),ce=Y.useCallback(()=>{de({type:"finishMonthSwitchingAnimation"})},[]),fe=Ar((Ie,Ce)=>{K(Ie)||de({type:"changeFocusedDay",focusedDay:Ie,withoutMonthSwitchingAnimation:Ce})});return{referenceDate:ne,calendarState:le,changeMonth:Q,changeFocusedDay:fe,isDateDisabled:K,onMonthSwitchingAnimationEnd:ce,handleChangeMonth:te}},Yq=e=>Ir("MuiPickersFadeTransitionGroup",e);Mr("MuiPickersFadeTransitionGroup",["root"]);const Xq=e=>{const{classes:r}=e;return Er({root:["root"]},Yq,r)},Kq=bt(Fy,{name:"MuiPickersFadeTransitionGroup",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"block",position:"relative"});function I4(e){const r=oi({props:e,name:"MuiPickersFadeTransitionGroup"}),{children:a,className:u,reduceAnimations:g,transKey:_}=r,M=Xq(r),D=jl();return g?a:L.jsx(Kq,{className:rr(M.root,u),children:L.jsx(By,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:D.transitions.duration.enteringScreen,enter:D.transitions.duration.enteringScreen,exit:0},children:a},_)})}function Jq(e){return Ir("MuiPickersDay",e)}const Dd=Mr("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),Qq=["autoFocus","className","day","disabled","disableHighlightToday","disableMargin","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","outsideCurrentMonth","selected","showDaysOutsideCurrentMonth","children","today","isFirstVisibleCell","isLastVisibleCell"],eZ=e=>{const{selected:r,disableMargin:a,disableHighlightToday:u,today:g,disabled:_,outsideCurrentMonth:M,showDaysOutsideCurrentMonth:D,classes:i}=e,j=M&&!D;return Er({root:["root",r&&!j&&"selected",_&&"disabled",!a&&"dayWithMargin",!u&&g&&"today",M&&D&&"dayOutsideMonth",j&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},Jq,i)},k4=({theme:e})=>vt({},e.typography.caption,{width:Sy,height:Sy,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:e.transitions.create("background-color",{duration:e.transitions.duration.short}),color:(e.vars||e).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.primary.main,e.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.focusOpacity})`:Bn(e.palette.primary.main,e.palette.action.focusOpacity),[`&.${Dd.selected}`]:{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${Dd.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,fontWeight:e.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(e.vars||e).palette.primary.dark}},[`&.${Dd.disabled}:not(.${Dd.selected})`]:{color:(e.vars||e).palette.text.disabled},[`&.${Dd.disabled}&.${Dd.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${k1}px`}},{props:{outsideCurrentMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(e.vars||e).palette.text.secondary}},{props:{disableHighlightToday:!1,today:!0},style:{[`&:not(.${Dd.selected})`]:{border:`1px solid ${(e.vars||e).palette.text.secondary}`}}}]}),P4=(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disableMargin&&r.dayWithMargin,!a.disableHighlightToday&&a.today&&r.today,!a.outsideCurrentMonth&&a.showDaysOutsideCurrentMonth&&r.dayOutsideMonth,a.outsideCurrentMonth&&!a.showDaysOutsideCurrentMonth&&r.hiddenDaySpacingFiller]},tZ=bt(rl,{name:"MuiPickersDay",slot:"Root",overridesResolver:P4})(k4),rZ=bt("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:P4})(({theme:e})=>vt({},k4({theme:e}),{opacity:0,pointerEvents:"none"})),kg=()=>{},nZ=Y.forwardRef(function(r,a){const u=oi({props:r,name:"MuiPickersDay"}),{autoFocus:g=!1,className:_,day:M,disabled:D=!1,disableHighlightToday:i=!1,disableMargin:j=!1,isAnimating:H,onClick:q,onDaySelect:X,onFocus:se=kg,onBlur:ne=kg,onKeyDown:le=kg,onMouseDown:de=kg,onMouseEnter:te=kg,outsideCurrentMonth:Q,selected:K=!1,showDaysOutsideCurrentMonth:ce=!1,children:fe,today:Ie=!1}=u,Ce=Sn(u,Qq),we=vt({},u,{autoFocus:g,disabled:D,disableHighlightToday:i,disableMargin:j,selected:K,showDaysOutsideCurrentMonth:ce,today:Ie}),ot=eZ(we),oe=Ei(),ve=Y.useRef(null),je=ai(ve,a);io(()=>{g&&!D&&!H&&!Q&&ve.current.focus()},[g,D,H,Q]);const He=ze=>{de(ze),Q&&ze.preventDefault()},Le=ze=>{D||X(M),Q&&ze.currentTarget.focus(),q&&q(ze)};return Q&&!ce?L.jsx(rZ,{className:rr(ot.root,ot.hiddenDaySpacingFiller,_),ownerState:we,role:Ce.role}):L.jsx(tZ,vt({className:rr(ot.root,_),ref:je,centerRipple:!0,disabled:D,tabIndex:K?0:-1,onKeyDown:ze=>le(ze,M),onFocus:ze=>se(ze,M),onBlur:ze=>ne(ze,M),onMouseEnter:ze=>te(ze,M),onClick:Le,onMouseDown:He},Ce,{ownerState:we,children:fe||oe.format(M,"dayOfMonth")}))}),iZ=Y.memo(nZ),oZ=e=>Ir("MuiPickersSlideTransition",e),ha=Mr("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),sZ=["children","className","reduceAnimations","slideDirection","transKey","classes"],aZ=e=>{const{classes:r,slideDirection:a}=e,u={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${a}`],exitActive:[`slideExitActiveLeft-${a}`]};return Er(u,oZ,r)},lZ=bt(Fy,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(e,r)=>[r.root,{[`.${ha["slideEnter-left"]}`]:r["slideEnter-left"]},{[`.${ha["slideEnter-right"]}`]:r["slideEnter-right"]},{[`.${ha.slideEnterActive}`]:r.slideEnterActive},{[`.${ha.slideExit}`]:r.slideExit},{[`.${ha["slideExitActiveLeft-left"]}`]:r["slideExitActiveLeft-left"]},{[`.${ha["slideExitActiveLeft-right"]}`]:r["slideExitActiveLeft-right"]}]})(({theme:e})=>{const r=e.transitions.create("transform",{duration:e.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${ha["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${ha["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${ha.slideEnterActive}`]:{transform:"translate(0%)",transition:r},[`& .${ha.slideExit}`]:{transform:"translate(0%)"},[`& .${ha["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:r,zIndex:0},[`& .${ha["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:r,zIndex:0}}});function cZ(e){const r=oi({props:e,name:"MuiPickersSlideTransition"}),{children:a,className:u,reduceAnimations:g,transKey:_}=r,M=Sn(r,sZ),D=aZ(r),i=jl();if(g)return L.jsx("div",{className:rr(D.root,u),children:a});const j={exit:D.exit,enterActive:D.enterActive,enter:D.enter,exitActive:D.exitActive};return L.jsx(lZ,{className:rr(D.root,u),childFactory:H=>Y.cloneElement(H,{classNames:j}),role:"presentation",children:L.jsx(BC,vt({mountOnEnter:!0,unmountOnExit:!0,timeout:i.transitions.duration.complex,classNames:j},M,{children:a}),_)})}const uZ=e=>Ir("MuiDayCalendar",e);Mr("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const dZ=["parentProps","day","focusableDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],hZ=["ownerState"],pZ=e=>{const{classes:r}=e;return Er({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},uZ,r)},A4=(Sy+k1*2)*6,fZ=bt("div",{name:"MuiDayCalendar",slot:"Root",overridesResolver:(e,r)=>r.root})({}),mZ=bt("div",{name:"MuiDayCalendar",slot:"Header",overridesResolver:(e,r)=>r.header})({display:"flex",justifyContent:"center",alignItems:"center"}),gZ=bt(nn,{name:"MuiDayCalendar",slot:"WeekDayLabel",overridesResolver:(e,r)=>r.weekDayLabel})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(e.vars||e).palette.text.secondary})),yZ=bt(nn,{name:"MuiDayCalendar",slot:"WeekNumberLabel",overridesResolver:(e,r)=>r.weekNumberLabel})(({theme:e})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:e.palette.text.disabled})),_Z=bt(nn,{name:"MuiDayCalendar",slot:"WeekNumber",overridesResolver:(e,r)=>r.weekNumber})(({theme:e})=>vt({},e.typography.caption,{width:Sy,height:Sy,padding:0,margin:`0 ${k1}px`,color:e.palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),xZ=bt("div",{name:"MuiDayCalendar",slot:"LoadingContainer",overridesResolver:(e,r)=>r.loadingContainer})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:A4}),vZ=bt(cZ,{name:"MuiDayCalendar",slot:"SlideTransition",overridesResolver:(e,r)=>r.slideTransition})({minHeight:A4}),bZ=bt("div",{name:"MuiDayCalendar",slot:"MonthContainer",overridesResolver:(e,r)=>r.monthContainer})({overflow:"hidden"}),wZ=bt("div",{name:"MuiDayCalendar",slot:"WeekContainer",overridesResolver:(e,r)=>r.weekContainer})({margin:`${k1}px 0`,display:"flex",justifyContent:"center"});function SZ(e){let{parentProps:r,day:a,focusableDay:u,selectedDays:g,isDateDisabled:_,currentMonthNumber:M,isViewFocused:D}=e,i=Sn(e,dZ);const{disabled:j,disableHighlightToday:H,isMonthSwitchingAnimating:q,showDaysOutsideCurrentMonth:X,slots:se,slotProps:ne,timezone:le}=r,de=Ei(),te=Uy(le),Q=u!==null&&de.isSameDay(a,u),K=g.some(je=>de.isSameDay(je,a)),ce=de.isSameDay(a,te),fe=(se==null?void 0:se.day)??iZ,Ie=jn({elementType:fe,externalSlotProps:ne==null?void 0:ne.day,additionalProps:vt({disableHighlightToday:H,showDaysOutsideCurrentMonth:X,role:"gridcell",isAnimating:q,"data-timestamp":de.toJsDate(a).valueOf()},i),ownerState:vt({},r,{day:a,selected:K})}),Ce=Sn(Ie,hZ),we=Y.useMemo(()=>j||_(a),[j,_,a]),ot=Y.useMemo(()=>de.getMonth(a)!==M,[de,a,M]),oe=Y.useMemo(()=>{const je=de.startOfMonth(de.setMonth(a,M));return X?de.isSameDay(a,de.startOfWeek(je)):de.isSameDay(a,je)},[M,a,X,de]),ve=Y.useMemo(()=>{const je=de.endOfMonth(de.setMonth(a,M));return X?de.isSameDay(a,de.endOfWeek(je)):de.isSameDay(a,je)},[M,a,X,de]);return L.jsx(fe,vt({},Ce,{day:a,disabled:we,autoFocus:D&&Q,today:ce,outsideCurrentMonth:ot,isFirstVisibleCell:oe,isLastVisibleCell:ve,selected:K,tabIndex:Q?0:-1,"aria-selected":K,"aria-current":ce?"date":void 0}))}function TZ(e){const r=oi({props:e,name:"MuiDayCalendar"}),a=Ei(),{onFocusedDayChange:u,className:g,currentMonth:_,selectedDays:M,focusedDay:D,loading:i,onSelectedDaysChange:j,onMonthSwitchingAnimationEnd:H,readOnly:q,reduceAnimations:X,renderLoading:se=()=>L.jsx("span",{children:"..."}),slideDirection:ne,TransitionProps:le,disablePast:de,disableFuture:te,minDate:Q,maxDate:K,shouldDisableDate:ce,shouldDisableMonth:fe,shouldDisableYear:Ie,dayOfWeekFormatter:Ce=qt=>a.format(qt,"weekdayShort").charAt(0).toUpperCase(),hasFocus:we,onFocusedViewChange:ot,gridLabelId:oe,displayWeekNumber:ve,fixedWeekNumber:je,autoFocus:He,timezone:Le}=r,ze=Uy(Le),Pe=pZ(r),tt=fs(),De=E4({shouldDisableDate:ce,shouldDisableMonth:fe,shouldDisableYear:Ie,minDate:Q,maxDate:K,disablePast:de,disableFuture:te,timezone:Le}),Ke=nl(),[Ge,ft]=tl({name:"DayCalendar",state:"hasFocus",controlled:we,default:He??!1}),[Gt,Ft]=Y.useState(()=>D||ze),wt=Ar(qt=>{q||j(qt)}),Rt=qt=>{De(qt)||(u(qt),Ft(qt),ot==null||ot(!0),ft(!0))},It=Ar((qt,Lt)=>{switch(qt.key){case"ArrowUp":Rt(a.addDays(Lt,-7)),qt.preventDefault();break;case"ArrowDown":Rt(a.addDays(Lt,7)),qt.preventDefault();break;case"ArrowLeft":{const Yt=a.addDays(Lt,tt?1:-1),Wt=a.addMonths(Lt,tt?1:-1),wr=Qg({utils:a,date:Yt,minDate:tt?Yt:a.startOfMonth(Wt),maxDate:tt?a.endOfMonth(Wt):Yt,isDateDisabled:De,timezone:Le});Rt(wr||Yt),qt.preventDefault();break}case"ArrowRight":{const Yt=a.addDays(Lt,tt?-1:1),Wt=a.addMonths(Lt,tt?-1:1),wr=Qg({utils:a,date:Yt,minDate:tt?a.startOfMonth(Wt):Yt,maxDate:tt?Yt:a.endOfMonth(Wt),isDateDisabled:De,timezone:Le});Rt(wr||Yt),qt.preventDefault();break}case"Home":Rt(a.startOfWeek(Lt)),qt.preventDefault();break;case"End":Rt(a.endOfWeek(Lt)),qt.preventDefault();break;case"PageUp":Rt(a.addMonths(Lt,1)),qt.preventDefault();break;case"PageDown":Rt(a.addMonths(Lt,-1)),qt.preventDefault();break}}),zt=Ar((qt,Lt)=>Rt(Lt)),At=Ar((qt,Lt)=>{Ge&&a.isSameDay(Gt,Lt)&&(ot==null||ot(!1))}),kt=a.getMonth(_),Ot=a.getYear(_),be=Y.useMemo(()=>M.filter(qt=>!!qt).map(qt=>a.startOfDay(qt)),[a,M]),Ht=`${Ot}-${kt}`,xt=Y.useMemo(()=>Y.createRef(),[Ht]),Bt=Y.useMemo(()=>{const qt=a.startOfMonth(_),Lt=a.endOfMonth(_);return De(Gt)||a.isAfterDay(Gt,Lt)||a.isBeforeDay(Gt,qt)?Qg({utils:a,date:Gt,minDate:qt,maxDate:Lt,disablePast:de,disableFuture:te,isDateDisabled:De,timezone:Le}):Gt},[_,te,de,Gt,De,a,Le]),rt=Y.useMemo(()=>{const qt=a.getWeekArray(_);let Lt=a.addMonths(_,1);for(;je&&qt.length<je;){const Yt=a.getWeekArray(Lt),Wt=a.isSameDay(qt[qt.length-1][0],Yt[0][0]);Yt.slice(Wt?1:0).forEach(wr=>{qt.length<je&&qt.push(wr)}),Lt=a.addMonths(Lt,1)}return qt},[_,je,a]);return L.jsxs(fZ,{role:"grid","aria-labelledby":oe,className:Pe.root,children:[L.jsxs(mZ,{role:"row",className:Pe.header,children:[ve&&L.jsx(yZ,{variant:"caption",role:"columnheader","aria-label":Ke.calendarWeekNumberHeaderLabel,className:Pe.weekNumberLabel,children:Ke.calendarWeekNumberHeaderText}),R7(a,ze).map((qt,Lt)=>L.jsx(gZ,{variant:"caption",role:"columnheader","aria-label":a.format(qt,"weekday"),className:Pe.weekDayLabel,children:Ce(qt)},Lt.toString()))]}),i?L.jsx(xZ,{className:Pe.loadingContainer,children:se()}):L.jsx(vZ,vt({transKey:Ht,onExited:H,reduceAnimations:X,slideDirection:ne,className:rr(g,Pe.slideTransition)},le,{nodeRef:xt,children:L.jsx(bZ,{ref:xt,role:"rowgroup",className:Pe.monthContainer,children:rt.map((qt,Lt)=>L.jsxs(wZ,{role:"row",className:Pe.weekContainer,"aria-rowindex":Lt+1,children:[ve&&L.jsx(_Z,{className:Pe.weekNumber,role:"rowheader","aria-label":Ke.calendarWeekNumberAriaLabelText(a.getWeekNumber(qt[0])),children:Ke.calendarWeekNumberText(a.getWeekNumber(qt[0]))}),qt.map((Yt,Wt)=>L.jsx(SZ,{parentProps:r,day:Yt,selectedDays:be,focusableDay:Bt,onKeyDown:It,onFocus:zt,onBlur:At,onDaySelect:wt,isDateDisabled:De,currentMonthNumber:kt,isViewFocused:Ge,"aria-colindex":Wt+1},Yt.toString()))]},`week-${qt[0]}`))})}))]})}function CZ(e){return Ir("MuiPickersMonth",e)}const dx=Mr("MuiPickersMonth",["root","monthButton","disabled","selected"]),MZ=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","aria-label","monthsPerRow","slots","slotProps"],EZ=e=>{const{disabled:r,selected:a,classes:u}=e;return Er({root:["root"],monthButton:["monthButton",r&&"disabled",a&&"selected"]},CZ,u)},IZ=bt("div",{name:"MuiPickersMonth",slot:"Root",overridesResolver:(e,r)=>[r.root]})({display:"flex",alignItems:"center",justifyContent:"center",flexBasis:"33.3%",variants:[{props:{monthsPerRow:4},style:{flexBasis:"25%"}}]}),kZ=bt("button",{name:"MuiPickersMonth",slot:"MonthButton",overridesResolver:(e,r)=>[r.monthButton,{[`&.${dx.disabled}`]:r.disabled},{[`&.${dx.selected}`]:r.selected}]})(({theme:e})=>vt({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{margin:"8px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.action.active,e.palette.action.hoverOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${dx.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${dx.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),PZ=Y.memo(function(r){const a=oi({props:r,name:"MuiPickersMonth"}),{autoFocus:u,className:g,children:_,disabled:M,selected:D,value:i,tabIndex:j,onClick:H,onKeyDown:q,onFocus:X,onBlur:se,"aria-current":ne,"aria-label":le,slots:de,slotProps:te}=a,Q=Sn(a,MZ),K=Y.useRef(null),ce=EZ(a);io(()=>{var Ce;u&&((Ce=K.current)==null||Ce.focus())},[u]);const fe=(de==null?void 0:de.monthButton)??kZ,Ie=jn({elementType:fe,externalSlotProps:te==null?void 0:te.monthButton,additionalProps:{children:_,disabled:M,tabIndex:j,ref:K,type:"button",role:"radio","aria-current":ne,"aria-checked":D,"aria-label":le,onClick:Ce=>H(Ce,i),onKeyDown:Ce=>q(Ce,i),onFocus:Ce=>X(Ce,i),onBlur:Ce=>se(Ce,i)},ownerState:a,className:ce.monthButton});return L.jsx(IZ,vt({className:rr(ce.root,g),ownerState:a},Q,{children:L.jsx(fe,vt({},Ie))}))});function AZ(e){return Ir("MuiMonthCalendar",e)}Mr("MuiMonthCalendar",["root"]);const DZ=["className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","autoFocus","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],RZ=e=>{const{classes:r}=e;return Er({root:["root"]},AZ,r)};function LZ(e,r){const a=Ei(),u=$y(),g=oi({props:e,name:r});return vt({disableFuture:!1,disablePast:!1},g,{minDate:Ca(a,g.minDate,u.minDate),maxDate:Ca(a,g.maxDate,u.maxDate)})}const zZ=bt("div",{name:"MuiMonthCalendar",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"flex",flexWrap:"wrap",alignContent:"stretch",padding:"0 4px",width:P1,boxSizing:"border-box"}),OZ=Y.forwardRef(function(r,a){const u=LZ(r,"MuiMonthCalendar"),{className:g,value:_,defaultValue:M,referenceDate:D,disabled:i,disableFuture:j,disablePast:H,maxDate:q,minDate:X,onChange:se,shouldDisableMonth:ne,readOnly:le,autoFocus:de=!1,onMonthFocus:te,hasFocus:Q,onFocusedViewChange:K,monthsPerRow:ce=3,timezone:fe,gridLabelId:Ie,slots:Ce,slotProps:we}=u,ot=Sn(u,DZ),{value:oe,handleValueChange:ve,timezone:je}=I1({name:"MonthCalendar",timezone:fe,value:_,defaultValue:M,referenceDate:D,onChange:se,valueManager:qs}),He=Uy(je),Le=fs(),ze=Ei(),Pe=Y.useMemo(()=>qs.getInitialReferenceValue({value:oe,utils:ze,props:u,timezone:je,referenceDate:D,granularity:Za.month}),[]),tt=u,De=RZ(tt),Ke=Y.useMemo(()=>ze.getMonth(He),[ze,He]),Ge=Y.useMemo(()=>oe!=null?ze.getMonth(oe):null,[oe,ze]),[ft,Gt]=Y.useState(()=>Ge||ze.getMonth(Pe)),[Ft,wt]=tl({name:"MonthCalendar",state:"hasFocus",controlled:Q,default:de??!1}),Rt=Ar(Ht=>{wt(Ht),K&&K(Ht)}),It=Y.useCallback(Ht=>{const xt=ze.startOfMonth(H&&ze.isAfter(He,X)?He:X),Bt=ze.startOfMonth(j&&ze.isBefore(He,q)?He:q),rt=ze.startOfMonth(Ht);return ze.isBefore(rt,xt)||ze.isAfter(rt,Bt)?!0:ne?ne(rt):!1},[j,H,q,X,He,ne,ze]),zt=Ar((Ht,xt)=>{if(le)return;const Bt=ze.setMonth(oe??Pe,xt);ve(Bt)}),At=Ar(Ht=>{It(ze.setMonth(oe??Pe,Ht))||(Gt(Ht),Rt(!0),te&&te(Ht))});Y.useEffect(()=>{Gt(Ht=>Ge!==null&&Ht!==Ge?Ge:Ht)},[Ge]);const kt=Ar((Ht,xt)=>{switch(Ht.key){case"ArrowUp":At((12+xt-3)%12),Ht.preventDefault();break;case"ArrowDown":At((12+xt+3)%12),Ht.preventDefault();break;case"ArrowLeft":At((12+xt+(Le?1:-1))%12),Ht.preventDefault();break;case"ArrowRight":At((12+xt+(Le?-1:1))%12),Ht.preventDefault();break}}),Ot=Ar((Ht,xt)=>{At(xt)}),be=Ar((Ht,xt)=>{ft===xt&&Rt(!1)});return L.jsx(zZ,vt({ref:a,className:rr(De.root,g),ownerState:tt,role:"radiogroup","aria-labelledby":Ie},ot,{children:ZC(ze,oe??Pe).map(Ht=>{const xt=ze.getMonth(Ht),Bt=ze.format(Ht,"monthShort"),rt=ze.format(Ht,"month"),qt=xt===Ge,Lt=i||It(Ht);return L.jsx(PZ,{selected:qt,value:xt,onClick:zt,onKeyDown:kt,autoFocus:Ft&&xt===ft,disabled:Lt,tabIndex:xt===ft&&!Lt?0:-1,onFocus:Ot,onBlur:be,"aria-current":Ke===xt?"date":void 0,"aria-label":rt,monthsPerRow:ce,slots:Ce,slotProps:we,children:Bt},Bt)})}))});function FZ(e){return Ir("MuiPickersYear",e)}const hx=Mr("MuiPickersYear",["root","yearButton","selected","disabled"]),BZ=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","yearsPerRow","slots","slotProps"],jZ=e=>{const{disabled:r,selected:a,classes:u}=e;return Er({root:["root"],yearButton:["yearButton",r&&"disabled",a&&"selected"]},FZ,u)},NZ=bt("div",{name:"MuiPickersYear",slot:"Root",overridesResolver:(e,r)=>[r.root]})({display:"flex",alignItems:"center",justifyContent:"center",flexBasis:"33.3%",variants:[{props:{yearsPerRow:4},style:{flexBasis:"25%"}}]}),VZ=bt("button",{name:"MuiPickersYear",slot:"YearButton",overridesResolver:(e,r)=>[r.yearButton,{[`&.${hx.disabled}`]:r.disabled},{[`&.${hx.selected}`]:r.selected}]})(({theme:e})=>vt({color:"unset",backgroundColor:"transparent",border:0,outline:0},e.typography.subtitle1,{margin:"6px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.focusOpacity})`:Bn(e.palette.action.active,e.palette.action.focusOpacity)},"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Bn(e.palette.action.active,e.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${hx.disabled}`]:{color:(e.vars||e).palette.text.secondary},[`&.${hx.selected}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.main,"&:focus, &:hover":{backgroundColor:(e.vars||e).palette.primary.dark}}})),$Z=Y.memo(function(r){const a=oi({props:r,name:"MuiPickersYear"}),{autoFocus:u,className:g,children:_,disabled:M,selected:D,value:i,tabIndex:j,onClick:H,onKeyDown:q,onFocus:X,onBlur:se,"aria-current":ne,slots:le,slotProps:de}=a,te=Sn(a,BZ),Q=Y.useRef(null),K=jZ(a);io(()=>{var Ie;u&&((Ie=Q.current)==null||Ie.focus())},[u]);const ce=(le==null?void 0:le.yearButton)??VZ,fe=jn({elementType:ce,externalSlotProps:de==null?void 0:de.yearButton,additionalProps:{children:_,disabled:M,tabIndex:j,ref:Q,type:"button",role:"radio","aria-current":ne,"aria-checked":D,onClick:Ie=>H(Ie,i),onKeyDown:Ie=>q(Ie,i),onFocus:Ie=>X(Ie,i),onBlur:Ie=>se(Ie,i)},ownerState:a,className:K.yearButton});return L.jsx(NZ,vt({className:rr(K.root,g),ownerState:a},te,{children:L.jsx(ce,vt({},fe))}))});function UZ(e){return Ir("MuiYearCalendar",e)}Mr("MuiYearCalendar",["root"]);const WZ=["autoFocus","className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],GZ=e=>{const{classes:r}=e;return Er({root:["root"]},UZ,r)};function HZ(e,r){const a=Ei(),u=$y(),g=oi({props:e,name:r});return vt({disablePast:!1,disableFuture:!1},g,{yearsPerRow:g.yearsPerRow??3,minDate:Ca(a,g.minDate,u.minDate),maxDate:Ca(a,g.maxDate,u.maxDate)})}const qZ=bt("div",{name:"MuiYearCalendar",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"auto",height:"100%",padding:"0 4px",width:P1,maxHeight:cq,boxSizing:"border-box",position:"relative"}),ZZ=Y.forwardRef(function(r,a){const u=HZ(r,"MuiYearCalendar"),{autoFocus:g,className:_,value:M,defaultValue:D,referenceDate:i,disabled:j,disableFuture:H,disablePast:q,maxDate:X,minDate:se,onChange:ne,readOnly:le,shouldDisableYear:de,onYearFocus:te,hasFocus:Q,onFocusedViewChange:K,yearsOrder:ce="asc",yearsPerRow:fe,timezone:Ie,gridLabelId:Ce,slots:we,slotProps:ot}=u,oe=Sn(u,WZ),{value:ve,handleValueChange:je,timezone:He}=I1({name:"YearCalendar",timezone:Ie,value:M,defaultValue:D,referenceDate:i,onChange:ne,valueManager:qs}),Le=Uy(He),ze=fs(),Pe=Ei(),tt=Y.useMemo(()=>qs.getInitialReferenceValue({value:ve,utils:Pe,props:u,timezone:He,referenceDate:i,granularity:Za.year}),[]),De=u,Ke=GZ(De),Ge=Y.useMemo(()=>Pe.getYear(Le),[Pe,Le]),ft=Y.useMemo(()=>ve!=null?Pe.getYear(ve):null,[ve,Pe]),[Gt,Ft]=Y.useState(()=>ft||Pe.getYear(tt)),[wt,Rt]=tl({name:"YearCalendar",state:"hasFocus",controlled:Q,default:g??!1}),It=Ar(Yt=>{Rt(Yt),K&&K(Yt)}),zt=Y.useCallback(Yt=>{if(q&&Pe.isBeforeYear(Yt,Le)||H&&Pe.isAfterYear(Yt,Le)||se&&Pe.isBeforeYear(Yt,se)||X&&Pe.isAfterYear(Yt,X))return!0;if(!de)return!1;const Wt=Pe.startOfYear(Yt);return de(Wt)},[H,q,X,se,Le,de,Pe]),At=Ar((Yt,Wt)=>{if(le)return;const wr=Pe.setYear(ve??tt,Wt);je(wr)}),kt=Ar(Yt=>{zt(Pe.setYear(ve??tt,Yt))||(Ft(Yt),It(!0),te==null||te(Yt))});Y.useEffect(()=>{Ft(Yt=>ft!==null&&Yt!==ft?ft:Yt)},[ft]);const Ot=ce!=="desc"?fe*1:fe*-1,be=ze&&ce==="asc"||!ze&&ce==="desc"?-1:1,Ht=Ar((Yt,Wt)=>{switch(Yt.key){case"ArrowUp":kt(Wt-Ot),Yt.preventDefault();break;case"ArrowDown":kt(Wt+Ot),Yt.preventDefault();break;case"ArrowLeft":kt(Wt-be),Yt.preventDefault();break;case"ArrowRight":kt(Wt+be),Yt.preventDefault();break}}),xt=Ar((Yt,Wt)=>{kt(Wt)}),Bt=Ar((Yt,Wt)=>{Gt===Wt&&It(!1)}),rt=Y.useRef(null),qt=ai(a,rt);Y.useEffect(()=>{if(g||rt.current===null)return;const Yt=rt.current.querySelector('[tabindex="0"]');if(!Yt)return;const Wt=Yt.offsetHeight,wr=Yt.offsetTop,Sr=rt.current.clientHeight,dn=rt.current.scrollTop,Tt=wr+Wt;Wt>Sr||wr<dn||(rt.current.scrollTop=Tt-Sr/2-Wt/2)},[g]);const Lt=Pe.getYearRange([se,X]);return ce==="desc"&&Lt.reverse(),L.jsx(qZ,vt({ref:qt,className:rr(Ke.root,_),ownerState:De,role:"radiogroup","aria-labelledby":Ce},oe,{children:Lt.map(Yt=>{const Wt=Pe.getYear(Yt),wr=Wt===ft,Sr=j||zt(Yt);return L.jsx($Z,{selected:wr,value:Wt,onClick:At,onKeyDown:Ht,autoFocus:wt&&Wt===Gt,disabled:Sr,tabIndex:Wt===Gt&&!Sr?0:-1,onFocus:xt,onBlur:Bt,"aria-current":Ge===Wt?"date":void 0,yearsPerRow:fe,slots:we,slotProps:ot,children:Pe.format(Yt,"year")},Pe.format(Yt,"year"))})}))}),YZ=e=>Ir("MuiPickersCalendarHeader",e),XZ=Mr("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]);function KZ(e){return Ir("MuiPickersArrowSwitcher",e)}Mr("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const JZ=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId"],QZ=["ownerState"],eY=["ownerState"],tY=bt("div",{name:"MuiPickersArrowSwitcher",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"flex"}),rY=bt("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer",overridesResolver:(e,r)=>r.spacer})(({theme:e})=>({width:e.spacing(3)})),lD=bt(Sf,{name:"MuiPickersArrowSwitcher",slot:"Button",overridesResolver:(e,r)=>r.button})({variants:[{props:{hidden:!0},style:{visibility:"hidden"}}]}),nY=e=>{const{classes:r}=e;return Er({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},KZ,r)},D4=Y.forwardRef(function(r,a){const u=fs(),g=oi({props:r,name:"MuiPickersArrowSwitcher"}),{children:_,className:M,slots:D,slotProps:i,isNextDisabled:j,isNextHidden:H,onGoToNext:q,nextLabel:X,isPreviousDisabled:se,isPreviousHidden:ne,onGoToPrevious:le,previousLabel:de,labelId:te}=g,Q=Sn(g,JZ),K=g,ce=nY(K),fe={isDisabled:j,isHidden:H,goTo:q,label:X},Ie={isDisabled:se,isHidden:ne,goTo:le,label:de},Ce=(D==null?void 0:D.previousIconButton)??lD,we=jn({elementType:Ce,externalSlotProps:i==null?void 0:i.previousIconButton,additionalProps:{size:"medium",title:Ie.label,"aria-label":Ie.label,disabled:Ie.isDisabled,edge:"end",onClick:Ie.goTo},ownerState:vt({},K,{hidden:Ie.isHidden}),className:rr(ce.button,ce.previousIconButton)}),ot=(D==null?void 0:D.nextIconButton)??lD,oe=jn({elementType:ot,externalSlotProps:i==null?void 0:i.nextIconButton,additionalProps:{size:"medium",title:fe.label,"aria-label":fe.label,disabled:fe.isDisabled,edge:"start",onClick:fe.goTo},ownerState:vt({},K,{hidden:fe.isHidden}),className:rr(ce.button,ce.nextIconButton)}),ve=(D==null?void 0:D.leftArrowIcon)??bH,je=jn({elementType:ve,externalSlotProps:i==null?void 0:i.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:K,className:ce.leftArrowIcon}),He=Sn(je,QZ),Le=(D==null?void 0:D.rightArrowIcon)??wH,ze=jn({elementType:Le,externalSlotProps:i==null?void 0:i.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:K,className:ce.rightArrowIcon}),Pe=Sn(ze,eY);return L.jsxs(tY,vt({ref:a,className:rr(ce.root,M),ownerState:K},Q,{children:[L.jsx(Ce,vt({},we,{children:u?L.jsx(Le,vt({},Pe)):L.jsx(ve,vt({},He))})),_?L.jsx(nn,{variant:"subtitle1",component:"span",id:te,children:_}):L.jsx(rY,{className:ce.spacer,ownerState:K}),L.jsx(ot,vt({},oe,{children:u?L.jsx(ve,vt({},He)):L.jsx(Le,vt({},Pe))}))]}))}),iY=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","timezone","format"],oY=["ownerState"],sY=e=>{const{classes:r}=e;return Er({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},YZ,r)},aY=bt("div",{name:"MuiPickersCalendarHeader",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),lY=bt("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer",overridesResolver:(e,r)=>r.labelContainer})(({theme:e})=>vt({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},e.typography.body1,{fontWeight:e.typography.fontWeightMedium})),cY=bt("div",{name:"MuiPickersCalendarHeader",slot:"Label",overridesResolver:(e,r)=>r.label})({marginRight:6}),uY=bt(Sf,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton",overridesResolver:(e,r)=>r.switchViewButton})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${XZ.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),dY=bt(vH,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon",overridesResolver:(e,r)=>r.switchViewIcon})(({theme:e})=>({willChange:"transform",transition:e.transitions.create("transform"),transform:"rotate(0deg)"})),hY=Y.forwardRef(function(r,a){const u=nl(),g=Ei(),_=oi({props:r,name:"MuiPickersCalendarHeader"}),{slots:M,slotProps:D,currentMonth:i,disabled:j,disableFuture:H,disablePast:q,maxDate:X,minDate:se,onMonthChange:ne,onViewChange:le,view:de,reduceAnimations:te,views:Q,labelId:K,className:ce,timezone:fe,format:Ie=`${g.formats.month} ${g.formats.year}`}=_,Ce=Sn(_,iY),we=_,ot=sY(_),oe=(M==null?void 0:M.switchViewButton)??uY,ve=jn({elementType:oe,externalSlotProps:D==null?void 0:D.switchViewButton,additionalProps:{size:"small","aria-label":u.calendarViewSwitchingButtonAriaLabel(de)},ownerState:we,className:ot.switchViewButton}),je=(M==null?void 0:M.switchViewIcon)??dY,He=jn({elementType:je,externalSlotProps:D==null?void 0:D.switchViewIcon,ownerState:we,className:ot.switchViewIcon}),Le=Sn(He,oY),ze=()=>ne(g.addMonths(i,1),"left"),Pe=()=>ne(g.addMonths(i,-1),"right"),tt=aq(i,{disableFuture:H,maxDate:X,timezone:fe}),De=lq(i,{disablePast:q,minDate:se,timezone:fe}),Ke=()=>{if(!(Q.length===1||!le||j))if(Q.length===2)le(Q.find(ft=>ft!==de)||Q[0]);else{const ft=Q.indexOf(de)!==0?0:1;le(Q[ft])}};if(Q.length===1&&Q[0]==="year")return null;const Ge=g.formatByString(i,Ie);return L.jsxs(aY,vt({},Ce,{ownerState:we,className:rr(ot.root,ce),ref:a,children:[L.jsxs(lY,{role:"presentation",onClick:Ke,ownerState:we,"aria-live":"polite",className:ot.labelContainer,children:[L.jsx(I4,{reduceAnimations:te,transKey:Ge,children:L.jsx(cY,{id:K,ownerState:we,className:ot.label,children:Ge})}),Q.length>1&&!j&&L.jsx(oe,vt({},ve,{children:L.jsx(je,vt({},Le))}))]}),L.jsx(By,{in:de==="day",appear:!te,enter:!te,children:L.jsx(D4,{slots:M,slotProps:D,onGoToPrevious:Pe,isPreviousDisabled:De,previousLabel:u.previousMonth,onGoToNext:ze,isNextDisabled:tt,nextLabel:u.nextMonth})})]}))}),R4=bt("div")({overflow:"hidden",width:P1,maxHeight:rM,display:"flex",flexDirection:"column",margin:"0 auto"}),pY="@media (prefers-reduced-motion: reduce)",rf=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),cD=rf&&rf[1]?parseInt(rf[1],10):null,uD=rf&&rf[2]?parseInt(rf[2],10):null,fY=cD&&cD<10||uD&&uD<13||!1,mY=()=>_6(pY,{defaultMatches:!1})||fY,gY=e=>Ir("MuiDateCalendar",e);Mr("MuiDateCalendar",["root","viewTransitionContainer"]);const yY=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],_Y=e=>{const{classes:r}=e;return Er({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},gY,r)};function xY(e,r){const a=Ei(),u=$y(),g=mY(),_=oi({props:e,name:r});return vt({},_,{loading:_.loading??!1,disablePast:_.disablePast??!1,disableFuture:_.disableFuture??!1,openTo:_.openTo??"day",views:_.views??["year","day"],reduceAnimations:_.reduceAnimations??g,renderLoading:_.renderLoading??(()=>L.jsx("span",{children:"..."})),minDate:Ca(a,_.minDate,u.minDate),maxDate:Ca(a,_.maxDate,u.maxDate)})}const vY=bt(R4,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"flex",flexDirection:"column",height:rM}),bY=bt(I4,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(e,r)=>r.viewTransitionContainer})({}),wY=Y.forwardRef(function(r,a){const u=Ei(),g=Bu(),_=xY(r,"MuiDateCalendar"),{autoFocus:M,onViewChange:D,value:i,defaultValue:j,referenceDate:H,disableFuture:q,disablePast:X,onChange:se,onYearChange:ne,onMonthChange:le,reduceAnimations:de,shouldDisableDate:te,shouldDisableMonth:Q,shouldDisableYear:K,view:ce,views:fe,openTo:Ie,className:Ce,disabled:we,readOnly:ot,minDate:oe,maxDate:ve,disableHighlightToday:je,focusedView:He,onFocusedViewChange:Le,showDaysOutsideCurrentMonth:ze,fixedWeekNumber:Pe,dayOfWeekFormatter:tt,slots:De,slotProps:Ke,loading:Ge,renderLoading:ft,displayWeekNumber:Gt,yearsOrder:Ft,yearsPerRow:wt,monthsPerRow:Rt,timezone:It}=_,zt=Sn(_,yY),{value:At,handleValueChange:kt,timezone:Ot}=I1({name:"DateCalendar",timezone:It,value:i,defaultValue:j,referenceDate:H,onChange:se,valueManager:qs}),{view:be,setView:Ht,focusedView:xt,setFocusedView:Bt,goToNextView:rt,setValueAndGoToNextView:qt}=nM({view:ce,views:fe,openTo:Ie,onChange:kt,onViewChange:D,autoFocus:M,focusedView:He,onFocusedViewChange:Le}),{referenceDate:Lt,calendarState:Yt,changeFocusedDay:Wt,changeMonth:wr,handleChangeMonth:Sr,isDateDisabled:dn,onMonthSwitchingAnimationEnd:Tt}=Zq({value:At,referenceDate:H,reduceAnimations:de,onMonthChange:le,minDate:oe,maxDate:ve,shouldDisableDate:te,disablePast:X,disableFuture:q,timezone:Ot}),ar=we&&At||oe,Xt=we&&At||ve,Hr=`${g}-grid-label`,zr=xt!==null,br=(De==null?void 0:De.calendarHeader)??hY,Qr=jn({elementType:br,externalSlotProps:Ke==null?void 0:Ke.calendarHeader,additionalProps:{views:fe,view:be,currentMonth:Yt.currentMonth,onViewChange:Ht,onMonthChange:(hr,Mn)=>Sr({newMonth:hr,direction:Mn}),minDate:ar,maxDate:Xt,disabled:we,disablePast:X,disableFuture:q,reduceAnimations:de,timezone:Ot,labelId:Hr},ownerState:_}),pn=Ar(hr=>{const Mn=u.startOfMonth(hr),bi=u.endOfMonth(hr),sn=dn(hr)?Qg({utils:u,date:hr,minDate:u.isBefore(oe,Mn)?Mn:oe,maxDate:u.isAfter(ve,bi)?bi:ve,disablePast:X,disableFuture:q,isDateDisabled:dn,timezone:Ot}):hr;sn?(qt(sn,"finish"),le==null||le(Mn)):(rt(),wr(Mn)),Wt(sn,!0)}),Wr=Ar(hr=>{const Mn=u.startOfYear(hr),bi=u.endOfYear(hr),sn=dn(hr)?Qg({utils:u,date:hr,minDate:u.isBefore(oe,Mn)?Mn:oe,maxDate:u.isAfter(ve,bi)?bi:ve,disablePast:X,disableFuture:q,isDateDisabled:dn,timezone:Ot}):hr;sn?(qt(sn,"finish"),ne==null||ne(sn)):(rt(),wr(Mn)),Wt(sn,!0)}),Jn=Ar(hr=>kt(hr&&gv(u,hr,At??Lt),"finish",be));Y.useEffect(()=>{At!=null&&u.isValid(At)&&wr(At)},[At]);const li=_,Dr=_Y(li),dr={disablePast:X,disableFuture:q,maxDate:ve,minDate:oe},gr={disableHighlightToday:je,readOnly:ot,disabled:we,timezone:Ot,gridLabelId:Hr,slots:De,slotProps:Ke},Zr=Y.useRef(be);Y.useEffect(()=>{Zr.current!==be&&(xt===Zr.current&&Bt(be,!0),Zr.current=be)},[xt,Bt,be]);const hn=Y.useMemo(()=>[At],[At]);return L.jsxs(vY,vt({ref:a,className:rr(Dr.root,Ce),ownerState:li},zt,{children:[L.jsx(br,vt({},Qr,{slots:De,slotProps:Ke})),L.jsx(bY,{reduceAnimations:de,className:Dr.viewTransitionContainer,transKey:be,ownerState:li,children:L.jsxs("div",{children:[be==="year"&&L.jsx(ZZ,vt({},dr,gr,{value:At,onChange:Wr,shouldDisableYear:K,hasFocus:zr,onFocusedViewChange:hr=>Bt("year",hr),yearsOrder:Ft,yearsPerRow:wt,referenceDate:Lt})),be==="month"&&L.jsx(OZ,vt({},dr,gr,{hasFocus:zr,className:Ce,value:At,onChange:pn,shouldDisableMonth:Q,onFocusedViewChange:hr=>Bt("month",hr),monthsPerRow:Rt,referenceDate:Lt})),be==="day"&&L.jsx(TZ,vt({},Yt,dr,gr,{onMonthSwitchingAnimationEnd:Tt,onFocusedDayChange:Wt,reduceAnimations:de,selectedDays:hn,onSelectedDaysChange:Jn,shouldDisableDate:te,shouldDisableMonth:Q,shouldDisableYear:K,hasFocus:zr,onFocusedViewChange:hr=>Bt("day",hr),showDaysOutsideCurrentMonth:ze,fixedWeekNumber:Pe,dayOfWeekFormatter:tt,displayWeekNumber:Gt,loading:Ge,renderLoading:ft}))]})})]}))}),lS=({view:e,onViewChange:r,views:a,focusedView:u,onFocusedViewChange:g,value:_,defaultValue:M,referenceDate:D,onChange:i,className:j,classes:H,disableFuture:q,disablePast:X,minDate:se,maxDate:ne,shouldDisableDate:le,shouldDisableMonth:de,shouldDisableYear:te,reduceAnimations:Q,onMonthChange:K,monthsPerRow:ce,onYearChange:fe,yearsOrder:Ie,yearsPerRow:Ce,slots:we,slotProps:ot,loading:oe,renderLoading:ve,disableHighlightToday:je,readOnly:He,disabled:Le,showDaysOutsideCurrentMonth:ze,dayOfWeekFormatter:Pe,sx:tt,autoFocus:De,fixedWeekNumber:Ke,displayWeekNumber:Ge,timezone:ft})=>L.jsx(wY,{view:e,onViewChange:r,views:a.filter(yv),focusedView:u&&yv(u)?u:null,onFocusedViewChange:g,value:_,defaultValue:M,referenceDate:D,onChange:i,className:j,classes:H,disableFuture:q,disablePast:X,minDate:se,maxDate:ne,shouldDisableDate:le,shouldDisableMonth:de,shouldDisableYear:te,reduceAnimations:Q,onMonthChange:K,monthsPerRow:ce,onYearChange:fe,yearsOrder:Ie,yearsPerRow:Ce,slots:we,slotProps:ot,loading:oe,renderLoading:ve,disableHighlightToday:je,readOnly:He,disabled:Le,showDaysOutsideCurrentMonth:ze,dayOfWeekFormatter:Pe,sx:tt,autoFocus:De,fixedWeekNumber:Ke,displayWeekNumber:Ge,timezone:ft});function SY(e){return Ir("MuiTimeClock",e)}Mr("MuiTimeClock",["root","arrowSwitcher"]);const mf=220,dc=36,Ty={x:mf/2,y:mf/2},L4={x:Ty.x,y:0},TY=L4.x-Ty.x,CY=L4.y-Ty.y,MY=e=>e*(180/Math.PI),z4=(e,r,a)=>{const u=r-Ty.x,g=a-Ty.y,_=Math.atan2(TY,CY)-Math.atan2(u,g);let M=MY(_);M=Math.round(M/e)*e,M%=360;const D=Math.floor(M/e)||0,i=u**2+g**2,j=Math.sqrt(i);return{value:D,distance:j}},EY=(e,r,a=1)=>{const u=a*6;let{value:g}=z4(u,e,r);return g=g*a%60,g},IY=(e,r,a)=>{const{value:u,distance:g}=z4(30,e,r);let _=u||12;return a?_%=12:g<mf/2-dc&&(_+=12,_%=24),_};function kY(e){return Ir("MuiClockPointer",e)}Mr("MuiClockPointer",["root","thumb"]);const PY=["className","hasSelected","isInner","type","viewValue"],AY=e=>{const{classes:r}=e;return Er({root:["root"],thumb:["thumb"]},kY,r)},DY=bt("div",{name:"MuiClockPointer",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>({width:2,backgroundColor:(e.vars||e).palette.primary.main,position:"absolute",left:"calc(50% - 1px)",bottom:"50%",transformOrigin:"center bottom 0px",variants:[{props:{shouldAnimate:!0},style:{transition:e.transitions.create(["transform","height"])}}]})),RY=bt("div",{name:"MuiClockPointer",slot:"Thumb",overridesResolver:(e,r)=>r.thumb})(({theme:e})=>({width:4,height:4,backgroundColor:(e.vars||e).palette.primary.contrastText,borderRadius:"50%",position:"absolute",top:-21,left:`calc(50% - ${dc/2}px)`,border:`${(dc-4)/2}px solid ${(e.vars||e).palette.primary.main}`,boxSizing:"content-box",variants:[{props:{hasSelected:!0},style:{backgroundColor:(e.vars||e).palette.primary.main}}]}));function LY(e){const r=oi({props:e,name:"MuiClockPointer"}),{className:a,isInner:u,type:g,viewValue:_}=r,M=Sn(r,PY),D=Y.useRef(g);Y.useEffect(()=>{D.current=g},[g]);const i=vt({},r,{shouldAnimate:D.current!==g}),j=AY(i),H=()=>{let X=360/(g==="hours"?12:60)*_;return g==="hours"&&_>12&&(X-=360),{height:Math.round((u?.26:.4)*mf),transform:`rotateZ(${X}deg)`}};return L.jsx(DY,vt({style:H(),className:rr(j.root,a),ownerState:i},M,{children:L.jsx(RY,{ownerState:i,className:j.thumb})}))}function zY(e){return Ir("MuiClock",e)}Mr("MuiClock",["root","clock","wrapper","squareMask","pin","amButton","pmButton","meridiemText","selected"]);const OY=e=>{const{classes:r,meridiemMode:a}=e;return Er({root:["root"],clock:["clock"],wrapper:["wrapper"],squareMask:["squareMask"],pin:["pin"],amButton:["amButton",a==="am"&&"selected"],pmButton:["pmButton",a==="pm"&&"selected"],meridiemText:["meridiemText"]},zY,r)},FY=bt("div",{name:"MuiClock",slot:"Root",overridesResolver:(e,r)=>r.root})(({theme:e})=>({display:"flex",justifyContent:"center",alignItems:"center",margin:e.spacing(2)})),BY=bt("div",{name:"MuiClock",slot:"Clock",overridesResolver:(e,r)=>r.clock})({backgroundColor:"rgba(0,0,0,.07)",borderRadius:"50%",height:220,width:220,flexShrink:0,position:"relative",pointerEvents:"none"}),jY=bt("div",{name:"MuiClock",slot:"Wrapper",overridesResolver:(e,r)=>r.wrapper})({"&:focus":{outline:"none"}}),NY=bt("div",{name:"MuiClock",slot:"SquareMask",overridesResolver:(e,r)=>r.squareMask})({width:"100%",height:"100%",position:"absolute",pointerEvents:"auto",outline:0,touchAction:"none",userSelect:"none",variants:[{props:{disabled:!1},style:{"@media (pointer: fine)":{cursor:"pointer",borderRadius:"50%"},"&:active":{cursor:"move"}}}]}),VY=bt("div",{name:"MuiClock",slot:"Pin",overridesResolver:(e,r)=>r.pin})(({theme:e})=>({width:6,height:6,borderRadius:"50%",backgroundColor:(e.vars||e).palette.primary.main,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})),O4=(e,r)=>({zIndex:1,bottom:8,paddingLeft:4,paddingRight:4,width:dc,variants:[{props:{meridiemMode:r},style:{backgroundColor:(e.vars||e).palette.primary.main,color:(e.vars||e).palette.primary.contrastText,"&:hover":{backgroundColor:(e.vars||e).palette.primary.light}}}]}),$Y=bt(Sf,{name:"MuiClock",slot:"AmButton",overridesResolver:(e,r)=>r.amButton})(({theme:e})=>vt({},O4(e,"am"),{position:"absolute",left:8})),UY=bt(Sf,{name:"MuiClock",slot:"PmButton",overridesResolver:(e,r)=>r.pmButton})(({theme:e})=>vt({},O4(e,"pm"),{position:"absolute",right:8})),dD=bt(nn,{name:"MuiClock",slot:"meridiemText",overridesResolver:(e,r)=>r.meridiemText})({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"});function WY(e){const r=oi({props:e,name:"MuiClock"}),{ampm:a,ampmInClock:u,autoFocus:g,children:_,value:M,handleMeridiemChange:D,isTimeDisabled:i,meridiemMode:j,minutesStep:H=1,onChange:q,selectedId:X,type:se,viewValue:ne,viewRange:[le,de],disabled:te=!1,readOnly:Q,className:K}=r,ce=r,fe=Ei(),Ie=nl(),Ce=Y.useRef(!1),we=OY(ce),ot=i(ne,se),oe=!a&&se==="hours"&&(ne<1||ne>12),ve=(Ft,wt)=>{te||Q||i(Ft,se)||q(Ft,wt)},je=(Ft,wt)=>{let{offsetX:Rt,offsetY:It}=Ft;if(Rt===void 0){const At=Ft.target.getBoundingClientRect();Rt=Ft.changedTouches[0].clientX-At.left,It=Ft.changedTouches[0].clientY-At.top}const zt=se==="seconds"||se==="minutes"?EY(Rt,It,H):IY(Rt,It,!!a);ve(zt,wt)},He=Ft=>{Ce.current=!0,je(Ft,"shallow")},Le=Ft=>{Ce.current&&(je(Ft,"finish"),Ce.current=!1),Ft.preventDefault()},ze=Ft=>{Ft.buttons>0&&je(Ft.nativeEvent,"shallow")},Pe=Ft=>{Ce.current&&(Ce.current=!1),je(Ft.nativeEvent,"finish")},tt=Y.useMemo(()=>se==="hours"?!0:ne%5===0,[se,ne]),De=se==="minutes"?H:1,Ke=Y.useRef(null);io(()=>{g&&Ke.current.focus()},[g]);const Ge=Ft=>Math.max(le,Math.min(de,Ft)),ft=Ft=>(Ft+(de+1))%(de+1),Gt=Ft=>{if(!Ce.current)switch(Ft.key){case"Home":ve(le,"partial"),Ft.preventDefault();break;case"End":ve(de,"partial"),Ft.preventDefault();break;case"ArrowUp":ve(ft(ne+De),"partial"),Ft.preventDefault();break;case"ArrowDown":ve(ft(ne-De),"partial"),Ft.preventDefault();break;case"PageUp":ve(Ge(ne+5),"partial"),Ft.preventDefault();break;case"PageDown":ve(Ge(ne-5),"partial"),Ft.preventDefault();break;case"Enter":case" ":ve(ne,"finish"),Ft.preventDefault();break}};return L.jsxs(FY,{className:rr(we.root,K),children:[L.jsxs(BY,{className:we.clock,children:[L.jsx(NY,{onTouchMove:He,onTouchStart:He,onTouchEnd:Le,onMouseUp:Pe,onMouseMove:ze,ownerState:{disabled:te},className:we.squareMask}),!ot&&L.jsxs(Y.Fragment,{children:[L.jsx(VY,{className:we.pin}),M!=null&&L.jsx(LY,{type:se,viewValue:ne,isInner:oe,hasSelected:tt})]}),L.jsx(jY,{"aria-activedescendant":X,"aria-label":Ie.clockLabelText(se,M,fe,M==null?null:fe.format(M,"fullTime")),ref:Ke,role:"listbox",onKeyDown:Gt,tabIndex:0,className:we.wrapper,children:_})]}),a&&u&&L.jsxs(Y.Fragment,{children:[L.jsx($Y,{onClick:Q?void 0:()=>D("am"),disabled:te||j===null,ownerState:ce,className:we.amButton,title:$d(fe,"am"),children:L.jsx(dD,{variant:"caption",className:we.meridiemText,children:$d(fe,"am")})}),L.jsx(UY,{disabled:te||j===null,onClick:Q?void 0:()=>D("pm"),ownerState:ce,className:we.pmButton,title:$d(fe,"pm"),children:L.jsx(dD,{variant:"caption",className:we.meridiemText,children:$d(fe,"pm")})})]})]})}function GY(e){return Ir("MuiClockNumber",e)}const px=Mr("MuiClockNumber",["root","selected","disabled"]),HY=["className","disabled","index","inner","label","selected"],qY=e=>{const{classes:r,selected:a,disabled:u}=e;return Er({root:["root",a&&"selected",u&&"disabled"]},GY,r)},ZY=bt("span",{name:"MuiClockNumber",slot:"Root",overridesResolver:(e,r)=>[r.root,{[`&.${px.disabled}`]:r.disabled},{[`&.${px.selected}`]:r.selected}]})(({theme:e})=>({height:dc,width:dc,position:"absolute",left:`calc((100% - ${dc}px) / 2)`,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:"50%",color:(e.vars||e).palette.text.primary,fontFamily:e.typography.fontFamily,"&:focused":{backgroundColor:(e.vars||e).palette.background.paper},[`&.${px.selected}`]:{color:(e.vars||e).palette.primary.contrastText},[`&.${px.disabled}`]:{pointerEvents:"none",color:(e.vars||e).palette.text.disabled},variants:[{props:{inner:!0},style:vt({},e.typography.body2,{color:(e.vars||e).palette.text.secondary})}]}));function F4(e){const r=oi({props:e,name:"MuiClockNumber"}),{className:a,disabled:u,index:g,inner:_,label:M,selected:D}=r,i=Sn(r,HY),j=r,H=qY(j),q=g%12/12*Math.PI*2-Math.PI/2,X=(mf-dc-2)/2*(_?.65:1),se=Math.round(Math.cos(q)*X),ne=Math.round(Math.sin(q)*X);return L.jsx(ZY,vt({className:rr(H.root,a),"aria-disabled":u?!0:void 0,"aria-selected":D?!0:void 0,role:"option",style:{transform:`translate(${se}px, ${ne+(mf-dc)/2}px`},ownerState:j},i,{children:M}))}const YY=({ampm:e,value:r,getClockNumberText:a,isDisabled:u,selectedId:g,utils:_})=>{const M=r?_.getHours(r):null,D=[],i=e?1:0,j=e?12:23,H=q=>M===null?!1:e?q===12?M===12||M===0:M===q||M-12===q:M===q;for(let q=i;q<=j;q+=1){let X=q.toString();q===0&&(X="00");const se=!e&&(q===0||q>12);X=_.formatNumber(X);const ne=H(q);D.push(L.jsx(F4,{id:ne?g:void 0,index:q,inner:se,selected:ne,disabled:u(q),label:X,"aria-label":a(X)},q))}return D},hD=({utils:e,value:r,isDisabled:a,getClockNumberText:u,selectedId:g})=>{const _=e.formatNumber;return[[5,_("05")],[10,_("10")],[15,_("15")],[20,_("20")],[25,_("25")],[30,_("30")],[35,_("35")],[40,_("40")],[45,_("45")],[50,_("50")],[55,_("55")],[0,_("00")]].map(([M,D],i)=>{const j=M===r;return L.jsx(F4,{label:D,id:j?g:void 0,index:i+1,inner:!1,disabled:a(M),selected:j,"aria-label":u(D)},M)})},XY=({value:e,referenceDate:r,utils:a,props:u,timezone:g})=>{const _=Y.useMemo(()=>qs.getInitialReferenceValue({value:e,utils:a,props:u,referenceDate:r,granularity:Za.day,timezone:g,getTodayDate:()=>YC(a,g,"date")}),[]);return e??_},KY=["ampm","ampmInClock","autoFocus","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableTime","showViewSwitcher","onChange","view","views","openTo","onViewChange","focusedView","onFocusedViewChange","className","disabled","readOnly","timezone"],JY=e=>{const{classes:r}=e;return Er({root:["root"],arrowSwitcher:["arrowSwitcher"]},SY,r)},QY=bt(R4,{name:"MuiTimeClock",slot:"Root",overridesResolver:(e,r)=>r.root})({display:"flex",flexDirection:"column",position:"relative"}),eX=bt(D4,{name:"MuiTimeClock",slot:"ArrowSwitcher",overridesResolver:(e,r)=>r.arrowSwitcher})({position:"absolute",right:12,top:15}),tX=["hours","minutes"],rX=Y.forwardRef(function(r,a){const u=Ei(),g=oi({props:r,name:"MuiTimeClock"}),{ampm:_=u.is12HourCycleInCurrentLocale(),ampmInClock:M=!1,autoFocus:D,slots:i,slotProps:j,value:H,defaultValue:q,referenceDate:X,disableIgnoringDatePartForTimeValidation:se=!1,maxTime:ne,minTime:le,disableFuture:de,disablePast:te,minutesStep:Q=1,shouldDisableTime:K,showViewSwitcher:ce,onChange:fe,view:Ie,views:Ce=tX,openTo:we,onViewChange:ot,focusedView:oe,onFocusedViewChange:ve,className:je,disabled:He,readOnly:Le,timezone:ze}=g,Pe=Sn(g,KY),{value:tt,handleValueChange:De,timezone:Ke}=I1({name:"TimeClock",timezone:ze,value:H,defaultValue:q,referenceDate:X,onChange:fe,valueManager:qs}),Ge=XY({value:tt,referenceDate:X,utils:u,props:g,timezone:Ke}),ft=nl(),Gt=Uy(Ke),{view:Ft,setView:wt,previousView:Rt,nextView:It,setValueAndGoToNextView:zt}=nM({view:Ie,views:Ce,openTo:we,onViewChange:ot,onChange:De,focusedView:oe,onFocusedViewChange:ve}),{meridiemMode:At,handleMeridiemChange:kt}=C4(Ge,_,zt),Ot=Y.useCallback((rt,qt)=>{const Lt=XC(se,u),Yt=qt==="hours"||qt==="minutes"&&Ce.includes("seconds"),Wt=({start:Sr,end:dn})=>!(le&&Lt(le,dn)||ne&&Lt(Sr,ne)||de&&Lt(Sr,Gt)||te&&Lt(Gt,Yt?dn:Sr)),wr=(Sr,dn=1)=>{if(Sr%dn!==0)return!1;if(K)switch(qt){case"hours":return!K(u.setHours(Ge,Sr),"hours");case"minutes":return!K(u.setMinutes(Ge,Sr),"minutes");case"seconds":return!K(u.setSeconds(Ge,Sr),"seconds");default:return!1}return!0};switch(qt){case"hours":{const Sr=gT(rt,At,_),dn=u.setHours(Ge,Sr);if(u.getHours(dn)!==Sr)return!0;const Tt=u.setSeconds(u.setMinutes(dn,0),0),ar=u.setSeconds(u.setMinutes(dn,59),59);return!Wt({start:Tt,end:ar})||!wr(Sr)}case"minutes":{const Sr=u.setMinutes(Ge,rt),dn=u.setSeconds(Sr,0),Tt=u.setSeconds(Sr,59);return!Wt({start:dn,end:Tt})||!wr(rt,Q)}case"seconds":{const Sr=u.setSeconds(Ge,rt);return!Wt({start:Sr,end:Sr})||!wr(rt)}default:throw new Error("not supported")}},[_,Ge,se,ne,At,le,Q,K,u,de,te,Gt,Ce]),be=Bu(),Ht=Y.useMemo(()=>{switch(Ft){case"hours":{const rt=(Yt,Wt)=>{const wr=gT(Yt,At,_);zt(u.setHours(Ge,wr),Wt,"hours")},qt=u.getHours(Ge);let Lt;return _?qt>12?Lt=[12,23]:Lt=[0,11]:Lt=[0,23],{onChange:rt,viewValue:qt,children:YY({value:tt,utils:u,ampm:_,onChange:rt,getClockNumberText:ft.hoursClockNumberText,isDisabled:Yt=>He||Ot(Yt,"hours"),selectedId:be}),viewRange:Lt}}case"minutes":{const rt=u.getMinutes(Ge),qt=(Lt,Yt)=>{zt(u.setMinutes(Ge,Lt),Yt,"minutes")};return{viewValue:rt,onChange:qt,children:hD({utils:u,value:rt,onChange:qt,getClockNumberText:ft.minutesClockNumberText,isDisabled:Lt=>He||Ot(Lt,"minutes"),selectedId:be}),viewRange:[0,59]}}case"seconds":{const rt=u.getSeconds(Ge),qt=(Lt,Yt)=>{zt(u.setSeconds(Ge,Lt),Yt,"seconds")};return{viewValue:rt,onChange:qt,children:hD({utils:u,value:rt,onChange:qt,getClockNumberText:ft.secondsClockNumberText,isDisabled:Lt=>He||Ot(Lt,"seconds"),selectedId:be}),viewRange:[0,59]}}default:throw new Error("You must provide the type for ClockView")}},[Ft,u,tt,_,ft.hoursClockNumberText,ft.minutesClockNumberText,ft.secondsClockNumberText,At,zt,Ge,Ot,be,He]),xt=g,Bt=JY(xt);return L.jsxs(QY,vt({ref:a,className:rr(Bt.root,je),ownerState:xt},Pe,{children:[L.jsx(WY,vt({autoFocus:D??!!oe,ampmInClock:M&&Ce.includes("hours"),value:tt,type:Ft,ampm:_,minutesStep:Q,isTimeDisabled:Ot,meridiemMode:At,handleMeridiemChange:kt,selectedId:be,disabled:He,readOnly:Le},Ht)),ce&&L.jsx(eX,{className:Bt.arrowSwitcher,slots:i,slotProps:j,onGoToPrevious:()=>wt(Rt),isPreviousDisabled:!Rt,previousLabel:ft.openPreviousView,onGoToNext:()=>wt(It),isNextDisabled:!It,nextLabel:ft.openNextView,ownerState:xt})]}))}),cS=({view:e,onViewChange:r,focusedView:a,onFocusedViewChange:u,views:g,value:_,defaultValue:M,referenceDate:D,onChange:i,className:j,classes:H,disableFuture:q,disablePast:X,minTime:se,maxTime:ne,shouldDisableTime:le,minutesStep:de,ampm:te,ampmInClock:Q,slots:K,slotProps:ce,readOnly:fe,disabled:Ie,sx:Ce,autoFocus:we,showViewSwitcher:ot,disableIgnoringDatePartForTimeValidation:oe,timezone:ve})=>L.jsx(rX,{view:e,onViewChange:r,focusedView:a&&_v(a)?a:null,onFocusedViewChange:u,views:g.filter(_v),value:_,defaultValue:M,referenceDate:D,onChange:i,className:j,classes:H,disableFuture:q,disablePast:X,minTime:se,maxTime:ne,shouldDisableTime:le,minutesStep:de,ampm:te,ampmInClock:Q,slots:K,slotProps:ce,readOnly:fe,disabled:Ie,sx:Ce,autoFocus:we,showViewSwitcher:ot,disableIgnoringDatePartForTimeValidation:oe,timezone:ve}),nX=["views","format"],iX=(e,r,a)=>{let{views:u,format:g}=r,_=Sn(r,nX);if(g)return g;const M=[],D=[];if(u.forEach(H=>{_v(H)?D.push(H):yv(H)&&M.push(H)}),D.length===0)return KA(e,vt({views:M},_));if(M.length===0)return QA(e,vt({views:D},_));const i=QA(e,vt({views:D},_));return`${KA(e,vt({views:M},_))} ${i}`},xT=Y.forwardRef(function(r,a){var H,q,X;const u=nl(),g=Ei(),_=_q(r,"MuiMobileDateTimePicker"),M=vt({day:lS,month:lS,year:lS,hours:cS,minutes:cS,seconds:cS},_.viewRenderers),D=_.ampmInClock??!1,i=vt({},_,{viewRenderers:M,format:iX(g,_),ampmInClock:D,slots:vt({field:NH},_.slots),slotProps:vt({},_.slotProps,{field:se=>{var ne;return vt({},DC((ne=_.slotProps)==null?void 0:ne.field,se),tH(_),{ref:a})},toolbar:vt({hidden:!1,ampmInClock:D},(H=_.slotProps)==null?void 0:H.toolbar),tabs:vt({hidden:!1},(q=_.slotProps)==null?void 0:q.tabs)})}),{renderPicker:j}=Hq({props:i,valueManager:qs,valueType:"date-time",getOpenDialogAriaText:nH({utils:g,formatKey:"fullDate",contextTranslation:u.openDatePickerDialogue,propsTranslation:(X=i.localeText)==null?void 0:X.openDatePickerDialogue}),validator:eM});return j()});xT.propTypes={ampm:Cr.bool,ampmInClock:Cr.bool,autoFocus:Cr.bool,className:Cr.string,closeOnSelect:Cr.bool,dayOfWeekFormatter:Cr.func,defaultValue:Cr.object,disabled:Cr.bool,disableFuture:Cr.bool,disableHighlightToday:Cr.bool,disableIgnoringDatePartForTimeValidation:Cr.bool,disableOpenPicker:Cr.bool,disablePast:Cr.bool,displayWeekNumber:Cr.bool,enableAccessibleFieldDOMStructure:Cr.any,fixedWeekNumber:Cr.number,format:Cr.string,formatDensity:Cr.oneOf(["dense","spacious"]),inputRef:S6,label:Cr.node,loading:Cr.bool,localeText:Cr.object,maxDate:Cr.object,maxDateTime:Cr.object,maxTime:Cr.object,minDate:Cr.object,minDateTime:Cr.object,minTime:Cr.object,minutesStep:Cr.number,monthsPerRow:Cr.oneOf([3,4]),name:Cr.string,onAccept:Cr.func,onChange:Cr.func,onClose:Cr.func,onError:Cr.func,onMonthChange:Cr.func,onOpen:Cr.func,onSelectedSectionsChange:Cr.func,onViewChange:Cr.func,onYearChange:Cr.func,open:Cr.bool,openTo:Cr.oneOf(["day","hours","minutes","month","seconds","year"]),orientation:Cr.oneOf(["landscape","portrait"]),readOnly:Cr.bool,reduceAnimations:Cr.bool,referenceDate:Cr.object,renderLoading:Cr.func,selectedSections:Cr.oneOfType([Cr.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),Cr.number]),shouldDisableDate:Cr.func,shouldDisableMonth:Cr.func,shouldDisableTime:Cr.func,shouldDisableYear:Cr.func,showDaysOutsideCurrentMonth:Cr.bool,slotProps:Cr.object,slots:Cr.object,sx:Cr.oneOfType([Cr.arrayOf(Cr.oneOfType([Cr.func,Cr.object,Cr.bool])),Cr.func,Cr.object]),timezone:Cr.string,value:Cr.object,view:Cr.oneOf(["day","hours","minutes","month","seconds","year"]),viewRenderers:Cr.shape({day:Cr.func,hours:Cr.func,minutes:Cr.func,month:Cr.func,seconds:Cr.func,year:Cr.func}),views:Cr.arrayOf(Cr.oneOf(["day","hours","minutes","month","seconds","year"]).isRequired),yearsOrder:Cr.oneOf(["asc","desc"]),yearsPerRow:Cr.oneOf([3,4])};function oX({title:e,action:r}){return L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},alignItems:"center",sx:{mb:1,paddingLeft:"15px",paddingRight:"5px"},children:[L.jsx(Rr,{size:{xs:10},children:L.jsx(nn,{variant:"h6",display:"inline",children:e})}),L.jsx(Rr,{size:{xs:2},children:L.jsx(va,{color:"primary",onClick:r,children:L.jsx(GC,{})})})]})}function sX({setShowAlert:e}){const r=()=>{e(!1)};return L.jsx(L.Fragment,{children:L.jsx(Ia,{fullScreen:!1,onClose:r,"aria-labelledby":"customized-dialog-title",open:!0,sx:{"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"515px"}}},children:L.jsxs(zn,{padding:"20px",children:[L.jsx(oX,{title:"Radar History Mode",action:r}),L.jsx(u4,{dateAdapter:N9,children:L.jsx(E7,{components:["MobileDateTimePicker"],children:L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch",paddingLeft:"20px"},children:[L.jsx(Rr,{size:{xs:6},children:L.jsx(xT,{defaultValue:ao("2022-04-17T15:30")})}),L.jsx(Rr,{size:{xs:6},children:L.jsx(xT,{defaultValue:ao("2024-04-17T15:30")})})]})})})]})})})}function aX({colorPickerTitle:e,sliderTitle:r,color:a,setColor:u,opacity:g,setOpacity:_}){return L.jsxs(zn,{margin:"10px",padding:"10px",backgroundColor:"#2E2E2E",borderRadius:"12px",children:[L.jsx(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch"},children:L.jsx(Rr,{size:{xs:12},children:L.jsx(ws,{label:e||"Color",type:"color",defaultValue:a,onChange:M=>u(M.target.value),fullWidth:!0})})}),L.jsx(nn,{gutterBottom:!0,children:r||"Width"}),L.jsx(Vd,{defaultValue:parseFloat(g),onChange:(M,D)=>_(D.toString()),step:.05,min:0,max:1,valueLabelDisplay:"auto"})]})}function El({value:e,setValue:r,title:a,hideSwitch:u=!1,colorPickerTitle:g,sliderTitle:_,color:M,setColor:D,width:i,setWidth:j}){return L.jsxs(zn,{margin:"10px",padding:"10px",backgroundColor:"#2E2E2E",borderRadius:"12px",children:[u?null:L.jsx(L.Fragment,{children:L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},sx:{mb:1,alignItems:"stretch"},children:[L.jsx(Rr,{size:{xs:6},children:L.jsx(nn,{display:"inline",children:a})}),L.jsx(Rr,{size:{xs:3},children:L.jsx(hv,{control:L.jsx(yc,{checked:e,onChange:H=>r(H.target.checked)}),label:""})}),L.jsx(Rr,{size:{xs:3},children:L.jsx(ws,{label:g||"Color",type:"color",defaultValue:M,onChange:H=>D(H.target.value),fullWidth:!0})})]})}),L.jsx(nn,{gutterBottom:!0,children:_||"Width"}),L.jsx(Vd,{defaultValue:parseFloat(i),onChange:(H,q)=>j(q.toString()),step:.1,min:.1,max:5,valueLabelDisplay:"auto"})]})}function lX({valueSatelliteLayer:e,setValueSatelliteLayer:r,valueSatelliteContours:a,setValueSatelliteContours:u}){return L.jsx(zn,{margin:"10px",padding:"10px",backgroundColor:"#2E2E2E",borderRadius:"12px",children:L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1},sx:{mb:1,alignItems:"stretch"},children:[L.jsxs(Rr,{size:{xs:6},children:[L.jsx(nn,{display:"inline",marginRight:"5px",children:"Satellite Layer"}),L.jsx(hv,{control:L.jsx(yc,{checked:e,onChange:g=>r(g.target.checked)}),label:""})]}),L.jsxs(Rr,{size:{xs:6},children:[L.jsx(nn,{display:"inline",marginRight:"5px",children:"Show Contours"}),L.jsx(hv,{control:L.jsx(yc,{checked:a,onChange:g=>u(g.target.checked)}),label:""})]})]})})}function pD({value:e,setValue:r,title:a,color:u,setColor:g,haloColor:_,setHaloColor:M,font:D,setFont:i,fontWeight:j,setFontWeight:H,fontSize:q,setFontSize:X}){return L.jsxs(zn,{margin:"10px",padding:"10px",backgroundColor:"#2E2E2E",borderRadius:"12px",children:[L.jsxs(Rr,{container:!0,rowSpacing:2,columnSpacing:{xs:1},sx:{mb:1,alignItems:"stretch"},children:[L.jsx(Rr,{size:{xs:8},children:L.jsx(nn,{display:"inline",marginRight:"15px",children:a})}),L.jsx(Rr,{size:{xs:4},children:L.jsx(hv,{control:L.jsx(yc,{checked:e,onChange:se=>r(se.target.checked)}),label:""})})]}),L.jsxs(Wz,{spacing:2,children:[L.jsxs(ws,{label:"Font Family",select:!0,fullWidth:!0,defaultValue:D,onChange:se=>i(se.target.value),children:[L.jsx(Ur,{value:"Arial Unicode MS",children:"Arial Unicode MS"}),L.jsx(Ur,{value:"Alegreya",children:"Alegreya"}),L.jsx(Ur,{value:"Alegreya SC",children:"Alegreya SC"}),L.jsx(Ur,{value:"Asap",children:"Asap"}),L.jsx(Ur,{value:"Barlow",children:"Barlow"}),L.jsx(Ur,{value:"DIN Pro",children:"DIN Pro"}),L.jsx(Ur,{value:"EB Garamond",children:"EB Garamond"}),L.jsx(Ur,{value:"Faustina",children:"Faustina"}),L.jsx(Ur,{value:"Frank Ruhl Libre",children:"Frank Ruhl Libre"}),L.jsx(Ur,{value:"Heebo",children:"Heebo"}),L.jsx(Ur,{value:"Inter",children:"Inter"}),L.jsx(Ur,{value:"Lato",children:"Lato"}),L.jsx(Ur,{value:"League Mono",children:"League Mono"}),L.jsx(Ur,{value:"Montserrat",children:"Montserrat"}),L.jsx(Ur,{value:"Manrope",children:"Manrope"}),L.jsx(Ur,{value:"Noto Sans CJK JP",children:"Noto Sans CJK JP"}),L.jsx(Ur,{value:"Open Sans",children:"Open Sans"}),L.jsx(Ur,{value:"Poppins",children:"Poppins"}),L.jsx(Ur,{value:"Raleway",children:"Raleway"}),L.jsx(Ur,{value:"Roboto",children:"Roboto"}),L.jsx(Ur,{value:"Roboto Mono",children:"Roboto Mono"}),L.jsx(Ur,{value:"Rubik",children:"Rubik"}),L.jsx(Ur,{value:"Source Code Pro",children:"Source Code Pro"}),L.jsx(Ur,{value:"Source Sans Pro",children:"Source Sans Pro"}),L.jsx(Ur,{value:"Spectral",children:"Spectral"}),L.jsx(Ur,{value:"Ubuntu",children:"Ubuntu"})]}),L.jsxs(ws,{label:"Font Weight",select:!0,fullWidth:!0,defaultValue:j,onChange:se=>H(se.target.value),children:[L.jsx(Ur,{value:"Regular",children:"Regular"}),L.jsx(Ur,{value:"Medium",children:"Medium"}),L.jsx(Ur,{value:"Bold",children:"Bold"})]}),L.jsx(ws,{label:"Font Size",type:"number",defaultValue:q,fullWidth:!0,onChange:se=>X(Number(se.target.value))}),L.jsx(ws,{label:"Text Color",type:"color",defaultValue:u,onChange:se=>g(se.target.value),fullWidth:!0}),L.jsx(ws,{label:"Halo Color",type:"color",defaultValue:_,onChange:se=>M(se.target.value),fullWidth:!0})]})]})}const cX=({projection:e,setProjection:r,satelliteLayer:a,setSatelliteLayer:u,contourLayer:g,setContourLayer:_,admin2Boundary:M,setAdmin2Boundary:D,admin2BoundaryColor:i,setAdmin2BoundaryColor:j,admin2BoundaryWidth:H,setAdmin2BoundaryWidth:q,admin1Boundary:X,setAdmin1Boundary:se,admin1BoundaryColor:ne,setAdmin1BoundaryColor:le,admin1BoundaryWidth:de,setAdmin1BoundaryWidth:te,admin0Boundary:Q,setAdmin0Boundary:K,admin0BoundaryColor:ce,setAdmin0BoundaryColor:fe,admin0BoundaryWidth:Ie,setAdmin0BoundaryWidth:Ce,settlementMajorLabel:we,setSettlementMajorLabel:ot,settlementMajorLabelFont:oe,setSettlementMajorLabelFont:ve,settlementMajorLabelFontWeight:je,setSettlementMajorLabelFontWeight:He,settlementMajorLabelFontSize:Le,setSettlementMajorLabelFontSize:ze,settlementMajorLabelColor:Pe,setSettlementMajorLabelColor:tt,settlementMajorLabelHaloColor:De,setSettlementMajorLabelHaloColor:Ke,settlementMinorLabel:Ge,setSettlementMinorLabel:ft,settlementMinorLabelFont:Gt,setSettlementMinorLabelFont:Ft,settlementMinorLabelFontWeight:wt,setSettlementMinorLabelFontWeight:Rt,settlementMinorLabelFontSize:It,setSettlementMinorLabelFontSize:zt,settlementMinorLabelColor:At,setSettlementMinorLabelColor:kt,settlementMinorLabelHaloColor:Ot,setSettlementMinorLabelHaloColor:be,primaryRoadNetwork:Ht,setPrimaryRoadNetwork:xt,primaryRoadNetworkColor:Bt,setPrimaryRoadNetworkColor:rt,primaryRoadNetworkWidth:qt,setPrimaryRoadNetworkWidth:Lt,secondaryRoadNetwork:Yt,setSecondaryRoadNetwork:Wt,secondaryRoadNetworkColor:wr,setSecondaryRoadNetworkColor:Sr,secondaryRoadNetworkWidth:dn,setSecondaryRoadNetworkWidth:Tt,motorwayRoadNetwork:ar,setMotorwayRoadNetwork:Xt,motorwayRoadNetworkColor:Hr,setMotorwayRoadNetworkColor:zr,motorwayRoadNetworkWidth:br,setMotorwayRoadNetworkWidth:Qr,motorwayLinkRoadNetwork:pn,setMotorwayLinkRoadNetwork:Wr,motorwayLinkRoadNetworkColor:Jn,setMotorwayLinkRoadNetworkColor:li,motorwayLinkRoadNetworkWidth:Dr,setMotorwayLinkRoadNetworkWidth:dr,trunkRoadNetwork:gr,setTrunkRoadNetwork:Zr,trunkRoadNetworkColor:hn,setTrunkRoadNetworkColor:hr,trunkRoadNetworkWidth:Mn,setTrunkRoadNetworkWidth:bi,tertiaryRoadNetwork:sn,setTertiaryRoadNetwork:qn,tertiaryRoadNetworkColor:uo,setTertiaryRoadNetworkColor:_o,tertiaryRoadNetworkWidth:eo,setTertiaryRoadNetworkWidth:ms,streetRoadNetwork:ut,setStreetRoadNetwork:ue,streetRoadNetworkColor:pe,setStreetRoadNetworkColor:ke,streetRoadNetworkWidth:Ve,setStreetRoadNetworkWidth:Be,backgroundColor:Xe,setBackgroundColor:lt,opacity:et,setOpacity:ct})=>L.jsxs(zn,{className:"map-state-control",maxWidth:"500px",children:[L.jsxs(zn,{className:"control-section",margin:"10px",padding:"10px",children:[L.jsx(nn,{variant:"h6",children:"Map Projection"}),L.jsx(ya,{}),L.jsx(Xz,{projection:e,setProjection:r})]}),L.jsxs(zn,{className:"control-section",margin:"10px",padding:"10px",children:[L.jsx(nn,{variant:"h6",children:"Map Layers"}),L.jsx(ya,{}),L.jsx(lX,{valueSatelliteLayer:a,setValueSatelliteLayer:u,valueSatelliteContours:g,setValueSatelliteContours:_})]}),L.jsxs(zn,{className:"control-section",margin:"10px",padding:"10px",children:[L.jsx(nn,{variant:"h6",children:"Administrative Boundaries"}),L.jsx(ya,{}),L.jsx(El,{value:M,setValue:D,title:"County Boundaries",color:i,setColor:j,width:H,setWidth:q}),L.jsx(El,{value:X,setValue:se,title:"State Boundaries",color:ne,setColor:le,width:de,setWidth:te}),L.jsx(El,{value:Q,setValue:K,title:"Country Boundaries",color:ce,setColor:fe,width:Ie,setWidth:Ce})]}),L.jsxs(zn,{className:"control-section",margin:"10px",padding:"10px",children:[L.jsx(nn,{variant:"h6",children:"Settlement Labels"}),L.jsx(ya,{}),L.jsx(pD,{value:we,setValue:ot,title:"Major Settlement Labels",color:Pe,setColor:tt,haloColor:De,setHaloColor:Ke,font:oe,setFont:ve,fontWeight:je,setFontWeight:He,fontSize:Le,setFontSize:ze}),L.jsx(pD,{value:Ge,setValue:ft,title:"Minor Settlement Labels",color:At,setColor:kt,haloColor:Ot,setHaloColor:be,font:Gt,setFont:Ft,fontWeight:wt,setFontWeight:Rt,fontSize:It,setFontSize:zt})]}),L.jsxs(zn,{className:"control-section",margin:"10px",padding:"10px",children:[L.jsx(nn,{variant:"h6",children:"Road Network"}),L.jsx(ya,{}),L.jsx(El,{value:Ht,setValue:xt,title:"Primary Road Network",color:Bt,setColor:rt,width:qt,setWidth:Lt}),L.jsx(El,{value:Yt,setValue:Wt,title:"Secondary Road Network",color:wr,setColor:Sr,width:dn,setWidth:Tt}),L.jsx(El,{value:ar,setValue:Xt,title:"Motorway Road Network",color:Hr,setColor:zr,width:br,setWidth:Qr}),L.jsx(El,{value:pn,setValue:Wr,title:"Motorway Link Road Network",color:Jn,setColor:li,width:Dr,setWidth:dr}),L.jsx(El,{value:gr,setValue:Zr,title:"Motorway Trunk Road Network",color:hn,setColor:hr,width:Mn,setWidth:bi}),L.jsx(El,{value:sn,setValue:qn,title:"Tertiary Road Network",color:uo,setColor:_o,width:eo,setWidth:ms}),L.jsx(El,{value:ut,setValue:ue,title:"Street Road Network",color:pe,setColor:ke,width:Ve,setWidth:Be})]}),L.jsxs(zn,{className:"control-section",margin:"10px",padding:"10px",children:[L.jsx(nn,{variant:"h6",children:"Background Design Settings"}),L.jsx(ya,{}),L.jsx(aX,{colorPickerTitle:"Background Color",sliderTitle:"Background Opacity",color:Xe,setColor:lt,opacity:et,setOpacity:ct})]})]}),uX=Oy({palette:{mode:"dark",background:{paper:wz[900]}},components:{MuiFormControl:{styleOverrides:{root:{}}},MuiInputLabel:{styleOverrides:{root:{color:"white","&.Mui-focused":{color:"white"}}}},MuiSelect:{styleOverrides:{root:{}}},MuiPaper:{styleOverrides:{root:{marginTop:"12px"}}},MuiFilledInput:{styleOverrides:{root:{backgroundColor:Al[800],boxShadow:"inset #FFF3 0px 1px 0px 0px,#000A 0px 1px 21px -5px",borderRadius:"10px",color:"white","&.Mui-focused":{backgroundColor:Al[700]},"&:hover":{backgroundColor:Al[600]},"&:active":{backgroundColor:Al[900],transition:"background-color 0s"},"&.Mui-focused:after":{display:"none"},"&:before":{borderBottom:"none",display:"none"}}}}}});function dX(){const[e,r]=Y.useState("single-site-radar");return L.jsx(kz,{theme:uX,children:L.jsxs(jy,{variant:"filled",fullWidth:!0,children:[L.jsx(T1,{id:"mode-select-label",children:"Weather Data"}),L.jsxs(Ny,{labelId:"mode-select-label",value:e,onChange:a=>{r(a.target.value)},variant:"filled",children:[L.jsx(jp,{children:"Radar"}),L.jsx(Ur,{value:"single-site-radar",children:"Single Site Radar"}),L.jsx(Ur,{value:"national-radar",children:"National Radar (CONUS)"}),L.jsx(jp,{children:"Satellite"}),L.jsx(Ur,{value:"global",children:"Global"}),L.jsx(Ur,{value:"regional",children:"Regional"}),L.jsx(Ur,{value:"storm-based",children:"Storm-Based"}),L.jsx(jp,{children:"Models"}),L.jsx(Ur,{value:"convection-allowing",children:"Convection-Allowing"}),L.jsx(Ur,{value:"regional",children:"Regional"}),L.jsx(Ur,{value:"global",children:"Global"}),L.jsx(Ur,{value:"tropical",children:"Tropical"}),L.jsx(jp,{children:"Forecasts"}),L.jsx(Ur,{value:"ndfd",children:"NDFD"})]})]})})}function hX(){const[e,r]=Y.useState(!1),[a,u]=Y.useState(""),{mode:g="system",setMode:_}=qV();return L.jsxs(X$,{position:"fixed",color:"transparent",style:{boxShadow:"none"},children:[L.jsx(lG,{children:L.jsx(Sf,{edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2,backgroundColor:"white",color:"black","&:hover":{backgroundColor:"black",color:"white"}},onClick:()=>r(!0),children:L.jsx(VG,{})})}),L.jsxs(U3,{open:e,onClose:()=>r(!1),children:[L.jsxs(zn,{sx:{width:320},p:2,children:[L.jsxs(Rr,{container:!0,direction:"row",sx:{justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[L.jsx(Rr,{children:L.jsx(nn,{variant:"h6",fontWeight:800,children:"RadarOmega"})}),L.jsx(Rr,{children:L.jsx(va,{onClick:()=>r(!1),children:L.jsx(qz,{color:"action"})})})]}),L.jsxs(Rr,{container:!0,direction:"column",spacing:2,children:[L.jsx(ws,{variant:"filled",label:"Search",fullWidth:!0}),L.jsx(dX,{})]})]}),L.jsx(zn,{px:2,children:L.jsx(nn,{fontWeight:400,color:"textSecondary",children:"General"})}),L.jsxs(Ns,{component:"nav",children:[L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{onClick:()=>u(a=="weather-alerts"?"":"weather-alerts"),children:[L.jsx(ni,{children:L.jsx(zG,{})}),L.jsx(kn,{primary:"Weather Alerts"}),a=="weather-alerts"?L.jsx(Vp,{}):L.jsx($p,{})]})}),L.jsxs(bu,{in:a=="weather-alerts",timeout:"auto",unmountOnExit:!0,children:[L.jsxs(Ns,{component:"div",children:[L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"United States"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Canada"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Germany"})]})})]}),L.jsx(ya,{})]}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{onClick:()=>u(a=="data-overlays"?"":"data-overlays"),children:[L.jsx(ni,{children:L.jsx(HG,{})}),L.jsx(kn,{primary:"Data Overlays"}),a=="data-overlays"?L.jsx(Vp,{}):L.jsx($p,{})]})}),L.jsxs(bu,{in:a=="data-overlays",timeout:"auto",unmountOnExit:!0,children:[L.jsxs(Ns,{component:"div",children:[L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Mesoscale Discussions"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Severe Weather"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Tropical Weather"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Hydrological Outlooks"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Fire Weather"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Winter Weather"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Climatological Outlooks"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"METARS"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Marine Tools"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Surface Fronts"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Surface Fronts"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Storm Reports"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Lightning Detection"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Nexrad History"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Spotter Network"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Power Outages"})]})})]}),L.jsx(ya,{})]}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{onClick:()=>u(a=="custom-locations"?"":"custom-locations"),children:[L.jsx(ni,{children:L.jsx(qG,{})}),L.jsx(kn,{primary:"Custom Locations"}),a=="custom-locations"?L.jsx(Vp,{}):L.jsx($p,{})]})}),L.jsxs(bu,{in:a=="custom-locations",timeout:"auto",unmountOnExit:!0,children:[L.jsxs(Ns,{component:"div",children:[L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Custom Location 1"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Custom Location 2"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Custom Location 3"})]})}),L.jsx(Vn,{disablePadding:!0,color:"yellow",children:L.jsxs(Kn,{color:"green",children:[L.jsx(ni,{}),L.jsx(kn,{color:"red",children:L.jsxs(Rr,{container:!0,spacing:2,alignItems:"center",children:[L.jsx(RG,{sx:{fontSize:20},color:"primary"}),L.jsx(nn,{color:"primary",children:"Add Location"})]})})]})})]}),L.jsx(ya,{})]}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{onClick:()=>u(a=="cyclone-port-network"?"":"cyclone-port-network"),children:[L.jsx(ni,{children:L.jsx(FG,{})}),L.jsx(kn,{primary:"cyclonePORT Network"}),a=="cyclone-port-network"?L.jsx(Vp,{}):L.jsx($p,{})]})}),L.jsxs(bu,{in:a=="cyclone-port-network",timeout:"auto",unmountOnExit:!0,children:[L.jsxs(Ns,{component:"div",children:[L.jsxs(Vn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"cyclonePORT",secondary:"200 Active"}),L.jsx(yc,{})]}),L.jsxs(Vn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Project MesoVort",secondary:"100 Active"}),L.jsx(yc,{})]}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{}),L.jsx(kn,{primary:"Device Settings"})]})})]}),L.jsx(ya,{})]})]}),L.jsx(zn,{px:2,children:L.jsx(nn,{fontWeight:400,color:"textSecondary",children:"Settings"})}),L.jsxs(Ns,{children:[L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{children:L.jsx(GG,{})}),L.jsx(kn,{primary:"General"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{children:L.jsx(WG,{})}),L.jsx(kn,{primary:"Manage Subscriptions"})]})}),L.jsx(Vn,{disablePadding:!0,children:L.jsxs(Kn,{children:[L.jsx(ni,{children:L.jsx(OG,{})}),L.jsx(kn,{primary:"Info & Support"})]})})]}),L.jsx(Rr,{container:!0,sx:{marginTop:"auto"},p:2,justifyContent:"end",children:L.jsx(Rr,{children:L.jsx(va,{onClick:()=>{const M=["system","light","dark"],D=M.indexOf(g);_(M[(D+1)%M.length])},children:g})})})]})]})}const pX="pk.eyJ1IjoibWV0ZW9kb24iLCJhIjoiY20yZG05MDM2MWIwdDJpcTQ5OTNiaWg4NCJ9.VSeZmvWg1L9kYJmbCafrJQ";function fX(){const e={position:"absolute",right:16,bottom:16},r={position:"absolute",right:16,bottom:86},a={position:"absolute",right:16,bottom:186},u={position:"absolute",right:16,bottom:286},g={position:"absolute",right:16,bottom:386},[_,M]=Y.useState(null),[D,i]=Y.useState(!1),[j,H]=Y.useState(!1),[q,X]=Y.useState(!1),[se,ne]=Y.useState(!1),[le,de]=Y.useState(!1),[te,Q]=Y.useState(!1),K=Y.useRef(null),ce=Y.useRef(null),[fe,Ie]=Y.useState("mercator"),[Ce,we]=Y.useState(!1),[ot,oe]=Y.useState(!1),[ve,je]=Y.useState(!0),[He,Le]=Y.useState(!0),[ze,Pe]=Y.useState(!0),[tt,De]=Y.useState(!0),[Ke,Ge]=Y.useState("Arial Unicode MS"),[ft,Gt]=Y.useState("Regular"),[Ft,wt]=Y.useState(18),[Rt,It]=Y.useState(!0),[zt,At]=Y.useState("Arial Unicode MS"),[kt,Ot]=Y.useState("Regular"),[be,Ht]=Y.useState(12),[xt,Bt]=Y.useState(!1),[rt,qt]=Y.useState(!1),[Lt,Yt]=Y.useState(!1),[Wt,wr]=Y.useState(!1),[Sr,dn]=Y.useState(!1),[Tt,ar]=Y.useState(!1),[Xt,Hr]=Y.useState(!1),[zr,br]=Y.useState("#FFFFFF"),[Qr,pn]=Y.useState("#00FF00"),[Wr,Jn]=Y.useState("#FFFFFF"),[li,Dr]=Y.useState("#FF0000"),[dr,gr]=Y.useState("#000000"),[Zr,hn]=Y.useState("#FFFFFF"),[hr,Mn]=Y.useState("#000000"),[bi,sn]=Y.useState("#FFFFFF"),[qn,uo]=Y.useState("#FFFFFF"),[_o,eo]=Y.useState("#FFFFFF"),[ms,ut]=Y.useState("#FFFFFF"),[ue,pe]=Y.useState("#FFFFFF"),[ke,Ve]=Y.useState("#FFFFFF"),[Be,Xe]=Y.useState("#FFFFFF"),[lt,et]=Y.useState("1"),[ct,yt]=Y.useState("1"),[mt,jt]=Y.useState("1"),[nr,or]=Y.useState("1"),[Or,Fr]=Y.useState("1"),[Br,jr]=Y.useState("1"),[Tn,Pn]=Y.useState("1"),[Yr,En]=Y.useState("1"),[ti,Ii]=Y.useState("1"),[ki,Zi]=Y.useState("1"),[Bo,Is]=Y.useState("#000000"),[Nl,Vl]=Y.useState("1");Y.useEffect(()=>(HA.accessToken=pX,K.current&&(console.log("EFFECT",K.current),ce.current=new HA.Map({container:K.current,style:"mapbox://styles/meteodon/cm4r1cny4000h01s89x0p8wm3",center:[-74.5,40],zoom:6,projection:fe})),()=>{var Ri;return(Ri=ce.current)==null?void 0:Ri.remove()}),[]),Y.useEffect(()=>{var Ri;ce.current&&((Ri=ce.current)==null||Ri.on("load",()=>{console.log("map loaded")}))},[K]),S9(ce,fe),T9(ce,Ce),_9(ce,ot),v9(ce,ve,zr,lt),C9(ce,He,Qr,ct),x9(ce,ze,Wr,mt),b9(ce,tt,li,dr,Ke,ft,Ft),w9(ce,Rt,Zr,hr,zt,kt,be),h9(ce,xt,bi,nr),p9(ce,rt,qn,Or),d9(ce,Lt,_o,Br),u9(ce,Wt,ms,Tn),g9(ce,Sr,ue,Yr),m9(ce,Tt,ke,ti),f9(ce,Xt,Be,ki),y9(ce,Bo,Nl);const il=Ri=>{M(Ri.currentTarget)},xc=Ri=>{i(!D)},ol=Ri=>{H(!j)},ju=Ri=>{X(!q)},Nu=Ri=>{ne(!se)},sl=!!_,al=sl?"simple-popover":void 0,jo=()=>{M(null)};return L.jsxs(zn,{sx:{display:"flex"},children:[L.jsx(cT,{fallback:L.jsx("div",{children:"Failed to load the Menu bar"}),children:L.jsx(hX,{})}),L.jsx(zn,{component:"main",sx:{flexGrow:1,bgcolor:"background.default",p:3},children:L.jsx(cT,{fallback:L.jsx("div",{children:"Failed to load the Map"}),children:L.jsx(c9,{drawerWidth:0,ref:K})})}),L.jsx(Id,{variant:"extended",sx:e,onClick:il,children:L.jsx(n$,{})}),L.jsx(Nz,{anchorOrigin:{vertical:"top",horizontal:"left"},id:al,open:sl,anchorEl:_,onClose:jo,transformOrigin:{vertical:"bottom",horizontal:"center"},children:L.jsx(cX,{projection:fe,setProjection:Ie,satelliteLayer:Ce,setSatelliteLayer:we,contourLayer:ot,setContourLayer:oe,admin2Boundary:ve,setAdmin2Boundary:je,admin2BoundaryColor:zr,setAdmin2BoundaryColor:br,admin2BoundaryWidth:lt,setAdmin2BoundaryWidth:et,admin1Boundary:He,setAdmin1Boundary:Le,admin1BoundaryColor:Qr,setAdmin1BoundaryColor:pn,admin1BoundaryWidth:ct,setAdmin1BoundaryWidth:yt,admin0Boundary:ze,setAdmin0Boundary:Pe,admin0BoundaryColor:Wr,setAdmin0BoundaryColor:Jn,admin0BoundaryWidth:mt,setAdmin0BoundaryWidth:jt,settlementMajorLabel:tt,setSettlementMajorLabel:De,settlementMajorLabelFont:Ke,setSettlementMajorLabelFont:Ge,settlementMajorLabelFontWeight:ft,setSettlementMajorLabelFontWeight:Gt,settlementMajorLabelFontSize:Ft,setSettlementMajorLabelFontSize:wt,settlementMajorLabelColor:li,setSettlementMajorLabelColor:Dr,settlementMajorLabelHaloColor:dr,setSettlementMajorLabelHaloColor:gr,settlementMinorLabel:Rt,setSettlementMinorLabel:It,settlementMinorLabelFont:zt,setSettlementMinorLabelFont:At,settlementMinorLabelFontWeight:kt,setSettlementMinorLabelFontWeight:Ot,settlementMinorLabelFontSize:be,setSettlementMinorLabelFontSize:Ht,settlementMinorLabelColor:Zr,setSettlementMinorLabelColor:hn,settlementMinorLabelHaloColor:hr,setSettlementMinorLabelHaloColor:Mn,primaryRoadNetwork:xt,setPrimaryRoadNetwork:Bt,primaryRoadNetworkColor:bi,setPrimaryRoadNetworkColor:sn,primaryRoadNetworkWidth:nr,setPrimaryRoadNetworkWidth:or,secondaryRoadNetwork:rt,setSecondaryRoadNetwork:qt,secondaryRoadNetworkColor:qn,setSecondaryRoadNetworkColor:uo,secondaryRoadNetworkWidth:Or,setSecondaryRoadNetworkWidth:Fr,motorwayRoadNetwork:Lt,setMotorwayRoadNetwork:Yt,motorwayRoadNetworkColor:_o,setMotorwayRoadNetworkColor:eo,motorwayRoadNetworkWidth:Br,setMotorwayRoadNetworkWidth:jr,motorwayLinkRoadNetwork:Wt,setMotorwayLinkRoadNetwork:wr,motorwayLinkRoadNetworkColor:ms,setMotorwayLinkRoadNetworkColor:ut,motorwayLinkRoadNetworkWidth:Tn,setMotorwayLinkRoadNetworkWidth:Pn,trunkRoadNetwork:Sr,setTrunkRoadNetwork:dn,trunkRoadNetworkColor:ue,setTrunkRoadNetworkColor:pe,trunkRoadNetworkWidth:Yr,setTrunkRoadNetworkWidth:En,tertiaryRoadNetwork:Tt,setTertiaryRoadNetwork:ar,tertiaryRoadNetworkColor:ke,setTertiaryRoadNetworkColor:Ve,tertiaryRoadNetworkWidth:ti,setTertiaryRoadNetworkWidth:Ii,streetRoadNetwork:Xt,setStreetRoadNetwork:Hr,streetRoadNetworkColor:Be,setStreetRoadNetworkColor:Xe,streetRoadNetworkWidth:ki,setStreetRoadNetworkWidth:Zi,backgroundColor:Bo,setBackgroundColor:Is,opacity:Nl,setOpacity:Vl})}),L.jsx(Id,{variant:"extended",sx:r,onClick:xc,children:L.jsx(tx,{})}),D?L.jsx(ZG,{setShowAlert:i}):null,L.jsx(Id,{variant:"extended",sx:a,onClick:ol,children:L.jsx(tx,{})}),j?L.jsx(a9,{setShowAlert:H}):null,L.jsx(Id,{variant:"extended",sx:u,onClick:ju,children:L.jsx(tx,{})}),q?L.jsx(s9,{setShowAlert:X}):null,L.jsx(Id,{variant:"extended",sx:g,onClick:Nu,children:L.jsx(tx,{})}),se?L.jsx(i9,{setShowAlert:ne}):null,L.jsx(Id,{variant:"extended",sx:{position:"absolute",right:16,bottom:486},onClick:()=>de(!0),children:"Map Settings"}),le?L.jsx(r9,{setShowAlert:de}):null,L.jsx(Id,{variant:"extended",sx:{position:"absolute",right:16,bottom:536},onClick:()=>Q(!0),children:"Date"}),te?L.jsx(sX,{setShowAlert:Q}):null]})}const mX=Oy({colorSchemes:{dark:!0},components:{MuiInput:{styleOverrides:{root:{borderBottom:"none"}}},MuiInputAdornment:{styleOverrides:{root:{border:"2px solid red",background:"red",borderBottom:"none"}}},MuiInputLabel:{styleOverrides:{root:{}}},MuiFilledInput:{styleOverrides:{root:{background:"linear-gradient(117deg, #3f424d 0%, #323337 60%)",boxShadow:"inset #FFF3 0px 1px 0px 0px,#000A 0px 1px 21px -5px",borderBottom:"none",borderRadius:"10px","&:before":{borderBottom:"none",display:"none"},"&.Mui-focused":{},"&.Mui-focused:after":{display:"none"}}}},MuiAppBar:{styleOverrides:{colorPrimary:{backgroundColor:"#1976d2"}}}}});function gX(){return L.jsx(L.Fragment,{children:L.jsx(kz,{theme:mX,children:L.jsx(cT,{fallback:L.jsx("div",{children:"Failed to load the Cams App"}),children:L.jsx(fX,{})})})})}ML(document.getElementById("root")).render(L.jsx(Y.StrictMode,{children:L.jsx(gX,{})}));
